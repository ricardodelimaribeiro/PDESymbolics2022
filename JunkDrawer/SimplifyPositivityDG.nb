(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    204417,       4964]
NotebookOptionsPosition[    197924,       4851]
NotebookOutlinePosition[    198261,       4866]
CellTagsIndexPosition[    198218,       4863]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<PDESymbolics2020`\>\"", "]"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"1f380f21-4c8a-4af3-9a81-0e8117b041e6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", "u", "}"}]}], ",", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}], ",", 
     RowBox[{"\"\<pars\>\"", "\[Rule]", 
      RowBox[{"{", "a", "}"}]}], ",", 
     RowBox[{"\"\<facts\>\"", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"xp", "=", 
  RowBox[{
   RowBox[{"DisintegrateOperator", "[", "variables", "]"}], "[", 
   RowBox[{
    RowBox[{
     RowBox[{"u", "[", "x", "]"}], " ", 
     RowBox[{
      RowBox[{"u", "''''"}], "[", "x", "]"}]}], "+", 
    RowBox[{"a", " ", 
     RowBox[{
      RowBox[{"u", "[", "x", "]"}], "^", "2"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SimplifyPositivityOperator", "[", "variables", "]"}], "[", 
  "\[IndentingNewLine]", 
  RowBox[{"Association", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\"\<expression\>\"", "\[Rule]", "xp"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<coefficients\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["\[FormalA]", "1"], ",", 
       SubscriptBox["\[FormalA]", "2"]}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "SimplifyPositivityExtremeEvenCoefficientsOperator", "[", "variables", 
   "]"}], "[", "\[IndentingNewLine]", 
  RowBox[{"Association", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\"\<expression\>\"", "\[Rule]", "xp"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<coefficients\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["\[FormalA]", "1"], ",", 
       SubscriptBox["\[FormalA]", "2"]}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.819868233782386*^9, 3.819868291503854*^9}, {
  3.81986839511388*^9, 3.819868538255951*^9}, {3.819868811221429*^9, 
  3.819868820281919*^9}, {3.8198688534656076`*^9, 3.819868854187896*^9}, {
  3.819868933723956*^9, 3.819868943693533*^9}, {3.8198689921673*^9, 
  3.819868997728249*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"7e904563-ce50-4fe5-8095-cc0620f8c731"],

Cell[BoxData[
 RowBox[{
  RowBox[{"a", " ", 
   SuperscriptBox[
    RowBox[{"u", "[", "x", "]"}], "2"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "+", 
     SubscriptBox["\[FormalA]", "1"], "-", 
     SubscriptBox["\[FormalA]", "2"]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{
     SuperscriptBox["u", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "x", "]"}], "2"]}], "+", 
  RowBox[{
   SubscriptBox["\[FormalA]", "1"], " ", 
   RowBox[{
    SuperscriptBox["u", "\[Prime]",
     MultilineFunction->None], "[", "x", "]"}], " ", 
   RowBox[{
    SuperscriptBox["u", 
     TagBox[
      RowBox[{"(", "3", ")"}],
      Derivative],
     MultilineFunction->None], "[", "x", "]"}]}], "+", 
  RowBox[{
   SubscriptBox["\[FormalA]", "2"], " ", 
   RowBox[{"u", "[", "x", "]"}], " ", 
   RowBox[{
    SuperscriptBox["u", 
     TagBox[
      RowBox[{"(", "4", ")"}],
      Derivative],
     MultilineFunction->None], "[", "x", "]"}]}]}]], "Output",
 CellChangeTimes->{{3.819868229847692*^9, 3.8198682342654057`*^9}, {
   3.819868265313801*^9, 3.8198682937867193`*^9}, {3.819868397483101*^9, 
   3.819868469880247*^9}, {3.8198685064369297`*^9, 3.8198685410115137`*^9}, 
   3.8198688209884*^9, 3.819868855414003*^9, {3.819868929656172*^9, 
   3.819868947036182*^9}, 3.819868998276793*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"b6ce34ab-c14b-49a7-9668-22a5c81a5fdc"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"\<\"expression\"\>", "\[Rule]", 
           RowBox[{
            RowBox[{"a", " ", 
             SuperscriptBox[
              RowBox[{"u", "[", "x", "]"}], "2"]}], "+", 
            SuperscriptBox[
             RowBox[{
              SuperscriptBox["u", "\[Prime]\[Prime]",
               MultilineFunction->None], "[", "x", "]"}], "2"]}]}], ",", 
          RowBox[{"\<\"rules\"\>", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              SubscriptBox["\[FormalA]", "1"], "\[Rule]", "0"}], ",", 
             RowBox[{
              SubscriptBox["\[FormalA]", "2"], "\[Rule]", "0"}]}], "}"}]}], 
          ",", 
          RowBox[{"\<\"coefficients\"\>", "\[Rule]", 
           RowBox[{"{", "}"}]}]}], "\[RightAssociation]"}], 
        RowBox[{"a", "\[GreaterEqual]", "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{{3.819868229847692*^9, 3.8198682342654057`*^9}, {
   3.819868265313801*^9, 3.8198682937867193`*^9}, {3.819868397483101*^9, 
   3.819868469880247*^9}, {3.8198685064369297`*^9, 3.8198685410115137`*^9}, 
   3.8198688209884*^9, 3.819868855414003*^9, {3.819868929656172*^9, 
   3.819868947036182*^9}, 3.819868998326601*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"d0609281-ab89-4369-8667-b16f757256fb"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"expression\"\>", "\[Rule]", 
    RowBox[{
     RowBox[{"a", " ", 
      SuperscriptBox[
       RowBox[{"u", "[", "x", "]"}], "2"]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SubscriptBox["\[FormalA]", "1"], "-", 
        SubscriptBox["\[FormalA]", "2"]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["u", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "x", "]"}], "2"]}], "+", 
     RowBox[{
      SubscriptBox["\[FormalA]", "1"], " ", 
      RowBox[{
       SuperscriptBox["u", "\[Prime]",
        MultilineFunction->None], "[", "x", "]"}], " ", 
      RowBox[{
       SuperscriptBox["u", 
        TagBox[
         RowBox[{"(", "3", ")"}],
         Derivative],
        MultilineFunction->None], "[", "x", "]"}]}], "+", 
     RowBox[{
      SubscriptBox["\[FormalA]", "2"], " ", 
      RowBox[{"u", "[", "x", "]"}], " ", 
      RowBox[{
       SuperscriptBox["u", 
        TagBox[
         RowBox[{"(", "4", ")"}],
         Derivative],
        MultilineFunction->None], "[", "x", "]"}]}]}]}], ",", 
   RowBox[{"\<\"coefficients\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[FormalA]", "1"], ",", 
      SubscriptBox["\[FormalA]", "2"]}], "}"}]}], ",", 
   RowBox[{"\<\"extremecoefficients\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"a", ",", 
      RowBox[{"1", "+", 
       SubscriptBox["\[FormalA]", "1"], "-", 
       SubscriptBox["\[FormalA]", "2"]}]}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.819868229847692*^9, 3.8198682342654057`*^9}, {
   3.819868265313801*^9, 3.8198682937867193`*^9}, {3.819868397483101*^9, 
   3.819868469880247*^9}, {3.8198685064369297`*^9, 3.8198685410115137`*^9}, 
   3.8198688209884*^9, 3.819868855414003*^9, {3.819868929656172*^9, 
   3.819868947036182*^9}, 3.8198689984245768`*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"96c29c68-ed93-4ea4-953a-92e9d165e11b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simplify Positivity and the rest...", "Chapter",
 CellChangeTimes->{{3.816700758516316*^9, 3.8167007754685583`*^9}, {
  3.816840516267845*^9, 
  3.816840523394045*^9}},ExpressionUUID->"dbd88126-6943-424a-897d-\
b56dd7f44c3c"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<PDESymbolics2020`\>\"", "]"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"b84a526d-2b11-4840-986e-95e95956924d"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
      "SimplifyPositivityOperatorX", "[", "variables_Association", "]"}], "[",
       "problem_", "]"}], ":=", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"problem", "===", "$Failed"}], ",", "\[IndentingNewLine]", 
       "$Failed", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Head", "[", "problem", "]"}], "===", "Piecewise"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PiecewiseOperatorMap", "[", 
        RowBox[{
        "SimplifyPositivityOperatorX", ",", "variables", ",", "problem"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Head", "[", "problem", "]"}], "=!=", "Association"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SimplifyPositivityOperatorX", "[", "variables", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{"\"\<expression\>\"", "\[Rule]", "problem"}], "]"}], "]"}], 
       ",", "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"fproblem", ",", " ", "coefficients"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"coefficients", "=", 
           RowBox[{"Lookup", "[", 
            RowBox[{
            "problem", ",", " ", "\"\<coefficients\>\"", ",", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"DeleteDuplicates", "@", 
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"Lookup", "[", 
                 RowBox[{
                 "problem", ",", " ", "\"\<expression\>\"", ",", "0"}], "]"}],
                 ",", " ", 
                RowBox[{"Subscript", "[", 
                 RowBox[{"\[FormalA]", ",", "_"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", " ", "Infinity"}], "}"}]}], "]"}]}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"fproblem", "=", 
           RowBox[{"FixedPoint", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"PiecewiseSimplify", "@", 
               RowBox[{
                RowBox[{
                "SimplifyPositivityEvenStepOperator", "[", "variables", "]"}],
                 "@", 
                RowBox[{"PiecewiseSimplify", "@", 
                 RowBox[{
                  RowBox[{
                  "SimplifyPositivityOddStepOperator", "[", "variables", 
                   "]"}], "@", "#"}]}]}]}], "&"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Append", "[", 
              RowBox[{"problem", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\"\<eliminator\>\"", "\[Rule]", "False"}], ",", 
                 RowBox[{"\"\<coefficients\>\"", "\[Rule]", "coefficients"}], 
                 ",", 
                 RowBox[{"\"\<facts\>\"", "\[Rule]", 
                  RowBox[{"Lookup", "[", 
                   RowBox[{"problem", ",", "\"\<facts\>\"", ",", "True"}], 
                   "]"}]}]}], "}"}]}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", "fproblem", "]"}], ";"}], "*)"}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Lookup", "[", 
             RowBox[{"problem", ",", "\"\<eliminator\>\"", ",", " ", "True"}],
              "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"ConditionalPiecewiseMap", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"With", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"extremevencoefficients", "=", 
                   RowBox[{"Lookup", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "SimplifyPositivityExtremeEvenCoefficientsOperator", "[", 
                    "variables", "]"}], "[", "#1", "]"}], ",", 
                    "\"\<extremecoefficients\>\"", ",", 
                    RowBox[{"{", "}"}]}], "]"}]}], "}"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{"Print", "[", "#1", "]"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Print", "[", "extremevencoefficients", "]"}], ";",
                    "\[IndentingNewLine]", 
                   RowBox[{"Print", "[", 
                    RowBox[{"And", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{"z", ",", 
                    RowBox[{"(", 
                    RowBox[{"z", "\[GreaterEqual]", "0"}], ")"}]}], "]"}], "/@",
                     "extremevencoefficients"}], ")"}]}], "]"}], ";"}], 
                  "*)"}], "\[IndentingNewLine]", 
                 RowBox[{"Piecewise", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"#1", ",", 
                    RowBox[{"Reduce", "[", 
                    RowBox[{
                    RowBox[{"#2", "&&", 
                    RowBox[{"(", 
                    RowBox[{"And", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{"z", ",", 
                    RowBox[{"(", 
                    RowBox[{"z", "\[GreaterEqual]", "0"}], ")"}]}], "]"}], "/@",
                     "extremevencoefficients"}], ")"}]}], ")"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{
                    "variables", ",", "\"\<domain\>\"", ",", " ", "Reals"}], 
                    "]"}]}], "]"}]}], "}"}], "}"}], ",", "$Failed"}], "]"}]}],
                 "\[IndentingNewLine]", "]"}], "&"}], ",", " ", 
              "\[IndentingNewLine]", "fproblem"}], "]"}], ",", 
            "\[IndentingNewLine]", "fproblem"}], "]"}]}]}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
      "SimplifyPositivityOddStepOperator", "[", "variables_Association", 
       "]"}], "[", "problem_", "]"}], ":=", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"problem", "===", "$Failed"}], ",", "\[IndentingNewLine]", 
       "$Failed", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Head", "[", "problem", "]"}], "===", "Piecewise"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PiecewiseOperatorMap", "[", 
        RowBox[{
        "SimplifyPositivityOddStepOperator", ",", "variables", ",", 
         "problem"}], "]"}], ",", "\[IndentingNewLine]", "True", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "expr", ",", "expralt", ",", "vars", ",", "allvars", ",", 
           "candidates", ",", "oddcandidates", ",", "candidatevariables", ",",
            "freevariables", ",", "sol", ",", " ", "reducedfree", ",", 
           "facts", ",", " ", "FA", ",", "EE", ",", "freeoddcandidates"}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"expr", "=", 
           RowBox[{"Expand", "@", 
            RowBox[{"problem", "[", "\"\<expression\>\"", "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"expralt", "=", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", "expr", "}"}], "//", "Flatten"}], ",", 
             RowBox[{
              RowBox[{"#", "=!=", "0"}], "&"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"expralt", "===", 
             RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "problem", ",",
             "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"vars", "=", 
              RowBox[{"getVars", "[", 
               RowBox[{"expralt", ",", " ", 
                RowBox[{"Lookup", "[", 
                 RowBox[{"variables", ",", "\"\<depVars\>\"", ",", 
                  RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"allvars", "=", 
              RowBox[{"Union", "[", 
               RowBox[{"vars", ",", 
                RowBox[{"Lookup", "[", 
                 RowBox[{"variables", ",", "\"\<indVars\>\"", ",", 
                  RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"facts", "=", 
              RowBox[{"Lookup", "[", 
               RowBox[{"variables", ",", "\"\<facts\>\"", ",", "True"}], 
               "]"}]}], ";", " ", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"candidates", "=", 
              RowBox[{"Flatten", "[", 
               RowBox[{
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{"Function", "[", 
                   RowBox[{
                    RowBox[{"{", "xp", "}"}], ",", 
                    RowBox[{"Union", "@@", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Part", "[", 
                    RowBox[{
                    RowBox[{"CoefficientRules", "[", 
                    RowBox[{"xp", ",", "#"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}], "/.", 
                    RowBox[{
                    RowBox[{"Rule", "[", 
                    RowBox[{
                    RowBox[{"{", "j_Integer", "}"}], ",", "coeff_"}], "]"}], 
                    "\[RuleDelayed]", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "#", ",", "coeff"}], "}"}]}]}], "&"}], 
                    ",", "allvars"}], "]"}]}]}], "]"}], ",", "expralt"}], 
                 "]"}], ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", " ", "[", 
              RowBox[{
               RowBox[{"candidates", "=!=", 
                RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"oddcandidates", "=", 
                RowBox[{"Select", "[", 
                 RowBox[{"candidates", ",", 
                  RowBox[{
                   RowBox[{"OddQ", "@", 
                    RowBox[{"First", "@", "#"}]}], "&"}]}], "]"}]}], ",", " ",
                "\[IndentingNewLine]", 
               RowBox[{"Return", "[", "problem", "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", " ", "[", 
              RowBox[{
               RowBox[{"oddcandidates", "===", 
                RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"Return", "[", "problem", "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{
               "select", " ", "the", " ", "candidates", " ", "that", " ", 
                "assumptions", " ", 
                RowBox[{"don", "'"}], "t", " ", "imply", " ", "they", " ", 
                "have", " ", "a", " ", "definite", " ", "sign"}], " ", "-", 
               RowBox[{
               "for", " ", "all", " ", "values", " ", "of", " ", "the", " ", 
                "variables"}]}], " ", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"TO", " ", "BE", " ", "DONE"}], " ", "*)"}], 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"candidatevariables", "=", 
              RowBox[{"DeleteDuplicates", "[", 
               RowBox[{"oddcandidates", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"Print", "[", "freevariables", "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Print", "[", "allvars", "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Print", "[", "facts", "]"}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"Print", "[", "\"\<zpob\>\"", "]"}], ";"}], 
              "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"FA", ":=", 
              RowBox[{
               RowBox[{"ForAll", "[", 
                RowBox[{"#1", ",", "#2"}], "]"}], "&"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"EE", ":=", 
              RowBox[{
               RowBox[{"Exists", "[", 
                RowBox[{"#1", ",", "#2"}], "]"}], "&"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"reducedfree", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"#", ",", 
                  RowBox[{"Reduce", "[", 
                   RowBox[{
                    RowBox[{"facts", "&&", 
                    RowBox[{"Reduce", "[", 
                    RowBox[{
                    RowBox[{"FA", "[", 
                    RowBox[{
                    RowBox[{"Complement", "[", 
                    RowBox[{"allvars", ",", 
                    RowBox[{"{", "#", "}"}]}], "]"}], ",", 
                    RowBox[{"Implies", "[", 
                    RowBox[{
                    RowBox[{"Reduce", "[", 
                    RowBox[{
                    RowBox[{"EE", "[", 
                    RowBox[{"#", ",", "facts"}], "]"}], ",", "Reals"}], "]"}],
                     ",", 
                    RowBox[{"Reduce", "[", 
                    RowBox[{
                    RowBox[{"FA", "[", 
                    RowBox[{"#", " ", ",", "facts"}], "]"}], ",", "Reals"}], 
                    "]"}]}], "]"}]}], "]"}], ",", "Reals"}], "]"}]}], ",", 
                    "Reals"}], "]"}]}], "}"}], "&"}], "/@", 
               "candidatevariables"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Print", "[", "reducedfree", "]"}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"Print", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Equivalent", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", "assumptions"}],
                     "]"}], "===", "True"}], "&"}], ",", " ", "reducedfree"}],
                 "]"}]}], "*)"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"freevariables", "=", 
              RowBox[{
               RowBox[{"Select", "[", 
                RowBox[{"reducedfree", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"FullSimplify", "[", 
                    RowBox[{"Equivalent", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", "facts"}], 
                    "]"}], "]"}], "===", "True"}], "&"}]}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Print", "[", "freevariables", "]"}], ";"}], 
              "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"freeoddcandidates", "=", 
              RowBox[{"Select", "[", 
               RowBox[{"oddcandidates", ",", " ", 
                RowBox[{
                 RowBox[{"MemberQ", "[", 
                  RowBox[{"freevariables", ",", " ", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}]}], "]"}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"(*", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Print", "[", "freeoddcandidates", "]"}], ";"}], 
              "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"If", " ", "[", 
              RowBox[{
               RowBox[{"freeoddcandidates", "===", 
                RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"Return", "[", "problem", "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"solve", " ", "undetermined", " ", "coefficients"}], 
              " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"sol", "=", 
              RowBox[{
               RowBox[{
               "SolveUndeterminedCoefficientsOperator", "[", "variables", 
                "]"}], "[", "\[IndentingNewLine]", 
               RowBox[{"Association", "[", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"\"\<expression\>\"", "\[Rule]", 
                   RowBox[{"freeoddcandidates", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "3"}], "]"}], "]"}]}], ",", " ", 
                  "\[IndentingNewLine]", 
                  RowBox[{"\"\<coefficients\>\"", "\[Rule]", 
                   RowBox[{"Lookup", "[", 
                    RowBox[{
                    "problem", ",", " ", "\"\<coefficients\>\"", ",", 
                    RowBox[{"{", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
                 "}"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
              "replace", " ", "back", " ", "in", " ", "the", " ", 
               "expression", " ", "and", " ", "append", " ", "rules"}], " ", 
              "*)"}], " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"PiecewiseMap", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", "rule", "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Association", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\"\<expression\>\"", "\[Rule]", "expr"}], "/.", 
                    "rule"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"\"\<rules\>\"", "\[Rule]", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Lookup", "[", 
                    RowBox[{"problem", ",", "\"\<rules\>\"", ",", 
                    RowBox[{"{", "}"}]}], "]"}], ",", "rule"}], "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"\"\<coefficients\>\"", "\[Rule]", 
                    RowBox[{"Select", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Lookup", "[", 
                    RowBox[{"problem", ",", "\"\<coefficients\>\"", ",", 
                    RowBox[{"{", "}"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"!", " ", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Keys", "@", "rule"}], ",", "#"}], "]"}]}], 
                    "&"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
                "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
               "sol"}], "]"}]}]}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
      "SimplifyPositivityEvenStepOperator", "[", "variables_Association", 
       "]"}], "[", "problem_", "]"}], ":=", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"problem", "===", "$Failed"}], ",", "\[IndentingNewLine]", 
       "$Failed", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Head", "[", "problem", "]"}], "===", "Piecewise"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PiecewiseOperatorMap", "[", 
        RowBox[{
        "SimplifyPositivityEvenStepOperator", ",", "variables", ",", 
         "problem"}], "]"}], ",", "\[IndentingNewLine]", "True", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "expr", ",", "expralt", ",", "vars", ",", "candidates", ",", 
           "evencandidates", ",", "dependentevencandidates", ",", "sol", ",", 
           "allvars"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"expr", "=", 
           RowBox[{"Expand", "@", 
            RowBox[{"problem", "[", "\"\<expression\>\"", "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"expralt", "=", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", "expr", "}"}], "//", "Flatten"}], ",", 
             RowBox[{
              RowBox[{"#", "=!=", "0"}], "&"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"expralt", "===", 
             RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "problem", ",",
             "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"vars", "=", 
              RowBox[{"getVars", "[", 
               RowBox[{"expr", ",", " ", 
                RowBox[{"Lookup", "[", 
                 RowBox[{"variables", ",", "\"\<depVars\>\"", ",", 
                  RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"allvars", "=", 
              RowBox[{"Union", "[", 
               RowBox[{"vars", ",", 
                RowBox[{"Lookup", "[", 
                 RowBox[{"variables", ",", "\"\<indVars\>\"", ",", 
                  RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"candidates", "=", 
              RowBox[{"Flatten", "[", 
               RowBox[{
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{"Function", "[", 
                   RowBox[{
                    RowBox[{"{", "xp", "}"}], ",", 
                    RowBox[{"Union", "@@", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Part", "[", 
                    RowBox[{
                    RowBox[{"CoefficientRules", "[", 
                    RowBox[{"xp", ",", "#"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}], "/.", 
                    RowBox[{
                    RowBox[{"Rule", "[", 
                    RowBox[{
                    RowBox[{"{", "j_Integer", "}"}], ",", "coeff_"}], "]"}], 
                    "\[RuleDelayed]", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "#", ",", "coeff"}], "}"}]}]}], "&"}], 
                    ",", "allvars"}], "]"}]}]}], "]"}], ",", "expralt"}], 
                 "]"}], ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", " ", "[", 
              RowBox[{
               RowBox[{"candidates", "=!=", 
                RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"evencandidates", "=", 
                 RowBox[{"Select", "[", 
                  RowBox[{
                   RowBox[{"Select", "[", 
                    RowBox[{"candidates", ",", 
                    RowBox[{
                    RowBox[{"EvenQ", "@", 
                    RowBox[{"First", "@", "#"}]}], "&"}]}], "]"}], ",", " ", 
                   RowBox[{
                    RowBox[{"!", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"expralt", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "&"}]}], 
                  "]"}]}], ";"}], "\[IndentingNewLine]", ",", " ", 
               "\[IndentingNewLine]", 
               RowBox[{"Return", "[", "problem", "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"dependentevencandidates", "=", 
              RowBox[{"Select", "[", 
               RowBox[{"evencandidates", ",", " ", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"!", 
                  RowBox[{"FreeQ", "[", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
                    RowBox[{"Alternatives", "@@", "allvars"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}]}], "&"}]}],
                "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", " ", "[", 
              RowBox[{
               RowBox[{"dependentevencandidates", "===", 
                RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"Return", "[", "problem", "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{
               "select", " ", "the", " ", "candidates", " ", "that", " ", 
                "assumptions", " ", 
                RowBox[{"don", "'"}], "t", " ", "imply", " ", "they", " ", 
                "have", " ", "a", " ", "definite", " ", "sign"}], " ", "-", 
               RowBox[{
               "for", " ", "all", " ", "values", " ", "of", " ", "the", " ", 
                "variables"}]}], " ", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"TO", " ", "BE", " ", "DONE"}], " ", "*)"}], 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"sol", "=", 
              RowBox[{
               RowBox[{"SimplifyPositivityOperatorX", "[", "variables", "]"}],
                "[", "\[IndentingNewLine]", 
               RowBox[{"Association", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"\"\<expression\>\"", "\[Rule]", 
                  RowBox[{"(", 
                   RowBox[{"dependentevencandidates", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "3"}], "]"}], "]"}], ")"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"\"\<coefficients\>\"", "\[Rule]", 
                  RowBox[{"Lookup", "[", 
                   RowBox[{"problem", ",", "\"\<coefficients\>\"", ",", 
                    RowBox[{"{", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"\"\<eliminator\>\"", "\[Rule]", "False"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"\"\<rules\>\"", "\[Rule]", 
                  RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}], 
               "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"PiecewiseMap", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"Association", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"\"\<eliminator\>\"", "\[Rule]", "False"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"\"\<expression\>\"", "\[Rule]", "expr"}], "/.", 
                   RowBox[{"#", "[", "\"\<rules\>\"", "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"\"\<rules\>\"", "\[Rule]", 
                   RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Lookup", "[", 
                    RowBox[{"problem", ",", "\"\<rules\>\"", ",", " ", 
                    RowBox[{"{", "}"}]}], "]"}], ",", " ", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{"#", ",", "\"\<rules\>\"", ",", 
                    RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"\"\<coefficients\>\"", "->", 
                   RowBox[{"Select", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Lookup", "[", 
                    RowBox[{"problem", ",", "\"\<coefficients\>\"", ",", 
                    RowBox[{"{", "}"}]}], "]"}], ",", 
                    RowBox[{"Function", "[", 
                    RowBox[{"z", ",", 
                    RowBox[{"!", " ", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Keys", "@", 
                    RowBox[{"#", "[", "\"\<rules\>\"", "]"}]}], ",", "z"}], 
                    "]"}]}]}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
                 "]"}], "&"}], ",", " ", "sol"}], "]"}]}]}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
      "SimplifyPositivityExtremeEvenCoefficientsOperator", "[", 
       "variables_Association", "]"}], "[", "problem_", "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"problem", "===", "$Failed"}], ",", "\[IndentingNewLine]", 
       "$Failed", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Head", "[", "problem", "]"}], "===", "Piecewise"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PiecewiseOperatorMap", "[", 
        RowBox[{
        "SimplifyPositivityExtremeEvenCoefficientsOperator", ",", "variables",
          ",", "problem"}], "]"}], ",", "\[IndentingNewLine]", "True", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "expr", ",", "expralt", ",", "vars", ",", "factVars", ",", 
           "candidates", ",", "evencandidates", ",", 
           "dependentevencandidates", ",", "independependentevencandidates", 
           ",", "allvars"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"expr", "=", 
           RowBox[{"Expand", "@", 
            RowBox[{"problem", "[", "\"\<expression\>\"", "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"expralt", "=", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", "expr", "}"}], "//", "Flatten"}], ",", 
             RowBox[{
              RowBox[{"#", "=!=", "0"}], "&"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"expr", "===", "0"}], "||", 
             RowBox[{"expr", "===", 
              RowBox[{"{", "}"}]}]}], ",", "\[IndentingNewLine]", "problem", 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"vars", "=", 
              RowBox[{"getVars", "[", 
               RowBox[{"expr", ",", " ", 
                RowBox[{"Lookup", "[", 
                 RowBox[{"variables", ",", "\"\<depVars\>\"", ",", 
                  RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"allvars", "=", 
              RowBox[{"Union", "[", 
               RowBox[{"vars", ",", 
                RowBox[{"Lookup", "[", 
                 RowBox[{"variables", ",", "\"\<indVars\>\"", ",", 
                  RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"candidates", "=", 
              RowBox[{"Flatten", "[", 
               RowBox[{
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{"Function", "[", 
                   RowBox[{
                    RowBox[{"{", "xp", "}"}], ",", 
                    RowBox[{"Union", "@@", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Part", "[", 
                    RowBox[{
                    RowBox[{"CoefficientRules", "[", 
                    RowBox[{"xp", ",", "#"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}], "/.", 
                    RowBox[{
                    RowBox[{"Rule", "[", 
                    RowBox[{
                    RowBox[{"{", "j_Integer", "}"}], ",", "coeff_"}], "]"}], 
                    "\[RuleDelayed]", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "#", ",", "coeff"}], "}"}]}]}], "&"}], 
                    ",", "allvars"}], "]"}]}]}], "]"}], ",", "expralt"}], 
                 "]"}], ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", " ", "[", 
              RowBox[{
               RowBox[{"candidates", "=!=", 
                RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"evencandidates", "=", 
                 RowBox[{"Select", "[", 
                  RowBox[{
                   RowBox[{"Select", "[", 
                    RowBox[{"candidates", ",", 
                    RowBox[{
                    RowBox[{"EvenQ", "@", 
                    RowBox[{"First", "@", "#"}]}], "&"}]}], "]"}], ",", " ", 
                   RowBox[{
                    RowBox[{"!", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"expralt", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "&"}]}], 
                  "]"}]}], ";"}], "\[IndentingNewLine]", ",", " ", 
               "\[IndentingNewLine]", 
               RowBox[{"Return", "[", "problem", "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"dependentevencandidates", "=", 
              RowBox[{"Select", "[", 
               RowBox[{"evencandidates", ",", " ", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"!", 
                  RowBox[{"FreeQ", "[", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
                    RowBox[{"Alternatives", "@@", "allvars"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}]}], "&"}]}],
                "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"independependentevencandidates", "=", 
              RowBox[{"Select", "[", 
               RowBox[{"evencandidates", ",", " ", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"FreeQ", "[", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
                   RowBox[{"Alternatives", "@@", "allvars"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}], "&"}]}], 
               "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Print", "[", "dependentevencandidates", "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Print", "[", "independependentevencandidates", "]"}], 
               ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"dependentevencandidates", "===", 
                RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"Append", "[", 
                RowBox[{"problem", ",", 
                 RowBox[{
                 "\"\<extremecoefficients\>\"", "\[Rule]", 
                  "\[IndentingNewLine]", 
                  RowBox[{"DeleteDuplicates", "@", 
                   RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Lookup", "[", 
                    RowBox[{
                    "problem", ",", "\"\<extremecoefficients\>\"", ",", 
                    RowBox[{"{", "}"}]}], "]"}], ",", 
                    RowBox[{"independependentevencandidates", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "3"}], "]"}], "]"}]}], "]"}]}]}]}], 
                "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Append", "[", 
                RowBox[{"problem", ",", 
                 RowBox[{
                 "\"\<extremecoefficients\>\"", "\[Rule]", 
                  "\[IndentingNewLine]", 
                  RowBox[{"DeleteDuplicates", "@", 
                   RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Lookup", "[", 
                    RowBox[{
                    "problem", ",", "\"\<extremecoefficients\>\"", ",", 
                    RowBox[{"{", "}"}]}], "]"}], ",", 
                    RowBox[{"independependentevencandidates", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "SimplifyPositivityExtremeEvenCoefficientsOperator", "[", 
                    "variables", "]"}], "[", "\[IndentingNewLine]", 
                    RowBox[{"Association", "[", "\[IndentingNewLine]", 
                    RowBox[{"\"\<expression\>\"", "->", 
                    RowBox[{"dependentevencandidates", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "3"}], "]"}], "]"}]}], 
                    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
                    "]"}], ",", "\"\<extremecoefficients\>\"", ",", 
                    RowBox[{"{", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
                    "]"}]}]}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.816674316663731*^9, 3.8166744340318127`*^9}, {
   3.8166744679481297`*^9, 3.816674480869293*^9}, {3.816675703061715*^9, 
   3.8166757419393806`*^9}, {3.816675826142705*^9, 3.8166758459997053`*^9}, {
   3.8166758882202578`*^9, 3.816675919976427*^9}, {3.816675995181541*^9, 
   3.816676035732924*^9}, {3.8166760926813393`*^9, 3.816676113425788*^9}, {
   3.8166761719214993`*^9, 3.81667628081231*^9}, {3.8166793727552347`*^9, 
   3.816679400799716*^9}, {3.816680121068594*^9, 3.8166801266110277`*^9}, {
   3.8166806275278387`*^9, 3.816680643704883*^9}, {3.816681361036075*^9, 
   3.816681380052024*^9}, {3.8167008562252913`*^9, 3.816700954986518*^9}, {
   3.816701026176176*^9, 3.81670102868169*^9}, 3.816701109675458*^9, {
   3.816701211455688*^9, 3.816701239955181*^9}, {3.8167013618123198`*^9, 
   3.8167013671169033`*^9}, 3.8167013987674*^9, {3.816701445596575*^9, 
   3.816701460964122*^9}, {3.816701584785922*^9, 3.816701746362542*^9}, {
   3.816701778767671*^9, 3.8167017808295727`*^9}, {3.816703857853858*^9, 
   3.816703915608605*^9}, {3.8167039684046707`*^9, 3.816704017437025*^9}, {
   3.8167042051091967`*^9, 3.816704379159184*^9}, {3.8167044322403507`*^9, 
   3.8167045495960197`*^9}, {3.816704606937962*^9, 3.816704608914459*^9}, {
   3.816704783128352*^9, 3.8167047861433277`*^9}, {3.816704839788124*^9, 
   3.816704840392624*^9}, {3.816704889188651*^9, 3.8167048912683372`*^9}, {
   3.816704955158495*^9, 3.816704955755764*^9}, 3.816709075219872*^9, {
   3.816709156106215*^9, 3.8167092164879627`*^9}, {3.816709261661015*^9, 
   3.816709281673195*^9}, {3.816709338578314*^9, 3.8167094638558807`*^9}, {
   3.816709837072311*^9, 3.816709837483253*^9}, {3.8167400334626493`*^9, 
   3.816740074321374*^9}, {3.8167401099576902`*^9, 3.8167401355945683`*^9}, {
   3.816740182723916*^9, 3.8167403214447308`*^9}, {3.816740468421204*^9, 
   3.816740473274869*^9}, {3.816740525970235*^9, 3.816740636255527*^9}, {
   3.816740674143607*^9, 3.816740863289255*^9}, {3.8167409045158*^9, 
   3.816740904899352*^9}, {3.8167409666902246`*^9, 3.8167411774894*^9}, {
   3.816759575132358*^9, 3.8167595909803467`*^9}, 3.816759727583911*^9, {
   3.8167618472503643`*^9, 3.816761879713238*^9}, {3.816761955959235*^9, 
   3.816761965401297*^9}, {3.816762007109528*^9, 3.8167620330737886`*^9}, {
   3.816763994226733*^9, 3.816763995552496*^9}, {3.816764072837284*^9, 
   3.81676414814952*^9}, {3.816764181268291*^9, 3.8167642228783007`*^9}, {
   3.81676427310116*^9, 3.8167643686061068`*^9}, {3.816764398953803*^9, 
   3.816764424003209*^9}, {3.81676461348785*^9, 3.816764615587739*^9}, {
   3.816764648663611*^9, 3.8167646739645233`*^9}, {3.8167647148050117`*^9, 
   3.816764758788891*^9}, {3.816764901340084*^9, 3.8167649328327103`*^9}, {
   3.8167649866351347`*^9, 3.8167649963030043`*^9}, {3.816766266273201*^9, 
   3.8167662668449907`*^9}, {3.816766444124548*^9, 3.816766449375991*^9}, {
   3.816766485316885*^9, 3.816766516194799*^9}, {3.816766572301139*^9, 
   3.816766609753894*^9}, {3.816771602651078*^9, 3.816771628107877*^9}, {
   3.8167717186984158`*^9, 3.816771720433867*^9}, {3.8167718116162453`*^9, 
   3.816771827748535*^9}, {3.81677191611065*^9, 3.8167719790350523`*^9}, {
   3.816772015828413*^9, 3.8167720455920753`*^9}, 3.8167721063657427`*^9, {
   3.816782002337783*^9, 3.816782017324654*^9}, {3.816782210091733*^9, 
   3.81678221512956*^9}, {3.816782247266841*^9, 3.816782258245995*^9}, {
   3.816782371125958*^9, 3.816782376063908*^9}, {3.8167827979595947`*^9, 
   3.8167828012908087`*^9}, {3.816782954534856*^9, 3.816782981519698*^9}, {
   3.816783139461616*^9, 3.816783176131209*^9}, {3.81678324555718*^9, 
   3.81678327938485*^9}, {3.8167833185357313`*^9, 3.816783328801434*^9}, {
   3.816783400420698*^9, 3.8167834297507668`*^9}, {3.81678350907231*^9, 
   3.8167835213647738`*^9}, {3.8167841163529253`*^9, 3.816784206681422*^9}, {
   3.816784239564846*^9, 3.816784272857897*^9}, {3.816784309999834*^9, 
   3.816784327972909*^9}, {3.816784370741556*^9, 3.816784372987734*^9}, {
   3.8167847770137453`*^9, 3.8167848017582817`*^9}, {3.816784836170542*^9, 
   3.816784844217792*^9}, {3.816784904874715*^9, 3.816784911158149*^9}, {
   3.816784947095619*^9, 3.8167849837456217`*^9}, {3.816785079879243*^9, 
   3.816785086522049*^9}, {3.8167851282444477`*^9, 3.8167851666883707`*^9}, {
   3.816789214145789*^9, 3.816789233473596*^9}, 3.816789273128772*^9, 
   3.816789306254068*^9, 3.816789344705718*^9, {3.816790098886924*^9, 
   3.816790118446789*^9}, {3.8168184286800537`*^9, 3.816818574073827*^9}, {
   3.8168188971576366`*^9, 3.8168189297254257`*^9}, {3.81681896429027*^9, 
   3.81681896961342*^9}, {3.816819012263352*^9, 3.816819015411837*^9}, {
   3.816819047091949*^9, 3.8168191102833*^9}, {3.816842602484564*^9, 
   3.816842640814179*^9}, {3.816843132668385*^9, 3.8168431355823793`*^9}, {
   3.816845098456581*^9, 3.816845156977646*^9}, {3.816845198457827*^9, 
   3.816845215259066*^9}, {3.816845247057972*^9, 3.816845309450987*^9}, {
   3.816845402269351*^9, 3.8168454460228243`*^9}, {3.8168455476834707`*^9, 
   3.816845597832794*^9}, {3.816845655799603*^9, 3.816845659750231*^9}, {
   3.816845746299602*^9, 3.816845748388358*^9}, {3.816845788959079*^9, 
   3.81684579365066*^9}, {3.8168458236872663`*^9, 3.816845832730323*^9}, {
   3.816845913544908*^9, 3.816846100715466*^9}, {3.8168461983129997`*^9, 
   3.816846342376212*^9}, {3.816846376663673*^9, 3.8168464603158007`*^9}, {
   3.816847074894967*^9, 3.816847121604439*^9}, {3.816847158285117*^9, 
   3.816847222116901*^9}, {3.81684728409509*^9, 3.816847493922866*^9}, {
   3.816847576118244*^9, 3.81684757650314*^9}, {3.816847619944477*^9, 
   3.816847698064562*^9}, {3.816847731316762*^9, 3.816847801989086*^9}},
 CellLabel->
  "In[288]:=",ExpressionUUID->"3f377784-ed48-46ad-8508-69e69fcea050"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", "u", "}"}]}], ",", " ", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}], ",", " ", 
     RowBox[{"\"\<pars\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xp", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<expression\>\"", "\[Rule]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "C1"}], ")"}], " ", 
        RowBox[{
         RowBox[{"u", "[", "x", "]"}], "^", "3"}]}], "+", 
       RowBox[{"C2", " ", 
        RowBox[{"u", "[", "x", "]"}], " ", 
        RowBox[{
         RowBox[{"u", "'"}], "[", "x", "]"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"u", "'"}], "[", "x", "]"}], "^", "2"}], "+", 
       RowBox[{"a", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"u", "'"}], "[", "x", "]"}], "^", "5"}]}]}]}], ",", " ", 
     RowBox[{"\"\<coefficients\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"C1", ",", "C2", ",", "C3"}], "}"}]}], ",", 
     RowBox[{"\"\<eliminator\>\"", "\[Rule]", "False"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"sp", "=", 
  RowBox[{
   RowBox[{"SimplifyPositivityOperatorX", "[", "variables", "]"}], "[", "xp", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8167827681502333`*^9, 3.816782768790616*^9}, {
  3.81678281996246*^9, 3.816782822077862*^9}, {3.8168518523826303`*^9, 
  3.816851868605503*^9}},
 CellLabel->
  "In[301]:=",ExpressionUUID->"34d20759-2c36-4895-8df4-beeedd15ca77"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"\<\"expression\"\>", "\[Rule]", 
           SuperscriptBox[
            RowBox[{
             SuperscriptBox["u", "\[Prime]",
              MultilineFunction->None], "[", "x", "]"}], "2"]}], ",", 
          RowBox[{"\<\"rules\"\>", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"C1", "\[Rule]", "1"}], ",", 
             RowBox[{"C2", "\[Rule]", "0"}]}], "}"}]}], ",", 
          RowBox[{"\<\"coefficients\"\>", "\[Rule]", 
           RowBox[{"{", "C3", "}"}]}]}], "\[RightAssociation]"}], 
        RowBox[{"a", "\[Equal]", "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{
  3.8167851928665752`*^9, {3.816789253617776*^9, 3.816789277601202*^9}, 
   3.8167893178899593`*^9, 3.816789394321966*^9, {3.816789505980521*^9, 
   3.8167895339154177`*^9}, 3.816789708454*^9, 3.816818586604302*^9, {
   3.816851844695176*^9, 3.816851873795175*^9}},
 CellLabel->
  "Out[303]=",ExpressionUUID->"ed87323a-810b-45e1-a914-c421db85b0e7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", "u", "}"}]}], ",", " ", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}], ",", " ", 
     RowBox[{"\"\<pars\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}]}], ",", " ", 
     RowBox[{"\"\<facts\>\"", "\[Rule]", 
      RowBox[{
       RowBox[{
        RowBox[{"u", "'"}], "[", "x", "]"}], ">", "0"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xp", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<expression\>\"", "\[Rule]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "C1"}], ")"}], " ", 
        RowBox[{
         RowBox[{"u", "[", "x", "]"}], "^", "3"}]}], "+", 
       RowBox[{"C2", " ", 
        RowBox[{"u", "[", "x", "]"}], " ", 
        RowBox[{
         RowBox[{"u", "'"}], "[", "x", "]"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"u", "'"}], "[", "x", "]"}], "^", "2"}], "+", 
       RowBox[{"a", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"u", "'"}], "[", "x", "]"}], "^", "5"}]}]}]}], ",", " ", 
     RowBox[{"\"\<coefficients\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"C1", ",", "C2", ",", "C3"}], "}"}]}], ",", 
     RowBox[{"\"\<eliminator\>\"", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"sp", "=", 
  RowBox[{
   RowBox[{"SimplifyPositivityOperatorX", "[", "variables", "]"}], "[", "xp", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8167827681502333`*^9, 3.816782768790616*^9}, {
  3.81678281996246*^9, 3.816782822077862*^9}, {3.8168518523826303`*^9, 
  3.816851901195424*^9}},
 CellLabel->
  "In[307]:=",ExpressionUUID->"7e4e3fe1-1485-421e-9201-04ba46515025"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"\<\"expression\"\>", "\[Rule]", 
           RowBox[{
            SuperscriptBox[
             RowBox[{
              SuperscriptBox["u", "\[Prime]",
               MultilineFunction->None], "[", "x", "]"}], "2"], "+", 
            RowBox[{"a", " ", 
             SuperscriptBox[
              RowBox[{
               SuperscriptBox["u", "\[Prime]",
                MultilineFunction->None], "[", "x", "]"}], "5"]}]}]}], ",", 
          RowBox[{"\<\"rules\"\>", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"C1", "\[Rule]", "1"}], ",", 
             RowBox[{"C2", "\[Rule]", "0"}]}], "}"}]}], ",", 
          RowBox[{"\<\"coefficients\"\>", "\[Rule]", 
           RowBox[{"{", "C3", "}"}]}]}], "\[RightAssociation]"}], 
        RowBox[{
         RowBox[{
          SuperscriptBox["u", "\[Prime]",
           MultilineFunction->None], "[", "x", "]"}], ">", "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{
  3.8167851928665752`*^9, {3.816789253617776*^9, 3.816789277601202*^9}, 
   3.8167893178899593`*^9, 3.816789394321966*^9, {3.816789505980521*^9, 
   3.8167895339154177`*^9}, 3.816789708454*^9, 3.816818586604302*^9, {
   3.816851844695176*^9, 3.8168519017899103`*^9}},
 CellLabel->
  "Out[309]=",ExpressionUUID->"aae0325a-fa83-4270-b3e0-26a7289b6217"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xp", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<expression\>\"", "\[Rule]", 
      RowBox[{"a", " ", 
       RowBox[{
        RowBox[{"u", "[", "x", "]"}], "^", "2"}]}]}], ",", " ", 
     RowBox[{"\"\<coefficients\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"C1", ",", "C2", ",", "C3"}], "}"}]}], ",", 
     RowBox[{"\"\<eliminator\>\"", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"sp", "=", 
  RowBox[{
   RowBox[{"SimplifyPositivityOperatorX", "[", "variables", "]"}], "[", "xp", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.816789722808422*^9, 3.8167897305328827`*^9}},
 CellLabel->
  "In[316]:=",ExpressionUUID->"de304bb5-8b95-4e7b-84c4-0359916a0ed4"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"\<\"expression\"\>", "\[Rule]", 
           RowBox[{"a", " ", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], "2"]}]}], ",", 
          RowBox[{"\<\"eliminator\"\>", "\[Rule]", "False"}], ",", 
          RowBox[{"\<\"coefficients\"\>", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"C1", ",", "C2", ",", "C3"}], "}"}]}], ",", 
          RowBox[{"\<\"facts\"\>", "\[Rule]", "True"}]}], 
         "\[RightAssociation]"}], 
        RowBox[{"a", "\[GreaterEqual]", "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{{3.8167897262159758`*^9, 3.816789731228297*^9}, 
   3.816818590661119*^9, 3.816851938006407*^9},
 CellLabel->
  "Out[317]=",ExpressionUUID->"284d5e68-f8b2-4fe2-a201-9eca1c4446c0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xp", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<expression\>\"", "\[Rule]", 
      RowBox[{
       RowBox[{"a", " ", 
        RowBox[{
         RowBox[{"u", "[", "x", "]"}], "^", "2"}]}], "+", " ", 
       RowBox[{"C1", " ", 
        RowBox[{"u", "[", "x", "]"}]}], "+", " ", 
       RowBox[{"C2", " ", 
        RowBox[{
         RowBox[{"u", "[", "x", "]"}], "^", "4"}]}], "+", 
       RowBox[{"C3", " ", 
        RowBox[{
         RowBox[{"u", "[", "x", "]"}], "^", "5"}]}]}]}], ",", " ", 
     RowBox[{"\"\<coefficients\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"C1", ",", "C2", ",", "C3"}], "}"}]}], ",", 
     RowBox[{"\"\<eliminator\>\"", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"sp", "=", 
  RowBox[{
   RowBox[{"SimplifyPositivityOperatorX", "[", "variables", "]"}], "[", "xp", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.816789722808422*^9, 3.8167897305328827`*^9}, {
  3.8167897630027533`*^9, 3.816789781497354*^9}},
 CellLabel->
  "In[318]:=",ExpressionUUID->"5f80f8ca-3a99-4382-9f59-6a6a743371d4"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"\<\"expression\"\>", "\[Rule]", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], "2"], " ", 
            RowBox[{"(", 
             RowBox[{"a", "+", 
              RowBox[{"C2", " ", 
               SuperscriptBox[
                RowBox[{"u", "[", "x", "]"}], "2"]}]}], ")"}]}]}], ",", 
          RowBox[{"\<\"rules\"\>", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"C1", "\[Rule]", "0"}], ",", 
             RowBox[{"C3", "\[Rule]", "0"}]}], "}"}]}], ",", 
          RowBox[{"\<\"coefficients\"\>", "\[Rule]", 
           RowBox[{"{", "C2", "}"}]}]}], "\[RightAssociation]"}], 
        RowBox[{
         RowBox[{
          RowBox[{
           SuperscriptBox["u", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}], ">", "0"}], "&&", 
         RowBox[{"a", "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{"C2", "\[GreaterEqual]", "0"}]}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{{3.8167897262159758`*^9, 3.816789731228297*^9}, 
   3.81678978263468*^9, 3.816851951681426*^9},
 CellLabel->
  "Out[319]=",ExpressionUUID->"6d04a6f9-b4d6-4315-a9a3-2a97937f8262"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", "u", "}"}]}], ",", " ", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}], ",", " ", 
     RowBox[{"\"\<pars\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xp", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<expression\>\"", "\[Rule]", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"u", "[", "x", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"C1", " ", "+", 
          RowBox[{"C2", " ", 
           RowBox[{
            RowBox[{"u", "'"}], "[", "x", "]"}]}], "+", " ", 
          RowBox[{"C3", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"u", "'"}], "[", "x", "]"}], "^", "2"}]}]}], ")"}]}], 
       "+", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"u", "[", "x", "]"}], "^", "2"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"C4", " ", 
           RowBox[{
            RowBox[{"u", "'"}], "[", "x", "]"}]}], "+", " ", 
          RowBox[{"C5", " ", "b", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"u", "'"}], "[", "x", "]"}], "^", "2"}]}]}], ")"}]}], 
       "+", 
       RowBox[{"a", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"u", "''"}], "[", "x", "]"}], "^", "4"}]}]}]}], 
     "\[IndentingNewLine]", ",", " ", 
     RowBox[{"\"\<coefficients\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"C1", ",", "C2", ",", "C3", ",", " ", "C4", ",", "C5"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<eliminator\>\"", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"sp", "=", 
  RowBox[{
   RowBox[{"SimplifyPositivityOperatorX", "[", "variables", "]"}], "[", "xp", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.816789722808422*^9, 3.8167897305328827`*^9}, {
  3.8167897630027533`*^9, 3.816789781497354*^9}, {3.816789898134118*^9, 
  3.816789978787181*^9}, {3.816790215241454*^9, 3.816790221079011*^9}, {
  3.8168519768081827`*^9, 3.816851977648638*^9}},
 CellLabel->
  "In[331]:=",ExpressionUUID->"39d9cd2d-08aa-4968-8d35-75ca3331e433"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"\<\"eliminator\"\>", "\[Rule]", "False"}], ",", 
          RowBox[{"\<\"expression\"\>", "\[Rule]", 
           RowBox[{
            RowBox[{"b", " ", "C5", " ", 
             SuperscriptBox[
              RowBox[{"u", "[", "x", "]"}], "2"], " ", 
             SuperscriptBox[
              RowBox[{
               SuperscriptBox["u", "\[Prime]",
                MultilineFunction->None], "[", "x", "]"}], "2"]}], "+", 
            RowBox[{"a", " ", 
             SuperscriptBox[
              RowBox[{
               SuperscriptBox["u", "\[Prime]\[Prime]",
                MultilineFunction->None], "[", "x", "]"}], "4"]}]}]}], ",", 
          RowBox[{"\<\"rules\"\>", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"C1", "\[Rule]", "0"}], ",", 
             RowBox[{"C2", "\[Rule]", "0"}], ",", 
             RowBox[{"C3", "\[Rule]", "0"}], ",", 
             RowBox[{"C4", "\[Rule]", "0"}]}], "}"}]}], ",", 
          RowBox[{"\<\"coefficients\"\>", "\[Rule]", 
           RowBox[{"{", "C5", "}"}]}]}], "\[RightAssociation]"}], 
        RowBox[{
         RowBox[{"a", "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"C5", "<", "0"}], "&&", 
             RowBox[{"b", "\[LessEqual]", "0"}]}], ")"}], "||", 
           RowBox[{"C5", "\[Equal]", "0"}], "||", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"C5", ">", "0"}], "&&", 
             RowBox[{"b", "\[GreaterEqual]", "0"}]}], ")"}]}], ")"}]}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{{3.8167897262159758`*^9, 3.816789731228297*^9}, 
   3.81678978263468*^9, 3.816789980106015*^9, 3.8167901273111143`*^9, 
   3.816790223290181*^9, {3.816851978490127*^9, 3.8168520207734003`*^9}},
 CellLabel->
  "Out[333]=",ExpressionUUID->"5e2b00db-030e-4eab-adfd-6c48e45d8025"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "PiecewiseSimplify"}]], "Input",
 CellChangeTimes->{{3.816851997028311*^9, 3.816852023779916*^9}},
 CellLabel->
  "In[334]:=",ExpressionUUID->"a4ed6859-e7da-4bbf-ada9-eae1d63cab67"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"\<\"eliminator\"\>", "\[Rule]", "False"}], ",", 
          RowBox[{"\<\"expression\"\>", "\[Rule]", 
           RowBox[{"a", " ", 
            SuperscriptBox[
             RowBox[{
              SuperscriptBox["u", "\[Prime]\[Prime]",
               MultilineFunction->None], "[", "x", "]"}], "4"]}]}], ",", 
          RowBox[{"\<\"rules\"\>", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"C1", "\[Rule]", "0"}], ",", 
             RowBox[{"C2", "\[Rule]", "0"}], ",", 
             RowBox[{"C3", "\[Rule]", "0"}], ",", 
             RowBox[{"C4", "\[Rule]", "0"}]}], "}"}]}], ",", 
          RowBox[{"\<\"coefficients\"\>", "\[Rule]", 
           RowBox[{"{", "0", "}"}]}]}], "\[RightAssociation]"}], 
        RowBox[{
         RowBox[{"C5", "\[Equal]", "0"}], "&&", 
         RowBox[{"a", "\[GreaterEqual]", "0"}]}]},
       {
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"\<\"eliminator\"\>", "\[Rule]", "False"}], ",", 
          RowBox[{"\<\"expression\"\>", "\[Rule]", 
           RowBox[{
            RowBox[{"b", " ", "C5", " ", 
             SuperscriptBox[
              RowBox[{"u", "[", "x", "]"}], "2"], " ", 
             SuperscriptBox[
              RowBox[{
               SuperscriptBox["u", "\[Prime]",
                MultilineFunction->None], "[", "x", "]"}], "2"]}], "+", 
            RowBox[{"a", " ", 
             SuperscriptBox[
              RowBox[{
               SuperscriptBox["u", "\[Prime]\[Prime]",
                MultilineFunction->None], "[", "x", "]"}], "4"]}]}]}], ",", 
          RowBox[{"\<\"rules\"\>", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"C1", "\[Rule]", "0"}], ",", 
             RowBox[{"C2", "\[Rule]", "0"}], ",", 
             RowBox[{"C3", "\[Rule]", "0"}], ",", 
             RowBox[{"C4", "\[Rule]", "0"}]}], "}"}]}], ",", 
          RowBox[{"\<\"coefficients\"\>", "\[Rule]", 
           RowBox[{"{", "C5", "}"}]}]}], "\[RightAssociation]"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"b", "\[GreaterEqual]", "0"}], "&&", 
           RowBox[{"a", "\[GreaterEqual]", "0"}], "&&", 
           RowBox[{"C5", ">", "0"}]}], ")"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"b", "\[LessEqual]", "0"}], "&&", 
           RowBox[{"a", "\[GreaterEqual]", "0"}], "&&", 
           RowBox[{"C5", "<", "0"}]}], ")"}]}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{{3.816852002518291*^9, 3.816852024355754*^9}},
 CellLabel->
  "Out[334]=",ExpressionUUID->"a724e9dc-fa49-42d8-bf83-6bbcfe9226e4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", "u", "}"}]}], ",", " ", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}], ",", " ", 
     RowBox[{"\"\<pars\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xp", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<expression\>\"", "\[Rule]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "C1"}], ")"}], " ", 
        RowBox[{
         RowBox[{"u", "[", "x", "]"}], "^", "3"}]}], "+", 
       RowBox[{"C2", " ", 
        RowBox[{"u", "[", "x", "]"}], " ", 
        RowBox[{
         RowBox[{"u", "'"}], "[", "x", "]"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"u", "'"}], "[", "x", "]"}], "^", "2"}], "+", 
       RowBox[{"a", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"u", "'"}], "[", "x", "]"}], "^", "4"}]}]}]}], ",", " ", 
     RowBox[{"\"\<coefficients\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"C1", ",", "C2", ",", "C3"}], "}"}]}], ",", 
     RowBox[{"\"\<eliminator\>\"", "\[Rule]", "False"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"sp", "=", 
  RowBox[{
   RowBox[{"SimplifyPositivityOperatorX", "[", "variables", "]"}], "[", "xp", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8167011160391207`*^9, 3.816701197617833*^9}, {
   3.8167012520308104`*^9, 3.816701269088232*^9}, {3.816701318907187*^9, 
   3.81670132289229*^9}, {3.816704027021307*^9, 3.816704067510912*^9}, {
   3.816704985441023*^9, 3.816705004318809*^9}, {3.8167050784928703`*^9, 
   3.8167050950873117`*^9}, {3.816708875743005*^9, 3.816708876338621*^9}, 
   3.8167092336344957`*^9, {3.816709479103093*^9, 3.816709513808701*^9}, {
   3.816709561812241*^9, 3.816709569213455*^9}, 3.816709707087674*^9, {
   3.81674015548345*^9, 3.816740158211224*^9}, {3.816772266941184*^9, 
   3.816772306888248*^9}, {3.816782171404676*^9, 3.816782171608508*^9}, {
   3.816782435283614*^9, 3.81678243699564*^9}, {3.816782467109535*^9, 
   3.816782469021611*^9}},
 CellLabel->
  "In[335]:=",ExpressionUUID->"a1e102f5-39c8-4e14-a547-2fda031fcafe"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"expression\"\>", "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      RowBox[{
       SuperscriptBox["u", "\[Prime]",
        MultilineFunction->None], "[", "x", "]"}], "2"], "+", 
     RowBox[{"a", " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["u", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}], "4"]}]}]}], ",", 
   RowBox[{"\<\"rules\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"C1", "\[Rule]", "1"}], ",", 
      RowBox[{"C2", "\[Rule]", "0"}]}], "}"}]}], ",", 
   RowBox[{"\<\"coefficients\"\>", "\[Rule]", 
    RowBox[{"{", "C3", "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.816772118020392*^9, 3.81677222274489*^9, {3.816772279560478*^9, 
   3.816772307288172*^9}, {3.816772758630898*^9, 3.81677276695337*^9}, 
   3.8167814820673513`*^9, 3.816782036849387*^9, {3.816782173331428*^9, 
   3.8167822216027308`*^9}, 3.81678228615886*^9, {3.81678242911836*^9, 
   3.8167824376728783`*^9}, 3.816782469405962*^9, 3.816790250905624*^9, 
   3.816851988729286*^9, 3.816852039316167*^9},
 CellLabel->
  "Out[337]=",ExpressionUUID->"d18129aa-b660-41e9-ae75-bb5b90b31a17"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", "u", "}"}]}], ",", " ", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}], ",", " ", 
     RowBox[{"\"\<pars\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"sp", "=", 
  RowBox[{
   RowBox[{"SimplifyPositivityOperatorX", "[", "variables", "]"}], "[", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<expression\>\"", "\[Rule]", " ", 
      RowBox[{
       RowBox[{"a", " ", 
        RowBox[{
         RowBox[{"u", "[", "x", "]"}], "^", "2"}]}], "+", 
       RowBox[{"C2", " ", 
        RowBox[{"u", "[", "x", "]"}], " ", 
        RowBox[{
         RowBox[{"u", "'"}], "[", "x", "]"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"u", "'"}], "[", "x", "]"}], "^", "2"}], "+", 
       RowBox[{"b", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"u", "'"}], "[", "x", "]"}], "^", "6"}]}]}]}], ",", " ", 
     RowBox[{"\"\<coefficients\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"C1", ",", "C2", ",", "C3"}], "}"}]}]}], "]"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{3.816766732423297*^9},
 CellLabel->"In[31]:=",ExpressionUUID->"96a32801-5a0c-467a-8b51-b7f38c3d0bde"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"\<\"eliminator\"\>", "\[Rule]", "False"}], ",", 
          RowBox[{"\<\"expression\"\>", "\[Rule]", 
           RowBox[{
            RowBox[{"a", " ", 
             SuperscriptBox[
              RowBox[{"u", "[", "x", "]"}], "2"]}], "+", 
            RowBox[{"C2", " ", 
             RowBox[{"u", "[", "x", "]"}], " ", 
             RowBox[{
              SuperscriptBox["u", "\[Prime]",
               MultilineFunction->None], "[", "x", "]"}]}], "+", 
            SuperscriptBox[
             RowBox[{
              SuperscriptBox["u", "\[Prime]",
               MultilineFunction->None], "[", "x", "]"}], "2"], "+", 
            RowBox[{"b", " ", 
             SuperscriptBox[
              RowBox[{
               SuperscriptBox["u", "\[Prime]",
                MultilineFunction->None], "[", "x", "]"}], "6"]}]}]}], ",", 
          RowBox[{"\<\"rules\"\>", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\<\"coefficients\"\>", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"C1", ",", "C2", ",", "C3"}], "}"}]}]}], 
         "\[RightAssociation]"}], 
        RowBox[{
         RowBox[{"a", "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{"b", "\[GreaterEqual]", "0"}]}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{3.816790277417845*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"3fe73ba2-06d5-4af4-9a48-0b9d384b008f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", "u", "}"}]}], ",", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"xp", "=", 
  RowBox[{
   RowBox[{"DisintegrateOperator", "[", "variables", "]"}], "[", 
   RowBox[{
    RowBox[{"u", "[", "x", "]"}], " ", 
    RowBox[{
     RowBox[{"u", "''''"}], "[", "x", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SimplifyPositivityOperatorX", "[", "variables", "]"}], "[", 
  "\[IndentingNewLine]", 
  RowBox[{"Association", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\"\<expression\>\"", "\[Rule]", "xp"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<coefficients\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["\[FormalA]", "1"], ",", 
       SubscriptBox["\[FormalA]", "2"]}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.816791599318475*^9, 3.8167916801361923`*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"7db1e45b-3f92-4c53-8965-1308c3a80156"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     SubscriptBox["\[FormalA]", "1"], "-", 
     SubscriptBox["\[FormalA]", "2"]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{
     SuperscriptBox["u", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "x", "]"}], "2"]}], "-", 
  RowBox[{
   SubscriptBox["\[FormalA]", "1"], " ", 
   RowBox[{
    SuperscriptBox["u", "\[Prime]",
     MultilineFunction->None], "[", "x", "]"}], " ", 
   RowBox[{
    SuperscriptBox["u", 
     TagBox[
      RowBox[{"(", "3", ")"}],
      Derivative],
     MultilineFunction->None], "[", "x", "]"}]}], "+", 
  RowBox[{
   SubscriptBox["\[FormalA]", "2"], " ", 
   RowBox[{"u", "[", "x", "]"}], " ", 
   RowBox[{
    SuperscriptBox["u", 
     TagBox[
      RowBox[{"(", "4", ")"}],
      Derivative],
     MultilineFunction->None], "[", "x", "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.8167916036341543`*^9, {3.81679167220485*^9, 3.816791680743773*^9}, 
   3.81681859863658*^9},
 CellLabel->"Out[53]=",ExpressionUUID->"bbfff392-4643-4c08-be81-ca107bacb858"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"expression\"\>", "\[Rule]", 
    SuperscriptBox[
     RowBox[{
      SuperscriptBox["u", "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "x", "]"}], "2"]}], ",", 
   RowBox[{"\<\"rules\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[FormalA]", "1"], "\[Rule]", "0"}], ",", 
      RowBox[{
       SubscriptBox["\[FormalA]", "2"], "\[Rule]", "0"}]}], "}"}]}], ",", 
   RowBox[{"\<\"coefficients\"\>", "\[Rule]", 
    RowBox[{"{", "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.8167916036341543`*^9, {3.81679167220485*^9, 3.816791680743773*^9}, 
   3.816818598669477*^9},
 CellLabel->"Out[54]=",ExpressionUUID->"981c600d-d8b5-4a2e-9bde-3f2da48b62ff"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", "u", "}"}]}], ",", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"xp", "=", 
  RowBox[{
   RowBox[{"DisintegrateOperator", "[", "variables", "]"}], "[", 
   RowBox[{
    RowBox[{"u", "[", "x", "]"}], " ", 
    RowBox[{
     RowBox[{"u", "''''"}], "[", "x", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SimplifyPositivityOperatorX", "[", "variables", "]"}], "[", 
  "\[IndentingNewLine]", 
  RowBox[{"Association", "[", "\[IndentingNewLine]", 
   RowBox[{"\"\<expression\>\"", "\[Rule]", "xp"}], "\[IndentingNewLine]", 
   "]"}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{3.816818610127605*^9},
 CellLabel->"In[55]:=",ExpressionUUID->"5e48a088-0a82-4744-97fc-0c7190bea598"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     SubscriptBox["\[FormalA]", "1"], "-", 
     SubscriptBox["\[FormalA]", "2"]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{
     SuperscriptBox["u", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "x", "]"}], "2"]}], "-", 
  RowBox[{
   SubscriptBox["\[FormalA]", "1"], " ", 
   RowBox[{
    SuperscriptBox["u", "\[Prime]",
     MultilineFunction->None], "[", "x", "]"}], " ", 
   RowBox[{
    SuperscriptBox["u", 
     TagBox[
      RowBox[{"(", "3", ")"}],
      Derivative],
     MultilineFunction->None], "[", "x", "]"}]}], "+", 
  RowBox[{
   SubscriptBox["\[FormalA]", "2"], " ", 
   RowBox[{"u", "[", "x", "]"}], " ", 
   RowBox[{
    SuperscriptBox["u", 
     TagBox[
      RowBox[{"(", "4", ")"}],
      Derivative],
     MultilineFunction->None], "[", "x", "]"}]}]}]], "Output",
 CellChangeTimes->{3.8168186119422503`*^9},
 CellLabel->"Out[56]=",ExpressionUUID->"c0acb78d-5e0a-45cb-a8d3-33dc2d7d0afe"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"expression\"\>", "\[Rule]", 
    SuperscriptBox[
     RowBox[{
      SuperscriptBox["u", "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "x", "]"}], "2"]}], ",", 
   RowBox[{"\<\"rules\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[FormalA]", "1"], "\[Rule]", "0"}], ",", 
      RowBox[{
       SubscriptBox["\[FormalA]", "2"], "\[Rule]", "0"}]}], "}"}]}], ",", 
   RowBox[{"\<\"coefficients\"\>", "\[Rule]", 
    RowBox[{"{", "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.81681861196204*^9},
 CellLabel->"Out[57]=",ExpressionUUID->"fc6fb849-a7d2-49f1-912a-f787372532b7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", "u", "}"}]}], ",", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}], ",", " ", 
     RowBox[{"\"\<pars\>\"", "\[Rule]", 
      RowBox[{"{", "a", "}"}]}], ",", 
     RowBox[{"\"\<VarDOperator\>\"", "\[Rule]", "DVarDOperator"}]}], "|>"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"xp", "=", 
  RowBox[{
   RowBox[{"DisintegrateOperator", "[", "variables", "]"}], "[", 
   RowBox[{
    RowBox[{"2", " ", 
     RowBox[{
      RowBox[{"u", " ", "[", "x", "]"}], "^", "2"}]}], "-", 
    RowBox[{"2", 
     RowBox[{"u", "[", "x", "]"}], " ", 
     RowBox[{"u", "[", 
      RowBox[{"x", "-", "1"}], "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SimplifyPositivityOperatorX", "[", "variables", "]"}], "[", 
  "\[IndentingNewLine]", 
  RowBox[{"Association", "[", "\[IndentingNewLine]", 
   RowBox[{"\"\<expression\>\"", "\[Rule]", "xp"}], "\[IndentingNewLine]", 
   "]"}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.816818686500678*^9, 3.816818693852076*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"7b248092-da1a-40ad-b209-f639fd5c4cc4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     SubscriptBox["\[FormalA]", "1"]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"u", "[", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], "]"}], "2"]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{"u", "[", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "x"}], "]"}], " ", 
   RowBox[{"u", "[", "x", "]"}]}], "+", 
  RowBox[{"2", " ", 
   SubscriptBox["\[FormalA]", "1"], " ", 
   SuperscriptBox[
    RowBox[{"u", "[", "x", "]"}], "2"]}]}]], "Output",
 CellChangeTimes->{3.816818698174184*^9},
 CellLabel->"Out[59]=",ExpressionUUID->"6dc4752c-f732-4bfb-a7ee-5d28dbaff3cd"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"\<\"eliminator\"\>", "\[Rule]", "False"}], ",", 
          RowBox[{"\<\"expression\"\>", "\[Rule]", 
           RowBox[{
            RowBox[{"2", " ", 
             SuperscriptBox[
              RowBox[{"u", "[", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "x"}], "]"}], "2"]}], "-", 
            RowBox[{"2", " ", 
             SubscriptBox["\[FormalA]", "1"], " ", 
             SuperscriptBox[
              RowBox[{"u", "[", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "x"}], "]"}], "2"]}], "-", 
            RowBox[{"2", " ", 
             RowBox[{"u", "[", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "x"}], "]"}], " ", 
             RowBox[{"u", "[", "x", "]"}]}], "+", 
            RowBox[{"2", " ", 
             SubscriptBox["\[FormalA]", "1"], " ", 
             SuperscriptBox[
              RowBox[{"u", "[", "x", "]"}], "2"]}]}]}], ",", 
          RowBox[{"\<\"rules\"\>", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\<\"coefficients\"\>", "\[Rule]", 
           RowBox[{"{", 
            SubscriptBox["\[FormalA]", "1"], "}"}]}]}], 
         "\[RightAssociation]"}], 
        RowBox[{"0", "\[LessEqual]", 
         SubscriptBox["\[FormalA]", "1"], "\[LessEqual]", "1"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{3.816818698181875*^9},
 CellLabel->"Out[60]=",ExpressionUUID->"53b11e28-67ef-48e4-af68-b8f38038e499"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", "u", "}"}]}], ",", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}], ",", " ", 
     RowBox[{"\"\<pars\>\"", "\[Rule]", 
      RowBox[{"{", "a", "}"}]}], ",", 
     RowBox[{"\"\<VarDOperator\>\"", "\[Rule]", "DVarDOperator"}]}], "|>"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"xp", "=", 
  RowBox[{
   RowBox[{"DisintegrateOperator", "[", "variables", "]"}], "[", 
   RowBox[{
    RowBox[{
     RowBox[{"u", " ", "[", "x", "]"}], " ", 
     RowBox[{"u", "[", 
      RowBox[{"x", "+", "1"}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"u", "[", "x", "]"}], " ", 
     RowBox[{"u", "[", 
      RowBox[{"x", "-", "1"}], "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SimplifyPositivityOperatorX", "[", "variables", "]"}], "[", 
  "\[IndentingNewLine]", 
  RowBox[{"Association", "[", "\[IndentingNewLine]", 
   RowBox[{"\"\<expression\>\"", "\[Rule]", "xp"}], "\[IndentingNewLine]", 
   "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.816818802919579*^9, 3.81681881465346*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"bb2ff9e5-8186-4f4d-bc47-10aeb3990d0e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["\[FormalA]", "1"], " ", 
   RowBox[{"u", "[", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "x"}], "]"}], " ", 
   RowBox[{"u", "[", "x", "]"}]}], "-", 
  RowBox[{
   SubscriptBox["\[FormalA]", "1"], " ", 
   RowBox[{"u", "[", "x", "]"}], " ", 
   RowBox[{"u", "[", 
    RowBox[{"1", "+", "x"}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.81681881136869*^9, 3.816818816886115*^9}, 
   3.816818937527267*^9, 3.816818975885744*^9, 3.8168190246556807`*^9, 
   3.816819083200515*^9, 3.8168191168633966`*^9},
 CellLabel->"Out[99]=",ExpressionUUID->"3ae35c52-b25a-4e01-9b87-1f1fd4a3c0c2"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"expression\"\>", "\[Rule]", "0"}], ",", 
   RowBox[{"\<\"rules\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[FormalA]", "1"], "\[Rule]", "0"}], "}"}]}], ",", 
   RowBox[{"\<\"coefficients\"\>", "\[Rule]", 
    RowBox[{"{", "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.81681881136869*^9, 3.816818816886115*^9}, 
   3.816818937527267*^9, 3.816818975885744*^9, 3.8168190246556807`*^9, 
   3.816819083200515*^9, 3.816819116903056*^9},
 CellLabel->
  "Out[100]=",ExpressionUUID->"f55edfcf-4716-436b-989c-f1552f92f482"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", "u", "}"}]}], ",", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}], ",", " ", 
     RowBox[{"\"\<pars\>\"", "\[Rule]", 
      RowBox[{"{", "a", "}"}]}]}], "|>"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"xp", "=", 
  RowBox[{
   RowBox[{"DisintegrateOperator", "[", "variables", "]"}], "[", 
   RowBox[{
    RowBox[{"u", "[", "x", "]"}], " ", 
    RowBox[{
     RowBox[{
      RowBox[{"u", "'"}], "[", "x", "]"}], "^", "2"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SimplifyPositivityOperatorX", "[", "variables", "]"}], "[", 
  "\[IndentingNewLine]", 
  RowBox[{"Association", "[", "\[IndentingNewLine]", 
   RowBox[{"\"\<expression\>\"", "\[Rule]", "xp"}], "\[IndentingNewLine]", 
   "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.816819151357685*^9, 3.816819169785733*^9}},
 CellLabel->
  "In[172]:=",ExpressionUUID->"149b881d-933b-4d9a-809f-a9090d4b749d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", 
       SubscriptBox["\[FormalA]", "1"]}]}], ")"}]}], " ", 
   RowBox[{"u", "[", "x", "]"}], " ", 
   SuperscriptBox[
    RowBox[{
     SuperscriptBox["u", "\[Prime]",
      MultilineFunction->None], "[", "x", "]"}], "2"]}], "-", 
  RowBox[{
   SubscriptBox["\[FormalA]", "1"], " ", 
   SuperscriptBox[
    RowBox[{"u", "[", "x", "]"}], "2"], " ", 
   RowBox[{
    SuperscriptBox["u", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "x", "]"}]}]}]], "Output",
 CellChangeTimes->{3.816819170724419*^9, 3.816838717325626*^9},
 CellLabel->
  "Out[173]=",ExpressionUUID->"d5b83c2d-930f-401a-a761-150397d54755"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.816819170724419*^9, 3.816838717339666*^9},
 CellLabel->
  "Out[174]=",ExpressionUUID->"23a50ae1-335f-44b4-9a25-a1b52519d842"]
}, Open  ]],

Cell[CellGroupData[{

Cell["PositivityQE", "Section",
 CellChangeTimes->{{3.816819271736682*^9, 
  3.81681927894517*^9}},ExpressionUUID->"f3a47fe3-e349-4508-a843-\
461136b1bf99"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"getSymbols", "[", "expr_", "]"}], ":=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"symbols", "=", 
         RowBox[{"DeleteDuplicates", "@", 
          RowBox[{"Flatten", "@", 
           RowBox[{"Cases", "[", 
            RowBox[{"expr", ",", 
             RowBox[{
              RowBox[{"f_Symbol", "|", 
               RowBox[{
                RowBox[{
                 RowBox[{"Derivative", "[", "__", "]"}], "[", "f_Symbol", 
                 "]"}], "[", "x__Symbol", "]"}], "|", 
               RowBox[{
                RowBox[{
                 RowBox[{"Derivative", "[", "__", "]"}], "[", "f_Symbol", 
                 "]"}], "[", "__", "]"}], "|", 
               RowBox[{"f_Symbol", "[", "__", "]"}], "|", 
               RowBox[{"_", "[", "x__Symbol", "]"}]}], "\[RuleDelayed]", 
              RowBox[{"{", 
               RowBox[{"f", ",", "x"}], "}"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}]}]}]}], "}"}], 
       ",", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "there", " ", "might", " ", "be", " ", "atomic", " ", "expressions", 
          " ", "in", " ", "symbols", " ", "that", " ", "are", " ", "not", " ",
           "strictly", " ", "symbols", " ", "in", " ", "this", " ", 
          "context"}], ",", 
         RowBox[{"like", " ", "Plus"}], ",", "Times", ",", 
         RowBox[{"Power", " ", 
          RowBox[{"etc", "."}]}]}], "*)"}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "those", " ", "are", " ", "symbols", " ", "which", " ", "should", 
          " ", "not", " ", "be", " ", "transford", " ", "into", " ", 
          "pattern"}], ",", 
         RowBox[{
         "so", " ", "we", " ", "eliminate", " ", "them", " ", "by", " ", 
          "exact", " ", "string", " ", "match", " ", "in", " ", "the", " ", 
          "actual", " ", 
          RowBox[{"expr", "."}]}]}], "*)"}], 
       RowBox[{"Select", "[", 
        RowBox[{"symbols", ",", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"StringFreeQ", "[", 
              RowBox[{
               RowBox[{"ToString", "[", "expr", "]"}], ",", 
               RowBox[{"ToString", "[", "#", "]"}]}], "]"}], "||", 
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"True", ",", "False"}], "}"}], ",", "#"}], "]"}]}], 
            ")"}]}], "&"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "findExtrema", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Facts", "\[Rule]", "True"}], ",", 
       RowBox[{"RandomSampleSize", "\[Rule]", "10"}], ",", 
       RowBox[{"Type", "\[Rule]", "Min"}]}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"findExtrema", "[", 
     RowBox[{"function_", ",", "vars_List", ",", 
      RowBox[{"pars_List:", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "randomSampleSize", ",", "type", ",", "facts", ",", "usedVars", ",", 
        "usedPars", ",", "parametricFacts", ",", "nonparametricFacts", ",", 
        "directExtrema", ",", "randomParValues", ",", "values", ",", 
        "typeValue"}], "}"}], ",", 
      RowBox[{
       RowBox[{"randomSampleSize", "=", 
        RowBox[{"OptionValue", "[", "RandomSampleSize", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"type", "=", 
        RowBox[{"OptionValue", "[", "Type", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"usedVars", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"vars", ",", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"FreeQ", "[", 
             RowBox[{"function", ",", "#"}], "]"}]}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"usedPars", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"pars", ",", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"FreeQ", "[", 
             RowBox[{"function", ",", "#"}], "]"}]}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"facts", "=", 
        RowBox[{"OptionValue", "[", "Facts", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"parametricFacts", ",", "nonparametricFacts"}], "}"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"GroupBy", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"FreeQQ", "[", 
               RowBox[{"facts", ",", "And"}], "]"}], ",", 
              RowBox[{"List", "@", "facts"}], ",", 
              RowBox[{"List", "@@", "facts"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"And", "@@", 
              RowBox[{"FreeQQ", "[", 
               RowBox[{"#", ",", "usedVars"}], "]"}]}], "&"}]}], "]"}], "/@", 
          
          RowBox[{"{", 
           RowBox[{"True", ",", "False"}], "}"}]}], "/.", 
         RowBox[{
          RowBox[{"Missing", "[", "___", "]"}], "\[Rule]", 
          RowBox[{"{", "}"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"DPrint", "[", 
          RowBox[{"\"\<parameters and variables = \>\"", ",", 
           RowBox[{"{", 
            RowBox[{"usedPars", ",", "usedVars"}], "}"}]}], "]"}], ";"}], 
        "*)"}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"DPrint", "[", 
          RowBox[{"\"\<parametricFacts, nonparametricFacts = \>\"", ",", 
           RowBox[{"{", 
            RowBox[{"parametricFacts", ",", "nonparametricFacts"}], "}"}]}], 
          "]"}], ";"}], "*)"}], 
       RowBox[{"typeValue", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"type", "===", "Min"}], ",", "MinValue", ",", "MaxValue"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"directExtrema", "=", 
        RowBox[{"typeValue", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"function", ",", 
            RowBox[{"And", "@@", "nonparametricFacts"}]}], "}"}], ",", 
          "usedVars"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "@", "directExtrema"}], "=!=", "typeValue"}], ",", 
         RowBox[{"Return", "@", "directExtrema"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"randomParValues", "=", 
        RowBox[{
         RowBox[{"Through", "[", 
          RowBox[{"Unevaluated", "@", 
           RowBox[{
            RowBox[{"Union", "[", 
             RowBox[{"RandomInteger", ",", "RandomReal"}], "]"}], "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "randomSampleSize"}], ",", "randomSampleSize"}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"randomSampleSize", ",", 
               RowBox[{"Length", "@", "usedPars"}]}], "}"}]}], "]"}]}], "]"}],
          "//", 
         RowBox[{
          RowBox[{"Round", "[", 
           RowBox[{"#", ",", 
            RowBox[{"10", "^", 
             RowBox[{"(", 
              RowBox[{"-", "2"}], ")"}]}]}], "]"}], "&"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"DPrint", "[", 
         RowBox[{"\"\<randomParValues = \>\"", ",", "randomParValues"}], 
         "]"}], "*)"}], ";", "\[IndentingNewLine]", 
       RowBox[{"randomParValues", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"randomParValues", ",", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Simplify", "[", 
               RowBox[{
                RowBox[{"And", "@@", "parametricFacts"}], "/.", 
                RowBox[{"Thread", "[", 
                 RowBox[{"usedPars", "\[Rule]", "#"}], "]"}]}], "]"}], "===", 
              "False"}], ")"}]}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"values", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"typeValue", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"function", ",", 
                RowBox[{"And", "@@", "nonparametricFacts"}]}], "}"}], ",", 
              "usedVars"}], "]"}], "/.", 
            RowBox[{"Thread", "[", 
             RowBox[{"usedPars", "\[Rule]", "#"}], "]"}]}], "&"}], ",", 
          "randomParValues"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"DPrint", "[", 
          RowBox[{"\"\<min/max values = \>\"", ",", "values"}], "]"}], ";"}], 
        "*)"}], 
       RowBox[{"type", "@", 
        RowBox[{"Select", "[", 
         RowBox[{"values", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"NumericQ", "[", "#", "]"}], "||", 
            RowBox[{
             RowBox[{"Head", "@", "#"}], "===", "DirectedInfinity"}]}], 
           "&"}]}], "]"}]}]}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "AssociatedPolynomial", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"Facts", "\[Rule]", "True"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"AssociatedPolynomial", "[", 
     RowBox[{"exp_List", ",", "depVars_List", ",", "indVars_List", ",", 
      RowBox[{"pars_List:", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "print", ",", "facts", ",", "expr", ",", "vars", ",", "functions", ",",
         "extraFunctions", ",", "extraFacts"}], "}"}], ",", 
      RowBox[{
       RowBox[{"print", "=", 
        RowBox[{"DebugPrint", "[", 
         RowBox[{"False", ",", "\"\<[assoc-pol]\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"facts", "=", 
        RowBox[{"OptionValue", "[", "Facts", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"print", "[", 
        RowBox[{"\"\<facts = \>\"", ",", "facts"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"expr", "=", 
        RowBox[{"Together", "/@", "exp"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"vars", "=", 
        RowBox[{"getVars", "[", 
         RowBox[{"expr", ",", "depVars"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"functions", "=", 
        RowBox[{"DeleteDuplicates", "@", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"FixedPoint", "[", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"MemberQ", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"Plus", ",", "Times"}], "}"}], ",", 
                   RowBox[{"Head", "@", "#"}]}], "]"}], ",", 
                 RowBox[{"Sequence", "@@", 
                  RowBox[{"List", "@@", "#"}]}], ",", "#"}], "]"}], "&"}], 
              "]"}], ",", "expr"}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"!", 
              RowBox[{"PolynomialQ", "[", 
               RowBox[{"#", ",", "vars"}], "]"}]}], "&&", 
             RowBox[{"!", 
              RowBox[{"FreeQQ", "[", 
               RowBox[{"#", ",", "vars"}], "]"}]}]}], "&"}]}], "]"}]}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"functions", "\[Equal]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{"expr", ",", 
            RowBox[{"{", "}"}], ",", "facts"}], "}"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"There", " ", "are", " ", "two", " ", "problems", " ", 
         RowBox[{"here", ":"}]}], "*)"}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "1.", " ", "functinos", " ", "need", " ", "to", " ", "be", " ", 
          "cleaned"}], ",", 
         RowBox[{
         "since", " ", "some", " ", "of", " ", "them", " ", "might", " ", 
          "be", " ", "expressed", " ", "by", " ", "others", " ", "in", " ", 
          "a", " ", "polynomial", " ", "relation"}], ",", 
         RowBox[{"like", " ", 
          RowBox[{
           RowBox[{"r", "[", "x", "]"}], "^", "b"}]}], ",", 
         RowBox[{
          RowBox[{"r", "[", "x", "]"}], "^", 
          RowBox[{"(", 
           RowBox[{"2", "b"}], ")"}]}], ",", 
         RowBox[{
          RowBox[{"r", "[", "x", "]"}], "^", 
          RowBox[{"(", 
           RowBox[{"b", "-", "1"}], ")"}]}]}], "*)"}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "2.", " ", "MinV", " ", "and", " ", "MaxV", " ", "do", " ", "not", 
          " ", "work", " ", "for", " ", "all", " ", "cases"}], ",", 
         RowBox[{
         "they", " ", "need", " ", "to", " ", "be", " ", "improved", " ", 
          RowBox[{"(", 
           RowBox[{"NMinimize", ",", "Minimize", ",", "FindMinimum"}], 
           ")"}]}]}], "*)"}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "It", " ", "might", " ", "be", " ", "useful", " ", "to", " ", 
          "apply", " ", "this", " ", "part", " ", "also", " ", "in", " ", 
          "SimplifyPositivity", " ", "to", " ", "handle", " ", "non"}], "-", 
         RowBox[{"plynomial", " ", 
          RowBox[{"cases", ".", " ", "Maybe"}], " ", "a", " ", "function", 
          " ", "for", " ", "this", " ", "will", " ", "be", " ", 
          RowBox[{"usefull", ":", 
           RowBox[{"AssociatePolynomial", "."}]}]}]}], "*)"}], 
       RowBox[{"print", "[", 
        RowBox[{"\"\<functions = \>\"", ",", "functions"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"extraFunctions", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Subscript", "[", 
            RowBox[{"\[FormalCapitalY]", ",", "k"}], "]"}], "@@", "indVars"}],
           ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", 
            RowBox[{"Length", "@", "functions"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"print", "[", 
        RowBox[{"\"\<extraFunctions = \>\"", ",", "extraFunctions"}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"print", "[", 
        RowBox[{"\"\<functions = \>\"", ",", 
         RowBox[{"Thread", "[", 
          RowBox[{"functions", "\[Rule]", "extraFunctions"}], "]"}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"extraFacts", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"MinV", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"First", "@", "#"}], ",", "facts"}], "}"}], ",", 
                "vars"}], "]"}], "\[LessEqual]", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", 
              RowBox[{"MaxV", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"First", "@", "#"}], ",", "facts"}], "}"}], ",", 
                "vars"}], "]"}]}], ")"}], "&"}], "/@", 
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{"functions", ",", "extraVars"}], "}"}], "]"}]}]}], ";"}],
         "*)"}], 
       RowBox[{"extraFacts", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"findExtrema", "[", 
             RowBox[{
              RowBox[{"First", "@", "#"}], ",", "vars", ",", "pars", ",", 
              RowBox[{"Facts", "\[Rule]", "facts"}], ",", 
              RowBox[{"Type", "\[Rule]", "Min"}]}], "]"}], "\[LessEqual]", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", 
            RowBox[{"findExtrema", "[", 
             RowBox[{
              RowBox[{"First", "@", "#"}], ",", "vars", ",", "pars", ",", 
              RowBox[{"Facts", "\[Rule]", "facts"}], ",", 
              RowBox[{"Type", "\[Rule]", "Max"}]}], "]"}]}], ")"}], "&"}], "/@", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"functions", ",", "extraFunctions"}], "}"}], "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"print", "[", 
        RowBox[{"\"\<genFacts = \>\"", ",", "extraFacts"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"expr", "/.", 
          RowBox[{"Thread", "[", 
           RowBox[{"functions", "\[Rule]", "extraFunctions"}], "]"}]}], ",", 
         "extraFunctions", ",", 
         RowBox[{"And", "@@", "extraFacts"}], ",", "functions"}], "}"}]}]}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PositivityQEOperatorX", "[", "variables_Association", "]"}], 
     "[", "problem_", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Which", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"problem", "===", "$Failed"}], ",", "\[IndentingNewLine]", 
      "$Failed", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Head", "[", "problem", "]"}], "===", "Piecewise"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"PiecewiseOperatorMap", "[", 
       RowBox[{"PositivityQEOperatorX", ",", "variables", ",", "problem"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Head", "[", "problem", "]"}], "=!=", "Association"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PositivityQEOperatorX", "[", "variables", "]"}], "[", 
       RowBox[{"Association", "[", 
        RowBox[{"\"\<expression\>\"", "\[Rule]", "problem"}], "]"}], "]"}], 
      ",", "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "exp", ",", "depVars", ",", "indVars", ",", "pars", ",", 
          "\[IndentingNewLine]", "dom", ",", "facts", ",", "timeConstraint", 
          ",", "type", ",", "expr", ",", "vars", ",", "factVars", ",", 
          "allVars", ",", "parametricFacts", ",", "nonparametricFacts", ",", 
          "extraFunctions", ",", "extraFacts", ",", "oldFunctions", ",", 
          "formalCoeffs", ",", "print", ",", "cleanup"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"exp", "=", 
          RowBox[{"Lookup", "[", 
           RowBox[{"problem", ",", "\"\<expression\>\"", ",", " ", "0"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"depVars", "=", 
          RowBox[{"Lookup", "[", 
           RowBox[{"variables", ",", "\"\<depVars\>\"", ",", " ", 
            RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"indVars", "=", 
          RowBox[{"Lookup", "[", 
           RowBox[{"variables", ",", "\"\<indVars\>\"", ",", " ", 
            RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"pars", "=", 
          RowBox[{"Lookup", "[", 
           RowBox[{"variables", ",", "\"\<pars\>\"", ",", " ", 
            RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"dom", "=", 
          RowBox[{"Lookup", "[", 
           RowBox[{"variables", ",", "\"\<domain\>\"", ",", " ", "Reals"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"facts", "=", 
          RowBox[{"Lookup", "[", 
           RowBox[{"variables", ",", "\"\<facts\>\"", ",", " ", "True"}], 
           "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"timeConstraint", "=", 
          RowBox[{"Lookup", "[", 
           RowBox[{"problem", ",", "\"\<timeconstraint\>\"", ",", 
            RowBox[{"Lookup", "[", 
             RowBox[{"variables", ",", "\"\<timeconstraint\>\"", ",", "5"}], 
             "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"type", "=", 
          RowBox[{"Lookup", "[", 
           RowBox[{
           "problem", ",", "\"\<type\>\"", ",", " ", "\"\<ForAll\>\""}], 
           "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"expr", "=", 
          RowBox[{"Together", "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", "exp", "}"}], "//", "Flatten"}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"print", "=", "Null"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"cleanup", ":=", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#", "===", "$Failed"}], ",", "$Failed", ",", " ", 
             RowBox[{"PiecewiseSimplify", "[", 
              RowBox[{"Piecewise", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{"exp", ",", "#"}], "}"}], "}"}], ",", "$Failed"}], 
               "]"}], "]"}]}], "]"}], "&"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "I", " ", "have", " ", "added", " ", "the", " ", "independent", " ",
            "variables", " ", "that", " ", "appear", " ", "in", " ", "the", 
           " ", "expression"}], "*)"}], 
         RowBox[{"vars", "=", 
          RowBox[{"Union", "[", 
           RowBox[{
            RowBox[{"getVars", "[", 
             RowBox[{"expr", ",", "depVars"}], "]"}], ",", 
            RowBox[{"Intersection", "[", 
             RowBox[{
              RowBox[{"getSymbols", "[", 
               RowBox[{"{", 
                RowBox[{"exp", ",", "facts"}], "}"}], "]"}], ",", "indVars"}],
              "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"factVars", "=", 
          RowBox[{"getVars", "[", 
           RowBox[{"facts", ",", "depVars"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"allVars", "=", 
          RowBox[{"Union", "[", 
           RowBox[{"vars", ",", "factVars"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "If", " ", "the", " ", "given", " ", "expression", " ", "does", 
            " ", "not", " ", "contain", " ", "any", " ", "variables"}], ",", 
           RowBox[{
            RowBox[{
            "then", " ", "it", " ", "is", " ", "a", " ", "coefficient", " ", 
             "and", " ", "hence", " ", "the", " ", "output", " ", "should", 
             " ", "be", " ", "expr"}], "\[GreaterEqual]", "0"}]}], "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"vars", "===", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"Return", "[", 
            RowBox[{"cleanup", "[", 
             RowBox[{"And", "@@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "\[GreaterEqual]", "0"}], "&"}], "/@", "expr"}],
                ")"}]}], "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"print", "[", 
          RowBox[{"\"\<vars = \>\"", ",", "vars"}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"parametricFacts", ",", "nonparametricFacts"}], "}"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"GroupBy", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"FreeQQ", "[", 
                 RowBox[{"facts", ",", "And"}], "]"}], ",", 
                RowBox[{"List", "@", "facts"}], ",", 
                RowBox[{"List", "@@", "facts"}]}], "]"}], ",", 
              RowBox[{
               RowBox[{"And", "@@", 
                RowBox[{"FreeQQ", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"Union", "[", 
                   RowBox[{"depVars", ",", "indVars"}], "]"}]}], "]"}]}], 
               "&"}]}], "]"}], "/@", 
            RowBox[{"{", 
             RowBox[{"True", ",", "False"}], "}"}]}], "/.", 
           RowBox[{
            RowBox[{"Missing", "[", "___", "]"}], "\[Rule]", 
            RowBox[{"{", "}"}]}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"print", "[", 
          RowBox[{
          "\"\<parametricFacts = \>\"", ",", "parametricFacts", ",", 
           "\"\<, nonparametricFacts = \>\"", ",", "nonparametricFacts"}], 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"cleanup", "@", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"type", "===", "Exists"}], ",", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"formalCoeffs", "=", 
              RowBox[{"Union", "@", 
               RowBox[{"Cases", "[", 
                RowBox[{"expr", ",", 
                 RowBox[{"Subscript", "[", 
                  RowBox[{"\[FormalA]", ",", "_Integer"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"print", "[", 
              RowBox[{
              "formalCoeffs", ",", "\"\< - \>\"", ",", "type", ",", 
               "\"\< - \>\"", ",", 
               RowBox[{"PolynomialQ", "[", 
                RowBox[{"expr", ",", "vars"}], "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"formalCoeffs", "===", 
                RowBox[{"{", "}"}]}], ",", 
               RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"And", "@@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"PolynomialQ", "[", 
                    RowBox[{"#", ",", "vars"}], "]"}], "&"}], "/@", "expr"}], 
                 ")"}]}], ",", 
               RowBox[{
                RowBox[{
                "print", "[", 
                 "\"\<Given expression seems to be a polynomial.\>\"", "]"}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"TimeConstrained", "[", 
                 RowBox[{
                  RowBox[{"FullSimplify", "@", 
                   RowBox[{"Reduce", "[", 
                    RowBox[{
                    RowBox[{"Exists", "[", 
                    RowBox[{
                    RowBox[{"Evaluate", "@", "formalCoeffs"}], ",", 
                    RowBox[{"ForAll", "[", 
                    RowBox[{
                    RowBox[{"Evaluate", "@", "allVars"}], ",", 
                    RowBox[{"And", "@@", "nonparametricFacts"}], ",", 
                    RowBox[{
                    RowBox[{"And", "@@", "parametricFacts"}], "&&", 
                    RowBox[{"(", 
                    RowBox[{"And", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "\[GreaterEqual]", "0"}], "&"}], "/@", 
                    "expr"}], ")"}]}], ")"}]}]}], "]"}]}], "]"}], ",", 
                    "dom"}], "]"}]}], ",", "timeConstraint", ",", "$Failed"}],
                  "]"}]}], ",", 
               RowBox[{"(*", 
                RowBox[{
                "If", " ", "expr", " ", "is", " ", "not", " ", "a", " ", 
                 "polynomial"}], "*)"}], 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "expr", ",", "extraFunctions", ",", "extraFacts", ",", 
                   "oldFunctions"}], "}"}], "=", 
                 RowBox[{"AssociatedPolynomial", "[", 
                  RowBox[{
                  "expr", ",", "depVars", ",", "indVars", ",", "pars", ",", 
                   RowBox[{"Facts", "\[Rule]", "facts"}]}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"print", "[", 
                 RowBox[{"\"\<expr = \>\"", ",", "expr"}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"print", "[", 
                 RowBox[{
                 "\"\<extraFunctions, extraFacts = \>\"", ",", 
                  "extraFunctions", ",", "\"\< | \>\"", ",", "extraFacts"}], 
                 "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"TimeConstrained", "[", 
                 RowBox[{
                  RowBox[{"FullSimplify", "@", 
                   RowBox[{"Reduce", "[", 
                    RowBox[{
                    RowBox[{"Exists", "[", 
                    RowBox[{"formalCoeffs", ",", 
                    RowBox[{"ForAll", "[", 
                    RowBox[{
                    RowBox[{"Evaluate", "@", 
                    RowBox[{"Union", "[", 
                    RowBox[{"allVars", ",", "extraFunctions"}], "]"}]}], ",", 
                    
                    RowBox[{
                    RowBox[{"And", "@@", "nonparametricFacts"}], "&&", 
                    "extraFacts"}], ",", 
                    RowBox[{
                    RowBox[{"And", "@@", "parametricFacts"}], "&&", 
                    RowBox[{"expr", "\[GreaterEqual]", "0"}]}]}], "]"}]}], 
                    "]"}], ",", "dom"}], "]"}]}], ",", "timeConstraint", ",", 
                  "$Failed"}], "]"}]}]}], "]"}]}], ",", "\[IndentingNewLine]",
             "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"If", " ", "type"}], "===", "ForAll"}], "*)"}], 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"And", "@@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"PolynomialQ", "[", 
                   RowBox[{"#", ",", "vars"}], "]"}], "&"}], "/@", "expr"}], 
                ")"}]}], ",", 
              RowBox[{
               RowBox[{
               "print", "[", 
                "\"\<Given expression seems to be a polynomial.\>\"", "]"}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "1.", " ", "parametric", " ", "facts", " ", "should", " ", 
                   "be", " ", "placed", " ", "with", " ", "conditions", " ", 
                   "where", " ", "the", " ", "expr"}], "\[GreaterEqual]", 
                  "0"}], ",", 
                 RowBox[{
                 "while", " ", "nonparametric", " ", "ones", " ", "should", 
                  " ", "be", " ", "as", " ", "conditions", " ", "on", " ", 
                  "vars"}]}], "*)"}], 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{
                 "2.", " ", "FullSumplify", " ", "is", " ", "needed"}], ",", 
                 RowBox[{
                 "since", " ", "sometimes", " ", "Resolve", " ", "gives", " ",
                   "complicated", " ", "constraints", " ", "which", " ", 
                  "can", " ", "actually", " ", "be", " ", "simplified"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"e", ".", "g", ".", "x"}], 
                   RowBox[{"(", 
                    RowBox[{"a", "+", "bx", "+", 
                    RowBox[{"cx", "^", "2"}]}], ")"}]}], "\[GreaterEqual]", 
                  "0"}]}], "*)"}], 
               RowBox[{"TimeConstrained", "[", 
                RowBox[{
                 RowBox[{"FullSimplify", "@", 
                  RowBox[{"Resolve", "[", 
                   RowBox[{
                    RowBox[{"ForAll", "[", 
                    RowBox[{
                    RowBox[{"Evaluate", "@", "allVars"}], ",", 
                    RowBox[{"And", "@@", "nonparametricFacts"}], ",", 
                    RowBox[{
                    RowBox[{"And", "@@", "parametricFacts"}], "&&", 
                    RowBox[{"(", 
                    RowBox[{"And", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "\[GreaterEqual]", "0"}], "&"}], "/@", 
                    "expr"}], ")"}]}], ")"}]}]}], "]"}], ",", "dom"}], 
                   "]"}]}], ",", "timeConstraint", ",", "$Failed"}], "]"}]}], 
              ",", 
              RowBox[{"(*", 
               RowBox[{
               "If", " ", "expr", " ", "is", " ", "not", " ", "a", " ", 
                "polynomial"}], "*)"}], "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "expr", ",", "extraFunctions", ",", "extraFacts", ",", 
                  "oldFunctions"}], "}"}], "=", 
                RowBox[{"AssociatedPolynomial", "[", 
                 RowBox[{
                 "expr", ",", "depVars", ",", "indVars", ",", "pars", ",", 
                  RowBox[{"Facts", "\[Rule]", "facts"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"print", "[", 
                RowBox[{"\"\<expr = \>\"", ",", "expr"}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"print", "[", 
                RowBox[{
                "\"\<extraFunctions, extraFacts = \>\"", ",", 
                 "extraFunctions", ",", "\"\< | \>\"", ",", "extraFacts"}], 
                "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"TimeConstrained", "[", 
                RowBox[{
                 RowBox[{"FullSimplify", "@", 
                  RowBox[{"Resolve", "[", 
                   RowBox[{
                    RowBox[{"ForAll", "[", 
                    RowBox[{
                    RowBox[{"Evaluate", "@", 
                    RowBox[{"Union", "[", 
                    RowBox[{"allVars", ",", "extraFunctions"}], "]"}]}], ",", 
                    
                    RowBox[{
                    RowBox[{"And", "@@", "nonparametricFacts"}], "&&", 
                    "extraFacts"}], ",", 
                    RowBox[{
                    RowBox[{"And", "@@", "parametricFacts"}], "&&", 
                    RowBox[{"(", 
                    RowBox[{"And", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "\[GreaterEqual]", "0"}], "&"}], "/@", 
                    "expr"}], ")"}]}], ")"}]}]}], "]"}], ",", "dom"}], 
                   "]"}]}], ",", "timeConstraint", ",", "$Failed"}], 
                "]"}]}]}], "]"}]}], "]"}]}]}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.8168192824642057`*^9, 3.816819282476822*^9}, {
   3.816819318565537*^9, 3.8168195457904*^9}, {3.816819707120102*^9, 
   3.8168197154360437`*^9}, {3.8168197961531887`*^9, 3.81681985992358*^9}, {
   3.816819941898942*^9, 3.8168199697082243`*^9}, {3.8168200032957277`*^9, 
   3.8168200051400013`*^9}, {3.816820086065187*^9, 3.816820092506309*^9}, {
   3.8168201428658447`*^9, 3.816820148952182*^9}, {3.8168202139695053`*^9, 
   3.8168202635920153`*^9}, {3.8168203337249537`*^9, 3.816820378525016*^9}, 
   3.816820445456182*^9, {3.816827185512403*^9, 3.816827384778758*^9}, {
   3.816827425806628*^9, 3.8168274472459507`*^9}, 3.8168274908388157`*^9, {
   3.816827608370524*^9, 3.8168276099154453`*^9}, {3.8168276612023153`*^9, 
   3.81682766326974*^9}, {3.816827736478063*^9, 3.816827758948482*^9}, {
   3.8168278421206512`*^9, 3.816827845573591*^9}, 3.8168279032703037`*^9, {
   3.816835611324839*^9, 3.816835621432025*^9}, {3.816842703821868*^9, 
   3.816842710252192*^9}, {3.816853027627645*^9, 3.816853180254401*^9}, {
   3.816853341106317*^9, 3.816853346189838*^9}, {3.8168533799912577`*^9, 
   3.816853382883752*^9}, {3.8168534424813128`*^9, 3.816853464972438*^9}},
 CellLabel->
  "In[349]:=",ExpressionUUID->"030d05a6-3a55-404e-b558-db868017fc99"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", "u", "}"}]}], ",", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}], ",", " ", 
     RowBox[{"\"\<pars\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}]}]}], "|>"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PositivityQEOperatorX", "[", "variables", "]"}], "[", 
  "\[IndentingNewLine]", 
  RowBox[{"Association", "[", "\[IndentingNewLine]", 
   RowBox[{"\"\<expression\>\"", "\[Rule]", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"a", " ", 
        RowBox[{
         RowBox[{"u", "[", "x", "]"}], "^", "2"}]}], "+", 
       RowBox[{"Sin", "[", 
        RowBox[{"u", "[", "x", "]"}], "]"}], "+", "2"}], ",", " ", 
      RowBox[{
       RowBox[{"b", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"u", "'"}], "[", "x", "]"}], "^", "2"}]}], "+", 
       RowBox[{"E", "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"u", "'"}], "[", "x", "]"}], ")"}]}]}]}], "}"}]}], 
   "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.81682011584729*^9, 3.816820183373259*^9}, {
  3.816820309339274*^9, 3.816820318132375*^9}, {3.8168275027155733`*^9, 
  3.816827512730492*^9}, {3.8168282485103607`*^9, 3.816828282148274*^9}},
 CellLabel->
  "In[355]:=",ExpressionUUID->"e41d48d9-bbaf-48e8-9b90-f0bdf8883ec7"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {"$Failed", 
        RowBox[{
         RowBox[{"a", "<", "0"}], "||", 
         RowBox[{"b", "<", "0"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"2", "+", 
           RowBox[{"Sin", "[", 
            RowBox[{"u", "[", "x", "]"}], "]"}], "+", 
           RowBox[{"a", " ", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], "2"]}]}], ",", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             SuperscriptBox["u", "\[Prime]",
              MultilineFunction->None], "[", "x", "]"}]], "+", 
           RowBox[{"b", " ", 
            SuperscriptBox[
             RowBox[{
              SuperscriptBox["u", "\[Prime]",
               MultilineFunction->None], "[", "x", "]"}], "2"]}]}]}], "}"}], 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{
  3.816820183882019*^9, 3.816820233809811*^9, 3.816820271114686*^9, {
   3.816820312456406*^9, 3.816820318655808*^9}, 3.816820359756743*^9, 
   3.81682745679148*^9, {3.8168274953447*^9, 3.8168275134138327`*^9}, {
   3.816828246179845*^9, 3.816828282911199*^9}, 3.816835627288047*^9, 
   3.816852057214427*^9, 3.816853477040443*^9},
 CellLabel->
  "Out[356]=",ExpressionUUID->"405ac2c2-c0ca-4c9d-a100-785337d20f29"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", "u", "}"}]}], ",", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}], ",", " ", 
     RowBox[{"\"\<pars\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}]}]}], "|>"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PositivityQEOperatorX", "[", "variables", "]"}], "[", 
  "\[IndentingNewLine]", 
  RowBox[{"Association", "[", "\[IndentingNewLine]", 
   RowBox[{"\"\<expression\>\"", "\[Rule]", 
    RowBox[{"{", "  ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"u", "[", "x", "]"}], "^", "2"}], "+", " ", 
       RowBox[{"a", " ", 
        RowBox[{"u", "[", "x", "]"}], " ", 
        RowBox[{
         RowBox[{"u", "'"}], "[", "x", "]"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"u", "'"}], "[", "x", "]"}], "^", "2"}], "+", 
       RowBox[{"b", " ", 
        RowBox[{
         RowBox[{"u", "'''"}], "[", "x", "]"}]}]}], ",", " ", 
      RowBox[{"b", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"u", "'"}], "[", "x", "]"}], "^", "2"}]}]}], "}"}]}], 
   "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.8168536744052143`*^9, 3.816853706955542*^9}},
 CellLabel->
  "In[359]:=",ExpressionUUID->"99d58f88-84c6-4036-8ae5-7a109befe33a"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], "2"], "+", 
           RowBox[{"a", " ", 
            RowBox[{"u", "[", "x", "]"}], " ", 
            RowBox[{
             SuperscriptBox["u", "\[Prime]",
              MultilineFunction->None], "[", "x", "]"}]}], "+", 
           SuperscriptBox[
            RowBox[{
             SuperscriptBox["u", "\[Prime]",
              MultilineFunction->None], "[", "x", "]"}], "2"]}], ",", "0"}], 
         "}"}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "\[LessEqual]", "a", "\[LessEqual]", "2"}], "&&", 
         RowBox[{"b", "\[Equal]", "0"}]}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{{3.8168536802070704`*^9, 3.816853707809588*^9}},
 CellLabel->
  "Out[360]=",ExpressionUUID->"d901b30b-fdf1-4f9c-a1e5-048b51abdff5"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Positivity - CHAINING IT ALL TOGETHER", "Section",
 CellChangeTimes->{{3.816838402314279*^9, 3.816838405860149*^9}, {
  3.816862350060471*^9, 
  3.816862356126066*^9}},ExpressionUUID->"ff957a94-9059-4957-ab48-\
c883339554b6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
    "PositivityDisintegrateOperator", "[", "variables_Association", "]"}], 
    "[", "problem_", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Which", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"problem", "===", "$Failed"}], ",", "\[IndentingNewLine]", 
     "$Failed", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Head", "[", "problem", "]"}], "===", "Piecewise"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PiecewiseOperatorMap", "[", 
      RowBox[{
      "PositivityDisintegrateOperator", ",", "variables", ",", "problem"}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Head", "[", "problem", "]"}], "=!=", "Association"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PositivityDisintegrateOperator", "[", "variables", "]"}], "[", 
      
      RowBox[{"Association", "[", 
       RowBox[{"\"\<expression\>\"", "\[Rule]", "problem"}], "]"}], "]"}], 
     ",", "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "genForm", ",", "depVars", ",", "indVars", ",", "pars", ",", "gcd"}], 
        "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"genForm", "=", " ", 
         RowBox[{"PiecewiseMap", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", "#", "}"}], "//", "Flatten"}], ")"}], "&"}], ",", 
           RowBox[{
            RowBox[{"DisintegrateOperator", "[", "variables", "]"}], "[", 
            RowBox[{"Lookup", "[", 
             RowBox[{"problem", ",", "\"\<expression\>\"", ",", "0"}], "]"}], 
            "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "genForm", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"depVars", "=", 
         RowBox[{"Lookup", "[", 
          RowBox[{"variables", ",", "\"\<depVars\>\"", ",", " ", 
           RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"indVars", "=", 
         RowBox[{"Lookup", "[", 
          RowBox[{"variables", ",", "\"\<indVars\>\"", ",", " ", 
           RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pars", "=", 
         RowBox[{"Lookup", "[", 
          RowBox[{"variables", ",", "\"\<pars\>\"", ",", " ", 
           RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"gcd", "=", 
         RowBox[{"PiecewiseMap", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"PolynomialGCD", "[", 
               RowBox[{"Sequence", "@@", 
                RowBox[{"List", "@@", "#"}]}], "]"}], "&"}], "/@", "#"}], 
            "&"}], ",", " ", "genForm"}], "]"}]}], ";", "\[IndentingNewLine]",
         "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "gcd", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.816838343833248*^9, 3.816838417676098*^9}, {
  3.8168384668614607`*^9, 3.816838497442314*^9}, {3.816838604231299*^9, 
  3.816838643474617*^9}, {3.8168386763429327`*^9, 3.8168387422783747`*^9}, {
  3.816838875783368*^9, 3.8168389617526703`*^9}, {3.816838993834949*^9, 
  3.816839016882381*^9}, {3.816839071514011*^9, 3.816839081582725*^9}, {
  3.816839666109098*^9, 3.8168396772372837`*^9}, {3.816839722671348*^9, 
  3.816839756181885*^9}},ExpressionUUID->"be792fa7-f155-48db-a0cb-\
e6ff39373075"],

Cell[BoxData[
 TemplateBox[{
  "Lookup","invrl",
   "\"The argument \\!\\(\\*RowBox[{\\\"variables\\\"}]\\) is not a valid \
Association or a list of rules.\"",2,12,1,26780563352476639463,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.816839468578842*^9, 3.816839569569047*^9},
 CellLabel->
  "During evaluation of \
In[11]:=",ExpressionUUID->"e3d3b929-656d-4f60-b330-726880bad779"],

Cell[BoxData[
 TemplateBox[{
  "Lookup","invrl",
   "\"The argument \\!\\(\\*RowBox[{\\\"variables\\\"}]\\) is not a valid \
Association or a list of rules.\"",2,13,2,26780563352476639463,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.816839468578842*^9, 3.816839569582426*^9},
 CellLabel->
  "During evaluation of \
In[11]:=",ExpressionUUID->"e3e66ec7-f886-4bfb-bf19-6cf2f9433642"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "Positivity", "]"}], "=", 
   RowBox[{"Union", "[", 
    RowBox[{
     RowBox[{"Options", "[", "PositivityQE", "]"}], ",", 
     RowBox[{"Options", "[", "SimplifyPositivity", "]"}]}], "]"}]}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Positivity", "[", 
    RowBox[{"expr_", ",", "depVars_List", ",", "indVars_List", ",", 
     RowBox[{"pars_List:", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "print", ",", "facts", ",", "timeConstraint", ",", "vars", ",", 
       "genForm", ",", "gcd", ",", "parametricPowers", ",", "assumedFacts", 
       ",", "extraFacts", ",", "extraFunctions", ",", "oldFunctions", ",", 
       "branching"}], "}"}], ",", 
     RowBox[{
      RowBox[{"print", "=", 
       RowBox[{"DebugPrint", "[", 
        RowBox[{"True", ",", "\"\<[pos]\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"facts", "=", 
       RowBox[{"OptionValue", "[", "Facts", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"timeConstraint", "=", 
       RowBox[{"OptionValue", "[", "TimeConstraint", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vars", "=", 
       RowBox[{"getVars", "[", 
        RowBox[{"expr", ",", "depVars"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", "Disintegrate", "*)"}], 
      RowBox[{"genForm", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Disintegrate", "[", 
          RowBox[{"expr", ",", "depVars", ",", "indVars", ",", "pars"}], 
          "]"}], "//", "Expand"}], ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"print", "[", 
       RowBox[{"\"\<Disintegrated expr = \>\"", ",", "genForm"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Together", ",", 
        RowBox[{
         RowBox[{
         "remove", " ", "power", " ", "factors", " ", "with", " ", 
          "parametric", " ", "powers", " ", "making", " ", "assumptions", " ",
           "that", " ", "they", " ", "are", " ", "non"}], "-", 
         RowBox[{"negative", 
          RowBox[{"(", 
           RowBox[{"unsafe", " ", "mode"}], ")"}]}]}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"gcd", "=", 
       RowBox[{"PolynomialGCD", "[", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"List", "@@", "genForm"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"print", "[", 
       RowBox[{"\"\<gcd = \>\"", ",", "gcd"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"parametricPowers", "=", 
       RowBox[{"Union", "@", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"gcd", ",", 
            RowBox[{
             RowBox[{"Power", "[", 
              RowBox[{"b_", ",", "p_"}], "]"}], "\[RuleDelayed]", 
             RowBox[{"{", 
              RowBox[{"b", ",", "p"}], "}"}]}]}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"!", 
             RowBox[{"FreeQQ", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "indVars"}], "]"}]}], "&&", 
            RowBox[{"!", 
             RowBox[{"FreeQQ", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "pars"}], "]"}]}]}], 
           "&"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gcd", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "^", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "&"}], ",", 
         "parametricPowers"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"print", "[", 
       RowBox[{"\"\<gcd = \>\"", ",", "gcd"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"parametricPowers", "=!=", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Power(s) \>\"", ",", "gcd", ",", 
          "\"\< are assumed non-negative in further computations.\>\""}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"assumedFacts", "=", 
       RowBox[{"And", "@@", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"First", "@", "#"}], "\[GreaterEqual]", "0"}], "&"}], ",",
           "parametricPowers"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"print", "[", 
       RowBox[{"\"\<assumedFacts = \>\"", ",", "assumedFacts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"genForm", "=", 
       RowBox[{"Expand", "[", 
        RowBox[{"genForm", "/", 
         RowBox[{"Times", "@@", "gcd"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"SimplifyPositivity", ":", 
        RowBox[{
        "need", " ", "to", " ", "be", " ", "polynomial", " ", "to", " ", 
         "proceed"}]}], "*)"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"PolynomialQ", "[", 
         RowBox[{"genForm", ",", "vars"}], "]"}], ",", 
        RowBox[{
         RowBox[{"extraFacts", "=", "assumedFacts"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"extraFunctions", "=", 
          RowBox[{"{", "}"}]}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "genForm", ",", "extraFunctions", ",", "extraFacts", ",", 
            "oldFunctions"}], "}"}], "=", 
          RowBox[{"AssociatedPolynomial", "[", 
           RowBox[{
           "genForm", ",", "depVars", ",", "indVars", ",", "pars", ",", 
            RowBox[{"Facts", "\[Rule]", 
             RowBox[{"facts", "&&", "assumedFacts"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"print", "[", 
          RowBox[{
          "\"\<{genForm, extraFunctions, extraFacts, oldFunctions} = \>\"", 
           ",", 
           RowBox[{"{", 
            RowBox[{
            "genForm", ",", "extraFunctions", ",", "extraFacts", ",", 
             "oldFunctions"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"extraFacts", "=", 
          RowBox[{"extraFacts", "&&", "assumedFacts"}]}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"branching", "=", 
       RowBox[{"SimplifyPositivity", "[", 
        RowBox[{"genForm", ",", 
         RowBox[{"Union", "[", 
          RowBox[{"depVars", ",", 
           RowBox[{"Head", "/@", "extraFunctions"}]}], "]"}], ",", "indVars", 
         ",", "pars", ",", 
         RowBox[{"Facts", "\[Rule]", 
          RowBox[{"facts", "&&", "extraFacts"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"print", "[", 
       RowBox[{"\"\<branching = \>\"", ",", "branching"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "PositivityQE", "*)"}], 
      RowBox[{"print", "[", 
       RowBox[{"\"\<facts = \>\"", ",", "facts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"print", "[", 
       RowBox[{"\"\<extraFacts = \>\"", ",", "extraFacts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"branching", "=", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Simplify", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"First", "@", "#"}], ")"}], "&&", 
               RowBox[{"PositivityQE", "[", 
                RowBox[{
                 RowBox[{"Last", "@", "#"}], ",", 
                 RowBox[{"Union", "[", 
                  RowBox[{"depVars", ",", 
                   RowBox[{"Head", "/@", "extraFunctions"}]}], "]"}], ",", 
                 "indVars", ",", 
                 RowBox[{"Facts", "\[Rule]", 
                  RowBox[{"facts", "&&", "extraFacts", "&&", 
                   RowBox[{"(", 
                    RowBox[{"First", "@", "#"}], ")"}]}]}], ",", 
                 RowBox[{"TimeConstraint", "\[Rule]", "timeConstraint"}]}], 
                "]"}]}], "]"}], ",", 
             RowBox[{"Last", "@", "#"}]}], "}"}], "&"}], ",", "branching"}], 
         "]"}], "//", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{"False", ",", "_"}], "}"}]}], "]"}], "&"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"branching", "=", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"First", "@", "#"}], ",", 
             RowBox[{"Refine", "[", 
              RowBox[{
               RowBox[{"Last", "@", "#"}], ",", 
               RowBox[{"First", "@", "#"}]}], "]"}]}], "}"}], "&"}], ",", 
          "branching"}], "]"}], "/.", 
        RowBox[{"Thread", "[", 
         RowBox[{"extraFunctions", "\[Rule]", "oldFunctions"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Union", "@", 
          RowBox[{"Cases", "[", 
           RowBox[{"branching", ",", 
            RowBox[{"Subscript", "[", 
             RowBox[{"\[FormalCapitalC]", ",", "_Integer"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}]}], "=!=", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<Some branches still contain formal coefficients. Printing \
reduced conditions ...\>\"", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "@", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"PositivityQE", "[", 
              RowBox[{
               RowBox[{"Last", "@", "#"}], ",", 
               RowBox[{"Union", "[", 
                RowBox[{"depVars", ",", 
                 RowBox[{"Head", "/@", "extraFunctions"}]}], "]"}], ",", 
               "indVars", ",", 
               RowBox[{"Facts", "\[Rule]", 
                RowBox[{"Simplify", "[", 
                 RowBox[{"facts", "&&", "extraFacts"}], "]"}]}], ",", 
               RowBox[{"TimeConstraint", "\[Rule]", "timeConstraint"}], ",", 
               RowBox[{"Type", "\[Rule]", "Exists"}]}], "]"}], "&"}], ",", 
            "branching"}], "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "branching"}]}], "]"}]}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{"End", "[", "]"}]}], "Input",
 CellChangeTimes->{{3.816838439076849*^9, 3.816838439082224*^9}, 
   3.8168386636470547`*^9},ExpressionUUID->"b7e9fd31-0a0f-4dd1-acc0-\
531da32d0e08"],

Cell[CellGroupData[{

Cell["Roadmap :", "Subsection",
 CellChangeTimes->{{3.81679172634481*^9, 
  3.8167917306774282`*^9}},ExpressionUUID->"22f4216b-2c8e-452e-9235-\
25eb3379f0e2"],

Cell["\<\



\
\>", "Text",
 CellChangeTimes->{{3.816791732401615*^9, 3.81679174671375*^9}, {
   3.8167917834292173`*^9, 3.816791818614661*^9}, {3.816791959471303*^9, 
   3.816791962117104*^9}, {3.816792008741686*^9, 3.816792012364992*^9}, {
   3.816792504687907*^9, 3.8167925303931513`*^9}, 3.816818762723221*^9, {
   3.816840314540058*^9, 3.816840344038989*^9}, {3.816840445128199*^9, 
   3.816840479869413*^9}, {3.816841831269665*^9, 3.816841858022388*^9}, 
   3.816842665364127*^9, {3.816852078626783*^9, 3.816852091147024*^9}, {
   3.8168523088194523`*^9, 3.816852331698983*^9}, {3.816853751384533*^9, 
   3.816853802735689*^9}, 
   3.816939154855743*^9},ExpressionUUID->"5e97c15a-e89d-4317-9bae-\
eacd263c52e5"],

Cell["\<\


\
\>", "Text",
 CellChangeTimes->{{3.816840271317563*^9, 3.81684028912912*^9}, {
   3.816840349888275*^9, 3.816840375904315*^9}, {3.8168404113017387`*^9, 
   3.816840416438076*^9}, 3.8168406756104107`*^9, {3.816852325376697*^9, 
   3.816852360788835*^9}, 3.81685377134696*^9, 
   3.816968335701741*^9},ExpressionUUID->"dfdd313b-75eb-48bd-bb65-\
f162f171a568"],

Cell["\<\



  
  
  \
\>", "Text",
 CellChangeTimes->{{3.8168520932888403`*^9, 3.8168521550108757`*^9}, {
   3.816852298075141*^9, 3.8168523033547373`*^9}, {3.816853804403171*^9, 
   3.816853850604203*^9}, 
   3.8169683941671343`*^9},ExpressionUUID->"d71ff9c1-a147-4f24-a2c2-\
5fc6dce115c0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["PositivityConditionOperator", "Subsection",
 CellChangeTimes->{{3.8169391602253933`*^9, 
  3.816939174627194*^9}},ExpressionUUID->"8fd9d438-78a1-446a-ad48-\
28a7bed90b71"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
    "SimplifyPositivityQEOperator", "[", "variables_Association", "]"}], "[", 
    "problem_", "]"}], ":=", 
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{"problem", "===", "$Failed"}], ",", "$Failed", ",", 
     RowBox[{
      RowBox[{"Head", "[", "problem", "]"}], "===", "Piecewise"}], ",", 
     RowBox[{"PiecewiseOperatorMap", "[", 
      RowBox[{
      "SimplifyPositivityQEOperator", ",", "variables", ",", "problem"}], 
      "]"}], ",", 
     RowBox[{
      RowBox[{"Head", "[", "problem", "]"}], "=!=", "Association"}], ",", 
     RowBox[{
      RowBox[{"SimplifyPositivityQEOperator", "[", "variables", "]"}], "[", 
      RowBox[{"Association", "[", 
       RowBox[{"\"\<expression\>\"", "\[Rule]", "problem"}], "]"}], "]"}], 
     ",", 
     RowBox[{
      RowBox[{"Head", "[", 
       RowBox[{"problem", "[", "\"\<expression\>\"", "]"}], "]"}], "===", 
      "Piecewise"}], ",", 
     RowBox[{
      RowBox[{"SimplifyPositivityQEOperator", "[", "variables", "]"}], "[", 
      RowBox[{"PiecewiseExpandAssociation", "[", "problem", "]"}], "]"}], ",",
      "True", ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "exp", ",", "depVars", ",", "indVars", ",", "pars", ",", "dom", ",", 
         "facts", ",", "timeConstraint", ",", "type", ",", "expr", ",", 
         "vars", ",", "factVars", ",", "allVars", ",", "parametricFacts", ",",
          "nonparametricFacts", ",", "extraFunctions", ",", "extraFacts", ",",
          "oldFunctions", ",", "formalCoeffs", ",", "print", ",", "cleanup"}],
         "}"}], ",", 
       RowBox[{
        RowBox[{"exp", "=", 
         RowBox[{"Lookup", "[", 
          RowBox[{"problem", ",", "\"\<expression\>\"", ",", "0"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"depVars", "=", 
         RowBox[{"Lookup", "[", 
          RowBox[{"variables", ",", "\"\<depVars\>\"", ",", 
           RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"indVars", "=", 
         RowBox[{"Lookup", "[", 
          RowBox[{"variables", ",", "\"\<indVars\>\"", ",", 
           RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pars", "=", 
         RowBox[{"Lookup", "[", 
          RowBox[{"variables", ",", "\"\<pars\>\"", ",", 
           RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dom", "=", 
         RowBox[{"Lookup", "[", 
          RowBox[{"variables", ",", "\"\<domain\>\"", ",", "Reals"}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"facts", "=", 
         RowBox[{"Lookup", "[", 
          RowBox[{"variables", ",", "\"\<facts\>\"", ",", "True"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"timeConstraint", "=", 
         RowBox[{"Lookup", "[", 
          RowBox[{"problem", ",", "\"\<timeconstraint\>\"", ",", 
           RowBox[{"Lookup", "[", 
            RowBox[{"variables", ",", "\"\<timeconstraint\>\"", ",", "5"}], 
            "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"type", "=", 
         RowBox[{"Lookup", "[", 
          RowBox[{"problem", ",", "\"\<type\>\"", ",", "\"\<ForAll\>\""}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"expr", "=", 
         RowBox[{"Together", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", "exp", "}"}], "//", "Flatten"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"print", "=", "Null"}], ";", "\[IndentingNewLine]", 
        RowBox[{"cleanup", ":=", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"#", "===", "$Failed"}], ",", "$Failed", ",", 
            RowBox[{"PiecewiseSimplify", "[", 
             RowBox[{"Piecewise", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{"exp", ",", "#"}], "}"}], "}"}], ",", "$Failed"}], 
              "]"}], "]"}]}], "]"}], "&"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "I", " ", "have", " ", "added", " ", "the", " ", "independent", " ", 
          "variables", " ", "that", " ", "appear", " ", "in", " ", "the", " ",
           "expression"}], "*)"}], 
        RowBox[{"vars", "=", 
         RowBox[{"Union", "[", 
          RowBox[{
           RowBox[{"getVars", "[", 
            RowBox[{"expr", ",", "depVars"}], "]"}], ",", 
           RowBox[{"Intersection", "[", 
            RowBox[{
             RowBox[{"getSymbols", "[", 
              RowBox[{"{", 
               RowBox[{"exp", ",", "facts"}], "}"}], "]"}], ",", "indVars"}], 
            "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"factVars", "=", 
         RowBox[{"getVars", "[", 
          RowBox[{"facts", ",", "depVars"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"allVars", "=", 
         RowBox[{"Union", "[", 
          RowBox[{"vars", ",", "factVars"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "If", " ", "the", " ", "given", " ", "expression", " ", "does", " ",
            "not", " ", "contain", " ", "any", " ", "variables"}], ",", 
          RowBox[{
           RowBox[{
           "then", " ", "it", " ", "is", " ", "a", " ", "coefficient", " ", 
            "and", " ", "hence", " ", "the", " ", "output", " ", "should", 
            " ", "be", " ", "expr"}], "\[GreaterEqual]", "0"}]}], "*)"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"vars", "===", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"cleanup", "[", 
            RowBox[{"And", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "\[GreaterEqual]", "0"}], "&"}], "/@", "expr"}], 
              ")"}]}], "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"print", "[", 
         RowBox[{"\"\<vars = \>\"", ",", "vars"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"parametricFacts", ",", "nonparametricFacts"}], "}"}], "=", 
         
         RowBox[{
          RowBox[{
           RowBox[{"GroupBy", "[", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"FreeQQ", "[", 
                RowBox[{"facts", ",", "And"}], "]"}], ",", 
               RowBox[{"List", "@", "facts"}], ",", 
               RowBox[{"List", "@@", "facts"}]}], "]"}], ",", 
             RowBox[{
              RowBox[{"And", "@@", 
               RowBox[{"FreeQQ", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"Union", "[", 
                  RowBox[{"depVars", ",", "indVars"}], "]"}]}], "]"}]}], 
              "&"}]}], "]"}], "/@", 
           RowBox[{"{", 
            RowBox[{"True", ",", "False"}], "}"}]}], "/.", 
          RowBox[{
           RowBox[{"Missing", "[", "___", "]"}], "\[Rule]", 
           RowBox[{"{", "}"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"print", "[", 
         RowBox[{
         "\"\<parametricFacts = \>\"", ",", "parametricFacts", ",", 
          "\"\<, nonparametricFacts = \>\"", ",", "nonparametricFacts"}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"cleanup", "@", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"type", "===", "Exists"}], ",", 
           RowBox[{
            RowBox[{"formalCoeffs", "=", 
             RowBox[{"Union", "@", 
              RowBox[{"Cases", "[", 
               RowBox[{"expr", ",", 
                RowBox[{"Subscript", "[", 
                 RowBox[{"\[FormalA]", ",", "_Integer"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"print", "[", 
             RowBox[{
             "formalCoeffs", ",", "\"\< - \>\"", ",", "type", ",", 
              "\"\< - \>\"", ",", 
              RowBox[{"PolynomialQ", "[", 
               RowBox[{"expr", ",", "vars"}], "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"formalCoeffs", "===", 
               RowBox[{"{", "}"}]}], ",", 
              RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"And", "@@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"PolynomialQ", "[", 
                   RowBox[{"#", ",", "vars"}], "]"}], "&"}], "/@", "expr"}], 
                ")"}]}], ",", 
              RowBox[{
               RowBox[{
               "print", "[", 
                "\"\<Given expression seems to be a polynomial.\>\"", "]"}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"TimeConstrained", "[", 
                RowBox[{
                 RowBox[{"FullSimplify", "@", 
                  RowBox[{"Reduce", "[", 
                   RowBox[{
                    RowBox[{"Exists", "[", 
                    RowBox[{
                    RowBox[{"Evaluate", "@", "formalCoeffs"}], ",", 
                    RowBox[{"ForAll", "[", 
                    RowBox[{
                    RowBox[{"Evaluate", "@", "allVars"}], ",", 
                    RowBox[{"And", "@@", "nonparametricFacts"}], ",", 
                    RowBox[{
                    RowBox[{"And", "@@", "parametricFacts"}], "&&", 
                    RowBox[{"(", 
                    RowBox[{"And", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "\[GreaterEqual]", "0"}], "&"}], "/@", 
                    "expr"}], ")"}]}], ")"}]}]}], "]"}]}], "]"}], ",", 
                    "dom"}], "]"}]}], ",", "timeConstraint", ",", "$Failed"}],
                 "]"}]}], ",", 
              RowBox[{"(*", 
               RowBox[{
               "If", " ", "expr", " ", "is", " ", "not", " ", "a", " ", 
                "polynomial"}], "*)"}], 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "expr", ",", "extraFunctions", ",", "extraFacts", ",", 
                  "oldFunctions"}], "}"}], "=", 
                RowBox[{"AssociatedPolynomial", "[", 
                 RowBox[{
                 "expr", ",", "depVars", ",", "indVars", ",", "pars", ",", 
                  RowBox[{"Facts", "\[Rule]", "facts"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"print", "[", 
                RowBox[{"\"\<expr = \>\"", ",", "expr"}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"print", "[", 
                RowBox[{
                "\"\<extraFunctions, extraFacts = \>\"", ",", 
                 "extraFunctions", ",", "\"\< | \>\"", ",", "extraFacts"}], 
                "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"TimeConstrained", "[", 
                RowBox[{
                 RowBox[{"FullSimplify", "@", 
                  RowBox[{"Reduce", "[", 
                   RowBox[{
                    RowBox[{"Exists", "[", 
                    RowBox[{"formalCoeffs", ",", 
                    RowBox[{"ForAll", "[", 
                    RowBox[{
                    RowBox[{"Evaluate", "@", 
                    RowBox[{"Union", "[", 
                    RowBox[{"allVars", ",", "extraFunctions"}], "]"}]}], ",", 
                    
                    RowBox[{
                    RowBox[{"And", "@@", "nonparametricFacts"}], "&&", 
                    "extraFacts"}], ",", 
                    RowBox[{
                    RowBox[{"And", "@@", "parametricFacts"}], "&&", 
                    RowBox[{"expr", "\[GreaterEqual]", "0"}]}]}], "]"}]}], 
                    "]"}], ",", "dom"}], "]"}]}], ",", "timeConstraint", ",", 
                 "$Failed"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"If", " ", "type"}], "===", "ForAll"}], "*)"}], 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"And", "@@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"PolynomialQ", "[", 
                  RowBox[{"#", ",", "vars"}], "]"}], "&"}], "/@", "expr"}], 
               ")"}]}], ",", 
             RowBox[{
              RowBox[{
              "print", "[", 
               "\"\<Given expression seems to be a polynomial.\>\"", "]"}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "1.", " ", "parametric", " ", "facts", " ", "should", " ", 
                  "be", " ", "placed", " ", "with", " ", "conditions", " ", 
                  "where", " ", "the", " ", "expr"}], "\[GreaterEqual]", 
                 "0"}], ",", 
                RowBox[{
                "while", " ", "nonparametric", " ", "ones", " ", "should", 
                 " ", "be", " ", "as", " ", "conditions", " ", "on", " ", 
                 "vars"}]}], "*)"}], 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"2.", " ", "FullSumplify", " ", "is", " ", "needed"}],
                 ",", 
                RowBox[{
                "since", " ", "sometimes", " ", "Resolve", " ", "gives", " ", 
                 "complicated", " ", "constraints", " ", "which", " ", "can", 
                 " ", "actually", " ", "be", " ", "simplified"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"e", ".", "g", ".", "x"}], 
                  RowBox[{"(", 
                   RowBox[{"a", "+", "bx", "+", 
                    RowBox[{"cx", "^", "2"}]}], ")"}]}], "\[GreaterEqual]", 
                 "0"}]}], "*)"}], 
              RowBox[{"TimeConstrained", "[", 
               RowBox[{
                RowBox[{"FullSimplify", "@", 
                 RowBox[{"Resolve", "[", 
                  RowBox[{
                   RowBox[{"ForAll", "[", 
                    RowBox[{
                    RowBox[{"Evaluate", "@", "allVars"}], ",", 
                    RowBox[{"And", "@@", "nonparametricFacts"}], ",", 
                    RowBox[{
                    RowBox[{"And", "@@", "parametricFacts"}], "&&", 
                    RowBox[{"(", 
                    RowBox[{"And", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "\[GreaterEqual]", "0"}], "&"}], "/@", 
                    "expr"}], ")"}]}], ")"}]}]}], "]"}], ",", "dom"}], 
                  "]"}]}], ",", "timeConstraint", ",", "$Failed"}], "]"}]}], 
             ",", 
             RowBox[{"(*", 
              RowBox[{
              "If", " ", "expr", " ", "is", " ", "not", " ", "a", " ", 
               "polynomial"}], "*)"}], 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "expr", ",", "extraFunctions", ",", "extraFacts", ",", 
                 "oldFunctions"}], "}"}], "=", 
               RowBox[{"AssociatedPolynomial", "[", 
                RowBox[{
                "expr", ",", "depVars", ",", "indVars", ",", "pars", ",", 
                 RowBox[{"Facts", "\[Rule]", "facts"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"print", "[", 
               RowBox[{"\"\<expr = \>\"", ",", "expr"}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"print", "[", 
               RowBox[{
               "\"\<extraFunctions, extraFacts = \>\"", ",", "extraFunctions",
                 ",", "\"\< | \>\"", ",", "extraFacts"}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"TimeConstrained", "[", 
               RowBox[{
                RowBox[{"FullSimplify", "@", 
                 RowBox[{"Resolve", "[", 
                  RowBox[{
                   RowBox[{"ForAll", "[", 
                    RowBox[{
                    RowBox[{"Evaluate", "@", 
                    RowBox[{"Union", "[", 
                    RowBox[{"allVars", ",", "extraFunctions"}], "]"}]}], ",", 
                    
                    RowBox[{
                    RowBox[{"And", "@@", "nonparametricFacts"}], "&&", 
                    "extraFacts"}], ",", 
                    RowBox[{
                    RowBox[{"And", "@@", "parametricFacts"}], "&&", 
                    RowBox[{"(", 
                    RowBox[{"And", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "\[GreaterEqual]", "0"}], "&"}], "/@", 
                    "expr"}], ")"}]}], ")"}]}]}], "]"}], ",", "dom"}], 
                  "]"}]}], ",", "timeConstraint", ",", "$Failed"}], "]"}]}]}],
             "]"}]}], "]"}]}]}]}], "]"}]}], "]"}]}], "\n", 
  "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{{3.816939175619583*^9, 3.8169391756223593`*^9}, 
   3.816939299183963*^9},ExpressionUUID->"5033b233-33bd-459b-b432-\
5c051f67f1d2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
    "PositivityConditionQEOperator", "[", "variables_Association", "]"}], "[",
     "problem_", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Which", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"problem", "===", "$Failed"}], ",", "$Failed", ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Head", "[", "problem", "]"}], "===", "Piecewise"}], ",", 
     RowBox[{"PiecewiseOperatorMap", "[", 
      RowBox[{"PositivityConditionQEOperatorvariables", ",", "problem"}], 
      "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Head", "[", "problem", "]"}], "=!=", "Association"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PositivityConditionQEOperator", "[", "variables", "]"}], "[", 
      "\[IndentingNewLine]", 
      RowBox[{"Association", "[", 
       RowBox[{"\"\<expression\>\"", "\[Rule]", "problem"}], "]"}], "]"}], 
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Head", "[", 
       RowBox[{"problem", "[", "\"\<expression\>\"", "]"}], "]"}], "===", 
      "Piecewise"}], ",", 
     RowBox[{
      RowBox[{"SimplifyPositivityQEOperator", "[", "variables", "]"}], "[", 
      RowBox[{"PiecewiseExpandAssociation", "[", "problem", "]"}], "]"}], ",",
      "\[IndentingNewLine]", "\[IndentingNewLine]", "True", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "exp", ",", "depVars", ",", "indVars", ",", "pars", ",", "dom", ",", 
         "facts", ",", "timeConstraint", ",", "type", ",", "expr", ",", 
         "vars", ",", "factVars", ",", "allVars", ",", "parametricFacts", ",",
          "nonparametricFacts", ",", "extraFunctions", ",", "extraFacts", ",",
          "oldFunctions", ",", "formalCoeffs", ",", "print", ",", "cleanup"}],
         "}"}], ",", 
       RowBox[{
        RowBox[{"exp", "=", 
         RowBox[{"Lookup", "[", 
          RowBox[{"problem", ",", "\"\<expression\>\"", ",", "0"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"depVars", "=", 
         RowBox[{"Lookup", "[", 
          RowBox[{"variables", ",", "\"\<depVars\>\"", ",", 
           RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"indVars", "=", 
         RowBox[{"Lookup", "[", 
          RowBox[{"variables", ",", "\"\<indVars\>\"", ",", 
           RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pars", "=", 
         RowBox[{"Lookup", "[", 
          RowBox[{"variables", ",", "\"\<pars\>\"", ",", 
           RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dom", "=", 
         RowBox[{"Lookup", "[", 
          RowBox[{"variables", ",", "\"\<domain\>\"", ",", "Reals"}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"facts", "=", 
         RowBox[{"Lookup", "[", 
          RowBox[{"variables", ",", "\"\<facts\>\"", ",", "True"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"timeConstraint", "=", 
         RowBox[{"Lookup", "[", 
          RowBox[{"problem", ",", "\"\<timeconstraint\>\"", ",", 
           RowBox[{"Lookup", "[", 
            RowBox[{"variables", ",", "\"\<timeconstraint\>\"", ",", "5"}], 
            "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"type", "=", 
         RowBox[{"Lookup", "[", 
          RowBox[{"problem", ",", "\"\<eliminator\>\"", ",", "True"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"expr", "=", 
         RowBox[{"Together", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", "exp", "}"}], "//", "Flatten"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"print", "=", "Null"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "I", " ", "have", " ", "added", " ", "the", " ", "independent", " ", 
          "variables", " ", "that", " ", "appear", " ", "in", " ", "the", " ",
           "expression"}], "*)"}], 
        RowBox[{"vars", "=", 
         RowBox[{"Union", "[", 
          RowBox[{
           RowBox[{"getVars", "[", 
            RowBox[{"expr", ",", "depVars"}], "]"}], ",", 
           RowBox[{"Intersection", "[", 
            RowBox[{
             RowBox[{"getSymbols", "[", 
              RowBox[{"{", 
               RowBox[{"exp", ",", "facts"}], "}"}], "]"}], ",", "indVars"}], 
            "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"factVars", "=", 
         RowBox[{"getVars", "[", 
          RowBox[{"facts", ",", "depVars"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"allVars", "=", 
         RowBox[{"Union", "[", 
          RowBox[{"vars", ",", "factVars"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "If", " ", "the", " ", "given", " ", "expression", " ", "does", " ",
            "not", " ", "contain", " ", "any", " ", "variables"}], ",", 
          RowBox[{
           RowBox[{
           "then", " ", "it", " ", "is", " ", "a", " ", "coefficient", " ", 
            "and", " ", "hence", " ", "the", " ", "output", " ", "should", 
            " ", "be", " ", "expr"}], "\[GreaterEqual]", "0"}]}], "*)"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"vars", "===", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"cleanup", "[", 
            RowBox[{"And", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "\[GreaterEqual]", "0"}], "&"}], "/@", "expr"}], 
              ")"}]}], "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"print", "[", 
         RowBox[{"\"\<vars = \>\"", ",", "vars"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"parametricFacts", ",", "nonparametricFacts"}], "}"}], "=", 
         
         RowBox[{
          RowBox[{
           RowBox[{"GroupBy", "[", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"FreeQQ", "[", 
                RowBox[{"facts", ",", "And"}], "]"}], ",", 
               RowBox[{"List", "@", "facts"}], ",", 
               RowBox[{"List", "@@", "facts"}]}], "]"}], ",", 
             RowBox[{
              RowBox[{"And", "@@", 
               RowBox[{"FreeQQ", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"Union", "[", 
                  RowBox[{"depVars", ",", "indVars"}], "]"}]}], "]"}]}], 
              "&"}]}], "]"}], "/@", 
           RowBox[{"{", 
            RowBox[{"True", ",", "False"}], "}"}]}], "/.", 
          RowBox[{
           RowBox[{"Missing", "[", "___", "]"}], "\[Rule]", 
           RowBox[{"{", "}"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"print", "[", 
         RowBox[{
         "\"\<parametricFacts = \>\"", ",", "parametricFacts", ",", 
          "\"\<, nonparametricFacts = \>\"", ",", "nonparametricFacts"}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"type", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"formalCoeffs", "=", 
            RowBox[{"Union", "@", 
             RowBox[{"Cases", "[", 
              RowBox[{"expr", ",", 
               RowBox[{"Subscript", "[", 
                RowBox[{"\[FormalA]", ",", "_Integer"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"print", "[", 
            RowBox[{
            "formalCoeffs", ",", "\"\< - \>\"", ",", "type", ",", 
             "\"\< - \>\"", ",", 
             RowBox[{"PolynomialQ", "[", 
              RowBox[{"expr", ",", "vars"}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"formalCoeffs", "===", 
              RowBox[{"{", "}"}]}], ",", 
             RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"And", "@@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"PolynomialQ", "[", 
                  RowBox[{"#", ",", "vars"}], "]"}], "&"}], "/@", "expr"}], 
               ")"}]}], ",", 
             RowBox[{
              RowBox[{
              "print", "[", 
               "\"\<Given expression seems to be a polynomial.\>\"", "]"}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"TimeConstrained", "[", 
               RowBox[{
                RowBox[{"FullSimplify", "@", 
                 RowBox[{"Reduce", "[", 
                  RowBox[{
                   RowBox[{"Exists", "[", 
                    RowBox[{
                    RowBox[{"Evaluate", "@", "formalCoeffs"}], ",", 
                    RowBox[{"ForAll", "[", 
                    RowBox[{
                    RowBox[{"Evaluate", "@", "allVars"}], ",", 
                    RowBox[{"And", "@@", "nonparametricFacts"}], ",", 
                    RowBox[{
                    RowBox[{"And", "@@", "parametricFacts"}], "&&", 
                    RowBox[{"(", 
                    RowBox[{"And", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "\[GreaterEqual]", "0"}], "&"}], "/@", 
                    "expr"}], ")"}]}], ")"}]}]}], "]"}]}], "]"}], ",", 
                   "dom"}], "]"}]}], ",", "timeConstraint", ",", "$Failed"}], 
               "]"}]}], ",", 
             RowBox[{"(*", 
              RowBox[{
              "If", " ", "expr", " ", "is", " ", "not", " ", "a", " ", 
               "polynomial"}], "*)"}], 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "expr", ",", "extraFunctions", ",", "extraFacts", ",", 
                 "oldFunctions"}], "}"}], "=", 
               RowBox[{"AssociatedPolynomial", "[", 
                RowBox[{
                "expr", ",", "depVars", ",", "indVars", ",", "pars", ",", 
                 RowBox[{"Facts", "\[Rule]", "facts"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"print", "[", 
               RowBox[{"\"\<expr = \>\"", ",", "expr"}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"print", "[", 
               RowBox[{
               "\"\<extraFunctions, extraFacts = \>\"", ",", "extraFunctions",
                 ",", "\"\< | \>\"", ",", "extraFacts"}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"TimeConstrained", "[", 
               RowBox[{
                RowBox[{"FullSimplify", "@", 
                 RowBox[{"Reduce", "[", 
                  RowBox[{
                   RowBox[{"Exists", "[", 
                    RowBox[{"formalCoeffs", ",", 
                    RowBox[{"ForAll", "[", 
                    RowBox[{
                    RowBox[{"Evaluate", "@", 
                    RowBox[{"Union", "[", 
                    RowBox[{"allVars", ",", "extraFunctions"}], "]"}]}], ",", 
                    
                    RowBox[{
                    RowBox[{"And", "@@", "nonparametricFacts"}], "&&", 
                    "extraFacts"}], ",", 
                    RowBox[{
                    RowBox[{"And", "@@", "parametricFacts"}], "&&", 
                    RowBox[{"expr", "\[GreaterEqual]", "0"}]}]}], "]"}]}], 
                    "]"}], ",", "dom"}], "]"}]}], ",", "timeConstraint", ",", 
                "$Failed"}], "]"}]}]}], "]"}]}], ",", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"If", " ", "type"}], "===", "ForAll"}], "*)"}], 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"And", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"PolynomialQ", "[", 
                 RowBox[{"#", ",", "vars"}], "]"}], "&"}], "/@", "expr"}], 
              ")"}]}], ",", 
            RowBox[{
             RowBox[{
             "print", "[", 
              "\"\<Given expression seems to be a polynomial.\>\"", "]"}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
                RowBox[{
                "1.", " ", "parametric", " ", "facts", " ", "should", " ", 
                 "be", " ", "placed", " ", "with", " ", "conditions", " ", 
                 "where", " ", "the", " ", "expr"}], "\[GreaterEqual]", "0"}],
                ",", 
               RowBox[{
               "while", " ", "nonparametric", " ", "ones", " ", "should", " ",
                 "be", " ", "as", " ", "conditions", " ", "on", " ", 
                "vars"}]}], "*)"}], 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"2.", " ", "FullSumplify", " ", "is", " ", "needed"}], 
               ",", 
               RowBox[{
               "since", " ", "sometimes", " ", "Resolve", " ", "gives", " ", 
                "complicated", " ", "constraints", " ", "which", " ", "can", 
                " ", "actually", " ", "be", " ", "simplified"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"e", ".", "g", ".", "x"}], 
                 RowBox[{"(", 
                  RowBox[{"a", "+", "bx", "+", 
                   RowBox[{"cx", "^", "2"}]}], ")"}]}], "\[GreaterEqual]", 
                "0"}]}], "*)"}], 
             RowBox[{"TimeConstrained", "[", 
              RowBox[{
               RowBox[{"FullSimplify", "@", 
                RowBox[{"Resolve", "[", 
                 RowBox[{
                  RowBox[{"ForAll", "[", 
                   RowBox[{
                    RowBox[{"Evaluate", "@", "allVars"}], ",", 
                    RowBox[{"And", "@@", "nonparametricFacts"}], ",", 
                    RowBox[{
                    RowBox[{"And", "@@", "parametricFacts"}], "&&", 
                    RowBox[{"(", 
                    RowBox[{"And", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "\[GreaterEqual]", "0"}], "&"}], "/@", 
                    "expr"}], ")"}]}], ")"}]}]}], "]"}], ",", "dom"}], 
                 "]"}]}], ",", "timeConstraint", ",", "$Failed"}], "]"}]}], 
            ",", 
            RowBox[{"(*", 
             RowBox[{
             "If", " ", "expr", " ", "is", " ", "not", " ", "a", " ", 
              "polynomial"}], "*)"}], 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "expr", ",", "extraFunctions", ",", "extraFacts", ",", 
                "oldFunctions"}], "}"}], "=", 
              RowBox[{"AssociatedPolynomial", "[", 
               RowBox[{
               "expr", ",", "depVars", ",", "indVars", ",", "pars", ",", 
                RowBox[{"Facts", "\[Rule]", "facts"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"print", "[", 
              RowBox[{"\"\<expr = \>\"", ",", "expr"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"print", "[", 
              RowBox[{
              "\"\<extraFunctions, extraFacts = \>\"", ",", "extraFunctions", 
               ",", "\"\< | \>\"", ",", "extraFacts"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"TimeConstrained", "[", 
              RowBox[{
               RowBox[{"FullSimplify", "@", 
                RowBox[{"Resolve", "[", 
                 RowBox[{
                  RowBox[{"ForAll", "[", 
                   RowBox[{
                    RowBox[{"Evaluate", "@", 
                    RowBox[{"Union", "[", 
                    RowBox[{"allVars", ",", "extraFunctions"}], "]"}]}], ",", 
                    
                    RowBox[{
                    RowBox[{"And", "@@", "nonparametricFacts"}], "&&", 
                    "extraFacts"}], ",", 
                    RowBox[{
                    RowBox[{"And", "@@", "parametricFacts"}], "&&", 
                    RowBox[{"(", 
                    RowBox[{"And", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "\[GreaterEqual]", "0"}], "&"}], "/@", 
                    "expr"}], ")"}]}], ")"}]}]}], "]"}], ",", "dom"}], 
                 "]"}]}], ",", "timeConstraint", ",", "$Failed"}], "]"}]}]}], 
           "]"}]}], "]"}]}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
  "\n"}]], "Input",
 CellChangeTimes->{{3.816939307566087*^9, 3.816939438343285*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"13286ad5-a59f-4ff6-863a-f89f8fbbf007"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 719},
WindowMargins->{{Automatic, 96}, {40, Automatic}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 160, 2, 30, "Input",ExpressionUUID->"1f380f21-4c8a-4af3-9a81-0e8117b041e6"],
Cell[CellGroupData[{
Cell[743, 26, 2255, 57, 326, "Input",ExpressionUUID->"7e904563-ce50-4fe5-8095-cc0620f8c731"],
Cell[3001, 85, 1381, 39, 37, "Output",ExpressionUUID->"b6ce34ab-c14b-49a7-9668-22a5c81a5fdc"],
Cell[4385, 126, 2465, 64, 57, "Output",ExpressionUUID->"d0609281-ab89-4369-8667-b16f757256fb"],
Cell[6853, 192, 2009, 54, 60, "Output",ExpressionUUID->"96c29c68-ed93-4ea4-953a-92e9d165e11b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8899, 251, 231, 4, 69, "Chapter",ExpressionUUID->"dbd88126-6943-424a-897d-b56dd7f44c3c"],
Cell[9133, 257, 160, 2, 30, "Input",ExpressionUUID->"b84a526d-2b11-4840-986e-95e95956924d"],
Cell[9296, 261, 45995, 939, 5968, "Input",ExpressionUUID->"3f377784-ed48-46ad-8508-69e69fcea050"],
Cell[CellGroupData[{
Cell[55316, 1204, 1713, 48, 94, "Input",ExpressionUUID->"34d20759-2c36-4895-8df4-beeedd15ca77"],
Cell[57032, 1254, 2170, 58, 55, "Output",ExpressionUUID->"ed87323a-810b-45e1-a914-c421db85b0e7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59239, 1317, 1855, 52, 115, "Input",ExpressionUUID->"7e4e3fe1-1485-421e-9201-04ba46515025"],
Cell[61097, 1371, 2504, 67, 55, "Output",ExpressionUUID->"aae0325a-fa83-4270-b3e0-26a7289b6217"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63638, 1443, 759, 20, 73, "Input",ExpressionUUID->"de304bb5-8b95-4e7b-84c4-0359916a0ed4"],
Cell[64400, 1465, 1939, 53, 79, "Output",ExpressionUUID->"284d5e68-f8b2-4fe2-a201-9eca1c4446c0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66376, 1523, 1119, 30, 73, "Input",ExpressionUUID->"5f80f8ca-3a99-4382-9f59-6a6a743371d4"],
Cell[67498, 1555, 2371, 65, 79, "Output",ExpressionUUID->"6d04a6f9-b4d6-4315-a9a3-2a97937f8262"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69906, 1625, 2325, 64, 136, "Input",ExpressionUUID->"39d9cd2d-08aa-4968-8d35-75ca3331e433"],
Cell[72234, 1691, 3083, 80, 121, "Output",ExpressionUUID->"5e2b00db-030e-4eab-adfd-6c48e45d8025"]
}, Open  ]],
Cell[CellGroupData[{
Cell[75354, 1776, 215, 4, 30, "Input",ExpressionUUID->"a4ed6859-e7da-4bbf-ada9-eae1d63cab67"],
Cell[75572, 1782, 3816, 98, 187, "Output",ExpressionUUID->"a724e9dc-fa49-42d8-bf83-6bbcfe9226e4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[79425, 1885, 2301, 56, 94, "Input",ExpressionUUID->"a1e102f5-39c8-4e14-a547-2fda031fcafe"],
Cell[81729, 1943, 1222, 29, 37, "Output",ExpressionUUID->"d18129aa-b660-41e9-ae75-bb5b90b31a17"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82988, 1977, 1393, 39, 94, "Input",ExpressionUUID->"96a32801-5a0c-467a-8b51-b7f38c3d0bde"],
Cell[84384, 2018, 2569, 69, 79, "Output",ExpressionUUID->"3fe73ba2-06d5-4af4-9a48-0b9d384b008f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86990, 2092, 1207, 30, 189, "Input",ExpressionUUID->"7db1e45b-3f92-4c53-8965-1308c3a80156"],
Cell[88200, 2124, 1073, 34, 37, "Output",ExpressionUUID->"bbfff392-4643-4c08-be81-ca107bacb858"],
Cell[89276, 2160, 794, 20, 37, "Output",ExpressionUUID->"981c600d-d8b5-4a2e-9bde-3f2da48b62ff"]
}, Open  ]],
Cell[CellGroupData[{
Cell[90107, 2185, 953, 23, 157, "Input",ExpressionUUID->"5e48a088-0a82-4744-97fc-0c7190bea598"],
Cell[91063, 2210, 1000, 32, 37, "Output",ExpressionUUID->"c0acb78d-5e0a-45cb-a8d3-33dc2d7d0afe"],
Cell[92066, 2244, 717, 18, 37, "Output",ExpressionUUID->"fc6fb849-a7d2-49f1-912a-f787372532b7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[92820, 2267, 1248, 31, 178, "Input",ExpressionUUID->"7b248092-da1a-40ad-b209-f639fd5c4cc4"],
Cell[94071, 2300, 657, 20, 37, "Output",ExpressionUUID->"6dc4752c-f732-4bfb-a7ee-5d28dbaff3cd"],
Cell[94731, 2322, 2634, 71, 103, "Output",ExpressionUUID->"53b11e28-67ef-48e4-af68-b8f38038e499"]
}, Open  ]],
Cell[CellGroupData[{
Cell[97402, 2398, 1250, 32, 157, "Input",ExpressionUUID->"bb2ff9e5-8186-4f4d-bc47-10aeb3990d0e"],
Cell[98655, 2432, 633, 16, 37, "Output",ExpressionUUID->"3ae35c52-b25a-4e01-9b87-1f1fd4a3c0c2"],
Cell[99291, 2450, 636, 14, 37, "Output",ExpressionUUID->"f55edfcf-4716-436b-989c-f1552f92f482"]
}, Open  ]],
Cell[CellGroupData[{
Cell[99964, 2469, 1058, 28, 136, "Input",ExpressionUUID->"149b881d-933b-4d9a-809f-a9090d4b749d"],
Cell[101025, 2499, 754, 23, 37, "Output",ExpressionUUID->"d5b83c2d-930f-401a-a761-150397d54755"],
Cell[101782, 2524, 181, 3, 34, "Output",ExpressionUUID->"23a50ae1-335f-44b4-9a25-a1b52519d842"]
}, Open  ]],
Cell[CellGroupData[{
Cell[102000, 2532, 156, 3, 67, "Section",ExpressionUUID->"f3a47fe3-e349-4508-a843-461136b1bf99"],
Cell[102159, 2537, 36460, 848, 3767, "Input",ExpressionUUID->"030d05a6-3a55-404e-b558-db868017fc99"],
Cell[CellGroupData[{
Cell[138644, 3389, 1529, 41, 157, "Input",ExpressionUUID->"e41d48d9-bbaf-48e8-9b90-f0bdf8883ec7"],
Cell[140176, 3432, 2362, 65, 61, "Output",ExpressionUUID->"405ac2c2-c0ca-4c9d-a100-785337d20f29"]
}, Open  ]],
Cell[CellGroupData[{
Cell[142575, 3502, 1433, 40, 136, "Input",ExpressionUUID->"99d58f88-84c6-4036-8ae5-7a109befe33a"],
Cell[144011, 3544, 2008, 58, 57, "Output",ExpressionUUID->"d901b30b-fdf1-4f9c-a1e5-048b51abdff5"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[146068, 3608, 231, 4, 67, "Section",ExpressionUUID->"ff957a94-9059-4957-ab48-c883339554b6"],
Cell[CellGroupData[{
Cell[146324, 3616, 3923, 86, 745, "Input",ExpressionUUID->"be792fa7-f155-48db-a0cb-e6ff39373075"],
Cell[150250, 3704, 407, 9, 24, "Message",ExpressionUUID->"e3d3b929-656d-4f60-b330-726880bad779"],
Cell[150660, 3715, 407, 9, 24, "Message",ExpressionUUID->"e3e66ec7-f886-4bfb-bf19-6cf2f9433642"]
}, Open  ]],
Cell[151082, 3727, 10775, 271, 1216, "Input",ExpressionUUID->"b7e9fd31-0a0f-4dd1-acc0-531da32d0e08"],
Cell[CellGroupData[{
Cell[161882, 4002, 158, 3, 54, "Subsection",ExpressionUUID->"22f4216b-2c8e-452e-9235-25eb3379f0e2"],
Cell[162043, 4007, 717, 16, 104, "Text",ExpressionUUID->"5e97c15a-e89d-4317-9bae-eacd263c52e5"],
Cell[162763, 4025, 371, 10, 81, "Text",ExpressionUUID->"dfdd313b-75eb-48bd-bb65-f162f171a568"],
Cell[163137, 4037, 292, 12, 150, "Text",ExpressionUUID->"d71ff9c1-a147-4f24-a2c2-5fc6dce115c0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[163466, 4054, 177, 3, 54, "Subsection",ExpressionUUID->"8fd9d438-78a1-446a-ad48-28a7bed90b71"],
Cell[163646, 4059, 17310, 398, 1617, "Input",ExpressionUUID->"5033b233-33bd-459b-b432-5c051f67f1d2"],
Cell[180959, 4459, 16925, 387, 1806, "Input",ExpressionUUID->"13286ad5-a59f-4ff6-863a-f89f8fbbf007"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)


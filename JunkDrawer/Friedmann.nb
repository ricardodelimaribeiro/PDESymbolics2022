(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     32039,        723]
NotebookOptionsPosition[     30641,        693]
NotebookOutlinePosition[     31034,        709]
CellTagsIndexPosition[     30991,        706]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"Get", "[", "\"\<PDESymbolics2020`PDESymbolics2020`\>\"", "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.835260957406108*^9, 3.835261100502852*^9}, {
  3.838460614233268*^9, 3.838460794557499*^9}, {3.83846084335816*^9, 
  3.8384608456730957`*^9}, {3.838460961425395*^9, 3.8384610008010273`*^9}, {
  3.838870122477291*^9, 3.838870139687518*^9}, {3.8388719987655573`*^9, 
  3.838872024751602*^9}, {3.83887241460251*^9, 3.8388724191835413`*^9}, {
  3.838873147022629*^9, 3.838873156305827*^9}, {3.8388731918395166`*^9, 
  3.8388732049935026`*^9}, {3.838890083918432*^9, 3.8388900995658617`*^9}, {
  3.840432876437385*^9, 3.840432878483585*^9}, {3.840432963343804*^9, 
  3.840432985476907*^9}, {3.840433051380302*^9, 3.840433051690324*^9}, {
  3.8422253766462517`*^9, 3.842225396053567*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"78ee9b1f-0c6c-423a-b456-79875b17f195"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"u", ",", "v"}], "}"}]}], ",", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "n", "}"}]}], ",", 
     RowBox[{"\"\<scheme\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"u", "[", 
          RowBox[{"n", "+", "1"}], "]"}], "-", 
         RowBox[{"u", "[", "n", "]"}]}], ",", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"n", "+", "1"}], "]"}], "-", 
         RowBox[{"v", "[", "n", "]"}]}]}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expression", "=", 
   RowBox[{
    RowBox[{"u", "[", 
     RowBox[{"n", "+", "2"}], "]"}], "-", 
    RowBox[{"u", "[", 
     RowBox[{"n", "+", "1"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"masterstencil", "=", 
  RowBox[{
   RowBox[{"StencilOperator", "[", "variables", "]"}], "[", "expression", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"stencil", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"StencilOperator", "[", "variables", "]"}], "[", "#", "]"}], 
    "&"}], "/@", 
   RowBox[{
   "variables", "[", "\"\<scheme\>\"", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Translations", "[", 
    RowBox[{"masterstencil", ",", "#"}], "]"}], "&"}], "/@", 
  "stencil"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.842225422725007*^9, 3.842225427016818*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"b2a34395-43c2-4800-88cb-b11342a9e408"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{"u", "\[Rule]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", "2", "}"}]}], "}"}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.8422254245484753`*^9, 3.8422254282696533`*^9}},
 CellLabel->"Out[6]=",ExpressionUUID->"3902003d-a03e-40fb-8e04-5273e7163032"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[LeftAssociation]", 
    RowBox[{"u", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "1", "}"}]}], "}"}]}], "\[RightAssociation]"}], ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{"v", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "1", "}"}]}], "}"}]}], "\[RightAssociation]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8422254245484753`*^9, 3.8422254282725487`*^9}},
 CellLabel->"Out[7]=",ExpressionUUID->"d74a79c0-2569-48da-8485-bfd5e899aaba"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", "1", "}"}], "}"}], ",", 
   RowBox[{"Missing", "[", "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8422254245484753`*^9, 3.842225428297492*^9}},
 CellLabel->"Out[8]=",ExpressionUUID->"e5b82dc1-374a-4467-b219-0da516dd3029"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"NewStencilOperator", "[", "variables_Association", "]"}], "[", 
     "xp_", "]"}], " ", ":=", "\n", "  ", 
    RowBox[{"Which", "[", "\n", "   ", 
     RowBox[{
      RowBox[{"xp", " ", "===", " ", "$Failed"}], ",", "\n", "   ", "$Failed",
       ",", "\n", "   ", 
      RowBox[{
       RowBox[{"Head", "[", "xp", "]"}], " ", "===", " ", "Piecewise"}], ",", 
      "\n", "   ", 
      RowBox[{"PiecewiseOperatorMap", "[", 
       RowBox[{"StencilOperator", ",", " ", "variables", ",", " ", "xp"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Head", "[", "xp", "]"}], "===", "List"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"StencilOperator", "[", "variables", "]"}], "[", "#", 
           "]"}], "&"}], "/@", "xp"}], "//", "PiecewiseExpand"}], "//", 
       "PiecewiseListClean"}], ",", "\n", "   ", "True", ",", "\n", "   ", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", "\n", "     ", 
         RowBox[{
          RowBox[{"dv", " ", "=", " ", 
           RowBox[{"Lookup", "[", 
            RowBox[{"variables", ",", " ", "\"\<depVars\>\"", ",", " ", 
             RowBox[{"{", "}"}]}], "]"}]}], ",", "\n", "     ", 
          RowBox[{"iv", " ", "=", " ", 
           RowBox[{"Lookup", "[", 
            RowBox[{"variables", ",", " ", "\"\<indVars\>\"", ",", " ", 
             RowBox[{"{", "}"}]}], "]"}]}]}], "\n", "     ", "}"}], ",", "\n",
         "    ", 
        RowBox[{"DeleteDuplicates", " ", "/@", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"#", " ", "->", " ", "\n", "             ", 
                RowBox[{"Cases", "[", 
                 RowBox[{
                  RowBox[{"{", "xp", "}"}], ",", " ", 
                  RowBox[{
                   RowBox[{"#", "[", "z___", "]"}], " ", "->", " ", 
                   RowBox[{"{", "z", "}"}]}], ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", " ", "Infinity"}], "}"}]}], "]"}]}], " ",
                "&"}], " ", "/@", " ", "\n", "           ", "dv"}], ")"}], 
            " ", "/.", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Rule", "[", 
                RowBox[{"#", ",", " ", "0"}], "]"}], " ", "&"}], " ", "/@", 
              " ", "iv"}], ")"}]}], " ", "//", " ", "Association"}], 
          ")"}]}]}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"deleted", " ", "Select"}], " ", "..."}], "."}], "*)"}], 
       "\n", "    ", "]"}]}], "\n", "   ", "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"added", " ", "to", " ", 
    RowBox[{"StencilOperator", ":", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Head", "[", "xp", "]"}], "===", 
       RowBox[{"List", " ", "and", " ", "deleted", " ", "Select"}]}], 
      "..."}]}]}], "*)"}], "\[IndentingNewLine]"}]], "Input",
 CellLabel->"In[9]:=",ExpressionUUID->"73d34383-6601-4b73-85f7-f6fcc058513a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"u", ",", "v"}], "}"}]}], ",", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"n", ",", "t"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<scheme\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"u", "[", 
          RowBox[{
           RowBox[{"n", "+", "1"}], ",", 
           RowBox[{"t", "+", "1"}]}], "]"}], "-", 
         RowBox[{"u", "[", 
          RowBox[{"n", ",", 
           RowBox[{"t", "+", "1"}]}], "]"}]}], ",", 
        RowBox[{"v", "[", 
         RowBox[{
          RowBox[{"n", "+", "1"}], ",", "t"}], "]"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<scheme2\>\"", "\[Rule]", 
      RowBox[{"{", "0", "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expression", "=", 
   RowBox[{
    RowBox[{"u", "[", 
     RowBox[{
      RowBox[{"n", "+", "4"}], ",", "t"}], "]"}], "-", 
    RowBox[{"u", "[", 
     RowBox[{"n", ",", "t"}], "]"}], "+", 
    RowBox[{"v", "[", 
     RowBox[{"n", ",", "t"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expression2", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mastersten", "=", 
  RowBox[{
   RowBox[{"NewStencilOperator", "[", "variables", "]"}], "[", "expression", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"sten", "=", 
  RowBox[{
   RowBox[{"NewStencilOperator", "[", "variables", "]"}], "/@", 
   RowBox[{"variables", "[", "\"\<scheme\>\"", "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.8422254896191463`*^9, 3.842225491147846*^9}, 
   3.842225531866703*^9, {3.842225565152924*^9, 3.842225574667644*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"96d1e0af-d63c-4208-b953-374544ef52f6"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"u", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "0"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"v", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.842225491695757*^9, 3.842225532715929*^9, {3.842225568810961*^9, 
   3.8422255752483177`*^9}},
 CellLabel->"Out[33]=",ExpressionUUID->"67ba778d-8a82-483b-a88b-6c98cc876c7f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"u", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"v", "\[Rule]", 
      RowBox[{"{", "}"}]}]}], "\[RightAssociation]"}], ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"u", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"v", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], "}"}]}]}], "\[RightAssociation]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.842225491695757*^9, 3.842225532715929*^9, {3.842225568810961*^9, 
   3.8422255752504377`*^9}},
 CellLabel->"Out[34]=",ExpressionUUID->"308e1985-0392-45f9-96cc-1fb524bee118"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"NewTranslationsOperator", "[", "variables_Association", "]"}], 
      "[", 
      RowBox[{"masterstencil_", ",", " ", "stencil_"}], "]"}], " ", ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"Which", "[", " ", "\n", "       ", 
      RowBox[{
       RowBox[{
        RowBox[{"masterstencil", "===", " ", "$Failed"}], "||", 
        RowBox[{"stencil", "===", "$Failed"}]}], ",", " ", 
       "\[IndentingNewLine]", "$Failed", ",", "\n", "        ", 
       RowBox[{
        RowBox[{"Head", "[", "stencil", "]"}], " ", "===", " ", "Piecewise"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"PiecewiseOperatorMap", "[", 
        RowBox[{
        "NewTranslationsOperator", ",", " ", "variables", ",", " ", 
         "masterstencil", ",", " ", "stencil"}], "]"}], ",", "\n", "        ", 
       RowBox[{
        RowBox[{"Head", "[", "stencil", "]"}], " ", "===", " ", "List"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"NewTranslationsOperator", "[", "variables", "]"}], "[", 
            RowBox[{"masterstencil", ",", "#"}], "]"}], "&"}], " ", "/@", " ",
           "stencil"}], "//", "PiecewiseExpand"}], "//", 
        "PiecewiseListClean"}], ",", " ", "\n", "        ", "True", ",", "\n",
        "   ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"sten", "=", "stencil"}], ",", " ", 
           RowBox[{"masten", "=", "masterstencil"}], ",", "stenkeys", ",", 
           "mastenkeys", ",", "rangelist", ",", " ", "stencillist", ",", 
           "translist"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"stenkeys", "=", 
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{"sten", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"#", "//", "Flatten"}], ")"}], "===", 
                RowBox[{"{", "}"}]}], "&"}]}], "]"}], "//", "Keys"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"sten", "=", 
           RowBox[{"KeyDrop", "[", 
            RowBox[{"sten", ",", "stenkeys"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"mastenkeys", "=", 
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{"masten", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"#", "//", "Flatten"}], ")"}], "===", 
                RowBox[{"{", "}"}]}], "&"}]}], "]"}], "//", "Keys"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"masten", "=", 
           RowBox[{"KeyDrop", "[", 
            RowBox[{"masten", ",", "mastenkeys"}], "]"}]}], ";", 
          "\[IndentingNewLine]", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"sten", " ", "===", " ", 
              RowBox[{"Association", "[", "]"}]}], "||", 
             RowBox[{"masten", "===", 
              RowBox[{"Association", "[", "]"}]}], "||", 
             RowBox[{"!", 
              RowBox[{"SubsetQ", "[", 
               RowBox[{
                RowBox[{"Keys", "[", "masten", "]"}], ",", 
                RowBox[{"Keys", "[", "sten", "]"}]}], "]"}]}]}], ",", "\n", 
            "   ", 
            RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"rangelist", "=", 
              RowBox[{"Association", "@@", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "->", 
                   RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Min", "/@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"masten", "[", "#", "]"}], "]"}]}], ",", 
                    RowBox[{"Max", "/@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"masten", "[", "#", "]"}], "]"}]}]}], "}"}], 
                    "]"}]}], "&"}], ",", 
                 RowBox[{"Keys", "[", "sten", "]"}]}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"stencillist", "=", 
              RowBox[{"Association", "@@", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "->", 
                   RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Min", "/@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"sten", "[", "#", "]"}], "]"}]}], ",", 
                    RowBox[{"Max", "/@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"sten", "[", "#", "]"}], "]"}]}]}], "}"}], 
                    "]"}]}], "&"}], ",", 
                 RowBox[{"Keys", "[", "sten", "]"}]}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"translist", "=", 
              RowBox[{"rangelist", "-", "stencillist"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"translist", "=", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{"k", ",", 
                   RowBox[{"{", 
                    RowBox[{"k", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "}"}]}], 
                  "]"}], "&"}], ",", "translist", ",", 
                RowBox[{"{", "2", "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"translist", "=", 
              RowBox[{
               RowBox[{"MapThread", "[", 
                RowBox[{"Intersection", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"translist", "[", "#", "]"}], "&"}], "/@", 
                  RowBox[{"Keys", "[", "sten", "]"}]}]}], "]"}], "//", 
               "Tuples"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"variables", "=", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<depVars\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"u", ",", "v"}], "}"}]}], ",", 
       RowBox[{"\"\<indVars\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"n", ",", "t"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<scheme\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"u", "[", 
            RowBox[{
             RowBox[{"n", "+", "1"}], ",", 
             RowBox[{"t", "+", "1"}]}], "]"}], "-", 
           RowBox[{"u", "[", 
            RowBox[{"n", ",", 
             RowBox[{"t", "+", "1"}]}], "]"}]}], ",", 
          RowBox[{"v", "[", 
           RowBox[{
            RowBox[{"n", "+", "1"}], ",", "t"}], "]"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<scheme2\>\"", "\[Rule]", 
        RowBox[{"{", "0", "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expression", "=", 
     RowBox[{
      RowBox[{"u", "[", 
       RowBox[{
        RowBox[{"n", "+", "4"}], ",", "t"}], "]"}], "-", 
      RowBox[{"u", "[", 
       RowBox[{"n", ",", "t"}], "]"}], "+", 
      RowBox[{"v", "[", 
       RowBox[{"n", ",", "t"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expression2", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mastersten", "=", 
     RowBox[{
      RowBox[{"NewStencilOperator", "[", "variables", "]"}], "[", 
      "expression", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sten", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"NewStencilOperator", "[", "variables", "]"}], "[", "#", 
        "]"}], "&"}], "/@", 
      RowBox[{"variables", "[", "\"\<scheme\>\"", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"NewTranslationsOperator", "[", "variables", "]"}], "[", 
      RowBox[{"mastersten", ",", "#"}], "]"}], "&"}], "/@", 
    "sten"}]}]}]], "Input",
 CellChangeTimes->{{3.838807897378329*^9, 3.838807934846445*^9}, {
   3.8388086153936996`*^9, 3.838808624964097*^9}, {3.838808712142025*^9, 
   3.838808718342952*^9}, {3.838809556205064*^9, 3.838809604486072*^9}, {
   3.838809832162485*^9, 3.838809858286603*^9}, {3.8388099263356805`*^9, 
   3.8388099318192945`*^9}, {3.8388099623182898`*^9, 
   3.8388099902721863`*^9}, {3.8388100401009083`*^9, 
   3.8388100688760233`*^9}, {3.838870507206621*^9, 3.8388705316026306`*^9}, {
   3.838870614724636*^9, 3.8388706440338306`*^9}, {3.838870695529188*^9, 
   3.8388707208041105`*^9}, {3.838871169523518*^9, 3.8388711714672165`*^9}, 
   3.838871238036564*^9, {3.8388713023188925`*^9, 3.838871306820933*^9}, {
   3.8388713597817726`*^9, 3.8388713632337866`*^9}, {3.8388714098096485`*^9, 
   3.838871420006081*^9}, {3.838871457332611*^9, 3.8388715240665646`*^9}, {
   3.8388715738791523`*^9, 3.8388715825667706`*^9}, {3.8388716450937767`*^9, 
   3.838871654305621*^9}, {3.83887189282472*^9, 3.83887190978872*^9}, {
   3.8388727624187284`*^9, 3.83887289645082*^9}, {3.838872983539749*^9, 
   3.8388730601619964`*^9}, {3.8388879453385353`*^9, 
   3.8388879540822268`*^9}, {3.8388888999889364`*^9, 3.838888908453761*^9}, {
   3.838890428021368*^9, 3.838890444926607*^9}, 3.8388905519827666`*^9, {
   3.838890605894513*^9, 3.8388906124142*^9}, {3.8389616414845977`*^9, 
   3.8389616447681684`*^9}, 3.8389622285019493`*^9, {3.8389730201091013`*^9, 
   3.8389730501594286`*^9}, {3.8389731215698876`*^9, 3.838973133621518*^9}, {
   3.83897316749236*^9, 3.838973190592564*^9}, {3.838973594097083*^9, 
   3.838973613712364*^9}, {3.8389736541621776`*^9, 3.8389736642724285`*^9}, {
   3.838973733465079*^9, 3.8389738529481015`*^9}, {3.8389738869095497`*^9, 
   3.838973890304512*^9}, {3.8389746951333127`*^9, 3.8389747464221344`*^9}, 
   3.838974804160821*^9, {3.8389748415323515`*^9, 3.8389749166547356`*^9}, {
   3.838974953967084*^9, 3.838975005930153*^9}, {3.8389751942958174`*^9, 
   3.8389752082746553`*^9}, {3.838975246720986*^9, 3.838975289729579*^9}, {
   3.838975336322755*^9, 3.8389753385294523`*^9}, {3.838975386365689*^9, 
   3.8389753895754194`*^9}, {3.838975451059638*^9, 3.8389754650146112`*^9}, {
   3.838975528900364*^9, 3.8389756104200816`*^9}, {3.838975830159861*^9, 
   3.838975895193781*^9}, {3.8389759646234455`*^9, 3.8389759658738766`*^9}, {
   3.8389760368349333`*^9, 3.8389760488093753`*^9}, {3.838976110883235*^9, 
   3.838976145099928*^9}, {3.8389762579327955`*^9, 3.8389762998653903`*^9}, {
   3.8389763357411823`*^9, 3.8389763366281586`*^9}, {3.8389763690746593`*^9, 
   3.838976374173633*^9}, {3.838976411643824*^9, 3.8389764163558593`*^9}, {
   3.838976704536436*^9, 3.8389767289137173`*^9}, {3.8389767851514144`*^9, 
   3.838976815443288*^9}, {3.838977286052569*^9, 3.8389773432941895`*^9}, {
   3.8389773950432577`*^9, 3.838977402821311*^9}, {3.838977513095767*^9, 
   3.838977532505523*^9}, {3.8389776490309553`*^9, 3.838977684859091*^9}, 
   3.838977717944085*^9, {3.8389778173498354`*^9, 3.8389778376549406`*^9}, 
   3.8389779280015807`*^9, {3.8389780237860155`*^9, 3.838978041490717*^9}, {
   3.838978143286389*^9, 3.838978150277173*^9}, {3.838978268918681*^9, 
   3.838978274738613*^9}, {3.8389783756842747`*^9, 3.83897840475628*^9}, {
   3.838978453404549*^9, 3.838978495676637*^9}, {3.8389785390053606`*^9, 
   3.8389785455419006`*^9}, {3.8389786423868437`*^9, 
   3.8389786453590393`*^9}, {3.838978693082611*^9, 3.838978696562378*^9}, {
   3.8389787275875206`*^9, 3.838978729794919*^9}, {3.8389788176310434`*^9, 
   3.838978832732892*^9}, {3.8389801134289703`*^9, 3.838980118520943*^9}, {
   3.838980158471317*^9, 3.838980186360391*^9}, {3.838980295073086*^9, 
   3.838980307788099*^9}, {3.838980346408035*^9, 3.838980396544319*^9}, {
   3.838980483017486*^9, 3.8389805089043493`*^9}, {3.838981456199033*^9, 
   3.8389815145686045`*^9}, {3.838981571456085*^9, 3.8389815763486757`*^9}, {
   3.838981613716009*^9, 3.8389816178160887`*^9}, {3.838989618856865*^9, 
   3.8389896199286766`*^9}, 3.8389897737573924`*^9, {3.8389898756899505`*^9, 
   3.8389900146778064`*^9}, {3.838990065856286*^9, 3.8389901317401943`*^9}, {
   3.838990528010458*^9, 3.838990557453511*^9}, {3.8389905881973352`*^9, 
   3.838990663669552*^9}, {3.8389907334027147`*^9, 3.8389907633974867`*^9}, {
   3.838990799931817*^9, 3.8389909064017754`*^9}, {3.8389909364264803`*^9, 
   3.8389909419091425`*^9}, {3.83899098509754*^9, 3.838991019915525*^9}, {
   3.8389917896053076`*^9, 3.838991834568287*^9}, {3.8389918762151814`*^9, 
   3.8389919304207973`*^9}, {3.838993688393157*^9, 3.8389937314574804`*^9}, {
   3.83899407480614*^9, 3.8389941213292694`*^9}, {3.8389941915063725`*^9, 
   3.8389942701412754`*^9}, {3.838994428898404*^9, 3.838994461710688*^9}, {
   3.8389945119283442`*^9, 3.83899451489812*^9}, {3.8390428281898117`*^9, 
   3.8390428286916456`*^9}, {3.839042971841225*^9, 3.839042986449129*^9}, {
   3.839043131872411*^9, 3.8390431469730005`*^9}, {3.8390431785946207`*^9, 
   3.8390431950407248`*^9}, {3.839043465809532*^9, 3.839043491965197*^9}, {
   3.839043538643547*^9, 3.8390435571016245`*^9}, {3.83904382053229*^9, 
   3.8390438596723156`*^9}, {3.8390441853535404`*^9, 
   3.8390442290744276`*^9}, {3.839044441623089*^9, 3.839044454111548*^9}, {
   3.839044491759078*^9, 3.8390445057010584`*^9}, {3.8390446116366425`*^9, 
   3.8390446182095375`*^9}, 3.8390446562439947`*^9, {3.839044713806119*^9, 
   3.839044777360266*^9}, {3.8390450933681946`*^9, 3.8390451078841667`*^9}, {
   3.8390451913314557`*^9, 3.8390452040596085`*^9}, {3.839045381891447*^9, 
   3.839045390985816*^9}, {3.8390460209513597`*^9, 3.839046024175071*^9}, {
   3.839046089636555*^9, 3.8390460922535744`*^9}, {3.8393895180489635`*^9, 
   3.8393895294023037`*^9}, {3.839389690601368*^9, 3.8393897044080067`*^9}, {
   3.8393897501848197`*^9, 3.839389756616391*^9}, {3.839389845851407*^9, 
   3.839389918911874*^9}, {3.839407882954399*^9, 3.8394079953216496`*^9}, {
   3.839408040024069*^9, 3.839408042145694*^9}, {3.8404301037655897`*^9, 
   3.840430180056231*^9}, {3.840430238957171*^9, 3.840430239073153*^9}, 
   3.8404309472771587`*^9, {3.8404309904218616`*^9, 3.840431079386642*^9}, {
   3.8404311094812717`*^9, 3.840431116932453*^9}, {3.8404311711189404`*^9, 
   3.840431237275004*^9}, {3.840431473420631*^9, 3.840431486071409*^9}, {
   3.840432385577507*^9, 3.840432394281001*^9}, {3.840433041547077*^9, 
   3.840433041863326*^9}, {3.8404330934147377`*^9, 3.840433096217595*^9}, {
   3.84043339328104*^9, 3.8404334215375023`*^9}, {3.840433600232115*^9, 
   3.840433791850531*^9}, {3.840433826594849*^9, 3.840433835794218*^9}, {
   3.840433978954236*^9, 3.840434189030027*^9}, {3.840434221604389*^9, 
   3.840434229423161*^9}, {3.840434320260922*^9, 3.84043436195518*^9}, {
   3.840434403447496*^9, 3.8404345221749353`*^9}, {3.8404353591787577`*^9, 
   3.840435376039517*^9}, {3.8404357508346663`*^9, 3.840435758846381*^9}, {
   3.8404451800563517`*^9, 3.840445211737527*^9}, {3.840446087402028*^9, 
   3.840446088811899*^9}, {3.840446279404141*^9, 3.840446308282926*^9}, {
   3.840446404305745*^9, 3.840446438712534*^9}, {3.8404465831128387`*^9, 
   3.8404466768125677`*^9}, {3.8404467114564743`*^9, 
   3.8404467140972557`*^9}, {3.8404469617460938`*^9, 3.840447070394109*^9}, {
   3.840447134665635*^9, 3.840447137856493*^9}, {3.840447250843944*^9, 
   3.840447268675867*^9}, {3.840447299842175*^9, 3.840447301694553*^9}, {
   3.8404473462613373`*^9, 3.840447365711472*^9}, {3.840447453942074*^9, 
   3.840447509939686*^9}, {3.840447889991125*^9, 3.840447892016038*^9}, {
   3.840447988470228*^9, 3.840448090751993*^9}, {3.84044828572453*^9, 
   3.840448330538094*^9}, 3.840448363585506*^9, {3.840448426963266*^9, 
   3.840448479309721*^9}, {3.8405227331614656`*^9, 3.840522786783924*^9}, {
   3.840522832641564*^9, 3.840522886605008*^9}, {3.840522960856275*^9, 
   3.840522963372993*^9}, {3.840524336053608*^9, 3.840524354185342*^9}, {
   3.840594154844077*^9, 3.840594171014472*^9}, {3.840620047539228*^9, 
   3.840620052584161*^9}, {3.840621792177183*^9, 3.840621796672064*^9}, {
   3.840621945519404*^9, 3.8406220138852453`*^9}, {3.840622061777609*^9, 
   3.840622101706368*^9}, {3.840622263833795*^9, 3.840622264565929*^9}, {
   3.8406224011317263`*^9, 3.8406224481440163`*^9}, {3.840622513020815*^9, 
   3.8406226068477182`*^9}, {3.840622733743647*^9, 3.840622804166993*^9}, {
   3.8406229684619293`*^9, 3.840622995884921*^9}, {3.840623082145247*^9, 
   3.840623085462945*^9}, {3.841194424875317*^9, 3.8411944413146477`*^9}, {
   3.841194615256301*^9, 3.841194650789344*^9}, {3.84119471296599*^9, 
   3.84119480012122*^9}, {3.8411948398699102`*^9, 3.841194864067622*^9}, 
   3.8422254778140173`*^9},ExpressionUUID->"82f20a38-6ba5-471c-8b20-\
355050d16172"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "0"}], "}"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.840433793840887*^9, 3.840433836839781*^9, {3.84043415326737*^9, 
   3.840434165630412*^9}, 3.840434198440119*^9, 3.8404342299214087`*^9, {
   3.840434341809288*^9, 3.8404343623171043`*^9}, {3.8404344137693996`*^9, 
   3.8404344516380787`*^9}, {3.8404344826957607`*^9, 
   3.8404345236146307`*^9}, {3.840435365104685*^9, 3.840435376650797*^9}, 
   3.8404357534086027`*^9, {3.840445186885634*^9, 3.840445213667981*^9}, 
   3.840446090372868*^9, {3.8404462841638813`*^9, 3.840446308951968*^9}, {
   3.8404464125239897`*^9, 3.840446439233367*^9}, 3.8404466786848097`*^9, 
   3.8404467153223467`*^9, 3.84044707087009*^9, 3.840447272025875*^9, 
   3.840447302359573*^9, 3.840447350076412*^9, 3.8404474558296337`*^9, {
   3.840447503625104*^9, 3.84044751141392*^9}, 3.840447893089198*^9, {
   3.8404479907760353`*^9, 3.840448091452919*^9}, {3.840448288373901*^9, 
   3.8404483320724783`*^9}, 3.840448364283568*^9, {3.8404484279764957`*^9, 
   3.840448480109461*^9}, 3.840522577518388*^9, 3.840522787898839*^9, 
   3.840522888114678*^9, 3.840522964475559*^9, 3.840524355250297*^9, 
   3.840594171937008*^9, 3.840617675068828*^9, 3.84062005387834*^9, 
   3.840621797064213*^9, 3.8406221070294247`*^9, 3.8406222661496563`*^9, {
   3.840622417930501*^9, 3.840622448852065*^9}, {3.840622517077862*^9, 
   3.8406226091518173`*^9}, {3.840622747289556*^9, 3.8406228049913473`*^9}, {
   3.8406229770007277`*^9, 3.840622996653675*^9}, 3.840623051749498*^9, 
   3.8406230887337923`*^9, 3.840678654144758*^9, {3.841194418181052*^9, 
   3.8411944454438467`*^9}, {3.841194748842237*^9, 3.8411947726364393`*^9}, {
   3.8411948356594*^9, 3.841194865700416*^9}},
 CellLabel->"Out[89]=",ExpressionUUID->"1783999b-25e3-43c6-b30f-b7239a1179b2"]
}, Open  ]]
},
WindowSize->{808, 695},
WindowMargins->{{316, Automatic}, {Automatic, 50}},
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (May 11, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"300b1424-7b8a-426b-83eb-5ab52dda9fc4"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 919, 14, 52, "Input",ExpressionUUID->"78ee9b1f-0c6c-423a-b456-79875b17f195"],
Cell[CellGroupData[{
Cell[1502, 38, 1618, 47, 157, "Input",ExpressionUUID->"b2a34395-43c2-4800-88cb-b11342a9e408"],
Cell[3123, 87, 363, 8, 34, "Output",ExpressionUUID->"3902003d-a03e-40fb-8e04-5273e7163032"],
Cell[3489, 97, 622, 17, 34, "Output",ExpressionUUID->"d74a79c0-2569-48da-8485-bfd5e899aaba"],
Cell[4114, 116, 298, 7, 34, "Output",ExpressionUUID->"e5b82dc1-374a-4467-b219-0da516dd3029"]
}, Open  ]],
Cell[4427, 126, 3237, 80, 451, "Input",ExpressionUUID->"73d34383-6601-4b73-85f7-f6fcc058513a"],
Cell[CellGroupData[{
Cell[7689, 210, 1878, 50, 157, "Input",ExpressionUUID->"96d1e0af-d63c-4208-b953-374544ef52f6"],
Cell[9570, 262, 608, 18, 34, "Output",ExpressionUUID->"67ba778d-8a82-483b-a88b-6c98cc876c7f"],
Cell[10181, 282, 871, 26, 57, "Output",ExpressionUUID->"308e1985-0392-45f9-96cc-1fb524bee118"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11089, 313, 17248, 330, 913, "Input",ExpressionUUID->"82f20a38-6ba5-471c-8b20-355050d16172"],
Cell[28340, 645, 2285, 45, 34, "Output",ExpressionUUID->"1783999b-25e3-43c6-b30f-b7239a1179b2"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)


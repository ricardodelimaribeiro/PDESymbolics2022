(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     11681,        334]
NotebookOptionsPosition[      9664,        294]
NotebookOutlinePosition[     10056,        310]
CellTagsIndexPosition[     10013,        307]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<depVars\>\"", "->", 
       RowBox[{"{", "u", "}"}]}], ",", 
      RowBox[{"\"\<indVars\>\"", "->", 
       RowBox[{"{", "x", "}"}]}], ",", 
      RowBox[{"\"\<expression\>\"", "->", 
       RowBox[{
        RowBox[{
         RowBox[{"u", "[", "x", "]"}], "^", "a"}], " ", 
        RowBox[{
         RowBox[{"u", "''''"}], "[", "x", "]"}]}]}], ",", 
      RowBox[{"\"\<result\>\"", "->", 
       RowBox[{"Times", "[", 
        RowBox[{"a", ",", 
         RowBox[{"Power", "[", 
          RowBox[{
           RowBox[{"u", "[", "x", "]"}], ",", 
           RowBox[{"Plus", "[", 
            RowBox[{
             RowBox[{"-", "2"}], ",", "a"}], "]"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", "2", "]"}], "[", "u", "]"}], "[", "x", 
          "]"}], ",", 
         RowBox[{"Plus", "[", 
          RowBox[{
           RowBox[{"Times", "[", 
            RowBox[{
             RowBox[{"-", "1"}], ",", 
             RowBox[{"Power", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Derivative", "[", "1", "]"}], "[", "u", "]"}], "[", 
                "x", "]"}], ",", "2"}], "]"}]}], "]"}], ",", 
           RowBox[{"Times", "[", 
            RowBox[{"a", ",", 
             RowBox[{"Power", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Derivative", "[", "1", "]"}], "[", "u", "]"}], "[", 
                "x", "]"}], ",", "2"}], "]"}]}], "]"}], ",", 
           RowBox[{"Times", "[", 
            RowBox[{
             RowBox[{"u", "[", "x", "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Derivative", "[", "2", "]"}], "[", "u", "]"}], "[", 
              "x", "]"}]}], "]"}]}], "]"}]}], "]"}]}]}], "}"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.842425827308013*^9, 3.842425827308848*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"7a4fb39e-46ff-4c4a-9d3b-40e01f7f8b82"],

Cell[BoxData[
 RowBox[{
  RowBox[{"result", " ", "=", " ", 
   RowBox[{"variables", "[", "\"\<result\>\"", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8424258311116133`*^9, 3.842425842550848*^9}, 
   3.842426050602957*^9},
 CellLabel->"In[38]:=",ExpressionUUID->"9a2de215-0f19-4437-a246-eae0675a7826"],

Cell[BoxData[
 RowBox[{
  RowBox[{"expression", " ", "=", " ", 
   RowBox[{"variables", "[", "\"\<expression\>\"", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.842425845444955*^9, 3.842425853837017*^9}, 
   3.842426054436256*^9},
 CellLabel->"In[39]:=",ExpressionUUID->"c7446c9e-2fdd-4705-b0df-74ee1afa2a5c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"BeautifyOperator", "[", "variables", "]"}], "[", "expression", 
  "]"}]], "Input",
 CellChangeTimes->{{3.842425857434634*^9, 3.842425865192492*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"e8b0ceec-f34b-4c2f-8424-da178655b6d2"],

Cell[BoxData[
 TemplateBox[{
  "Power", "infy", 
   "\"Infinite expression \\!\\(\\*FractionBox[\\\"1\\\", \\\"0\\\"]\\) \
encountered.\"", 2, 42, 17, 31845497354103555185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.842506844450493*^9, 3.842506880840465*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"9a01be72-d461-47ef-b32b-cbdaf94d5590"],

Cell[BoxData[
 TemplateBox[{
  "Power", "infy", 
   "\"Infinite expression \\!\\(\\*FractionBox[\\\"1\\\", \\\"0\\\"]\\) \
encountered.\"", 2, 42, 18, 31845497354103555185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.842506844450493*^9, 3.842506880847383*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"3013ab5a-9e60-4581-8fa6-370bf255c370"],

Cell[BoxData[
 TemplateBox[{
  "Power", "infy", 
   "\"Infinite expression \\!\\(\\*FractionBox[\\\"1\\\", \\\"0\\\"]\\) \
encountered.\"", 2, 42, 19, 31845497354103555185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.842506844450493*^9, 3.842506880853067*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"c1f020d1-1ee6-400a-a650-33f8603efe38"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Power\\\", \\\"::\\\", \
\\\"infy\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"", 2, 42, 20, 31845497354103555185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.842506844450493*^9, 3.842506880858638*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"150359e2-c1d4-493b-85be-af0bc19a6417"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["0", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "a"}]], " ", "a"}], "+", 
  RowBox[{
   SuperscriptBox["0", "a"], " ", "a"}], "+", 
  RowBox[{
   SuperscriptBox["0", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "a"}]], " ", 
   SuperscriptBox["a", "2"]}], "-", 
  RowBox[{"a", " ", 
   SuperscriptBox[
    RowBox[{"u", "[", "x", "]"}], 
    RowBox[{
     RowBox[{"-", "2"}], "+", "a"}]], " ", 
   SuperscriptBox[
    RowBox[{
     SuperscriptBox["u", "\[Prime]",
      MultilineFunction->None], "[", "x", "]"}], "2"], " ", 
   RowBox[{
    SuperscriptBox["u", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "x", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["a", "2"], " ", 
   SuperscriptBox[
    RowBox[{"u", "[", "x", "]"}], 
    RowBox[{
     RowBox[{"-", "2"}], "+", "a"}]], " ", 
   SuperscriptBox[
    RowBox[{
     SuperscriptBox["u", "\[Prime]",
      MultilineFunction->None], "[", "x", "]"}], "2"], " ", 
   RowBox[{
    SuperscriptBox["u", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "x", "]"}]}], "+", 
  RowBox[{"a", " ", 
   SuperscriptBox[
    RowBox[{"u", "[", "x", "]"}], 
    RowBox[{
     RowBox[{"-", "1"}], "+", "a"}]], " ", 
   SuperscriptBox[
    RowBox[{
     SuperscriptBox["u", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "x", "]"}], "2"]}]}]], "Output",
 CellChangeTimes->{3.8424258668479853`*^9, 3.84242617075456*^9, 
  3.842426407136649*^9, 3.842506632351201*^9, 3.842506844821107*^9, 
  3.8425068812071543`*^9},
 CellLabel->"Out[42]=",ExpressionUUID->"c1f845e2-ffdc-43de-ac68-68ebece3f8e5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"u", "[", "x", "]"}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Power", "[", 
     RowBox[{
      RowBox[{"u", "[", "x", "]"}], ",", "___"}], "]"}], "->", "0"}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.842426173949778*^9, 3.842426262624488*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"8213935d-508f-4e6e-8211-4dee9672b1be"],

Cell[BoxData[
 RowBox[{"u", "[", "x", "]"}]], "Output",
 CellChangeTimes->{
  3.842426213964033*^9, {3.8424262556587467`*^9, 3.8424262632421303`*^9}},
 CellLabel->"Out[10]=",ExpressionUUID->"e06a500b-0a3f-438a-8b1a-0671443afdeb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullForm", "[", "expression", "]"}]], "Input",
 CellChangeTimes->{{3.842426288513782*^9, 3.842426304853363*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"16be40d8-649d-4e0c-a63a-7132496de1ef"],

Cell[BoxData[
 TagBox[
  StyleBox[
   RowBox[{"Times", "[", 
    RowBox[{
     RowBox[{"Power", "[", 
      RowBox[{
       RowBox[{"u", "[", "x", "]"}], ",", "a"}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", "4", "]"}], "[", "u", "]"}], "[", "x", 
      "]"}]}], "]"}],
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output",
 CellChangeTimes->{{3.842426296132255*^9, 3.8424263056129417`*^9}},
 CellLabel->
  "Out[12]//FullForm=",ExpressionUUID->"77aafccd-4e57-4bcf-98db-5eaa2c87faf3"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dep", "=", 
   RowBox[{"{", 
    RowBox[{"u", ",", "v"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ind", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.84250691820149*^9, 3.842507005303019*^9}, {
  3.84250704517062*^9, 3.842507049064836*^9}, {3.842518504268565*^9, 
  3.842518513467811*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"3266a83e-1efb-4dc8-9c19-42a9fb260c62"],

Cell[CellGroupData[{

Cell["Use this in IntegralEquivalenceClassOperator!!!", "Subsection",
 CellChangeTimes->{{3.842518574159912*^9, 
  3.842518586283595*^9}},ExpressionUUID->"1741a4b3-3728-4719-84c3-\
af9a73c06e60"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"#", "[", 
    RowBox[{"Sequence", "@@", "ind"}], "]"}], "&"}], "/@", "dep"}]], "Input",
 CellChangeTimes->{{3.842518516872087*^9, 3.842518563014332*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"f3d6f9f4-0268-4b39-b512-d2db2275290a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"u", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", 
   RowBox[{"v", "[", 
    RowBox[{"x", ",", "y"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.842518563730604*^9},
 CellLabel->"Out[53]=",ExpressionUUID->"9feda860-172c-479b-a627-73c996af7ac5"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 905},
WindowMargins->{{436, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"403d6ab0-6813-46f8-bdff-9bf672101200"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2109, 57, 94, "Input",ExpressionUUID->"7a4fb39e-46ff-4c4a-9d3b-40e01f7f8b82"],
Cell[2670, 79, 305, 6, 30, "Input",ExpressionUUID->"9a2de215-0f19-4437-a246-eae0675a7826"],
Cell[2978, 87, 311, 6, 30, "Input",ExpressionUUID->"c7446c9e-2fdd-4705-b0df-74ee1afa2a5c"],
Cell[CellGroupData[{
Cell[3314, 97, 262, 5, 30, "Input",ExpressionUUID->"e8b0ceec-f34b-4c2f-8424-da178655b6d2"],
Cell[3579, 104, 392, 9, 40, "Message",ExpressionUUID->"9a01be72-d461-47ef-b32b-cbdaf94d5590"],
Cell[3974, 115, 392, 9, 40, "Message",ExpressionUUID->"3013ab5a-9e60-4581-8fa6-370bf255c370"],
Cell[4369, 126, 392, 9, 40, "Message",ExpressionUUID->"c1f020d1-1ee6-400a-a650-33f8603efe38"],
Cell[4764, 137, 472, 10, 28, "Message",ExpressionUUID->"150359e2-c1d4-493b-85be-af0bc19a6417"],
Cell[5239, 149, 1606, 50, 34, "Output",ExpressionUUID->"c1f845e2-ffdc-43de-ac68-68ebece3f8e5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6882, 204, 369, 10, 30, "Input",ExpressionUUID->"8213935d-508f-4e6e-8211-4dee9672b1be"],
Cell[7254, 216, 229, 4, 34, "Output",ExpressionUUID->"e06a500b-0a3f-438a-8b1a-0671443afdeb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7520, 225, 215, 3, 30, "Input",ExpressionUUID->"16be40d8-649d-4e0c-a63a-7132496de1ef"],
Cell[7738, 230, 574, 18, 45, "Output",ExpressionUUID->"77aafccd-4e57-4bcf-98db-5eaa2c87faf3"]
}, Open  ]],
Cell[8327, 251, 480, 12, 52, "Input",ExpressionUUID->"3266a83e-1efb-4dc8-9c19-42a9fb260c62"],
Cell[CellGroupData[{
Cell[8832, 267, 195, 3, 54, "Subsection",ExpressionUUID->"1741a4b3-3728-4719-84c3-af9a73c06e60"],
Cell[CellGroupData[{
Cell[9052, 274, 279, 6, 30, "Input",ExpressionUUID->"f3d6f9f4-0268-4b39-b512-d2db2275290a"],
Cell[9334, 282, 302, 8, 34, "Output",ExpressionUUID->"9feda860-172c-479b-a627-73c996af7ac5"]
}, Open  ]]
}, Open  ]]
}
]
*)


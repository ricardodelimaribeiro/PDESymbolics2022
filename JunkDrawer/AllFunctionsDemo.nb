(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    200841,       6035]
NotebookOptionsPosition[    173155,       5524]
NotebookOutlinePosition[    173546,       5540]
CellTagsIndexPosition[    173503,       5537]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<PDESymbolics2020`\>\"", "]"}]], "Input",Expression\
UUID->"6725cdff-6134-44e5-8358-e62b50a43511"],

Cell[CellGroupData[{

Cell["Data structure and basic utilities", "Section",
 CellChangeTimes->{{3.858492879436411*^9, 3.858492884636849*^9}, {
  3.858493005045755*^9, 
  3.8584930087629623`*^9}},ExpressionUUID->"a2bc80cc-6d82-4929-942f-\
0bdf5bc1caa2"],

Cell[CellGroupData[{

Cell["Piecewise tools", "Subsection",
 CellChangeTimes->{{3.859250114162119*^9, 
  3.859250121510593*^9}},ExpressionUUID->"80baef63-c07a-46e6-9002-\
ea4317b93094"],

Cell[CellGroupData[{

Cell["Piecewise cleaning", "Subsubsection",
 CellChangeTimes->{{3.859256903303094*^9, 
  3.85925691419771*^9}},ExpressionUUID->"9c1c551d-1167-48a1-a6c0-\
15a0df10b65d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PiecewiseListClean", "[", 
  RowBox[{"Piecewise", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"$Failed", ",", " ", "1", ",", "2"}], "}"}], ",", 
        RowBox[{"a", "==", "1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
        RowBox[{"a", "==", "2"}]}], "}"}]}], "}"}], ",", "$Failed"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.85925677591191*^9, 3.859256836678214*^9}, {
  3.859531182997466*^9, 3.859531188639612*^9}},
 CellLabel->
  "In[477]:=",ExpressionUUID->"8c8c2f9a-3db2-4b13-8113-d3d25f81f611"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {"$Failed", 
        RowBox[{"a", "\[NotEqual]", "2"}]},
       {
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}], 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{
  3.859256837195697*^9, {3.8595311858859167`*^9, 3.859531189450223*^9}},
 CellLabel->
  "Out[477]=",ExpressionUUID->"a97025a3-2e13-4104-bdd6-f87d167d38e4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PiecewiseAssociationClean", "[", "\[IndentingNewLine]", 
   RowBox[{"Piecewise", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Association", "[", 
          RowBox[{"\"\<a\>\"", "->", "$Failed"}], "]"}], ",", 
         RowBox[{"a", "==", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Association", "[", 
          RowBox[{"\"\<a\>\"", "->", "1"}], "]"}], ",", 
         RowBox[{"a", "==", "2"}]}], "}"}]}], "}"}], ",", "$Failed"}], "]"}], 
   "\[IndentingNewLine]", "]"}], "  "}]], "Input",
 CellChangeTimes->{{3.85925597975316*^9, 3.859256044173531*^9}, {
  3.8592561255578833`*^9, 3.8592561287870083`*^9}, {3.859256232049079*^9, 
  3.859256242112934*^9}, {3.859256850152808*^9, 
  3.859256871599958*^9}},ExpressionUUID->"71455e47-439a-4133-9074-\
7cba90cad369"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"\[LeftAssociation]", 
         RowBox[{"\<\"a\"\>", "\[Rule]", "1"}], "\[RightAssociation]"}], 
        RowBox[{"a", "\[Equal]", "2"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{{3.859256038132394*^9, 3.859256044794773*^9}, 
   3.8592561294824266`*^9, 3.8592568647374973`*^9},
 CellLabel->
  "Out[178]=",ExpressionUUID->"504125ec-ed6b-43c9-960a-0f0ab0baac31"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Piecewise Mapping", "Subsubsection",
 CellChangeTimes->{{3.858495285650226*^9, 3.8584952938896217`*^9}, {
  3.859256892540881*^9, 
  3.859256901594187*^9}},ExpressionUUID->"2a1740b1-a3b3-41bb-b67a-\
d614faf4cc60"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PiecewiseMap", "[", 
  RowBox[{"f", ",", " ", 
   RowBox[{"Piecewise", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"x", "<", "0"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", 
         RowBox[{"x", ">", "3"}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"$Failed", ",", " ", 
         RowBox[{"0", "\[LessEqual]", "x", "<", "3"}]}], "}"}]}], "}"}], ",", 
     " ", "$Failed"}], "]"}]}], "]"}]], "Input",
 CellLabel->
  "In[179]:=",ExpressionUUID->"2b6c8226-3535-4825-904f-bfa5408c23cd"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {"$Failed", 
        RowBox[{"0", "\[LessEqual]", "x", "\[LessEqual]", "3"}]},
       {
        RowBox[{"f", "[", "1", "]"}], 
        RowBox[{"x", "<", "0"}]},
       {
        RowBox[{"f", "[", "2", "]"}], 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{3.8592569436299963`*^9},
 CellLabel->
  "Out[179]=",ExpressionUUID->"93eef66e-b05a-4874-9301-9dd3aecb3e09"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ConditionalPiecewiseMap", "[", 
  RowBox[{"f", ",", " ", 
   RowBox[{"Piecewise", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"x", "<", "0"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", 
         RowBox[{"x", ">", "3"}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"$Failed", ",", " ", 
         RowBox[{"0", "\[LessEqual]", "x", "<", "3"}]}], "}"}]}], "}"}], ",", 
     " ", "$Failed"}], "]"}]}], "]"}]], "Input",
 CellLabel->"In[24]:=",ExpressionUUID->"1ca11699-b186-4564-b606-7f75709123fb"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {"$Failed", 
        RowBox[{"0", "\[LessEqual]", "x", "\[LessEqual]", "3"}]},
       {
        RowBox[{"f", "[", 
         RowBox[{"1", ",", 
          RowBox[{"x", "<", "0"}]}], "]"}], 
        RowBox[{"x", "<", "0"}]},
       {
        RowBox[{"f", "[", 
         RowBox[{"2", ",", 
          RowBox[{"x", ">", "3"}]}], "]"}], 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{3.8584953014573298`*^9},
 CellLabel->"Out[24]=",ExpressionUUID->"ae497828-07cd-4554-a8f4-efdceea176d3"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Piecewise Simplification", "Subsubsection",
 CellChangeTimes->{{3.859255969074007*^9, 3.8592559766566896`*^9}, {
  3.8592562133244963`*^9, 
  3.859256218187031*^9}},ExpressionUUID->"47fec98b-ecf6-4ffc-ade0-\
45acd65ce39b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PiecewiseEliminateEqualitiesOperator", "[", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{"\"\<facts\>\"", "\[Rule]", 
     RowBox[{"a", ">", "0"}]}], "\[RightAssociation]"}], "]"}], "[", 
  TagBox[GridBox[{
     {"\[Piecewise]", GridBox[{
        {
         RowBox[{
          SqrtBox[
           SuperscriptBox["a", "2"]], " ", "x"}], 
         RowBox[{"a", ">", "2"}]},
        {
         SqrtBox[
          SuperscriptBox["b", "2"]], 
         RowBox[{"b", ">", "1"}]},
        {
         RowBox[{"a", "+", "b"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"b", "\[Equal]", "1"}], "&&", 
            RowBox[{"a", "\[Equal]", "2"}]}], ")"}], "||", 
          RowBox[{"a", "<", "2"}]}]},
        {"$Failed", 
         TagBox["True",
          "PiecewiseDefault",
          AutoDelete->True]}
       },
       AllowedDimensions->{2, Automatic},
       Editable->True,
       GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.84]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}},
       Selectable->True]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.35]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   "Piecewise",
   DeleteWithContents->True,
   Editable->False,
   SelectWithContents->True,
   Selectable->False,
   StripWrapperBoxes->True], "]"}]], "Input",
 CellLabel->
  "In[149]:=",ExpressionUUID->"f58a492d-c058-473a-9079-b70d72dfe5f7"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        SqrtBox[
         SuperscriptBox["b", "2"]], 
        RowBox[{
         RowBox[{"0", "<", "a", "\[LessEqual]", "2"}], "&&", 
         RowBox[{"b", ">", "1"}]}]},
       {
        RowBox[{"1", "+", "a"}], 
        RowBox[{
         RowBox[{"b", "\[Equal]", "1"}], "&&", 
         RowBox[{"0", "<", "a", "\[LessEqual]", "2"}]}]},
       {
        RowBox[{"a", "+", "b"}], 
        RowBox[{
         RowBox[{"0", "<", "a", "<", "2"}], "&&", 
         RowBox[{"b", "<", "1"}]}]},
       {
        RowBox[{
         SqrtBox[
          SuperscriptBox["a", "2"]], " ", "x"}], 
        RowBox[{"a", ">", "2"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{3.85925625306959*^9},
 CellLabel->
  "Out[149]=",ExpressionUUID->"7a347d56-e0f7-41d1-a6ff-29213b41c3e4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", "u", "}"}]}], ",", " ", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}], ",", 
     RowBox[{"\"\<pars\>\"", "\[Rule]", 
      RowBox[{"{", "a", "}"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{"expression", " ", "=", " ", 
  RowBox[{"Piecewise", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", " ", 
        RowBox[{"a", "==", "1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", "+", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], "a"]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "a"}], "+", 
          SuperscriptBox["a", "2"]}], "\[NotEqual]", "0"}]}], "}"}]}], "}"}], 
    ",", "$Failed"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"PiecewiseBeautify", "[", "expression", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PiecewiseEliminateEqualitiesOperator", "[", "variables", "]"}], 
  "[", "expression", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PiecewiseSimplifyOperator", "[", "variables", "]"}], "[", 
  "expression", "]"}]}], "Input",
 CellChangeTimes->{{3.859256616733367*^9, 3.859256673322064*^9}},
 CellLabel->
  "In[170]:=",ExpressionUUID->"d6f283cd-3e73-4e62-aff4-24d23824b141"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {"a", 
        RowBox[{"a", "\[Equal]", "1"}]},
       {
        RowBox[{"a", "+", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], "a"]}], 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "a"}], "+", 
          SuperscriptBox["a", "2"]}], "\[NotEqual]", "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{
  3.859256619230576*^9, {3.8592566494846773`*^9, 3.8592566738274727`*^9}},
 CellLabel->
  "Out[171]=",ExpressionUUID->"de05e424-9d49-4068-b4d6-b005c0b0a899"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {"a", 
        RowBox[{"a", "\[Equal]", "1"}]},
       {
        RowBox[{"a", "+", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], "a"]}], 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "a"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "a"}], ")"}], " ", "a"}], "\[NotEqual]", 
         "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{
  3.859256619230576*^9, {3.8592566494846773`*^9, 3.859256673835018*^9}},
 CellLabel->
  "Out[172]=",ExpressionUUID->"69a32f1e-977b-431e-9dc3-4485d4a9efc4"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {"1", 
        RowBox[{"a", "\[Equal]", "1"}]},
       {
        RowBox[{"a", "+", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], "a"]}], 
        RowBox[{
         RowBox[{"a", " ", 
          RowBox[{"(", 
           RowBox[{"2", "-", 
            RowBox[{"3", " ", "a"}], "+", 
            SuperscriptBox["a", "2"]}], ")"}]}], "\[NotEqual]", "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{
  3.859256619230576*^9, {3.8592566494846773`*^9, 3.8592566738394213`*^9}},
 CellLabel->
  "Out[173]=",ExpressionUUID->"4d3731d0-379e-434f-999f-3766a90c940a"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {"1", 
        RowBox[{"a", "\[Equal]", "1"}]},
       {
        RowBox[{"a", "+", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], "a"]}], 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "a"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "a"}], ")"}], " ", "a"}], "\[NotEqual]", 
         "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{
  3.859256619230576*^9, {3.8592566494846773`*^9, 3.859256673843315*^9}},
 CellLabel->
  "Out[174]=",ExpressionUUID->"22c81aed-7a28-4a92-8699-7faee089f493"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PiecewiseFullSimplifyOperator", "[", "variables", " ", "]"}], "[",
    "expression", "]"}], " "}]], "Input",
 CellChangeTimes->{{3.8592565098573437`*^9, 3.8592565098628063`*^9}, 
   3.859256623736286*^9},
 CellLabel->
  "In[165]:=",ExpressionUUID->"61b6d816-71e5-4ef4-b2c2-d2c7a5027fe7"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {"1", 
        RowBox[{"a", "\[Equal]", "1"}]},
       {
        RowBox[{"a", "+", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], "a"]}], 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "a"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "a"}], ")"}], " ", "a"}], "\[NotEqual]", 
         "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{3.859256624643553*^9},
 CellLabel->
  "Out[165]=",ExpressionUUID->"9d4e4b2d-a81e-4e93-bfc7-d85556184296"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Other piecewise operations", "Subsubsection",
 CellChangeTimes->{{3.859256306373783*^9, 
  3.859256313093791*^9}},ExpressionUUID->"03829598-235e-4d3c-8749-\
a1d192bb9c1f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PiecewiseReplace", "[", 
   RowBox[{"expression", ",", " ", "rules"}], "]"}], " "}]], "Input",
 CellChangeTimes->{{3.8592569964941072`*^9, 
  3.859256999697523*^9}},ExpressionUUID->"670df50d-e971-435b-960e-\
dc6ea3fd1346"],

Cell[BoxData[
 RowBox[{"PiecewiseEqualOperator", "[", "]"}]], "Input",ExpressionUUID->"13056ac9-c056-43f3-aa83-cdc0fca22f38"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<indVars\>\"", "->", 
      RowBox[{"{", "n", "}"}]}], ",", 
     RowBox[{"\"\<depVars\>\"", "->", 
      RowBox[{"{", "u", "}"}]}], ",", 
     RowBox[{"\"\<pars\>\"", "->", 
      RowBox[{"{", "a", "}"}]}]}], "|>"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"expression", "=", 
  RowBox[{"Piecewise", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "*", 
          RowBox[{
           RowBox[{"u", "[", "n", "]"}], "^", "2"}]}], "+", "3"}], ",", 
        RowBox[{"n", "<", "0"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"u", "[", 
         RowBox[{"n", "+", "1"}], "]"}], ",", 
        RowBox[{"n", ">=", "0"}]}], "}"}]}], "}"}], ",", "$Failed"}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"PiecewiseExtractGeneratorsOperator", "[", "variables", "]"}], "[", 
  "expression", "]"}]}], "Input",
 CellLabel->
  "In[150]:=",ExpressionUUID->"861a52b9-8ab4-43ee-ab8f-7468ae5b864a"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"3", "+", 
         RowBox[{"a", " ", 
          SuperscriptBox[
           RowBox[{"u", "[", "n", "]"}], "2"]}]}], 
        RowBox[{"n", "<", "0"}]},
       {
        RowBox[{"u", "[", 
         RowBox[{"1", "+", "n"}], "]"}], 
        RowBox[{"n", "\[GreaterEqual]", "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{3.8592563997935247`*^9},
 CellLabel->
  "Out[151]=",ExpressionUUID->"0e17b44e-d8b8-44db-b28c-e62626a879e6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"u", "[", "n", "]"}], ",", 
   RowBox[{"u", "[", 
    RowBox[{"1", "+", "n"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.859256399817021*^9},
 CellLabel->
  "Out[152]=",ExpressionUUID->"948af24f-2e5e-4168-bdaa-b77d28f2efe7"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Utilities", "Subsection",
 CellChangeTimes->{{3.86110157707504*^9, 
  3.861101592212655*^9}},ExpressionUUID->"4311a9c7-e5bd-448a-a08a-\
b9c574a197e4"],

Cell[BoxData["MKF"], "Input",
 CellChangeTimes->{{3.86110168664942*^9, 
  3.8611016872454433`*^9}},ExpressionUUID->"4bd2af94-6b4d-4fb9-960f-\
0990b2620848"],

Cell[BoxData["GetDependentVarsInstancesOperator"], "Input",
 CellChangeTimes->{{3.861101720979803*^9, 
  3.861101739902959*^9}},ExpressionUUID->"96563694-f1b4-4717-82ea-\
916976995915"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Regroup Parameters", "Subsection",
 CellChangeTimes->{{3.8592501774216413`*^9, 
  3.859250184976927*^9}},ExpressionUUID->"3bb16392-f4a1-406e-bc69-\
51a03c833056"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RegroupParametersOperator", "[", 
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{"\"\<pars\>\"", "->", 
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}]}], "}"}], "]"}], "]"}], "[", 
  RowBox[{
   RowBox[{"a", " ", "x"}], " ", "+", "x", "+", 
   RowBox[{
    RowBox[{"a", "^", "2"}], " ", 
    RowBox[{"x", "^", "2"}]}], "+", " ", "y", "+", " ", 
   RowBox[{"b", " ", 
    RowBox[{"x", "^", "2"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8592501858638687`*^9, 3.859250217960949*^9}},
 CellLabel->
  "In[143]:=",ExpressionUUID->"007f3345-0716-49d6-9fc4-ff81455b6251"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "+", "a"}], ")"}], " ", "x"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["a", "2"], "+", "b"}], ")"}], " ", 
   SuperscriptBox["x", "2"]}], "+", "y"}]], "Output",
 CellChangeTimes->{{3.859250187240593*^9, 3.859250218860952*^9}},
 CellLabel->
  "Out[143]=",ExpressionUUID->"613c71d4-7b04-4c3c-ba0a-7838b27ff0e4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equal To Zero and HomogeneousSolveAlways Operator", "Subsection",
 CellChangeTimes->{{3.85910275148523*^9, 3.859102757954678*^9}, {
  3.859248395931468*^9, 
  3.859248405086907*^9}},ExpressionUUID->"caac2498-0049-4f55-a1da-\
c359748626ed"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<generators\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"u", "[", "x", "]"}], ",", "x"}], "}"}]}], ",", " ", 
      RowBox[{"\"\<pars\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b", ",", "c"}], "}"}]}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EqualToZeroOperator", "[", "variables", "]"}], "[", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", "^", "2"}], "-", "1"}], ")"}], " ", 
    RowBox[{
     RowBox[{"u", "[", "x", "]"}], "^", "2"}]}], "+", 
   RowBox[{"b", " ", 
    RowBox[{
     RowBox[{"u", "[", "x", "]"}], "^", "a"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8591027728694344`*^9, 3.85910281735988*^9}, {
  3.8591029020120573`*^9, 3.859102918273232*^9}, {3.859102949665716*^9, 
  3.859102954811468*^9}},
 CellLabel->
  "In[246]:=",ExpressionUUID->"c129c220-26e6-431c-8622-f3ac5083485c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "\[Rule]", "2"}], ",", 
       RowBox[{"b", "\[Rule]", 
        RowBox[{"1", "-", 
         SuperscriptBox["c", "2"]}]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"a", "\[Equal]", "2"}], "&&", 
      RowBox[{"b", "\[Equal]", 
       RowBox[{"1", "-", 
        SuperscriptBox["c", "2"]}]}], "&&", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["c", "2"]}], "\[NotEqual]", "0"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"b", "\[Rule]", "0"}], ",", 
       RowBox[{"c", "\[Rule]", 
        RowBox[{"-", "1"}]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"b", "\[Equal]", "0"}], "&&", 
      RowBox[{"c", "\[Equal]", 
       RowBox[{"-", "1"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"b", "\[Rule]", "0"}], ",", 
       RowBox[{"c", "\[Rule]", "1"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"b", "\[Equal]", "0"}], "&&", 
      RowBox[{"c", "\[Equal]", "1"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.859102763292081*^9, 3.8591027910871563`*^9}, 
   3.859102833010117*^9, 3.859102919661982*^9, {3.859102951638733*^9, 
   3.859102956527577*^9}, 3.859340629558778*^9},
 CellLabel->
  "Out[247]=",ExpressionUUID->"2fd23bb9-40a0-4bd2-9e8c-791fc7aeeffc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<generators\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}], ",", " ", 
     RowBox[{"\"\<pars\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"a", ",", "b", ",", "c"}], "}"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ImprovedHomogeneousSolveAlwaysOperator", "[", "variables", "]"}], 
  "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", " ", "x"}], " ", "+", "b"}], ")"}], "^", "c"}], "\[Equal]",
    "0"}], "]"}]}], "Input",
 CellChangeTimes->{{3.859248392662162*^9, 3.859248392672147*^9}},
 CellLabel->
  "In[114]:=",ExpressionUUID->"8d13791d-f39f-4d73-9e8e-5942074cc14f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", "\[Rule]", "0"}], ",", 
      RowBox[{"b", "\[Rule]", "0"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"a", "\[Equal]", "0"}], "&&", 
     RowBox[{"b", "\[Equal]", "0"}], "&&", 
     RowBox[{"c", ">", "0"}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.85924840789671*^9},
 CellLabel->
  "Out[115]=",ExpressionUUID->"b98f82d7-63a8-42bc-a468-fb15dcbd39e0"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"SolveAlwaysOperator", "[", "]"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"not", " ", "documented"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.859258668230774*^9, 
  3.859258677609645*^9}},ExpressionUUID->"d328e72b-986d-4574-850e-\
94b76fd81e68"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Monomial dependence and parametric refine", "Subsection",
 CellChangeTimes->{{3.8592492273413982`*^9, 3.859249231540119*^9}, {
  3.859249287024617*^9, 
  3.8592492928158073`*^9}},ExpressionUUID->"51dc473a-9bd6-41ab-950f-\
db38bf8a5710"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", " ", "=", " ", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", "u", "}"}]}], ",", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}], ",", 
     RowBox[{"\"\<pars\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}]}]}], "|>"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"MonomialDependenceOperator", "[", "variables", "]"}], "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"u", "[", "x", "]"}], "^", "2"}], ",", 
    RowBox[{"a", " ", 
     RowBox[{
      RowBox[{"u", "[", "x", "]"}], "^", "b"}]}]}], "}"}], "]"}]}], "Input",
 CellLabel->
  "In[127]:=",ExpressionUUID->"8df024d6-fb66-4d17-adc6-54266fd9fb63"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", "\[Rule]", "0"}], ",", 
          RowBox[{"b", "\[Rule]", "2"}]}], "}"}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", "0"}], "&&", 
         RowBox[{"b", "\[Equal]", "2"}]}]},
       {
        RowBox[{"{", 
         RowBox[{"a", "\[Rule]", "0"}], "}"}], 
        RowBox[{"a", "\[Equal]", "0"}]},
       {
        RowBox[{"{", 
         RowBox[{"b", "\[Rule]", "2"}], "}"}], 
        RowBox[{"b", "\[Equal]", "2"}]},
       {
        RowBox[{"{", "}"}], 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{3.8592492356470747`*^9},
 CellLabel->
  "Out[128]=",ExpressionUUID->"2004864b-a56a-41d5-82b2-40450bb7ef8d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", " ", "=", " ", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "->", 
      RowBox[{"{", "u", "}"}]}], ",", 
     RowBox[{"\"\<indVars\>\"", "->", 
      RowBox[{"{", "x", "}"}]}], ",", 
     RowBox[{"\"\<pars\>\"", "->", 
      RowBox[{"{", "a", "}"}]}]}], "|>"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"exp", "=", 
   RowBox[{
    RowBox[{"u", "[", "x", "]"}], "+", 
    RowBox[{
     RowBox[{"u", "[", "x", "]"}], "^", "a"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"PiecewiseOperatorMap", "[", 
  RowBox[{"ParametricRefineOperator", ",", "variables", ",", "exp"}], 
  "]"}]}], "Input",
 CellChangeTimes->{3.859249300769616*^9},
 CellLabel->
  "In[132]:=",ExpressionUUID->"76f5794c-248f-4b9d-a83e-5d30d2d8cfd3"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"2", " ", 
         RowBox[{"u", "[", "x", "]"}]}], 
        RowBox[{"a", "\[Equal]", "1"}]},
       {
        RowBox[{
         RowBox[{"u", "[", "x", "]"}], "+", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], "a"]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "+", "a"}], "\[NotEqual]", "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{{3.859249297266796*^9, 3.859249301418103*^9}},
 CellLabel->
  "Out[134]=",ExpressionUUID->"7679ba64-a9c9-47e1-ab11-0ec9fe27299f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Other", "Subsection",
 CellChangeTimes->{{3.859250057306744*^9, 3.859250064883079*^9}, {
  3.859257113584071*^9, 
  3.859257115384697*^9}},ExpressionUUID->"d2c08158-93d9-4311-b18c-\
d7418bec4a32"],

Cell[BoxData["KroneckerDeltaOperator"], "Input",
 CellChangeTimes->{{3.8592571172860737`*^9, 
  3.859257120732329*^9}},ExpressionUUID->"136718ef-e337-40ff-b2f4-\
2ad30efea82c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Further ideas", "Subsection",
 CellChangeTimes->{{3.8584942255543737`*^9, 
  3.858494230752021*^9}},ExpressionUUID->"f1800d3f-e9fc-4aa4-b337-\
84bdfc688161"],

Cell["\<\
Build the \[OpenCurlyDoubleQuote]Perhaps\[CloseCurlyDoubleQuote] framework
Do we have a piecewisemap thread? Also it could be nice to have other \
constructs: piecewise fold, nest...\
\>", "Text",
 CellChangeTimes->{{3.859258029593195*^9, 3.859258038114481*^9}, {
  3.859258356509387*^9, 3.8592583593877974`*^9}, {3.859298707112241*^9, 
  3.8592987524760227`*^9}, {3.859340519811389*^9, 
  3.859340521057804*^9}},ExpressionUUID->"3d114692-433d-4229-b36a-\
037de528c7e7"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Kleisli category", "Section",
 CellChangeTimes->{{3.861101598958108*^9, 
  3.861101605957273*^9}},ExpressionUUID->"21e514b7-a8f6-4a5a-abe2-\
fd9921101c17"],

Cell["This is mostly of interest to developers", "Text",
 CellChangeTimes->{{3.861101609486712*^9, 
  3.8611016254252243`*^9}},ExpressionUUID->"6938b28b-77dc-41fe-afb5-\
a5f3cac8b462"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Linear Algebra", "Section",
 CellChangeTimes->{{3.858492939938949*^9, 
  3.858492950415399*^9}},ExpressionUUID->"3299be97-3ea1-431b-a23c-\
bbe5188706ef"],

Cell[CellGroupData[{

Cell["Gaussian Elimination", "Subsection",
 CellChangeTimes->{{3.85924855436447*^9, 
  3.859248561456201*^9}},ExpressionUUID->"249a3820-287a-46f6-bf04-\
b19ad66cf02c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"GaussianEliminationOperator", "[", 
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<pars\>\"", "\[Rule]", 
       RowBox[{"{", "a", "}"}]}], ",", " ", 
      RowBox[{"\"\<generators\>\"", "\[Rule]", 
       RowBox[{"{", "x", "}"}]}]}], "}"}], "]"}], "]"}], "[", 
  RowBox[{"Association", "[", 
   RowBox[{"{", 
    RowBox[{"\"\<matrix\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"a", "+", "x"}]}], "}"}]}], "}"}]}], "}"}], "]"}], 
  "]"}]], "Input",
 CellLabel->
  "In[119]:=",ExpressionUUID->"4bad1a16-6a40-4f04-a0eb-b07a7334ef40"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"matrix\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"\<\"vector\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.859248565516405*^9},
 CellLabel->
  "Out[119]=",ExpressionUUID->"a7f64fb5-1844-49e7-8c4a-f132735070c4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"LinearSystemSolveOperator", "[", 
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<pars\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}]}], ",", " ", 
      RowBox[{"\"\<generators\>\"", "\[Rule]", 
       RowBox[{"{", "x", "}"}]}]}], "}"}], "]"}], "]"}], "[", 
  RowBox[{"Association", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<matrix\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "+", 
           RowBox[{"a", " ", "x"}]}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "a"}], "}"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<vector\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"b", ",", "b"}], "}"}]}], ",", 
     RowBox[{"\"\<unknowns\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"w", ",", "z"}], "}"}]}]}], "}"}], "]"}], "]"}]], "Input",
 CellLabel->
  "In[120]:=",ExpressionUUID->"a9da7406-d389-42bc-a326-eeaaa0880632"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"w", "\[Rule]", 
           FractionBox["b", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", "a"}], ")"}], " ", "x"}]]}], ",", 
          RowBox[{"z", "\[Rule]", 
           FractionBox["b", "a"]}]}], "}"}], 
        RowBox[{
         RowBox[{"a", "\[NotEqual]", 
          RowBox[{"-", "1"}]}], "&&", 
         RowBox[{"a", "\[NotEqual]", "0"}]}]},
       {
        RowBox[{"{", 
         RowBox[{"w", "\[Rule]", "0"}], "}"}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", "0"}], "&&", 
         RowBox[{"b", "\[Equal]", "0"}]}]},
       {
        RowBox[{"{", 
         RowBox[{"z", "\[Rule]", "0"}], "}"}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", 
          RowBox[{"-", "1"}]}], "&&", 
         RowBox[{"b", "\[Equal]", "0"}]}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{3.859248584303966*^9},
 CellLabel->
  "Out[120]=",ExpressionUUID->"cdc49a47-4e5f-4361-a0d2-277a0be5d887"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"MatrixInverseOperator", "[", 
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<pars\>\"", "\[Rule]", 
       RowBox[{"{", "a", "}"}]}], ",", " ", 
      RowBox[{"\"\<generators\>\"", "\[Rule]", 
       RowBox[{"{", "x", "}"}]}]}], "}"}], "]"}], "]"}], "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", "^", "2"}], "-", "1"}], ")"}], "x"}], ",", "0"}], "}"}],
     ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"a", "+", "x"}]}], "}"}]}], "}"}], "]"}]], "Input",
 CellLabel->
  "In[121]:=",ExpressionUUID->"8a78f129-4f4e-4a4a-bea3-ee8b2ac923d0"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            FractionBox["1", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                SuperscriptBox["a", "2"]}], ")"}], " ", "x"}]], ",", "0"}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            FractionBox["1", 
             RowBox[{"a", "+", "x"}]]}], "}"}]}], "}"}], 
        RowBox[{
         RowBox[{"a", "\[NotEqual]", 
          RowBox[{"-", "1"}]}], "&&", 
         RowBox[{"a", "\[NotEqual]", "1"}]}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{3.8592486080334*^9},
 CellLabel->
  "Out[121]=",ExpressionUUID->"78d0a741-606b-4b25-88aa-3f0cfc914365"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"MatrixKernelOperator", "[", 
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<pars\>\"", "\[Rule]", 
       RowBox[{"{", "a", "}"}]}], ",", " ", 
      RowBox[{"\"\<generators\>\"", "\[Rule]", 
       RowBox[{"{", "x", "}"}]}]}], "}"}], "]"}], "]"}], "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", "^", "2"}], "-", "1"}], ")"}], "x"}], ",", "0"}], "}"}],
     ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"a", "+", "x"}]}], "}"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.859248751881003*^9, 3.8592487544919033`*^9}},
 CellLabel->
  "In[123]:=",ExpressionUUID->"5a0bd282-6d2a-4b7c-801d-82a436baa58c"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"{", "}"}], 
        RowBox[{
         RowBox[{"a", "\[NotEqual]", 
          RowBox[{"-", "1"}]}], "&&", 
         RowBox[{"a", "\[NotEqual]", "1"}]}]},
       {
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], "}"}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", 
          RowBox[{"-", "1"}]}], "||", 
         RowBox[{"a", "\[Equal]", "1"}]}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{3.859248755714395*^9},
 CellLabel->
  "Out[123]=",ExpressionUUID->"47025b23-ffbd-4089-871f-0cd327cc13ce"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Basis Operator", "Subsection",
 CellChangeTimes->{{3.858494394541473*^9, 
  3.858494399131257*^9}},ExpressionUUID->"f4f12220-de71-4238-99b4-\
48e1d6c17e32"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"BasisOperator", "[", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", "u", "}"}]}], ",", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}]}], "|>"}], "]"}], "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"u", "[", "x", "]"}], ",", 
    RowBox[{"2", " ", 
     RowBox[{"u", "[", "x", "]"}]}], ",", 
    RowBox[{
     RowBox[{"u", "'"}], "[", "x", "]"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.858494452382654*^9, 3.858494471605762*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"73a294fb-4546-4dd6-b0e0-3b0a69b11c00"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"u", "[", "x", "]"}], ",", 
   RowBox[{
    SuperscriptBox["u", "\[Prime]",
     MultilineFunction->None], "[", "x", "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.858494455922606*^9, 3.85849447231034*^9}},
 CellLabel->"Out[20]=",ExpressionUUID->"7bcdffcf-ef13-4e70-bd4d-33467eece9c5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<pars\>\"", "\[Rule]", 
      RowBox[{"{", "a", "}"}]}], ",", 
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", "u", "}"}]}], ",", " ", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}]}], "|>"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BasisOperator", "[", "variables", "]"}], "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"u", "[", "x", "]"}], ",", 
     RowBox[{"a", " ", 
      RowBox[{
       RowBox[{"u", "[", "x", "]"}], "^", "2"}]}], ",", " ", "x", ",", " ", 
     RowBox[{"x", "^", "a"}], ",", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "^", "2"}], "-", "4"}], ")"}], " ", 
      RowBox[{"x", "^", 
       RowBox[{"(", 
        RowBox[{"a", "-", "2"}], ")"}]}]}]}], "}"}], "]"}], "//", 
  RowBox[{
  "PiecewiseFullSimplifyOperator", "[", "variables", "]"}]}]}], "Input",
 CellChangeTimes->{{3.8584944079525948`*^9, 3.8584944224965467`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"08b91d09-4a8b-4e49-b6c6-81ff549e0aa7"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"-", 
           FractionBox["4", 
            SuperscriptBox["x", "2"]]}], ",", "1", ",", 
          RowBox[{"u", "[", "x", "]"}]}], "}"}], 
        RowBox[{"a", "\[Equal]", "0"}]},
       {
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"-", 
           FractionBox["3", "x"]}], ",", 
          RowBox[{"u", "[", "x", "]"}], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], "2"]}], "}"}], 
        RowBox[{"a", "\[Equal]", "1"}]},
       {
        RowBox[{"{", 
         RowBox[{"x", ",", 
          FractionBox["1", 
           SuperscriptBox["x", "2"]], ",", 
          RowBox[{"u", "[", "x", "]"}], ",", 
          RowBox[{
           RowBox[{"-", "2"}], " ", 
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], "2"]}]}], "}"}], 
        RowBox[{"a", "\[Equal]", 
         RowBox[{"-", "2"}]}]},
       {
        RowBox[{"{", 
         RowBox[{"x", ",", 
          SuperscriptBox["x", "2"], ",", 
          RowBox[{"u", "[", "x", "]"}], ",", 
          RowBox[{"2", " ", 
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], "2"]}]}], "}"}], 
        RowBox[{"a", "\[Equal]", "2"}]},
       {
        RowBox[{"{", 
         RowBox[{"x", ",", 
          SuperscriptBox["x", "3"], ",", 
          RowBox[{"u", "[", "x", "]"}], ",", 
          RowBox[{"3", " ", 
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], "2"]}]}], "}"}], 
        RowBox[{"a", "\[Equal]", "3"}]},
       {
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "4"}], "+", 
             SuperscriptBox["a", "2"]}], ")"}], " ", 
           SuperscriptBox["x", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "a"}]]}], ",", 
          SuperscriptBox["x", "a"], ",", 
          RowBox[{"u", "[", "x", "]"}], ",", 
          RowBox[{"a", " ", 
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], "2"]}]}], "}"}], 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "3"}], "+", "a"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "a"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "a"}], ")"}], " ", "a", " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", "a"}], ")"}]}], "\[NotEqual]", "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{{3.8584944041046667`*^9, 3.858494423336575*^9}},
 CellLabel->"Out[18]=",ExpressionUUID->"c43b6189-01fc-4a29-8119-b7fc31fa7fe1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Undetermined coefficients methods", "Subsection",
 CellChangeTimes->{{3.85924864394925*^9, 
  3.8592486528440447`*^9}},ExpressionUUID->"1d259232-3680-4cf8-b99c-\
e7c3e023ac7a"],

Cell[CellGroupData[{

Cell["Monomial generation", "Subsubsection",
 CellChangeTimes->{{3.859249330505188*^9, 
  3.859249336015109*^9}},ExpressionUUID->"7553b524-97f2-4084-a028-\
7f2b9fee1b70"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "->", 
      RowBox[{"{", "u", "}"}]}], ",", " ", 
     RowBox[{"\"\<indVars\>\"", "->", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"MonomialsOperator", "[", "variables", "]"}], "[", 
  "\[IndentingNewLine]", 
  RowBox[{"<|", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\"\<degree\>\"", "->", "2"}], ",", "\[IndentingNewLine]", " ", 
    RowBox[{"\"\<derivatives\>\"", "->", "2"}], ",", "\n", "      ", 
    RowBox[{"\"\<homogeneousderivatives\>\"", "->", "True"}], ",", 
    "\[IndentingNewLine]", " ", 
    RowBox[{"\"\<homogeneousdegree\>\"", "->", "False"}], ",", 
    "\[IndentingNewLine]", " ", 
    RowBox[{"\"\<type\>\"", "->", "\"\<Even\>\""}]}], "\[IndentingNewLine]", 
   "|>"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8592498105715714`*^9, 
  3.85924987114132*^9}},ExpressionUUID->"8536d65d-6508-4b28-92bf-\
d6ae32efb9ff"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SuperscriptBox[
    RowBox[{
     SuperscriptBox["u", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "2"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"x", ",", "y"}], "]"}], "2"], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["u", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "2"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"x", ",", "y"}], "]"}], " ", 
    RowBox[{
     SuperscriptBox["u", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"1", ",", "1"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"x", ",", "y"}], "]"}]}], ",", 
   SuperscriptBox[
    RowBox[{
     SuperscriptBox["u", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"1", ",", "1"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"x", ",", "y"}], "]"}], "2"], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["u", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "2"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"x", ",", "y"}], "]"}], " ", 
    RowBox[{
     SuperscriptBox["u", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"2", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"x", ",", "y"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["u", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"1", ",", "1"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"x", ",", "y"}], "]"}], " ", 
    RowBox[{
     SuperscriptBox["u", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"2", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"x", ",", "y"}], "]"}]}], ",", 
   SuperscriptBox[
    RowBox[{
     SuperscriptBox["u", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"2", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"x", ",", "y"}], "]"}], "2"]}], "}"}]], "Output",
 CellChangeTimes->{{3.8592498550053368`*^9, 3.859249862945879*^9}},
 CellLabel->
  "Out[138]=",ExpressionUUID->"82abce46-5e02-4359-96d9-26de560a7b15"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generic Linear combinations", "Subsubsection",
 CellChangeTimes->{{3.8592493389238663`*^9, 
  3.859249344657681*^9}},ExpressionUUID->"5d318674-bf8a-4378-b86c-\
ddf91be32f64"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"GenericLinearCombinationOperator", "[", 
   RowBox[{"<|", "|>"}], "]"}], "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"u", "[", "x", "]"}], ",", 
    RowBox[{
     RowBox[{"u", "'"}], "[", "x", "]"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.859248656579898*^9, 3.859248668250053*^9}},
 CellLabel->
  "In[264]:=",ExpressionUUID->"308db3df-ac56-4f18-a9a1-2881d00f4b28"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["\[FormalA]", "1"], " ", 
     RowBox[{"u", "[", "x", "]"}]}], "+", 
    RowBox[{
     SubscriptBox["\[FormalA]", "2"], " ", 
     RowBox[{
      SuperscriptBox["u", "\[Prime]",
       MultilineFunction->None], "[", "x", "]"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[FormalA]", "1"], ",", 
     SubscriptBox["\[FormalA]", "2"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.85924866980796*^9, 3.859351611348887*^9},
 CellLabel->
  "Out[264]=",ExpressionUUID->"e09ebc5b-89d6-42a4-a83d-c192712d8111"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Undetermined coefficients solver", "Subsubsection",
 CellChangeTimes->{{3.859249348955451*^9, 3.859249351298204*^9}, {
  3.85925840553362*^9, 
  3.859258413504621*^9}},ExpressionUUID->"522ab974-afeb-4c5f-85ee-\
dcaa9d5b242b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", "\[IndentingNewLine]", 
   RowBox[{"Association", "[", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", " ", 
     RowBox[{
      RowBox[{"\"\<pars\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<depVars\>\"", "\[Rule]", 
       RowBox[{"{", "u", "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<indVars\>\"", "\[Rule]", 
       RowBox[{"{", "x", "}"}]}]}], "\[IndentingNewLine]", "}"}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SolveUndeterminedCoefficientsOperator", "[", "variables", "]"}], 
  "[", "\[IndentingNewLine]", 
  RowBox[{"Association", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<expression\>\"", "->", 
      RowBox[{
       RowBox[{"a", " ", "X"}], "+", 
       RowBox[{"b", " ", "Y"}]}]}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{"\"\<coefficients\>\"", "->", 
      RowBox[{"{", 
       RowBox[{"X", ",", "Y", ",", "Z"}], "}"}]}]}], "}"}], "]"}], 
  "]"}]}], "Input",
 CellLabel->
  "In[182]:=",ExpressionUUID->"ac41955c-382f-452f-a86f-6fc50f0b4a90"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"{", 
         RowBox[{"X", "\[Rule]", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{"b", " ", "Y"}], "a"]}]}], "}"}], 
        RowBox[{"a", "\[NotEqual]", "0"}]},
       {
        RowBox[{"{", 
         RowBox[{"Y", "\[Rule]", "0"}], "}"}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", "0"}], "&&", 
         RowBox[{"b", "\[NotEqual]", "0"}]}]},
       {
        RowBox[{"{", "}"}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", "0"}], "&&", 
         RowBox[{"b", "\[Equal]", "0"}]}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{3.8592587474453583`*^9},
 CellLabel->
  "Out[183]=",ExpressionUUID->"13f12f4b-16ab-4c0d-bcc0-adfdebbe25c2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SolveUndeterminedCoefficientsOperator", "[", "variables", "]"}], 
  "[", "\[IndentingNewLine]", 
  RowBox[{"Association", "[", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<expression\>\"", "->", 
      RowBox[{"a", "-", 
       RowBox[{"c", " ", "X"}], "+", 
       RowBox[{"a", " ", "Y"}], "+", "Z", "+", 
       RowBox[{"X", " ", 
        SuperscriptBox[
         RowBox[{
          RowBox[{"u", "'"}], "[", 
          RowBox[{"x", "+", "1"}], "]"}], "2"]}]}]}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<coefficients\>\"", "->", 
      RowBox[{"{", 
       RowBox[{"X", ",", "Y", ",", "Z"}], "}"}]}]}], "\[IndentingNewLine]", 
    "}"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.859258774634647*^9, 3.859258786048297*^9}},
 CellLabel->
  "In[188]:=",ExpressionUUID->"a2341ab4-dde3-4f35-81a4-dba954b861d5"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"X", "\[Rule]", "0"}], ",", 
          RowBox[{"Y", "\[Rule]", 
           FractionBox[
            RowBox[{
             RowBox[{"-", "a"}], "-", "Z"}], "a"]}]}], "}"}], 
        RowBox[{"a", "\[NotEqual]", "0"}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"X", "\[Rule]", "0"}], ",", 
          RowBox[{"Z", "\[Rule]", "0"}]}], "}"}], 
        RowBox[{"a", "\[Equal]", "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{{3.859258771951847*^9, 3.859258786525177*^9}},
 CellLabel->
  "Out[188]=",ExpressionUUID->"4a6bbbb3-db7e-4d9d-8248-faf0941454cf"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Undetermined coefficients ingredients", "Subsubsection",
 CellChangeTimes->{{3.8592588034346848`*^9, 
  3.859258813191333*^9}},ExpressionUUID->"b0d81635-f58e-474e-859f-\
ca7da795810f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", "\[IndentingNewLine]", 
   RowBox[{"Association", "[", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<coefficients\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"X", ",", "Y"}], "}"}]}], ",", "\[IndentingNewLine]", " ", 
      RowBox[{"\"\<pars\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}]}]}], "}"}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UndeterminedCoefficientsOperator", "[", "variables", "]"}], "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"a", " ", "X"}], "+", 
     RowBox[{"b", " ", "Y"}]}], " ", ",", " ", 
    RowBox[{"X", "-", "Y"}]}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UndeterminedCoefficientsMatrixOperator", "[", "variables", "]"}], 
  "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"a", " ", "X"}], "+", 
     RowBox[{"b", " ", "Y"}]}], " ", ",", " ", 
    RowBox[{"X", "-", "Y"}]}], "}"}], "]"}], "\[IndentingNewLine]"}], "Input",\

 CellChangeTimes->{{3.859258837289538*^9, 
  3.859258891305496*^9}},ExpressionUUID->"56e5ea32-1a7b-4270-a3ff-\
a9da48aaff1c"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"matrix\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ",", 
   RowBox[{"\<\"vector\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}]}], ",", 
   RowBox[{"\<\"factors\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.859258838492811*^9, 3.859258883351327*^9}},
 CellLabel->
  "Out[199]=",ExpressionUUID->"bbe88269-cd8a-4532-8762-c20d600635fc"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"matrix\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ",", 
   RowBox[{"\<\"factors\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.859258838492811*^9, 3.8592588833554564`*^9}},
 CellLabel->
  "Out[200]=",ExpressionUUID->"097c11b7-e760-414e-98a3-b3e62d09ffe7"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"matrix\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ",", 
   RowBox[{"\<\"vector\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}]}], ",", 
   RowBox[{"\<\"factors\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.859258838492811*^9, 3.859258883359226*^9}},
 CellLabel->
  "Out[201]=",ExpressionUUID->"45914e4f-0e56-4649-a964-66f4c2941af1"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Further ideas", "Subsection",
 CellChangeTimes->{{3.8584942255543737`*^9, 
  3.858494230752021*^9}},ExpressionUUID->"0b05244f-f5cc-4584-93a7-\
5332d6df4c7a"],

Cell["Here are some additional extensions that can be done", "Text",
 CellChangeTimes->{{3.858494278857666*^9, 
  3.858494292033298*^9}},ExpressionUUID->"b7aba881-485f-4be8-9a4e-\
a2cecbcd9b59"],

Cell[CellGroupData[{

Cell["Support for fields other than reals", "Subsubsection",
 CellChangeTimes->{{3.859531358835792*^9, 
  3.859531369939762*^9}},ExpressionUUID->"8b0f1559-a968-4723-a288-\
f87753b31920"],

Cell["\<\
Gaussian elimination supports various fields BUT this is not fully tested ... \
\>", "Text",
 CellChangeTimes->{{3.8595313723594217`*^9, 
  3.859531409430016*^9}},ExpressionUUID->"0c3efae7-57af-4fc0-8b63-\
faa20900fd0e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Basis Mod Linear operator", "Subsubsection",
 CellChangeTimes->{{3.858494232511902*^9, 
  3.858494242017455*^9}},ExpressionUUID->"b55b2bc0-b348-4b90-8f9f-\
41ebefd5e2a9"],

Cell["\<\
The idea is to have a single basis mod linear operator that can be used for \
mod null lagrangians, etc\
\>", "Text",
 CellChangeTimes->{{3.8584942490468493`*^9, 3.8584942724221992`*^9}, {
  3.859258060336972*^9, 
  3.8592580614016533`*^9}},ExpressionUUID->"dcd711d9-ed4c-41bd-bf7e-\
9cca59bfa0b8"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Nonlinear Algebra", "Section",
 CellChangeTimes->{{3.858494320915264*^9, 
  3.85849432858628*^9}},ExpressionUUID->"1ad90fbc-7423-4aa5-a72a-\
f0274b66c25e"],

Cell["\<\
This remains to be done - one of the things to do is the parametric groebner \
basis.\
\>", "Text",
 CellChangeTimes->{{3.858494329684165*^9, 
  3.8584943532335978`*^9}},ExpressionUUID->"17330bcd-49f2-44b9-a9e4-\
6bf30f1d6180"],

Cell[CellGroupData[{

Cell["Further ideas", "Subsection",
 CellChangeTimes->{{3.8584942255543737`*^9, 
  3.858494230752021*^9}},ExpressionUUID->"1421eb0e-d6a8-460d-b74b-\
1082989d2ca2"],

Cell[CellGroupData[{

Cell["Monomial Orders", "Subsubsection",
 CellChangeTimes->{{3.8595315359683647`*^9, 
  3.859531542017242*^9}},ExpressionUUID->"be5ce378-7132-408b-bea1-\
09f124bb12e9"],

Cell["\<\
Build lexicographic, degree reverse lexicographic monomial order functions;
Sort monomials by arbitrary orders\
\>", "Text",
 CellChangeTimes->{{3.859531613041967*^9, 
  3.859531659330188*^9}},ExpressionUUID->"d6e6f2a5-60f0-4002-971b-\
23598660b66e"]
}, Open  ]],

Cell["Polynomial division", "Subsubsection",
 CellChangeTimes->{{3.859531436361931*^9, 
  3.8595314411049843`*^9}},ExpressionUUID->"7ef85fcb-e44f-44b1-8a63-\
1f5e1eae6b50"],

Cell[CellGroupData[{

Cell["Reduced Polynomial Basis/Reduced Ideal generator", "Subsubsection",
 CellChangeTimes->{{3.8592580636678953`*^9, 
  3.859258097126439*^9}},ExpressionUUID->"7419263d-b35c-42b3-876d-\
1b9f3dc43a79"],

Cell["\<\
Given a set of polynomials, build a polynomial basis or the reduced ideal \
generator. This is the same kind of technology as for systems of linear PDEs, \
which is already drafted...\
\>", "Text",
 CellChangeTimes->{{3.859258100281289*^9, 3.859258120483037*^9}, {
  3.859258489241333*^9, 3.859258511863071*^9}, {3.859258555290162*^9, 
  3.8592585666566*^9}},ExpressionUUID->"d8dd2be2-5b13-4ba3-a255-d5c0d1647d73"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Groebner Basis", "Subsubsection",
 CellChangeTimes->{{3.859531566082111*^9, 
  3.859531571479062*^9}},ExpressionUUID->"7126f39d-caa0-447d-8f97-\
50b475ad94d6"],

Cell["Compute Groebner with taking into account parameters", "Text",
 CellChangeTimes->{{3.8595315771001167`*^9, 
  3.859531597414538*^9}},ExpressionUUID->"c4e24b9b-2446-4f9c-8d95-\
307fda832351"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Variational Calculus", "Section",
 CellChangeTimes->{{3.858492914303948*^9, 
  3.858492924896769*^9}},ExpressionUUID->"156248cd-5e9b-4d16-a7cd-\
09fb1d421b68"],

Cell[CellGroupData[{

Cell["Variational derivatives", "Subsection",
 CellChangeTimes->{{3.8592500245796747`*^9, 
  3.859250029450425*^9}},ExpressionUUID->"b1c01f4d-7e2d-4d4d-9745-\
1b7667bb80ea"],

Cell[CellGroupData[{

Cell["Discrete Variational Derivatives Operator", "Subsubsection",
 CellChangeTimes->{{3.859102604110914*^9, 
  3.859102620509862*^9}},ExpressionUUID->"efe479e4-b942-4edc-9708-\
71aa3b3b0a9f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"DVarDOperator", "[", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", "u", "}"}]}], ",", 
     RowBox[{"\"\<indVars\>\"", " ", "\[Rule]", " ", 
      RowBox[{"{", "n", "}"}]}]}], "|>"}], "]"}], "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"u", "[", 
      RowBox[{"n", "+", "1"}], "]"}], "-", 
     RowBox[{"u", "[", "n", "]"}]}], ")"}], "^", "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.859102625239399*^9, 3.859102642756219*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"c759d76d-1861-4a62-87e1-ed1f12fb58a0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"u", "[", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], "]"}]}], "+", 
      RowBox[{"u", "[", "n", "]"}]}], ")"}]}], "-", 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"u", "[", "n", "]"}]}], "+", 
      RowBox[{"u", "[", 
       RowBox[{"1", "+", "n"}], "]"}]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8591026362790623`*^9, 3.8591026448879232`*^9}},
 CellLabel->"Out[62]=",ExpressionUUID->"43e5688b-d108-4761-8ba2-ca0103242ba8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Partial Variational Derivative", "Subsubsection",
 CellChangeTimes->{{3.85925003543041*^9, 
  3.859250041236274*^9}},ExpressionUUID->"6e981ce6-3854-4776-8f41-\
48a73227ca2d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"u", ",", "v"}], "}"}]}], ",", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"n", ",", "l"}], "}"}]}], ",", 
     RowBox[{"\"\<timeVars\>\"", "\[Rule]", 
      RowBox[{"{", "l", "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PartialDVarDOperator", "[", "variables", "]"}], "[", 
  RowBox[{
   RowBox[{"u", "[", 
    RowBox[{"n", ",", "l"}], "]"}], "-", 
   RowBox[{
    RowBox[{"u", "[", 
     RowBox[{
      RowBox[{"n", "+", "1"}], ",", 
      RowBox[{"l", "+", "1"}]}], "]"}], " ", 
    RowBox[{"v", "[", 
     RowBox[{"n", ",", "l"}], "]"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.834046335009293*^9, 3.8340463416327*^9}},
 CellLabel->"In[139]:=",
 CellID->527423912,ExpressionUUID->"01ced711-d53a-4949-a552-d2e147d5da13"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"KroneckerDeltaOperator", "[", "l", "]"}], "-", 
    RowBox[{
     RowBox[{"KroneckerDeltaOperator", "[", 
      RowBox[{"1", "+", "l"}], "]"}], " ", 
     RowBox[{"v", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "+", "n"}], ",", "l"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"KroneckerDeltaOperator", "[", "l", "]"}]}], " ", 
    RowBox[{"u", "[", 
     RowBox[{
      RowBox[{"1", "+", "n"}], ",", 
      RowBox[{"1", "+", "l"}]}], "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.83404634266897*^9, 3.834046350917985*^9}, {
   3.8340463909257603`*^9, 3.834046396174037*^9}, 3.8340465942641706`*^9, 
   3.847334648955064*^9, 3.8473353079966993`*^9, 3.859250047390749*^9},
 CellLabel->
  "Out[140]=",ExpressionUUID->"71d7a8de-fd4a-46bf-a520-5a76d7bef828"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Variational Derivative", "Subsubsection",
 CellChangeTimes->{{3.85925031091297*^9, 
  3.8592503160610237`*^9}},ExpressionUUID->"738c2529-b38a-4de3-9cc4-\
51490ac162d5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"VarDOperator", "[", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", " ", "\[Rule]", " ", 
      RowBox[{"{", "u", "}"}]}], ",", " ", 
     RowBox[{"\"\<indVars\>\"", " ", "\[Rule]", " ", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}]}]}], "|>"}], "]"}], "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Derivative", "[", 
       RowBox[{"1", ",", "0"}], "]"}], "[", "u", "]"}], "[", 
     RowBox[{"x", ",", "y"}], "]"}], "^", "2"}], " ", "+", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Derivative", "[", 
       RowBox[{"0", ",", "1"}], "]"}], "[", "u", "]"}], "[", 
     RowBox[{"x", ",", "y"}], "]"}], "^", "2"}]}], "]"}]], "Input",
 CellLabel->
  "In[144]:=",ExpressionUUID->"85a3d164-4880-445d-879b-cdf7c1f1ff9d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "2"}], " ", 
    RowBox[{
     SuperscriptBox["u", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "2"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"x", ",", "y"}], "]"}]}], "-", 
   RowBox[{"2", " ", 
    RowBox[{
     SuperscriptBox["u", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"2", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"x", ",", "y"}], "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.859250320427518*^9},
 CellLabel->
  "Out[144]=",ExpressionUUID->"9e9cc462-494d-44f6-9ee9-cc06ea8b54d7"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Clean Null Lagrangians", "Subsection",
 CellChangeTimes->{{3.858495177201909*^9, 
  3.858495187904574*^9}},ExpressionUUID->"f46ec1ff-b5f6-4552-a37d-\
490f6159fa64"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"CleanNullLagrangiansOperator", "[", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", " ", "->", " ", 
      RowBox[{"{", "u", "}"}]}], ",", " ", 
     RowBox[{"\"\<indVars\>\"", " ", "->", " ", 
      RowBox[{"{", "x", "}"}]}]}], "|>"}], "]"}], "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"u", "[", "x", "]"}], "^", "2"}], ",", " ", 
    RowBox[{
     RowBox[{"u", "[", "x", "]"}], " ", 
     RowBox[{
      RowBox[{"u", "'"}], "[", "x", "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"u", "'"}], "[", "x", "]"}], "^", "2"}], ",", "  ", 
    RowBox[{
     RowBox[{"u", "[", "x", "]"}], " ", 
     RowBox[{
      RowBox[{"u", "''"}], "[", "x", "]"}]}]}], "}"}], "]"}]], "Input",
 CellLabel->"In[22]:=",ExpressionUUID->"a1be2ca4-8994-4bbc-bcda-2eabf98fd219"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"u", "[", "x", "]"}], "2"], ",", 
   SuperscriptBox[
    RowBox[{
     SuperscriptBox["u", "\[Prime]",
      MultilineFunction->None], "[", "x", "]"}], "2"], ",", 
   RowBox[{
    RowBox[{"u", "[", "x", "]"}], " ", 
    RowBox[{
     SuperscriptBox["u", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "x", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.858495192141366*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"66fd2b61-e91e-4e24-9452-c01b388f2e74"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"CleanNullLagrangiansOperator", "[", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", " ", "->", " ", 
      RowBox[{"{", "u", "}"}]}], ",", " ", 
     RowBox[{"\"\<indVars\>\"", " ", "->", " ", 
      RowBox[{"{", "x", "}"}]}]}], "|>"}], "]"}], "[", 
  RowBox[{
   RowBox[{
    RowBox[{"u", "[", "x", "]"}], "^", "2"}], "+", " ", 
   RowBox[{
    RowBox[{"u", "[", "x", "]"}], " ", 
    RowBox[{
     RowBox[{"u", "'"}], "[", "x", "]"}]}], "+", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"u", "'"}], "[", "x", "]"}], "^", "2"}], "+", "  ", 
   RowBox[{
    RowBox[{"u", "[", "x", "]"}], " ", 
    RowBox[{
     RowBox[{"u", "''"}], "[", "x", "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8584951968739*^9, 3.8584952060161753`*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"19f62023-74f4-43cf-ac28-77c71c09d782"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"u", "[", "x", "]"}], "2"], "+", 
  SuperscriptBox[
   RowBox[{
    SuperscriptBox["u", "\[Prime]",
     MultilineFunction->None], "[", "x", "]"}], "2"], "+", 
  RowBox[{
   RowBox[{"u", "[", "x", "]"}], " ", 
   RowBox[{
    SuperscriptBox["u", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "x", "]"}]}]}]], "Output",
 CellChangeTimes->{3.858495207321826*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"031a5bad-d943-4b91-85d5-254a318cbbcd"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Basis Mod Null Lagrangians", "Subsection",
 CellChangeTimes->{{3.858494036418433*^9, 
  3.8584940461309137`*^9}},ExpressionUUID->"f6c54b2c-29b4-4159-8a50-\
07c8d13e1b74"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<depVars\>\"", "\[Rule]", 
       RowBox[{"{", "u", "}"}]}], ",", 
      RowBox[{"\"\<indVars\>\"", "\[Rule]", 
       RowBox[{"{", "x", "}"}]}], ",", 
      RowBox[{"\"\<pars\>\"", "\[Rule]", 
       RowBox[{"{", "a", "}"}]}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BasisModNullLagrangiansOperator", "[", "variables", "]"}], "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"u", "[", "x", "]"}], "^", "a"}], ",", 
    RowBox[{
     RowBox[{"u", "[", "x", "]"}], "^", "2"}]}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.85849406651598*^9, 3.8584940773700123`*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"baff7f2c-0a5f-4405-bfe6-d22747a527bb"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"{", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], "2"], "}"}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", "0"}], "||", 
         RowBox[{"a", "\[Equal]", "2"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], "2"], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], "a"]}], "}"}], 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "a"}], ")"}], " ", "a"}], "\[NotEqual]", 
         "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{{3.858494052718882*^9, 3.858494078449614*^9}},
 CellLabel->"Out[14]=",ExpressionUUID->"905532eb-6b3a-432c-a0bf-8492d8d9b8f6"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equivalents by Integration and Summing by parts", "Subsection",
 CellChangeTimes->{{3.859103093608404*^9, 
  3.8591031104492073`*^9}},ExpressionUUID->"743b2c8b-f24d-4792-af17-\
adde725817dc"],

Cell[CellGroupData[{

Cell["Discrete Equivalents", "Subsubsection",
 CellChangeTimes->{{3.858496509543692*^9, 
  3.858496517211008*^9}},ExpressionUUID->"c2ba9341-730a-4851-9ce8-\
a8b8d89eb5a1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", "u", "}"}]}], ",", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}]}], ",", " ", 
     RowBox[{"\"\<pars\>\"", "\[Rule]", 
      RowBox[{"{", "a", "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DiscreteEquivalentsOperator", "[", "variables", "]"}], "[", 
  RowBox[{
   RowBox[{
    RowBox[{"u", "[", 
     RowBox[{
      RowBox[{"x", "+", "1"}], ",", 
      RowBox[{"y", "+", "1"}]}], "]"}], "^", "a"}], " ", "+", 
   RowBox[{"u", "[", 
    RowBox[{"x", ",", "y"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.858496676101863*^9, 3.8584966762674093`*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"a5eb0643-ff0d-4856-a8c3-8052c9f47b6c"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"u", "[", 
           RowBox[{"x", ",", "y"}], "]"}], ",", 
          RowBox[{"u", "[", 
           RowBox[{
            RowBox[{"1", "+", "x"}], ",", 
            RowBox[{"1", "+", "y"}]}], "]"}]}], "}"}], 
        RowBox[{"a", "\[Equal]", "1"}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"u", "[", 
           RowBox[{"x", ",", "y"}], "]"}], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "a"], ",", 
          RowBox[{"u", "[", 
           RowBox[{
            RowBox[{"1", "+", "x"}], ",", 
            RowBox[{"1", "+", "y"}]}], "]"}]}], "}"}], 
        RowBox[{"a", "\[Equal]", "0"}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"u", "[", 
           RowBox[{"x", ",", "y"}], "]"}], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "a"], ",", 
          RowBox[{"u", "[", 
           RowBox[{
            RowBox[{"1", "+", "x"}], ",", 
            RowBox[{"1", "+", "y"}]}], "]"}], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", 
            RowBox[{
             RowBox[{"1", "+", "x"}], ",", 
             RowBox[{"1", "+", "y"}]}], "]"}], "a"]}], "}"}], 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "a"}], ")"}], " ", "a"}], "\[NotEqual]", 
         "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{{3.858496520280191*^9, 3.8584965296603403`*^9}, 
   3.858496676930986*^9},
 CellLabel->"Out[42]=",ExpressionUUID->"55a90ee3-246b-4316-b942-b3d21311bed6"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equivalents (and fast equivalents) by integration by parts", \
"Subsubsection",
 CellChangeTimes->{{3.859103173263976*^9, 3.859103193028537*^9}, {
  3.859103570428561*^9, 
  3.859103574819105*^9}},ExpressionUUID->"3f03187b-818a-439b-ace3-\
fad22720843d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", " ", "=", " ", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", " ", 
      RowBox[{"{", "u", "}"}]}], ",", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}], ",", 
     RowBox[{"\"\<pars\>\"", "->", 
      RowBox[{"{", "a", "}"}]}]}], "|>"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EquivalentsByIntegrationByPartsOperator", "[", "variables", "]"}], 
  "[", 
  RowBox[{
   RowBox[{
    RowBox[{"u", "[", "x", "]"}], "^", "a"}], " ", 
   RowBox[{
    RowBox[{"u", "''''"}], "[", "x", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8591032926501827`*^9, 3.859103326531785*^9}, {
  3.8591033635144043`*^9, 
  3.859103365078867*^9}},ExpressionUUID->"e9511f56-3bb2-49b6-a133-\
88a765dc7bc5"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "a"}], "+", 
             RowBox[{"3", " ", 
              SuperscriptBox["a", "2"]}], "-", 
             SuperscriptBox["a", "3"]}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], 
            RowBox[{
             RowBox[{"-", "3"}], "+", "a"}]], " ", 
           SuperscriptBox[
            RowBox[{
             SuperscriptBox["u", "\[Prime]",
              MultilineFunction->None], "[", "x", "]"}], "4"]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "a"}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["a", "2"]}]}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], 
            RowBox[{
             RowBox[{"-", "2"}], "+", "a"}]], " ", 
           SuperscriptBox[
            RowBox[{
             SuperscriptBox["u", "\[Prime]",
              MultilineFunction->None], "[", "x", "]"}], "2"], " ", 
           RowBox[{
            SuperscriptBox["u", "\[Prime]\[Prime]",
             MultilineFunction->None], "[", "x", "]"}]}], ",", 
          RowBox[{"a", " ", 
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], 
            RowBox[{
             RowBox[{"-", "1"}], "+", "a"}]], " ", 
           SuperscriptBox[
            RowBox[{
             SuperscriptBox["u", "\[Prime]\[Prime]",
              MultilineFunction->None], "[", "x", "]"}], "2"]}], ",", 
          RowBox[{
           RowBox[{"-", "a"}], " ", 
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], 
            RowBox[{
             RowBox[{"-", "1"}], "+", "a"}]], " ", 
           RowBox[{
            SuperscriptBox["u", "\[Prime]",
             MultilineFunction->None], "[", "x", "]"}], " ", 
           RowBox[{
            SuperscriptBox["u", 
             TagBox[
              RowBox[{"(", "3", ")"}],
              Derivative],
             MultilineFunction->None], "[", "x", "]"}]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], "a"], " ", 
           RowBox[{
            SuperscriptBox["u", 
             TagBox[
              RowBox[{"(", "4", ")"}],
              Derivative],
             MultilineFunction->None], "[", "x", "]"}]}]}], "}"}], 
        RowBox[{
         RowBox[{
          RowBox[{"2", " ", "a"}], "-", 
          RowBox[{"3", " ", 
           SuperscriptBox["a", "2"]}], "+", 
          SuperscriptBox["a", "3"]}], "\[NotEqual]", "0"}]},
       {"$Failed", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "\[NotEqual]", "0"}], "&&", 
           RowBox[{"a", "\[NotEqual]", "1"}], "&&", 
           RowBox[{"a", "\[NotEqual]", "2"}]}], ")"}], "||", 
         RowBox[{
          RowBox[{
           RowBox[{"2", " ", "a"}], "-", 
           RowBox[{"3", " ", 
            SuperscriptBox["a", "2"]}], "+", 
           SuperscriptBox["a", "3"]}], "\[NotEqual]", "0"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "a"}], "+", 
             SuperscriptBox["a", "2"]}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], 
            RowBox[{
             RowBox[{"-", "2"}], "+", "a"}]], " ", 
           SuperscriptBox[
            RowBox[{
             SuperscriptBox["u", "\[Prime]",
              MultilineFunction->None], "[", "x", "]"}], "2"], " ", 
           RowBox[{
            SuperscriptBox["u", "\[Prime]\[Prime]",
             MultilineFunction->None], "[", "x", "]"}]}], ",", 
          RowBox[{"a", " ", 
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], 
            RowBox[{
             RowBox[{"-", "1"}], "+", "a"}]], " ", 
           SuperscriptBox[
            RowBox[{
             SuperscriptBox["u", "\[Prime]\[Prime]",
              MultilineFunction->None], "[", "x", "]"}], "2"]}], ",", 
          RowBox[{
           RowBox[{"-", "a"}], " ", 
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], 
            RowBox[{
             RowBox[{"-", "1"}], "+", "a"}]], " ", 
           RowBox[{
            SuperscriptBox["u", "\[Prime]",
             MultilineFunction->None], "[", "x", "]"}], " ", 
           RowBox[{
            SuperscriptBox["u", 
             TagBox[
              RowBox[{"(", "3", ")"}],
              Derivative],
             MultilineFunction->None], "[", "x", "]"}]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], "a"], " ", 
           RowBox[{
            SuperscriptBox["u", 
             TagBox[
              RowBox[{"(", "4", ")"}],
              Derivative],
             MultilineFunction->None], "[", "x", "]"}]}]}], "}"}], 
        RowBox[{"a", "\[Equal]", "2"}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", " ", 
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], 
            RowBox[{
             RowBox[{"-", "1"}], "+", "a"}]], " ", 
           SuperscriptBox[
            RowBox[{
             SuperscriptBox["u", "\[Prime]\[Prime]",
              MultilineFunction->None], "[", "x", "]"}], "2"]}], ",", 
          RowBox[{
           RowBox[{"-", "a"}], " ", 
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], 
            RowBox[{
             RowBox[{"-", "1"}], "+", "a"}]], " ", 
           RowBox[{
            SuperscriptBox["u", "\[Prime]",
             MultilineFunction->None], "[", "x", "]"}], " ", 
           RowBox[{
            SuperscriptBox["u", 
             TagBox[
              RowBox[{"(", "3", ")"}],
              Derivative],
             MultilineFunction->None], "[", "x", "]"}]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], "a"], " ", 
           RowBox[{
            SuperscriptBox["u", 
             TagBox[
              RowBox[{"(", "4", ")"}],
              Derivative],
             MultilineFunction->None], "[", "x", "]"}]}]}], "}"}], 
        RowBox[{"a", "\[Equal]", "1"}]},
       {
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], "a"], " ", 
          RowBox[{
           SuperscriptBox["u", 
            TagBox[
             RowBox[{"(", "4", ")"}],
             Derivative],
            MultilineFunction->None], "[", "x", "]"}]}], "}"}], 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{
  3.859103224413948*^9, {3.859103309605142*^9, 3.859103330019422*^9}},
 CellLabel->"Out[89]=",ExpressionUUID->"4e413941-6f68-49aa-8203-a21d4e8b737f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<depVars\>\"", "\[Rule]", 
       RowBox[{"{", "u", "}"}]}], ",", 
      RowBox[{"\"\<indVars\>\"", "\[Rule]", 
       RowBox[{"{", "x", "}"}]}], ",", 
      RowBox[{"\"\<pars\>\"", "\[Rule]", 
       RowBox[{"{", "a", "}"}]}]}], "}"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
  "FastEquivalentsByIntegrationByPartsOperator", "[", "variables", "]"}], "[", 
  RowBox[{
   RowBox[{
    RowBox[{"u", "[", "x", "]"}], "^", "a"}], " ", 
   RowBox[{
    RowBox[{"u", "''''"}], "[", "x", "]"}]}], "]"}]}], "Input",
 CellLabel->"In[92]:=",ExpressionUUID->"d97d4246-6708-420b-8506-dc6eed35c4e7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"u", "[", "x", "]"}], 
     RowBox[{
      RowBox[{"-", "3"}], "+", "a"}]], " ", 
    SuperscriptBox[
     RowBox[{
      SuperscriptBox["u", "\[Prime]",
       MultilineFunction->None], "[", "x", "]"}], "4"]}], ",", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"u", "[", "x", "]"}], 
     RowBox[{
      RowBox[{"-", "2"}], "+", "a"}]], " ", 
    SuperscriptBox[
     RowBox[{
      SuperscriptBox["u", "\[Prime]",
       MultilineFunction->None], "[", "x", "]"}], "2"], " ", 
    RowBox[{
     SuperscriptBox["u", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "x", "]"}]}], ",", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"u", "[", "x", "]"}], 
     RowBox[{
      RowBox[{"-", "1"}], "+", "a"}]], " ", 
    SuperscriptBox[
     RowBox[{
      SuperscriptBox["u", "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "x", "]"}], "2"]}], ",", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"u", "[", "x", "]"}], 
     RowBox[{
      RowBox[{"-", "1"}], "+", "a"}]], " ", 
    RowBox[{
     SuperscriptBox["u", "\[Prime]",
      MultilineFunction->None], "[", "x", "]"}], " ", 
    RowBox[{
     SuperscriptBox["u", 
      TagBox[
       RowBox[{"(", "3", ")"}],
       Derivative],
      MultilineFunction->None], "[", "x", "]"}]}], ",", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"u", "[", "x", "]"}], "a"], " ", 
    RowBox[{
     SuperscriptBox["u", 
      TagBox[
       RowBox[{"(", "4", ")"}],
       Derivative],
      MultilineFunction->None], "[", "x", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.859103563472967*^9},
 CellLabel->"Out[93]=",ExpressionUUID->"249f08bb-93cd-4cf4-8657-7a5ed111fa98"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Beautification of integrals and sums", "Section",
 CellChangeTimes->{{3.858492959338545*^9, 
  3.858492969422882*^9}},ExpressionUUID->"1a8346c0-0476-439e-93a7-\
8175752acbe9"],

Cell[CellGroupData[{

Cell["Represent Mod Null Lagrangians", "Subsection",
 CellChangeTimes->{{3.8592581983329697`*^9, 
  3.859258207195362*^9}},ExpressionUUID->"86307fa0-235a-45da-9395-\
bcb073bdd13e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RepresentModNullLagrangiansOperator", "[", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", " ", "\[Rule]", " ", 
      RowBox[{"{", "u", "}"}]}], ",", " ", 
     RowBox[{"\"\<indVars\>\"", " ", "\[Rule]", " ", 
      RowBox[{"{", "x", "}"}]}], ",", " ", 
     RowBox[{"\"\<pars\>\"", "->", 
      RowBox[{"{", 
       RowBox[{"a", ",", "b", ",", "c"}], "}"}]}]}], "|>"}], "]"}], "[", 
  RowBox[{
   RowBox[{
    RowBox[{"u", "[", "x", "]"}], "^", "2"}], "+", " ", 
   RowBox[{"a", " ", 
    RowBox[{"u", "[", "x", "]"}], " ", 
    RowBox[{
     RowBox[{"u", "'"}], "[", "x", "]"}]}], " ", "+", " ", 
   RowBox[{"b", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"u", "'"}], "[", "x", "]"}], "^", "2"}]}], " ", "+", " ", 
   RowBox[{"c", " ", 
    RowBox[{"u", "[", "x", "]"}], " ", 
    RowBox[{
     RowBox[{"u", "''"}], "[", "x", "]"}]}]}], "]"}]], "Input",
 CellLabel->
  "In[181]:=",ExpressionUUID->"44d993c4-40e6-442c-b1d4-5459824d9693"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        SuperscriptBox[
         RowBox[{"u", "[", "x", "]"}], "2"], 
        RowBox[{
         RowBox[{"b", "\[Equal]", "0"}], "&&", 
         RowBox[{"c", "\[Equal]", "0"}]}]},
       {
        RowBox[{
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], "2"], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"b", "-", "c"}], ")"}], " ", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["u", "\[Prime]",
             MultilineFunction->None], "[", "x", "]"}], "2"]}]}], 
        RowBox[{"b", "\[NotEqual]", "0"}]},
       {
        RowBox[{
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], "2"], "+", 
         RowBox[{"c", " ", 
          RowBox[{"u", "[", "x", "]"}], " ", 
          RowBox[{
           SuperscriptBox["u", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}]}], 
        RowBox[{
         RowBox[{"b", "\[Equal]", "0"}], "&&", 
         RowBox[{"c", "\[NotEqual]", "0"}]}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{3.859258210716909*^9},
 CellLabel->
  "Out[181]=",ExpressionUUID->"c9e7bea1-0f59-49d7-99a7-abb29aea8588"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Integrate by parts methods", "Subsection",
 CellChangeTimes->{{3.859248836665695*^9, 
  3.85924886257873*^9}},ExpressionUUID->"6f3e3760-7d9e-4072-aaf0-\
085a7e86c9b0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", " ", 
      RowBox[{"{", "u", "}"}]}], ",", " ", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", " ", 
      RowBox[{"{", "x", "}"}]}], ",", " ", 
     RowBox[{"\"\<pars\>\"", "\[Rule]", 
      RowBox[{"{", "a", "}"}]}]}], "|>"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IntegrateByPartsOperator", "[", "variables", "]"}], "[", 
  RowBox[{
   RowBox[{
    RowBox[{"u", "[", "x", "]"}], "^", "a"}], " ", 
   RowBox[{
    RowBox[{"u", "''"}], "[", "x", "]"}]}], "]"}]}], "Input",
 CellLabel->
  "In[124]:=",ExpressionUUID->"413564ce-cf0c-4148-adbc-d970a5eeba64"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "a"}], " ", 
  SuperscriptBox[
   RowBox[{"u", "[", "x", "]"}], 
   RowBox[{
    RowBox[{"-", "1"}], "+", "a"}]], " ", 
  SuperscriptBox[
   RowBox[{
    SuperscriptBox["u", "\[Prime]",
     MultilineFunction->None], "[", "x", "]"}], "2"]}]], "Output",
 CellChangeTimes->{3.859248866292643*^9},
 CellLabel->
  "Out[125]=",ExpressionUUID->"c26e4cac-c9e4-49f1-8734-e221174ef82c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RemoveDersOperator", "[", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"u", ",", "v"}], "}"}]}], ",", " ", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}], ",", " ", 
     RowBox[{"\"\<rdVars\>\"", "\[Rule]", 
      RowBox[{"{", "v", "}"}]}]}], "|>"}], "]"}], "[", 
  RowBox[{
   RowBox[{"u", "[", "x", "]"}], " ", 
   RowBox[{
    RowBox[{"v", "''"}], "[", "x", "]"}]}], "]"}]], "Input",
 CellLabel->
  "In[126]:=",ExpressionUUID->"cb6e1a55-48b8-487d-9883-a5fb32788d47"],

Cell[BoxData[
 RowBox[{
  RowBox[{"v", "[", "x", "]"}], " ", 
  RowBox[{
   SuperscriptBox["u", "\[Prime]\[Prime]",
    MultilineFunction->None], "[", "x", "]"}]}]], "Output",
 CellChangeTimes->{3.859248897851652*^9},
 CellLabel->
  "Out[126]=",ExpressionUUID->"b54e648d-529c-4253-a9a4-e8ca60dcbdf5"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"RemoveDersOperator", "[", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"u", ",", "v"}], "}"}]}], ",", " ", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}], ",", " ", 
     RowBox[{"\"\<rdVars\>\"", "\[Rule]", 
      RowBox[{"{", "v", "}"}]}]}], "|>"}], "]"}], "[", 
  RowBox[{
   RowBox[{"u", "[", "x", "]"}], " ", 
   RowBox[{
    RowBox[{"v", "''"}], "[", "x", "]"}]}], "]"}]], "Input",ExpressionUUID->\
"e32b7613-8b6a-40df-8a7e-3134a326fbde"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Beautify Operator", "Subsection",
 CellChangeTimes->{{3.8584945307326117`*^9, 
  3.8584945368001423`*^9}},ExpressionUUID->"24047d17-fa48-4d4f-9144-\
9ff5449c830e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"BeautifyOperator", "[", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", " ", 
      RowBox[{"{", "u", "}"}]}], ",", " ", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", " ", 
      RowBox[{"{", "x", "}"}]}]}], "|>"}], "]"}], "[", 
  RowBox[{
   RowBox[{"u", "[", "x", "]"}], 
   RowBox[{
    RowBox[{"u", "''"}], "[", "x", "]"}]}], "]"}]], "Input",
 CellLabel->"In[21]:=",ExpressionUUID->"5669d80c-685f-457c-b3d9-e1c4017952d8"],

Cell[BoxData[
 RowBox[{"-", 
  SuperscriptBox[
   RowBox[{
    SuperscriptBox["u", "\[Prime]",
     MultilineFunction->None], "[", "x", "]"}], "2"]}]], "Output",
 CellChangeTimes->{3.8584945408603563`*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"8bd3037f-c9a0-4634-b10c-120b3ff7efc5"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Disintegrate Operator", "Subsection",
 CellChangeTimes->{{3.858496662658958*^9, 
  3.858496671133856*^9}},ExpressionUUID->"0c9af3ff-a6f8-4ecd-a430-\
c551823e1baf"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", "u", "}"}]}], ",", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DisintegrateOperator", "[", "variables", "]"}], "[", 
  RowBox[{
   RowBox[{"u", "[", "x", "]"}], " ", 
   RowBox[{
    RowBox[{"u", "''''"}], "[", "x", "]"}]}], "]"}]}], "Input",
 CellLabel->"In[43]:=",ExpressionUUID->"7a11daa6-ede7-4c05-abea-e2d7a52eb651"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     SubscriptBox["\[FormalA]", "1"], "+", 
     SubscriptBox["\[FormalA]", "2"]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{
     SuperscriptBox["u", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "x", "]"}], "2"]}], "+", 
  RowBox[{
   SubscriptBox["\[FormalA]", "2"], " ", 
   RowBox[{
    SuperscriptBox["u", "\[Prime]",
     MultilineFunction->None], "[", "x", "]"}], " ", 
   RowBox[{
    SuperscriptBox["u", 
     TagBox[
      RowBox[{"(", "3", ")"}],
      Derivative],
     MultilineFunction->None], "[", "x", "]"}]}], "+", 
  RowBox[{
   SubscriptBox["\[FormalA]", "1"], " ", 
   RowBox[{"u", "[", "x", "]"}], " ", 
   RowBox[{
    SuperscriptBox["u", 
     TagBox[
      RowBox[{"(", "4", ")"}],
      Derivative],
     MultilineFunction->None], "[", "x", "]"}]}]}]], "Output",
 CellChangeTimes->{3.858496691123496*^9},
 CellLabel->"Out[44]=",ExpressionUUID->"bf8c72e7-00fc-4bfd-87bc-614c018c3f44"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Further ideas", "Subsection",
 CellChangeTimes->{{3.8584942255543737`*^9, 3.858494230752021*^9}, {
  3.859249201724903*^9, 
  3.8592492028751497`*^9}},ExpressionUUID->"53298c08-a343-4f52-b551-\
b683a768f4d6"],

Cell["\<\
Check if remove ders works in discrete setting (probably not).
 Also use remove ders to compute adjoint. 
 Need to develop the discrete analog of integrate by parts. \
\>", "Text",
 CellChangeTimes->{{3.859248957712225*^9, 3.859249025310302*^9}, {
  3.859249084450391*^9, 
  3.859249143413918*^9}},ExpressionUUID->"acf0fa56-8cad-4222-aea9-\
976fee4dc006"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Positivity", "Section",
 CellChangeTimes->{{3.858492983353139*^9, 
  3.858492987872135*^9}},ExpressionUUID->"c17248f3-5340-4397-8ebf-\
c78b7b52fd35"],

Cell[CellGroupData[{

Cell["Positivity necessary conditions", "Subsection",
 CellChangeTimes->{{3.859257055066877*^9, 
  3.859257067752076*^9}},ExpressionUUID->"dd417bf4-87dc-4f3e-9dc4-\
4adc6c410e54"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", "u", "}"}]}], ",", " ", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}], ",", " ", 
     RowBox[{"\"\<pars\>\"", "\[Rule]", 
      RowBox[{"{", "a", "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xp", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<expression\>\"", "\[Rule]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "C1"}], ")"}], " ", 
        RowBox[{
         RowBox[{"u", "[", "x", "]"}], "^", "3"}]}], "+", 
       RowBox[{"C2", " ", 
        RowBox[{"u", "[", "x", "]"}], " ", 
        RowBox[{
         RowBox[{"u", "'"}], "[", "x", "]"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"u", "'"}], "[", "x", "]"}], "^", "2"}], "+", 
       RowBox[{"a", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"u", "'"}], "[", "x", "]"}], "^", "5"}]}]}]}], ",", " ", 
     RowBox[{"\"\<coefficients\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"C1", ",", "C2", ",", "C3"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"sp", "=", 
  RowBox[{
   RowBox[{"SimplifyPositivityOperator", "[", "variables", "]"}], "[", "xp", 
   "]"}]}]}], "Input",
 CellLabel->
  "In[227]:=",ExpressionUUID->"0798e5da-23cd-4dc1-89d3-af4ca617cd1f"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"\<\"expression\"\>", "\[Rule]", 
           SuperscriptBox[
            RowBox[{
             SuperscriptBox["u", "\[Prime]",
              MultilineFunction->None], "[", "x", "]"}], "2"]}], ",", 
          RowBox[{"\<\"rules\"\>", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"C1", "\[Rule]", "1"}], ",", 
             RowBox[{"C2", "\[Rule]", "0"}]}], "}"}]}], ",", 
          RowBox[{"\<\"coefficients\"\>", "\[Rule]", 
           RowBox[{"{", "C3", "}"}]}]}], "\[RightAssociation]"}], 
        RowBox[{"a", "\[Equal]", "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{{3.859295249007142*^9, 3.859295263938785*^9}},
 CellLabel->
  "Out[229]=",ExpressionUUID->"79e83310-0168-4ccc-876e-1aecd407b91e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", "u", "}"}]}], ",", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}], ",", " ", 
     RowBox[{"\"\<pars\>\"", "\[Rule]", 
      RowBox[{"{", "a", "}"}]}], ",", 
     RowBox[{"\"\<facts\>\"", "\[Rule]", 
      RowBox[{
       RowBox[{"u", "[", "x", "]"}], ">", "0"}]}]}], "|>"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"xp", "=", 
  RowBox[{
   RowBox[{"DisintegrateOperator", "[", "variables", "]"}], "[", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{
      RowBox[{"u", "[", "x", "]"}], "^", "2"}]}], " ", 
    RowBox[{
     RowBox[{"u", "''"}], "[", "x", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SimplifyPositivityQEOperator", "[", "variables", "]"}], "[", "xp", 
  "]"}]}], "Input",
 CellLabel->
  "In[261]:=",ExpressionUUID->"ac4770d6-53c9-4660-9e4e-5ab720d8be1f"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {"$Failed", 
        RowBox[{
         RowBox[{"u", "[", "x", "]"}], "\[LessEqual]", "0"}]},
       {
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"u", "[", "x", "]"}], " ", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["u", "\[Prime]",
             MultilineFunction->None], "[", "x", "]"}], "2"]}], "+", 
         RowBox[{"2", " ", 
          SubscriptBox["\[FormalA]", "1"], " ", 
          RowBox[{"u", "[", "x", "]"}], " ", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["u", "\[Prime]",
             MultilineFunction->None], "[", "x", "]"}], "2"]}], "+", 
         RowBox[{
          SubscriptBox["\[FormalA]", "1"], " ", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], "2"], " ", 
          RowBox[{
           SuperscriptBox["u", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}]}], 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{3.859351546012537*^9},
 CellLabel->
  "Out[262]=",ExpressionUUID->"bf55672e-3393-4bc3-841a-d83bf9485cbd"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {"$Failed", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[FormalA]", "1"], "\[NotEqual]", "0"}], "||", 
         RowBox[{
          RowBox[{"u", "[", "x", "]"}], "\[LessEqual]", "0"}]}]},
       {
        RowBox[{"2", " ", 
         RowBox[{"u", "[", "x", "]"}], " ", 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox["u", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}], "2"]}], 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{3.859351546027883*^9},
 CellLabel->
  "Out[263]=",ExpressionUUID->"02f37f39-cb41-4f2b-9e76-5f6530022cd4"]
}, Open  ]]
}, Open  ]],

Cell["Positivity sufficient conditions", "Subsection",
 CellChangeTimes->{{3.859257069672151*^9, 
  3.859257079887742*^9}},ExpressionUUID->"6219a5a4-86a0-441c-9c91-\
6d722a4478d7"],

Cell[CellGroupData[{

Cell["Positivity necessary and sufficient conditions", "Subsection",
 CellChangeTimes->{{3.859257069672151*^9, 3.859257079887742*^9}, {
  3.859295274231184*^9, 
  3.8592952763852243`*^9}},ExpressionUUID->"c36e13a2-fc98-4848-9a48-\
956713fbe2e8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", "u", "}"}]}], ",", " ", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}], ",", " ", 
     RowBox[{"\"\<pars\>\"", "\[Rule]", 
      RowBox[{"{", "a", "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xp", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<expression\>\"", "\[Rule]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "C1"}], ")"}], " ", 
        RowBox[{
         RowBox[{"u", "[", "x", "]"}], "^", "3"}]}], "+", 
       RowBox[{"C2", " ", 
        RowBox[{"u", "[", "x", "]"}], " ", 
        RowBox[{
         RowBox[{"u", "'"}], "[", "x", "]"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"u", "'"}], "[", "x", "]"}], "^", "2"}], "+", 
       RowBox[{"a", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"u", "'"}], "[", "x", "]"}], "^", "5"}]}]}]}], ",", " ", 
     RowBox[{"\"\<coefficients\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"C1", ",", "C2", ",", "C3"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"sp", "=", 
  RowBox[{
   RowBox[{"SimplifyPositivityQEOperator", "[", "variables", "]"}], "[", "xp",
    "]"}]}]}], "Input",
 CellLabel->
  "In[236]:=",ExpressionUUID->"6485d785-eef2-4bfc-a52b-6afaea467b13"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["u", "\[Prime]",
           MultilineFunction->None], "[", "x", "]"}], "2"], 
        RowBox[{
         RowBox[{"a", "\[Equal]", "0"}], "&&", 
         RowBox[{"C1", "\[Equal]", "1"}], "&&", 
         RowBox[{"C2", "\[Equal]", "0"}]}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{3.859298328443623*^9},
 CellLabel->
  "Out[238]=",ExpressionUUID->"9c145f7c-2fd3-4c07-b227-c6ba3ab77d7a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", "u", "}"}]}], ",", " ", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}], ",", " ", 
     RowBox[{"\"\<pars\>\"", "\[Rule]", 
      RowBox[{"{", "a", "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xp", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<expression\>\"", "\[Rule]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "C1"}], ")"}], " ", 
        RowBox[{
         RowBox[{"u", "[", "x", "]"}], "^", "3"}]}], "+", 
       RowBox[{"C2", " ", 
        RowBox[{"u", "[", "x", "]"}], " ", 
        RowBox[{
         RowBox[{"u", "'"}], "[", "x", "]"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"u", "'"}], "[", "x", "]"}], "^", "2"}], "+", 
       RowBox[{"a", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"u", "'"}], "[", "x", "]"}], "^", "5"}]}]}]}], ",", " ", 
     RowBox[{"\"\<coefficients\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"C1", ",", "C2", ",", "C3"}], "}"}]}], ",", 
     RowBox[{"\"\<eliminator\>\"", "\[Rule]", "False"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PositivityConditionQEOperator", "[", "variables", "]"}], "[", "xp",
   "]"}]}], "Input",
 CellChangeTimes->{{3.859295061031723*^9, 3.859295091026767*^9}, {
  3.8592951783373632`*^9, 3.859295181270877*^9}, {3.859295214416071*^9, 
  3.859295215210631*^9}},
 CellLabel->
  "In[239]:=",ExpressionUUID->"91df30ad-d080-438d-80e4-60e44feb4ee2"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {"True", 
        RowBox[{
         RowBox[{"C1", "\[Equal]", "1"}], "&&", 
         RowBox[{"C2", "\[Equal]", "0"}], "&&", 
         RowBox[{"a", "\[Equal]", "0"}]}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{{3.859295053323702*^9, 3.859295092398777*^9}, 
   3.8592951819937363`*^9, 3.859295215814863*^9, 3.859295265805788*^9, 
   3.859298363625578*^9},
 CellLabel->
  "Out[241]=",ExpressionUUID->"a73e530a-9aa4-4cc1-92d5-a3e3d2b3b3ad"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Other", "Subsection",
 CellChangeTimes->{{3.859257081314563*^9, 
  3.8592570831470613`*^9}},ExpressionUUID->"7e5f273c-beaa-4737-ad21-\
6abdc3feed19"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Association", "[", "\n", "        ", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"v", ",", "m"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{"\"\<pars\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"a", ",", "b", ",", "q"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<facts\>\"", "\[Rule]", 
      RowBox[{
       RowBox[{"m", "[", "x", "]"}], ">", "0"}]}]}], "\n", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SignedFactorsOperator", "[", "variables", "]"}], "[", 
  RowBox[{"a", " ", 
   RowBox[{"m", "[", "x", "]"}], " ", 
   RowBox[{
    RowBox[{"v", "[", "x", "]"}], "^", "2"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8592950000374603`*^9, 3.859295005410475*^9}},
 CellLabel->
  "In[478]:=",ExpressionUUID->"96a256ef-c3c8-445b-a46f-fe3f5285ec45"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"\<\"positive\"\>", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"m", "[", "x", "]"}], ",", 
             SuperscriptBox[
              RowBox[{"v", "[", "x", "]"}], "2"]}], "}"}]}], ",", 
          RowBox[{"\<\"negative\"\>", "\[Rule]", 
           RowBox[{"{", "a", "}"}]}]}], "\[RightAssociation]"}], 
        RowBox[{
         RowBox[{
          RowBox[{"m", "[", "x", "]"}], ">", "0"}], "&&", 
         RowBox[{"a", "<", "0"}]}]},
       {
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"\<\"positive\"\>", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"a", ",", 
             RowBox[{"m", "[", "x", "]"}], ",", 
             SuperscriptBox[
              RowBox[{"v", "[", "x", "]"}], "2"]}], "}"}]}], ",", 
          RowBox[{"\<\"negative\"\>", "\[Rule]", 
           RowBox[{"{", "}"}]}]}], "\[RightAssociation]"}], 
        RowBox[{
         RowBox[{
          RowBox[{"m", "[", "x", "]"}], ">", "0"}], "&&", 
         RowBox[{"a", "\[GreaterEqual]", "0"}]}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{3.859295006123629*^9, 3.859531219494117*^9},
 CellLabel->
  "Out[479]=",ExpressionUUID->"0d2e5f07-90ef-4b40-bebf-219a29c1c3eb"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Further ideas", "Subsection",
 CellChangeTimes->{{3.8584942255543737`*^9, 3.858494230752021*^9}, {
  3.859249201724903*^9, 
  3.8592492028751497`*^9}},ExpressionUUID->"b15e0952-7a7c-4854-960a-\
bf8d0adb57d1"],

Cell["\<\
We need a full positivity operator. Also the outputs are a bit uneven. \
\>", "Text",
 CellChangeTimes->{{3.859298433824215*^9, 
  3.859298453975628*^9}},ExpressionUUID->"5e036ce8-dfd7-4099-9fef-\
67f29b0026a6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PositivityOperator", "[", "variables", "]"}], "[", "xp", 
  "]"}]], "Input",
 CellChangeTimes->{{3.8592950938562202`*^9, 3.859295136208987*^9}},
 CellLabel->
  "In[216]:=",ExpressionUUID->"3cd42f7b-8954-42bd-8faa-867c111b1d6c"],

Cell[BoxData["\<\"Not ready\"\>"], "Print",
 CellChangeTimes->{3.8592951367006083`*^9},
 CellLabel->
  "During evaluation of \
In[216]:=",ExpressionUUID->"a5099e7a-b7d4-4c38-be39-c04527f1a0fa"],

Cell[BoxData[
 RowBox[{"Null", "[", 
  RowBox[{"\[LeftAssociation]", 
   RowBox[{
    RowBox[{"\<\"expression\"\>", "\[Rule]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "C1"}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"u", "[", "x", "]"}], "3"]}], "+", 
      RowBox[{"C2", " ", 
       RowBox[{"u", "[", "x", "]"}], " ", 
       RowBox[{
        SuperscriptBox["u", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}], "+", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["u", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}], "2"], "+", 
      RowBox[{"a", " ", 
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["u", "\[Prime]",
          MultilineFunction->None], "[", "x", "]"}], "5"]}]}]}], ",", 
    RowBox[{"\<\"coefficients\"\>", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"C1", ",", "C2", ",", "C3"}], "}"}]}], ",", 
    RowBox[{"\<\"eliminator\"\>", "\[Rule]", "False"}]}], 
   "\[RightAssociation]"}], "]"}]], "Output",
 CellChangeTimes->{3.859295136705575*^9},
 CellLabel->
  "Out[216]=",ExpressionUUID->"6bdb1ad1-81be-4587-bde4-bcede9762b8c"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Time dependent PDEs", "Section",
 CellChangeTimes->{{3.858492991595014*^9, 
  3.858492998330592*^9}},ExpressionUUID->"209f5b68-70ca-457d-ae79-\
b2f2899ebeb6"],

Cell[CellGroupData[{

Cell["Conserved Q Operator", "Subsection",
 CellChangeTimes->{{3.85849535167601*^9, 
  3.858495363100224*^9}},ExpressionUUID->"04de3792-c04c-4a9b-8e74-\
e49fefdd857c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", " ", "=", " ", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", "u", "}"}]}], ",", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}], ",", 
     RowBox[{"\"\<timederivativeorder\>\"", "\[Rule]", "1"}], ",", 
     RowBox[{"\"\<eqRhs\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"u", "''"}], "[", "x", "]"}], "}"}]}], ",", 
     RowBox[{"\"\<pars\>\"", "->", 
      RowBox[{"{", "a", "}"}]}]}], "|>"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ConservedQOperator", "[", "variables", "]"}], "[", 
  RowBox[{
   RowBox[{"u", "[", "x", "]"}], "^", "a"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8584953758611*^9, 3.858495376182699*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"ee1953fa-0ac5-4297-a773-78538eb2f5c7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", "\[Rule]", "0"}], "}"}], ",", 
     RowBox[{"a", "\[Equal]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u", "[", "x", "]"}], "\[Rule]", "0"}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"u", "[", "x", "]"}], "\[Equal]", "0"}], "&&", 
      RowBox[{"a", ">", "0"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SuperscriptBox["u", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "x", "]"}], "\[Rule]", "0"}], "}"}], 
     ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["u", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "x", "]"}], "\[Equal]", "0"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.858495376820319*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"664b939d-b3dd-4d50-bcc6-2680392d9517"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Find Conserved Quantities -  Operator and Basis", "Subsection",
 CellChangeTimes->{{3.859171588151368*^9, 3.859171595698299*^9}, {
  3.8591718273647537`*^9, 
  3.859171852797625*^9}},ExpressionUUID->"8faf428f-83d4-4c9b-9bf1-\
cd3eb560148a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", "u", "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}], ",", 
     RowBox[{"\"\<timederivativeorder\>\"", "\[Rule]", "1"}], ",", 
     RowBox[{"\"\<eqRhs\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"u", "[", "x", "]"}], 
         RowBox[{
          RowBox[{"u", "'"}], "[", "x", "]"}]}], "+", 
        RowBox[{
         RowBox[{"u", "'''"}], "[", "x", "]"}]}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindConservedQuantityOperator", "[", "variables", "]"}], "[", 
  RowBox[{"Association", "[", 
   RowBox[{
    RowBox[{"\"\<degree\>\"", "\[Rule]", "3"}], ",", 
    RowBox[{"\"\<derivatives\>\"", "\[Rule]", "1"}]}], "]"}], "]"}]}], "Input",\

 CellLabel->
  "In[112]:=",ExpressionUUID->"8127ac85-ed6a-41b8-8c55-5edbec29b51c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["\[FormalA]", "1"], " ", 
   RowBox[{"u", "[", "x", "]"}]}], "+", 
  RowBox[{
   SubscriptBox["\[FormalA]", "2"], " ", 
   SuperscriptBox[
    RowBox[{"u", "[", "x", "]"}], "2"]}], "-", 
  RowBox[{
   FractionBox["1", "3"], " ", 
   SubscriptBox["\[FormalA]", "4"], " ", 
   SuperscriptBox[
    RowBox[{"u", "[", "x", "]"}], "3"]}], "+", 
  RowBox[{
   SubscriptBox["\[FormalA]", "4"], " ", 
   SuperscriptBox[
    RowBox[{
     SuperscriptBox["u", "\[Prime]",
      MultilineFunction->None], "[", "x", "]"}], "2"]}]}]], "Output",
 CellChangeTimes->{3.85917183575741*^9},
 CellLabel->
  "Out[113]=",ExpressionUUID->"1bcd35d5-b289-4c94-924e-e9048129ed47"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", "u", "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}], ",", 
     RowBox[{"\"\<timederivativeorder\>\"", "\[Rule]", "1"}], ",", 
     RowBox[{"\"\<eqRhs\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"u", "[", "x", "]"}], 
         RowBox[{
          RowBox[{"u", "'"}], "[", "x", "]"}]}], "+", 
        RowBox[{
         RowBox[{"u", "'''"}], "[", "x", "]"}]}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindConservedQuantityBasisOperator", "[", "variables", "]"}], "[", 
  
  RowBox[{"Association", "[", 
   RowBox[{
    RowBox[{"\"\<degree\>\"", "\[Rule]", "3"}], ",", 
    RowBox[{"\"\<derivatives\>\"", "\[Rule]", "2"}]}], "]"}], "]"}]}], "Input",\

 CellLabel->"In[94]:=",ExpressionUUID->"894e1fb1-43ac-4d58-941d-9838c496813f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"u", "[", "x", "]"}], ",", 
   SuperscriptBox[
    RowBox[{"u", "[", "x", "]"}], "2"], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "3"]}], " ", 
     SuperscriptBox[
      RowBox[{"u", "[", "x", "]"}], "3"]}], "+", 
    SuperscriptBox[
     RowBox[{
      SuperscriptBox["u", "\[Prime]",
       MultilineFunction->None], "[", "x", "]"}], "2"]}]}], "}"}]], "Output",
 CellChangeTimes->{3.859171602205305*^9},
 CellLabel->"Out[95]=",ExpressionUUID->"e3472d56-b0e8-4886-a7af-3fdac3562f89"]
}, Open  ]],

Cell["\<\
Note this works also for semi - discrete schemes and higher order time \
derivatives\
\>", "Text",
 CellChangeTimes->{{3.8591716069149513`*^9, 3.8591716178894243`*^9}, {
  3.859171672971447*^9, 
  3.8591716798304033`*^9}},ExpressionUUID->"466ffce4-a2b1-4d87-b345-\
b63e08c08a1f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", "u", "}"}]}], ",", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "n", "}"}]}], ",", " ", 
     RowBox[{"\"\<pars\>\"", "\[Rule]", 
      RowBox[{"{", "a", "}"}]}], ",", 
     RowBox[{"\"\<eqRhs\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"2", 
         RowBox[{"u", "[", "n", "]"}]}], "-", 
        RowBox[{"u", "[", 
         RowBox[{"n", "+", "1"}], "]"}], "-", 
        RowBox[{"u", "[", 
         RowBox[{"n", "-", "1"}], "]"}]}], "}"}]}], ",", " ", 
     RowBox[{"\"\<VarDOperator\>\"", "\[Rule]", "DVarDOperator"}], ",", " ", 
     RowBox[{"\"\<timederivativeorder\>\"", "\[Rule]", "2"}]}], "|>"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindConservedQuantityBasisOperator", "[", "variables", "]"}], "[", 
  
  RowBox[{"Association", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<degree\>\"", "\[Rule]", "3"}], ",", " ", 
     RowBox[{"\"\<generators\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"u", "[", "n", "]"}], ",", "n"}], "}"}]}]}], "}"}], "]"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.859171656151038*^9, 3.859171735089855*^9}},
 CellLabel->
  "In[110]:=",ExpressionUUID->"cf5d8770-f80d-4b99-b431-45d1874d526c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"u", "[", "n", "]"}], ",", 
   RowBox[{"n", " ", 
    RowBox[{"u", "[", "n", "]"}]}], ",", 
   RowBox[{
    SuperscriptBox["n", "2"], " ", 
    RowBox[{"u", "[", "n", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.859171683395646*^9, 3.8591717357150507`*^9}},
 CellLabel->
  "Out[111]=",ExpressionUUID->"0c045231-25a2-4c90-a094-ed1bb2259cfa"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Integrating Factors - Operator and basis", "Subsection",
 CellChangeTimes->{{3.859171862624076*^9, 3.8591718814959793`*^9}, 
   3.859248338766325*^9, {3.8592483826147223`*^9, 
   3.8592483885900393`*^9}},ExpressionUUID->"a369de74-9faf-4384-a69f-\
115ba8117b0e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"u", ",", "v"}], "}"}]}], ",", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"x", ",", "t"}], "}"}]}]}], "]"}]}], ";", 
  RowBox[{"problem", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<expression\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"u", "[", 
            RowBox[{"x", ",", "t"}], "]"}], ",", "t"}], "]"}], "-", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"u", "[", 
            RowBox[{"x", ",", "t"}], "]"}], ",", "x"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"x", ",", "t"}], "]"}], ",", "t"}], "]"}], "-", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"x", ",", "t"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "2"}], "}"}]}], "]"}]}]}], "}"}]}], ",", 
     RowBox[{"\"\<monomials\>\"", "\[Rule]", 
      RowBox[{"Association", "[", 
       RowBox[{
        RowBox[{"\"\<degree\>\"", "\[Rule]", "1"}], ",", 
        RowBox[{"\"\<derivatives\>\"", "\[Rule]", "2"}]}], "]"}]}]}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindIntegratingFactorBasisOperator", "[", "variables", "]"}], "[", 
  "problem", "]"}]}], "Input",
 CellLabel->
  "In[116]:=",ExpressionUUID->"403ae5a8-804e-42ce-b6e3-13019701a3ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"u", "[", 
       RowBox[{"x", ",", "t"}], "]"}], ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["v", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "t"}], "]"}], "-", 
       RowBox[{
        SuperscriptBox["v", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"2", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "t"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         SuperscriptBox["u", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "t"}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["u", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "t"}], "]"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["u", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "2"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "t"}], "]"}], ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["u", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "t"}], "]"}], ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["u", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"2", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "t"}], "]"}], ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "\[IndentingNewLine]"}]], \
"Input",
 CellChangeTimes->{{3.859248491534174*^9, 
  3.859248500048398*^9}},ExpressionUUID->"99b54882-adc5-4989-a67c-\
7f8a64bb12f1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FindIntegratingFactorOperator", "[", "variables", "]"}], "[", 
  "problem", "]"}]], "Input",
 CellLabel->
  "In[118]:=",ExpressionUUID->"a2246de0-247b-47e7-b234-c5904d12593c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox["\[FormalA]", "1"], "+", 
    RowBox[{
     SubscriptBox["\[FormalA]", "2"], " ", 
     RowBox[{"u", "[", 
      RowBox[{"x", ",", "t"}], "]"}]}], "+", 
    RowBox[{
     SubscriptBox["\[FormalA]", "3"], " ", 
     RowBox[{
      SuperscriptBox["v", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "t"}], "]"}]}], "+", 
    RowBox[{
     SubscriptBox["\[FormalA]", "4"], " ", 
     RowBox[{
      SuperscriptBox["u", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "2"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "t"}], "]"}]}], "+", 
    RowBox[{
     SubscriptBox["\[FormalA]", "5"], " ", 
     RowBox[{
      SuperscriptBox["u", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "t"}], "]"}]}], "+", 
    RowBox[{
     SubscriptBox["\[FormalA]", "6"], " ", 
     RowBox[{
      SuperscriptBox["u", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"2", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "t"}], "]"}]}], "-", 
    RowBox[{
     SubscriptBox["\[FormalA]", "3"], " ", 
     RowBox[{
      SuperscriptBox["v", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"2", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "t"}], "]"}]}]}], ",", 
   RowBox[{
    SubscriptBox["\[FormalA]", "7"], "-", 
    RowBox[{
     SubscriptBox["\[FormalA]", "3"], " ", 
     RowBox[{
      SuperscriptBox["u", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "t"}], "]"}]}], "+", 
    RowBox[{
     SubscriptBox["\[FormalA]", "3"], " ", 
     RowBox[{
      SuperscriptBox["u", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "t"}], "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.859248503500847*^9},
 CellLabel->
  "Out[118]=",ExpressionUUID->"6dd402b4-471b-4b6c-a345-6740a72dc74f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Further ideas", "Subsection",
 CellChangeTimes->{{3.8584942255543737`*^9, 
  3.858494230752021*^9}},ExpressionUUID->"f0fad840-9a51-4598-a336-\
f6010eab6f4f"],

Cell[CellGroupData[{

Cell["Homotopy operators", "Subsubsection",
 CellChangeTimes->{{3.859510803321682*^9, 
  3.859510813791947*^9}},ExpressionUUID->"0100de3f-03d7-479a-92a1-\
2b57b87402b8"],

Cell["\<\
Given a null Lagrangian rewrite is as a divergence . This could be done by \
direct methods or by using the homotopy operator\
\>", "Text",
 CellChangeTimes->{{3.859510815767723*^9, 
  3.859510845211191*^9}},ExpressionUUID->"2f416931-0fb8-4ab2-87e4-\
2c58d8361552"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Discrete schemes", "Section",
 CellChangeTimes->{{3.858493017827317*^9, 
  3.8584930233188066`*^9}},ExpressionUUID->"4bbae880-0036-4fe8-92ba-\
881fad0c5692"],

Cell[CellGroupData[{

Cell["Polynomial Reduction mod schemes ", "Subsection",
 CellChangeTimes->{{3.859509724391749*^9, 
  3.859509735928967*^9}},ExpressionUUID->"debbdf6f-489d-40d2-ac38-\
c5f268f5945b"],

Cell[CellGroupData[{

Cell["Translations", "Subsubsection",
 CellChangeTimes->{{3.8595094322253103`*^9, 
  3.859509439042795*^9}},ExpressionUUID->"253fb072-1c66-48df-adcf-\
e257fb8e3095"],

Cell[BoxData[
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<indVars\>\"", "->", 
      RowBox[{"{", "n", "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<depVars\>\"", "->", 
      RowBox[{"{", "u", "}"}]}]}], "\[IndentingNewLine]", "|>"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8595106428891783`*^9, 3.8595106435882893`*^9}},
 CellLabel->
  "In[464]:=",ExpressionUUID->"c41c6a41-8d05-4243-b6d3-7f905a7408da"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"StencilOperator", "[", "variables", "]"}], "[", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"u", "[", 
     RowBox[{"n", "-", "2"}], "]"}], "-", 
    RowBox[{"u", "[", 
     RowBox[{"n", "+", "3"}], "]"}]}], ")"}], "]"}]], "Input",
 CellLabel->
  "In[465]:=",ExpressionUUID->"b9df1777-980f-4d19-8608-594712256e66"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{"u", "\[Rule]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"-", "2"}], "}"}], ",", 
     RowBox[{"{", "3", "}"}]}], "}"}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.859509546537985*^9, 3.8595106468568897`*^9},
 CellLabel->
  "Out[465]=",ExpressionUUID->"15cfe6ef-6110-47fc-9a6e-225e7c11fd93"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"StencilOperator", "[", "variables", "]"}], "[", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"u", "[", 
     RowBox[{"n", "+", "1"}], "]"}], "-", 
    RowBox[{"u", "[", "n", "]"}]}], ")"}], "]"}]], "Input",
 CellChangeTimes->{{3.8595095513374243`*^9, 3.859509553746117*^9}},
 CellLabel->
  "In[466]:=",ExpressionUUID->"34a236f3-4e9b-4062-ac6d-405f1fcf3c25"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{"u", "\[Rule]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "1", "}"}]}], "}"}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.8595095542577353`*^9, 3.8595106491793547`*^9},
 CellLabel->
  "Out[466]=",ExpressionUUID->"3f7f75ae-3cc1-4a6f-888f-b806dcc84514"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RangeSchemeTranslationsOperator", "[", "variables", "]"}], "[", 
  RowBox[{
   RowBox[{"\[LeftAssociation]", 
    RowBox[{"u", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"-", "2"}], "}"}], ",", 
       RowBox[{"{", "3", "}"}]}], "}"}]}], "\[RightAssociation]"}], ",", " ", 
   
   RowBox[{"\[LeftAssociation]", 
    RowBox[{"u", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "1", "}"}]}], "}"}]}], "\[RightAssociation]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.859509448274934*^9, 3.8595094489929247`*^9}, {
  3.859509510532434*^9, 3.859509513155053*^9}, {3.859509543396389*^9, 
  3.859509565839319*^9}, {3.85950969139799*^9, 3.859509696339673*^9}, {
  3.8595106378068943`*^9, 3.859510652714951*^9}},
 CellLabel->
  "In[467]:=",ExpressionUUID->"b98943ae-b74e-430d-b50c-cae05c073fb0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"-", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"-", "1"}], "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "1", "}"}], ",", 
   RowBox[{"{", "2", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8595095666013727`*^9, {3.8595096924654827`*^9, 3.859509697068427*^9}, 
   3.8595106537896423`*^9},
 CellLabel->
  "Out[467]=",ExpressionUUID->"ed307c75-2375-4077-bfef-ff73efd87b92"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Reduce Mod Scheme", "Subsubsection",
 CellChangeTimes->{{3.859446408196533*^9, 
  3.8594464126644382`*^9}},ExpressionUUID->"302f2e42-0c40-455d-b09a-\
858af2f87cb3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<indVars\>\"", "->", 
      RowBox[{"{", "n", "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<depVars\>\"", "->", 
      RowBox[{"{", "u", "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<scheme\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"u", "[", 
         RowBox[{"n", "+", "1"}], "]"}], "-", 
        RowBox[{"u", "[", "n", "]"}]}], "}"}]}]}], "\[IndentingNewLine]", 
    "|>"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expression", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"u", "[", 
        RowBox[{"n", "+", "2"}], "]"}], "-", 
       RowBox[{"u", "[", 
        RowBox[{"n", "-", "4"}], "]"}]}], ")"}], "^", "2"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"u", "[", 
        RowBox[{"n", "-", "1"}], "]"}], "-", 
       RowBox[{"u", "[", "n", "]"}]}], ")"}], "^", "2"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReduceModSchemeOperator", "[", "variables", "]"}], "[", 
  "expression", "]"}]}], "Input",
 CellChangeTimes->{{3.859508701670369*^9, 3.859508741634385*^9}, {
   3.85951068684328*^9, 3.859510693343807*^9}, 3.859510756452162*^9},
 CellLabel->
  "In[473]:=",ExpressionUUID->"1740b88d-e221-4c66-8987-f8ad21585ef2"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"exp\"\>", "\[Rule]", "0"}], ",", 
   RowBox[{"\<\"scheme\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"u", "[", "n", "]"}]}], "+", 
      RowBox[{"u", "[", 
       RowBox[{"1", "+", "n"}], "]"}]}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.859446481984021*^9, 3.859450078159565*^9, {3.859508703286227*^9, 
   3.859508743448667*^9}, 3.859509706448236*^9, 3.8595106941926327`*^9, 
   3.85951075731054*^9},
 CellLabel->
  "Out[475]=",ExpressionUUID->"61998da2-2662-4ba3-8a49-acae75d556b9"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Time Difference Operator", "Subsection",
 CellChangeTimes->{{3.859446248498889*^9, 
  3.859446258183333*^9}},ExpressionUUID->"80c5cb1e-0ba4-46dd-b7bf-\
6ae152818eee"],

Cell[CellGroupData[{

Cell["Explicit schemes", "Subsubsection",
 CellChangeTimes->{{3.859508757644843*^9, 
  3.8595087619155893`*^9}},ExpressionUUID->"9c632aa3-6385-40ef-bd95-\
3a59949d5e1d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "->", 
      RowBox[{"{", "u", "}"}]}], ",", 
     RowBox[{"\"\<indVars\>\"", "->", 
      RowBox[{"{", "n", "}"}]}], ",", 
     RowBox[{"\"\<rhs\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"u", "[", 
         RowBox[{"n", "-", "1"}], "]"}], "-", 
        RowBox[{"u", "[", "n", "]"}], "+", 
        RowBox[{"u", "[", 
         RowBox[{"n", "+", "1"}], "]"}]}], "}"}]}]}], "|>"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"TimeDifferenceOperator", "[", "variables", "]"}], "[", 
  RowBox[{"u", "[", "n", "]"}], "]"}], "\n", 
 RowBox[{
  RowBox[{"TimeDifferenceOperator", "[", "variables", "]"}], "[", 
  RowBox[{"n", " ", 
   RowBox[{"u", "[", "n", "]"}]}], "]"}], "\n", 
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "->", 
      RowBox[{"{", "u", "}"}]}], ",", 
     RowBox[{"\"\<indVars\>\"", "->", 
      RowBox[{"{", "n", "}"}]}], ",", 
     RowBox[{"\"\<rhs\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"u", "[", 
         RowBox[{"n", "-", "1"}], "]"}], "-", 
        RowBox[{"u", "[", "n", "]"}], "+", 
        RowBox[{"u", "[", 
         RowBox[{"n", "+", "1"}], "]"}]}], "}"}]}], ",", "\n", 
     RowBox[{"\"\<timederivativeorder\>\"", "\[Rule]", "2"}]}], "|>"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"TimeDifferenceOperator", "[", "variables", "]"}], "[", 
  RowBox[{
   RowBox[{"n", "^", "2"}], " ", 
   RowBox[{"u", "[", "n", "]"}]}], "]"}]}], "Input",
 CellLabel->
  "In[430]:=",ExpressionUUID->"526426ee-ed51-4df0-932a-bf857b0af135"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"exp\"\>", "\[Rule]", "0"}], ",", 
   RowBox[{"\<\"rhs\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"u", "[", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "n"}], "]"}], "-", 
      RowBox[{"u", "[", "n", "]"}], "+", 
      RowBox[{"u", "[", 
       RowBox[{"1", "+", "n"}], "]"}]}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.859446297711173*^9, 3.859450147927112*^9},
 CellLabel->
  "Out[431]=",ExpressionUUID->"7465e783-00b5-4d5a-802a-459a2843767c"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"exp\"\>", "\[Rule]", "0"}], ",", 
   RowBox[{"\<\"rhs\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"u", "[", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "n"}], "]"}], "-", 
      RowBox[{"u", "[", "n", "]"}], "+", 
      RowBox[{"u", "[", 
       RowBox[{"1", "+", "n"}], "]"}]}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.859446297711173*^9, 3.859450147933509*^9},
 CellLabel->
  "Out[432]=",ExpressionUUID->"8c3d6c6c-7790-4a62-b4e3-73c3f8585394"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"exp\"\>", "\[Rule]", "0"}], ",", 
   RowBox[{"\<\"rhs\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"u", "[", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "n"}], "]"}], "-", 
      RowBox[{"u", "[", "n", "]"}], "+", 
      RowBox[{"u", "[", 
       RowBox[{"1", "+", "n"}], "]"}]}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.859446297711173*^9, 3.8594501479362707`*^9},
 CellLabel->
  "Out[434]=",ExpressionUUID->"9652b231-250e-41a6-a110-da6e188be9dd"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Implicit Schemes", "Subsubsection",
 CellChangeTimes->{{3.859508767380209*^9, 
  3.8595087734759493`*^9}},ExpressionUUID->"a1d24c73-e40a-4495-bcdf-\
c5a436404351"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "->", 
      RowBox[{"{", "u", "}"}]}], ",", 
     RowBox[{"\"\<indVars\>\"", "->", 
      RowBox[{"{", 
       RowBox[{"n", ",", "t"}], "}"}]}], ",", 
     RowBox[{"\"\<scheme\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"u", "[", 
         RowBox[{"n", ",", 
          RowBox[{"t", "+", "1"}]}], "]"}], "-", 
        RowBox[{"u", "[", 
         RowBox[{"n", ",", "t"}], "]"}]}], "}"}]}]}], "|>"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TimeDifferenceOperator", "[", "variables", "]"}], "[", 
  RowBox[{"u", "[", 
   RowBox[{"n", ",", "t"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8594462808203793`*^9, 3.859446281191367*^9}},
 CellLabel->
  "In[435]:=",ExpressionUUID->"cbd98607-119a-4485-9b62-f06b6ac0a698"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"exp\"\>", "\[Rule]", "0"}], ",", 
   RowBox[{"\<\"scheme\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"u", "[", 
        RowBox[{"n", ",", "t"}], "]"}]}], "+", 
      RowBox[{"u", "[", 
       RowBox[{"n", ",", 
        RowBox[{"1", "+", "t"}]}], "]"}]}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.8594462821605864`*^9, 3.859450310888124*^9},
 CellLabel->
  "Out[436]=",ExpressionUUID->"4d307046-b48c-4841-9f3d-09b86b84eae9"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Discrete Conserved Quantities", "Subsection",
 CellChangeTimes->{{3.858495750440804*^9, 3.8584957751622*^9}, {
  3.859508919051962*^9, 
  3.8595089213874493`*^9}},ExpressionUUID->"d0fd2db2-e2c7-4573-bf98-\
1135d8ec241f"],

Cell[CellGroupData[{

Cell["Checking", "Subsubsection",
 CellChangeTimes->{{3.8595089240653048`*^9, 
  3.859508926760242*^9}},ExpressionUUID->"104291ab-c1d8-4b29-b796-\
3ef33849d56f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", " ", "=", " ", 
   RowBox[{"<|", "\n", 
    RowBox[{
     RowBox[{"\"\<indVars\>\"", " ", "->", " ", 
      RowBox[{"{", 
       RowBox[{"n", ",", "t"}], "}"}]}], ",", "\n", 
     RowBox[{"\"\<depVars\>\"", " ", "->", " ", 
      RowBox[{"{", "u", "}"}]}], ",", "\n", 
     RowBox[{"\"\<pars\>\"", " ", "->", " ", 
      RowBox[{"{", "a", "}"}]}], ",", "\n", 
     RowBox[{"\"\<scheme\>\"", " ", "->", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"u", "[", 
         RowBox[{"n", ",", 
          RowBox[{"t", "+", "1"}]}], "]"}], "-", 
        RowBox[{"a", "*", 
         RowBox[{"u", "[", 
          RowBox[{"n", ",", "t"}], "]"}]}]}], "}"}]}]}], "\n", "|>"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"DiscreteConservedQOperator", "[", "variables", "]"}], "[", 
  RowBox[{"u", "[", 
   RowBox[{"n", ",", "t"}], "]"}], "]"}]}], "Input",
 CellLabel->"In[29]:=",ExpressionUUID->"ca8e6ffe-cc27-4263-accf-638c63757e9d"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {"True", 
        RowBox[{
         RowBox[{"a", "\[Equal]", "0"}], "||", 
         RowBox[{"a", "\[Equal]", "1"}]}]},
       {"False", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "a"}], ")"}], " ", "a"}], "\[NotEqual]", 
         "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{3.858495777731412*^9},
 CellLabel->"Out[30]=",ExpressionUUID->"0dd70654-2b1f-4c14-b4e9-e6b49e767e63"]
}, Open  ]]
}, Open  ]],

Cell["Finding a basis (for explicit schemes only)", "Subsubsection",
 CellChangeTimes->{{3.859508928608246*^9, 3.85950893205153*^9}, {
  3.8595097541785107`*^9, 
  3.8595097606901283`*^9}},ExpressionUUID->"2af39c17-1b2d-4d29-9906-\
00225f5cd09a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Further ideas", "Subsection",
 CellChangeTimes->{{3.8584942255543737`*^9, 
  3.858494230752021*^9}},ExpressionUUID->"49853718-8813-4ebd-bb2b-\
7e34bf9e24bc"],

Cell[CellGroupData[{

Cell["PDE to scheme", "Subsubsection",
 CellChangeTimes->{{3.858520083124577*^9, 
  3.8585200870906677`*^9}},ExpressionUUID->"41a975c3-1527-44cb-9b77-\
64acbf1e2983"],

Cell["\<\
The idea is to have a function that given a PDE will build numerical schemes \
with \[OpenCurlyDoubleQuote]good\[CloseCurlyDoubleQuote] properties\
\>", "Text",
 CellChangeTimes->{{3.858520095006052*^9, 
  3.858520123145823*^9}},ExpressionUUID->"4af936ad-a71a-4162-96d6-\
a622da35009b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Scheme to PDE", "Subsubsection",
 CellChangeTimes->{{3.858579688897463*^9, 
  3.85857969540469*^9}},ExpressionUUID->"91278940-869d-46cd-b821-\
ca2147438351"],

Cell["The inverse of pde to scheme", "Text",
 CellChangeTimes->{{3.858579698205179*^9, 3.8585797065169897`*^9}, {
  3.859259026909321*^9, 
  3.8592590277991753`*^9}},ExpressionUUID->"c39ee50e-c671-4d5e-b8bb-\
19cfbb199372"]
}, Open  ]],

Cell["Experimental test of conservation and positivity", "Subsubsection",
 CellChangeTimes->{{3.859259029724359*^9, 
  3.859259043382156*^9}},ExpressionUUID->"2c39ba29-665d-411c-80f4-\
c44afddcccba"],

Cell["Testing positivity preservation", "Subsubsection",
 CellChangeTimes->{{3.859259046002596*^9, 
  3.859259066898231*^9}},ExpressionUUID->"a3f37dca-0d5b-4dc9-bf93-\
333cf9aa0226"],

Cell[CellGroupData[{

Cell["Finite Elements", "Subsubsection",
 CellChangeTimes->{{3.8595086462371693`*^9, 
  3.859508649776085*^9}},ExpressionUUID->"e25b13c5-30c7-424a-af80-\
f6af136576fd"],

Cell["\<\
Apply these methods to finite elements by regarding them as coupled systems \
of ODEs\
\>", "Text",
 CellChangeTimes->{{3.859508652786798*^9, 
  3.8595086773877974`*^9}},ExpressionUUID->"655ead14-d5df-4342-bc4a-\
142f844d74f8"]
}, Open  ]]
}, Open  ]],

Cell["", "Subsection",
 CellChangeTimes->{{3.8584942255543737`*^9, 3.858494230752021*^9}, {
   3.859249201724903*^9, 3.8592492028751497`*^9}, 
   3.859259025060519*^9},ExpressionUUID->"fb7746d1-9a18-4a7a-afd8-\
50d1ff6484f0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solving PDEs", "Section",
 CellChangeTimes->{{3.8584943008820763`*^9, 3.8584943091006517`*^9}, {
  3.859357785785137*^9, 
  3.859357789010356*^9}},ExpressionUUID->"977c5cbd-9f7b-4fcf-9b6c-\
4f7b666cc35e"],

Cell["Basic PDE manipulation", "Subsection",
 CellChangeTimes->{{3.859357794437024*^9, 
  3.8593578002047863`*^9}},ExpressionUUID->"30df6397-c44a-4796-8ef4-\
3283630799b6"],

Cell["Overdetermined systems", "Subsection",
 CellChangeTimes->{{3.859357803671241*^9, 
  3.859357812698497*^9}},ExpressionUUID->"7115331a-3710-413a-974d-\
588955fbae20"],

Cell[CellGroupData[{

Cell["Further ideas", "Subsection",
 CellChangeTimes->{{3.8584942255543737`*^9, 
  3.858494230752021*^9}},ExpressionUUID->"f806dc49-74f6-4fd5-a225-\
731a86d87a48"],

Cell["\<\
Get determining equations for conservation laws and for integrating factors.
Get determining equations for symmetries.
Get determining equations for inverse Euler-Lagrange equations of arbitrary \
order\
\>", "Text",
 CellChangeTimes->{{3.859249908257362*^9, 3.8592499579889708`*^9}, {
  3.859250409422367*^9, 3.859250411275097*^9}, {3.8592985703289747`*^9, 
  3.859298604299961*^9}},ExpressionUUID->"1ef9e211-b575-4974-bf0e-\
f5ad2c4488dd"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Testing and verification", "Section",
 CellChangeTimes->{{3.858493042121344*^9, 
  3.8584930483822737`*^9}},ExpressionUUID->"dc49d5f7-0f76-47d3-b4ed-\
9fc35c480593"],

Cell[CellGroupData[{

Cell["Test Operator", "Subsection",
 CellChangeTimes->{{3.85924998232576*^9, 
  3.859249987455365*^9}},ExpressionUUID->"0d440f2b-903b-4e32-853b-\
fdae6b824d44"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", "u", "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}], ",", 
     RowBox[{"\"\<timederivativeorder\>\"", "\[Rule]", "1"}], ",", 
     RowBox[{"\"\<eqRhs\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"u", "[", "x", "]"}], 
         RowBox[{
          RowBox[{"u", "'"}], "[", "x", "]"}]}], "+", 
        RowBox[{
         RowBox[{"u", "'''"}], "[", "x", "]"}]}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FindConservedQuantityOperator", "[", "variables", "]"}], "[", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<degree\>\"", "\[Rule]", "3"}], ",", 
     RowBox[{"\"\<derivatives\>\"", "\[Rule]", "1"}]}], "]"}], "]"}], "//", 
  "TestOperator"}]}], "Input",
 CellChangeTimes->{{3.859298532850708*^9, 3.859298536161215*^9}},
 CellLabel->
  "In[437]:=",ExpressionUUID->"d85ca6d3-0f21-4a70-885f-f161a0eaabcb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"True", ",", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[FormalA]", "1"], " ", 
     RowBox[{"u", "[", "x", "]"}]}], "+", 
    RowBox[{
     SubscriptBox["\[FormalA]", "2"], " ", 
     SuperscriptBox[
      RowBox[{"u", "[", "x", "]"}], "2"]}], "-", 
    RowBox[{
     FractionBox["1", "3"], " ", 
     SubscriptBox["\[FormalA]", "4"], " ", 
     SuperscriptBox[
      RowBox[{"u", "[", "x", "]"}], "3"]}], "+", 
    RowBox[{
     SubscriptBox["\[FormalA]", "4"], " ", 
     SuperscriptBox[
      RowBox[{
       SuperscriptBox["u", "\[Prime]",
        MultilineFunction->None], "[", "x", "]"}], "2"]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.859450971241376*^9},
 CellLabel->
  "Out[438]=",ExpressionUUID->"3b1622d5-82c0-40ec-bcd0-32e35bdcb509"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Further ideas", "Subsection",
 CellChangeTimes->{{3.859509778889406*^9, 
  3.859509780659132*^9}},ExpressionUUID->"20f5b960-fa38-4707-8f0f-\
9476d5f44ae4"],

Cell["\<\
need to document which functions are tested with necessary or sufficient \
conditions 
need to check if the test operator works with HeaderOperator\
\>", "Text",
 CellChangeTimes->{{3.8595097830114202`*^9, 
  3.859509818231339*^9}},ExpressionUUID->"ceb09385-c211-4cb7-a243-\
1023c794d8f4"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1424, 700},
WindowMargins->{{Automatic, 6}, {Automatic, 0}},
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (May 11, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"0cf6564e-c4cd-48bf-b1b0-b36428bf0fac"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 139, 2, 30, "Input",ExpressionUUID->"6725cdff-6134-44e5-8358-e62b50a43511"],
Cell[CellGroupData[{
Cell[722, 26, 230, 4, 67, "Section",ExpressionUUID->"a2bc80cc-6d82-4929-942f-0bdf5bc1caa2"],
Cell[CellGroupData[{
Cell[977, 34, 163, 3, 54, "Subsection",ExpressionUUID->"80baef63-c07a-46e6-9002-ea4317b93094"],
Cell[CellGroupData[{
Cell[1165, 41, 168, 3, 45, "Subsubsection",ExpressionUUID->"9c1c551d-1167-48a1-a6c0-15a0df10b65d"],
Cell[CellGroupData[{
Cell[1358, 48, 707, 20, 30, "Input",ExpressionUUID->"8c8c2f9a-3db2-4b13-8113-d3d25f81f611"],
Cell[2068, 70, 1454, 43, 51, "Output",ExpressionUUID->"a97025a3-2e13-4104-bdd6-f87d167d38e4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3559, 118, 893, 22, 73, "Input",ExpressionUUID->"71455e47-439a-4133-9074-7cba90cad369"],
Cell[4455, 142, 1515, 43, 51, "Output",ExpressionUUID->"504125ec-ed6b-43c9-960a-0f0ab0baac31"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[6019, 191, 219, 4, 45, "Subsubsection",ExpressionUUID->"2a1740b1-a3b3-41bb-b67a-d614faf4cc60"],
Cell[CellGroupData[{
Cell[6263, 199, 616, 18, 30, "Input",ExpressionUUID->"2b6c8226-3535-4825-904f-bfa5408c23cd"],
Cell[6882, 219, 1474, 44, 69, "Output",ExpressionUUID->"93eef66e-b05a-4874-9301-9dd3aecb3e09"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8393, 268, 623, 17, 30, "Input",ExpressionUUID->"1ca11699-b186-4564-b606-7f75709123fb"],
Cell[9019, 287, 1592, 47, 69, "Output",ExpressionUUID->"ae497828-07cd-4554-a8f4-efdceea176d3"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[10660, 340, 228, 4, 45, "Subsubsection",ExpressionUUID->"47fec98b-ecf6-4ffc-ade0-45acd65ce39b"],
Cell[CellGroupData[{
Cell[10913, 348, 1976, 59, 95, "Input",ExpressionUUID->"f58a492d-c058-473a-9079-b70d72dfe5f7"],
Cell[12892, 409, 1896, 59, 113, "Output",ExpressionUUID->"7a347d56-e0f7-41d1-a6ff-29213b41c3e4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14825, 473, 1517, 41, 117, "Input",ExpressionUUID->"d6f283cd-3e73-4e62-aff4-24d23824b141"],
Cell[16345, 516, 1735, 52, 71, "Output",ExpressionUUID->"de05e424-9d49-4068-b4d6-b005c0b0a899"],
Cell[18083, 570, 1845, 56, 71, "Output",ExpressionUUID->"69a32f1e-977b-431e-9dc3-4485d4a9efc4"],
Cell[19931, 628, 1785, 53, 73, "Output",ExpressionUUID->"4d3731d0-379e-434f-999f-3766a90c940a"],
Cell[21719, 683, 1845, 56, 71, "Output",ExpressionUUID->"22c81aed-7a28-4a92-8699-7faee089f493"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23601, 744, 334, 8, 30, "Input",ExpressionUUID->"61b6d816-71e5-4ef4-b2c2-d2c7a5027fe7"],
Cell[23938, 754, 1794, 55, 71, "Output",ExpressionUUID->"9d4e4b2d-a81e-4e93-bfc7-d85556184296"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[25781, 815, 177, 3, 45, "Subsubsection",ExpressionUUID->"03829598-235e-4d3c-8749-a1d192bb9c1f"],
Cell[25961, 820, 257, 6, 30, "Input",ExpressionUUID->"670df50d-e971-435b-960e-dc6ea3fd1346"],
Cell[26221, 828, 125, 1, 30, "Input",ExpressionUUID->"13056ac9-c056-43f3-aa83-cdc0fca22f38"],
Cell[CellGroupData[{
Cell[26371, 833, 1081, 33, 73, "Input",ExpressionUUID->"861a52b9-8ab4-43ee-ab8f-7468ae5b864a"],
Cell[27455, 868, 1580, 48, 71, "Output",ExpressionUUID->"0e17b44e-d8b8-44db-b28c-e62626a879e6"],
Cell[29038, 918, 281, 8, 34, "Output",ExpressionUUID->"948af24f-2e5e-4168-bdaa-b77d28f2efe7"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[29380, 933, 156, 3, 54, "Subsection",ExpressionUUID->"4311a9c7-e5bd-448a-a08a-b9c574a197e4"],
Cell[29539, 938, 156, 3, 30, "Input",ExpressionUUID->"4bd2af94-6b4d-4fb9-960f-0990b2620848"],
Cell[29698, 943, 185, 3, 30, "Input",ExpressionUUID->"96563694-f1b4-4717-82ea-916976995915"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29920, 951, 168, 3, 54, "Subsection",ExpressionUUID->"3bb16392-f4a1-406e-bc69-51a03c833056"],
Cell[CellGroupData[{
Cell[30113, 958, 629, 17, 30, "Input",ExpressionUUID->"007f3345-0716-49d6-9fc4-ff81455b6251"],
Cell[30745, 977, 405, 12, 37, "Output",ExpressionUUID->"613c71d4-7b04-4c3c-ba0a-7838b27ff0e4"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[31199, 995, 245, 4, 54, "Subsection",ExpressionUUID->"caac2498-0049-4f55-a1da-c359748626ed"],
Cell[CellGroupData[{
Cell[31469, 1003, 1053, 30, 52, "Input",ExpressionUUID->"c129c220-26e6-431c-8622-f3ac5083485c"],
Cell[32525, 1035, 1444, 44, 37, "Output",ExpressionUUID->"2fd23bb9-40a0-4bd2-9e8c-791fc7aeeffc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34006, 1084, 734, 21, 52, "Input",ExpressionUUID->"8d13791d-f39f-4d73-9e8e-5942074cc14f"],
Cell[34743, 1107, 467, 14, 34, "Output",ExpressionUUID->"b98f82d7-63a8-42bc-a468-fb15dcbd39e0"]
}, Open  ]],
Cell[35225, 1124, 287, 7, 30, "Input",ExpressionUUID->"d328e72b-986d-4574-850e-94b76fd81e68"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35549, 1136, 242, 4, 54, "Subsection",ExpressionUUID->"51dc473a-9bd6-41ab-950f-db38bf8a5710"],
Cell[CellGroupData[{
Cell[35816, 1144, 760, 22, 52, "Input",ExpressionUUID->"8df024d6-fb66-4d17-adc6-54266fd9fb63"],
Cell[36579, 1168, 1792, 55, 87, "Output",ExpressionUUID->"2004864b-a56a-41d5-82b2-40450bb7ef8d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38408, 1228, 800, 23, 73, "Input",ExpressionUUID->"76f5794c-248f-4b9d-a83e-5d30d2d8cfd3"],
Cell[39211, 1253, 1664, 50, 71, "Output",ExpressionUUID->"7679ba64-a9c9-47e1-ab11-0ec9fe27299f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[40924, 1309, 202, 4, 54, "Subsection",ExpressionUUID->"d2c08158-93d9-4311-b18c-d7418bec4a32"],
Cell[41129, 1315, 176, 3, 30, "Input",ExpressionUUID->"136718ef-e337-40ff-b2f4-2ad30efea82c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41342, 1323, 163, 3, 54, "Subsection",ExpressionUUID->"f1800d3f-e9fc-4aa4-b337-84bdfc688161"],
Cell[41508, 1328, 480, 9, 58, "Text",ExpressionUUID->"3d114692-433d-4229-b36a-037de528c7e7"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[42037, 1343, 161, 3, 67, "Section",ExpressionUUID->"21e514b7-a8f6-4a5a-abe2-fd9921101c17"],
Cell[42201, 1348, 184, 3, 35, "Text",ExpressionUUID->"6938b28b-77dc-41fe-afb5-a5f3cac8b462"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42422, 1356, 159, 3, 67, "Section",ExpressionUUID->"3299be97-3ea1-431b-a23c-bbe5188706ef"],
Cell[CellGroupData[{
Cell[42606, 1363, 167, 3, 54, "Subsection",ExpressionUUID->"249a3820-287a-46f6-bf04-b19ad66cf02c"],
Cell[CellGroupData[{
Cell[42798, 1370, 742, 22, 30, "Input",ExpressionUUID->"4bad1a16-6a40-4f04-a0eb-b07a7334ef40"],
Cell[43543, 1394, 531, 15, 37, "Output",ExpressionUUID->"a7f64fb5-1844-49e7-8c4a-f132735070c4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44111, 1414, 1072, 31, 52, "Input",ExpressionUUID->"a9da7406-d389-42bc-a326-eeaaa0880632"],
Cell[45186, 1447, 2128, 65, 99, "Output",ExpressionUUID->"cdc49a47-4e5f-4361-a0d2-277a0be5d887"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47351, 1517, 720, 23, 30, "Input",ExpressionUUID->"8a78f129-4f4e-4a4a-bea3-ee8b2ac923d0"],
Cell[48074, 1542, 1897, 58, 67, "Output",ExpressionUUID->"78d0a741-606b-4b25-88aa-3f0cfc914365"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50008, 1605, 787, 24, 30, "Input",ExpressionUUID->"5a0bd282-6d2a-4b7c-801d-82a436baa58c"],
Cell[50798, 1631, 1694, 52, 69, "Output",ExpressionUUID->"47025b23-ffbd-4089-871f-0cd327cc13ce"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[52541, 1689, 162, 3, 54, "Subsection",ExpressionUUID->"f4f12220-de71-4238-99b4-48e1d6c17e32"],
Cell[CellGroupData[{
Cell[52728, 1696, 630, 17, 30, "Input",ExpressionUUID->"73a294fb-4546-4dd6-b0e0-3b0a69b11c00"],
Cell[53361, 1715, 338, 8, 34, "Output",ExpressionUUID->"7bcdffcf-ef13-4e70-bd4d-33467eece9c5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53736, 1728, 1134, 31, 52, "Input",ExpressionUUID->"08b91d09-4a8b-4e49-b6c6-81ff549e0aa7"],
Cell[54873, 1761, 3815, 113, 183, "Output",ExpressionUUID->"c43b6189-01fc-4a29-8119-b7fc31fa7fe1"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[58737, 1880, 182, 3, 54, "Subsection",ExpressionUUID->"1d259232-3680-4cf8-b99c-e7c3e023ac7a"],
Cell[CellGroupData[{
Cell[58944, 1887, 170, 3, 45, "Subsubsection",ExpressionUUID->"7553b524-97f2-4084-a028-7f2b9fee1b70"],
Cell[CellGroupData[{
Cell[59139, 1894, 1035, 25, 199, "Input",ExpressionUUID->"8536d65d-6508-4b28-92bf-d6ae32efb9ff"],
Cell[60177, 1921, 2256, 83, 37, "Output",ExpressionUUID->"82abce46-5e02-4359-96d9-26de560a7b15"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[62482, 2010, 180, 3, 45, "Subsubsection",ExpressionUUID->"5d318674-bf8a-4378-b86c-ddf91be32f64"],
Cell[CellGroupData[{
Cell[62687, 2017, 411, 11, 30, "Input",ExpressionUUID->"308db3df-ac56-4f18-a9a1-2881d00f4b28"],
Cell[63101, 2030, 607, 18, 37, "Output",ExpressionUUID->"e09ebc5b-89d6-42a4-a83d-c192712d8111"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[63757, 2054, 231, 4, 45, "Subsubsection",ExpressionUUID->"522ab974-afeb-4c5f-85ee-dcaa9d5b242b"],
Cell[CellGroupData[{
Cell[64013, 2062, 1208, 30, 241, "Input",ExpressionUUID->"ac41955c-382f-452f-a86f-6fc50f0b4a90"],
Cell[65224, 2094, 1828, 56, 95, "Output",ExpressionUUID->"13f12f4b-16ab-4c0d-bcc0-adfdebbe25c2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67089, 2155, 891, 23, 121, "Input",ExpressionUUID->"a2341ab4-dde3-4f35-81a4-dba954b861d5"],
Cell[67983, 2180, 1771, 53, 77, "Output",ExpressionUUID->"4a6bbbb3-db7e-4d9d-8248-faf0941454cf"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[69803, 2239, 190, 3, 45, "Subsubsection",ExpressionUUID->"b0d81635-f58e-474e-859f-ca7da795810f"],
Cell[CellGroupData[{
Cell[70018, 2246, 1201, 33, 178, "Input",ExpressionUUID->"56e5ea32-1a7b-4270-a3ff-a9da48aaff1c"],
Cell[71222, 2281, 684, 19, 37, "Output",ExpressionUUID->"bbe88269-cd8a-4532-8762-c20d600635fc"],
Cell[71909, 2302, 582, 16, 37, "Output",ExpressionUUID->"097c11b7-e760-414e-98a3-b3e62d09ffe7"],
Cell[72494, 2320, 684, 19, 37, "Output",ExpressionUUID->"45914e4f-0e56-4649-a964-66f4c2941af1"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[73239, 2346, 163, 3, 54, "Subsection",ExpressionUUID->"0b05244f-f5cc-4584-93a7-5332d6df4c7a"],
Cell[73405, 2351, 194, 3, 35, "Text",ExpressionUUID->"b7aba881-485f-4be8-9a4e-a2cecbcd9b59"],
Cell[CellGroupData[{
Cell[73624, 2358, 186, 3, 45, "Subsubsection",ExpressionUUID->"8b0f1559-a968-4723-a288-f87753b31920"],
Cell[73813, 2363, 230, 5, 35, "Text",ExpressionUUID->"0c3efae7-57af-4fc0-8b63-faa20900fd0e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74080, 2373, 176, 3, 45, "Subsubsection",ExpressionUUID->"b55b2bc0-b348-4b90-8f9f-41ebefd5e2a9"],
Cell[74259, 2378, 308, 7, 35, "Text",ExpressionUUID->"dcd711d9-ed4c-41bd-bf7e-9cca59bfa0b8"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[74628, 2392, 161, 3, 67, "Section",ExpressionUUID->"1ad90fbc-7423-4aa5-a72a-f0274b66c25e"],
Cell[74792, 2397, 237, 6, 35, "Text",ExpressionUUID->"17330bcd-49f2-44b9-a9e4-6bf30f1d6180"],
Cell[CellGroupData[{
Cell[75054, 2407, 163, 3, 54, "Subsection",ExpressionUUID->"1421eb0e-d6a8-460d-b74b-1082989d2ca2"],
Cell[CellGroupData[{
Cell[75242, 2414, 168, 3, 45, "Subsubsection",ExpressionUUID->"be5ce378-7132-408b-bea1-09f124bb12e9"],
Cell[75413, 2419, 260, 6, 58, "Text",ExpressionUUID->"d6e6f2a5-60f0-4002-971b-23598660b66e"]
}, Open  ]],
Cell[75688, 2428, 172, 3, 45, "Subsubsection",ExpressionUUID->"7ef85fcb-e44f-44b1-8a63-1f5e1eae6b50"],
Cell[CellGroupData[{
Cell[75885, 2435, 201, 3, 37, "Subsubsection",ExpressionUUID->"7419263d-b35c-42b3-876d-1b9f3dc43a79"],
Cell[76089, 2440, 424, 7, 35, "Text",ExpressionUUID->"d8dd2be2-5b13-4ba3-a255-d5c0d1647d73"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76550, 2452, 165, 3, 45, "Subsubsection",ExpressionUUID->"7126f39d-caa0-447d-8f97-50b475ad94d6"],
Cell[76718, 2457, 196, 3, 35, "Text",ExpressionUUID->"c4e24b9b-2446-4f9c-8d95-307fda832351"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[76975, 2467, 165, 3, 67, "Section",ExpressionUUID->"156248cd-5e9b-4d16-a7cd-09fb1d421b68"],
Cell[CellGroupData[{
Cell[77165, 2474, 173, 3, 54, "Subsection",ExpressionUUID->"b1c01f4d-7e2d-4d4d-9745-1b7667bb80ea"],
Cell[CellGroupData[{
Cell[77363, 2481, 192, 3, 45, "Subsubsection",ExpressionUUID->"efe479e4-b942-4edc-9708-71aa3b3b0a9f"],
Cell[CellGroupData[{
Cell[77580, 2488, 607, 16, 30, "Input",ExpressionUUID->"c759d76d-1861-4a62-87e1-ed1f12fb58a0"],
Cell[78190, 2506, 628, 19, 34, "Output",ExpressionUUID->"43e5688b-d108-4761-8ba2-ca0103242ba8"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[78867, 2531, 180, 3, 45, "Subsubsection",ExpressionUUID->"6e981ce6-3854-4776-8f41-48a73227ca2d"],
Cell[CellGroupData[{
Cell[79072, 2538, 968, 27, 52, "Input",ExpressionUUID->"01ced711-d53a-4949-a552-d2e147d5da13",
 CellID->527423912],
Cell[80043, 2567, 864, 23, 34, "Output",ExpressionUUID->"71d7a8de-fd4a-46bf-a520-5a76d7bef828"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[80956, 2596, 174, 3, 45, "Subsubsection",ExpressionUUID->"738c2529-b38a-4de3-9cc4-51490ac162d5"],
Cell[CellGroupData[{
Cell[81155, 2603, 819, 24, 30, "Input",ExpressionUUID->"85a3d164-4880-445d-879b-cdf7c1f1ff9d"],
Cell[81977, 2629, 676, 24, 37, "Output",ExpressionUUID->"9e9cc462-494d-44f6-9ee9-cc06ea8b54d7"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[82714, 2660, 170, 3, 54, "Subsection",ExpressionUUID->"f46ec1ff-b5f6-4552-a37d-490f6159fa64"],
Cell[CellGroupData[{
Cell[82909, 2667, 836, 24, 30, "Input",ExpressionUUID->"a1be2ca4-8994-4bbc-bcda-2eabf98fd219"],
Cell[83748, 2693, 536, 15, 37, "Output",ExpressionUUID->"66fd2b61-e91e-4e24-9452-c01b388f2e74"]
}, Open  ]],
Cell[CellGroupData[{
Cell[84321, 2713, 865, 24, 30, "Input",ExpressionUUID->"19f62023-74f4-43cf-ac28-77c71c09d782"],
Cell[85189, 2739, 502, 14, 34, "Output",ExpressionUUID->"031a5bad-d943-4b91-85d5-254a318cbbcd"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[85740, 2759, 176, 3, 54, "Subsection",ExpressionUUID->"f6c54b2c-29b4-4159-8a50-07c8d13e1b74"],
Cell[CellGroupData[{
Cell[85941, 2766, 828, 22, 52, "Input",ExpressionUUID->"baff7f2c-0a5f-4405-bfe6-d22747a527bb"],
Cell[86772, 2790, 1901, 57, 79, "Output",ExpressionUUID->"905532eb-6b3a-432c-a0bf-8492d8d9b8f6"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[88722, 2853, 197, 3, 54, "Subsection",ExpressionUUID->"743b2c8b-f24d-4792-af17-adde725817dc"],
Cell[CellGroupData[{
Cell[88944, 2860, 171, 3, 45, "Subsubsection",ExpressionUUID->"c2ba9341-730a-4851-9ce8-a8b8d89eb5a1"],
Cell[CellGroupData[{
Cell[89140, 2867, 880, 23, 52, "Input",ExpressionUUID->"a5eb0643-ff0d-4856-a8c3-8052c9f47b6c"],
Cell[90023, 2892, 2810, 84, 97, "Output",ExpressionUUID->"55a90ee3-246b-4316-b942-b3d21311bed6"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[92882, 2982, 260, 5, 45, "Subsubsection",ExpressionUUID->"3f03187b-818a-439b-ace3-fad22720843d"],
Cell[CellGroupData[{
Cell[93167, 2991, 804, 22, 52, "Input",ExpressionUUID->"e9511f56-3bb2-49b6-a133-88a765dc7bc5"],
Cell[93974, 3015, 7896, 226, 127, "Output",ExpressionUUID->"4e413941-6f68-49aa-8203-a21d4e8b737f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[101907, 3246, 726, 20, 52, "Input",ExpressionUUID->"d97d4246-6708-420b-8506-dc6eed35c4e7"],
Cell[102636, 3268, 1719, 57, 37, "Output",ExpressionUUID->"249f08bb-93cd-4cf4-8657-7a5ed111fa98"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[104428, 3333, 181, 3, 67, "Section",ExpressionUUID->"1a8346c0-0476-439e-93a7-8175752acbe9"],
Cell[CellGroupData[{
Cell[104634, 3340, 180, 3, 54, "Subsection",ExpressionUUID->"86307fa0-235a-45da-9395-bcb073bdd13e"],
Cell[CellGroupData[{
Cell[104839, 3347, 994, 28, 30, "Input",ExpressionUUID->"44d993c4-40e6-442c-b1d4-5459824d9693"],
Cell[105836, 3377, 2278, 68, 93, "Output",ExpressionUUID->"c9e7bea1-0f59-49d7-99a7-abb29aea8588"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[108163, 3451, 173, 3, 54, "Subsection",ExpressionUUID->"6f3e3760-7d9e-4072-aaf0-085a7e86c9b0"],
Cell[CellGroupData[{
Cell[108361, 3458, 698, 19, 52, "Input",ExpressionUUID->"413564ce-cf0c-4148-adbc-d970a5eeba64"],
Cell[109062, 3479, 416, 13, 34, "Output",ExpressionUUID->"c26e4cac-c9e4-49f1-8734-e221174ef82c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[109515, 3497, 601, 17, 30, "Input",ExpressionUUID->"cb6e1a55-48b8-487d-9883-a5fb32788d47"],
Cell[110119, 3516, 300, 8, 34, "Output",ExpressionUUID->"b54e648d-529c-4253-a9a4-e8ca60dcbdf5"]
}, Open  ]],
Cell[110434, 3527, 575, 16, 30, "Input",ExpressionUUID->"e32b7613-8b6a-40df-8a7e-3134a326fbde"]
}, Open  ]],
Cell[CellGroupData[{
Cell[111046, 3548, 169, 3, 54, "Subsection",ExpressionUUID->"24047d17-fa48-4d4f-9144-9ff5449c830e"],
Cell[CellGroupData[{
Cell[111240, 3555, 485, 13, 30, "Input",ExpressionUUID->"5669d80c-685f-457c-b3d9-e1c4017952d8"],
Cell[111728, 3570, 284, 7, 34, "Output",ExpressionUUID->"8bd3037f-c9a0-4634-b10c-120b3ff7efc5"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[112061, 3583, 169, 3, 54, "Subsection",ExpressionUUID->"0c9af3ff-a6f8-4ecd-a430-c551823e1baf"],
Cell[CellGroupData[{
Cell[112255, 3590, 580, 15, 52, "Input",ExpressionUUID->"7a11daa6-ede7-4c05-abea-e2d7a52eb651"],
Cell[112838, 3607, 998, 32, 37, "Output",ExpressionUUID->"bf8c72e7-00fc-4bfd-87bc-614c018c3f44"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[113885, 3645, 214, 4, 54, "Subsection",ExpressionUUID->"53298c08-a343-4f52-b551-b683a768f4d6"],
Cell[114102, 3651, 365, 8, 81, "Text",ExpressionUUID->"acf0fa56-8cad-4222-aea9-976fee4dc006"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[114516, 3665, 155, 3, 67, "Section",ExpressionUUID->"c17248f3-5340-4397-8ebf-c78b7b52fd35"],
Cell[CellGroupData[{
Cell[114696, 3672, 179, 3, 54, "Subsection",ExpressionUUID->"dd417bf4-87dc-4f3e-9dc4-4adc6c410e54"],
Cell[CellGroupData[{
Cell[114900, 3679, 1451, 42, 73, "Input",ExpressionUUID->"0798e5da-23cd-4dc1-89d3-af4ca617cd1f"],
Cell[116354, 3723, 1950, 54, 55, "Output",ExpressionUUID->"79e83310-0168-4ccc-876e-1aecd407b91e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[118341, 3782, 970, 28, 73, "Input",ExpressionUUID->"ac4770d6-53c9-4660-9e4e-5ab720d8be1f"],
Cell[119314, 3812, 2175, 62, 55, "Output",ExpressionUUID->"bf55672e-3393-4bc3-841a-d83bf9485cbd"],
Cell[121492, 3876, 1699, 50, 55, "Output",ExpressionUUID->"02f37f39-cb41-4f2b-9e76-5f6530022cd4"]
}, Open  ]]
}, Open  ]],
Cell[123218, 3930, 180, 3, 54, "Subsection",ExpressionUUID->"6219a5a4-86a0-441c-9c91-6d722a4478d7"],
Cell[CellGroupData[{
Cell[123423, 3937, 245, 4, 38, "Subsection",ExpressionUUID->"c36e13a2-fc98-4848-9a48-956713fbe2e8"],
Cell[CellGroupData[{
Cell[123693, 3945, 1453, 42, 73, "Input",ExpressionUUID->"6485d785-eef2-4bfc-a52b-6afaea467b13"],
Cell[125149, 3989, 1589, 47, 55, "Output",ExpressionUUID->"9c145f7c-2fd3-4c07-b227-c6ba3ab77d7a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[126775, 4041, 1657, 45, 73, "Input",ExpressionUUID->"91df30ad-d080-438d-80e4-60e44feb4ee2"],
Cell[128435, 4088, 1574, 45, 51, "Output",ExpressionUUID->"a73e530a-9aa4-4cc1-92d5-a3e3d2b3b3ad"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[130058, 4139, 155, 3, 54, "Subsection",ExpressionUUID->"7e5f273c-beaa-4737-ad21-6abdc3feed19"],
Cell[CellGroupData[{
Cell[130238, 4146, 1026, 25, 157, "Input",ExpressionUUID->"96a256ef-c3c8-445b-a46f-fe3f5285ec45"],
Cell[131267, 4173, 2425, 68, 79, "Output",ExpressionUUID->"0d2e5f07-90ef-4b40-bebf-219a29c1c3eb"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[133741, 4247, 214, 4, 54, "Subsection",ExpressionUUID->"b15e0952-7a7c-4854-960a-bf8d0adb57d1"],
Cell[133958, 4253, 221, 5, 35, "Text",ExpressionUUID->"5e036ce8-dfd7-4099-9fef-67f29b0026a6"],
Cell[CellGroupData[{
Cell[134204, 4262, 262, 6, 30, "Input",ExpressionUUID->"3cd42f7b-8954-42bd-8faa-867c111b1d6c"],
Cell[134469, 4270, 193, 4, 24, "Print",ExpressionUUID->"a5099e7a-b7d4-4c38-be39-c04527f1a0fa"],
Cell[134665, 4276, 1159, 32, 37, "Output",ExpressionUUID->"6bdb1ad1-81be-4587-bde4-bcede9762b8c"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[135885, 4315, 164, 3, 67, "Section",ExpressionUUID->"209f5b68-70ca-457d-ae79-b2f2899ebeb6"],
Cell[CellGroupData[{
Cell[136074, 4322, 167, 3, 54, "Subsection",ExpressionUUID->"04de3792-c04c-4a9b-8e74-e49fefdd857c"],
Cell[CellGroupData[{
Cell[136266, 4329, 869, 21, 52, "Input",ExpressionUUID->"ee1953fa-0ac5-4297-a773-78538eb2f5c7"],
Cell[137138, 4352, 980, 31, 34, "Output",ExpressionUUID->"664b939d-b3dd-4d50-bcc6-2680392d9517"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[138167, 4389, 246, 4, 54, "Subsection",ExpressionUUID->"8faf428f-83d4-4c9b-9bf1-cd3eb560148a"],
Cell[CellGroupData[{
Cell[138438, 4397, 1030, 28, 73, "Input",ExpressionUUID->"8127ac85-ed6a-41b8-8c55-5edbec29b51c"],
Cell[139471, 4427, 705, 22, 51, "Output",ExpressionUUID->"1bcd35d5-b289-4c94-924e-e9048129ed47"]
}, Open  ]],
Cell[CellGroupData[{
Cell[140213, 4454, 1034, 28, 73, "Input",ExpressionUUID->"894e1fb1-43ac-4d58-941d-9838c496813f"],
Cell[141250, 4484, 566, 17, 51, "Output",ExpressionUUID->"e3472d56-b0e8-4886-a7af-3fdac3562f89"]
}, Open  ]],
Cell[141831, 4504, 289, 7, 35, "Text",ExpressionUUID->"466ffce4-a2b1-4d87-b345-b63e08c08a1f"],
Cell[CellGroupData[{
Cell[142145, 4515, 1373, 37, 52, "Input",ExpressionUUID->"cf5d8770-f80d-4b99-b431-45d1874d526c"],
Cell[143521, 4554, 397, 11, 37, "Output",ExpressionUUID->"0c045231-25a2-4c90-a094-ed1bb2259cfa"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[143967, 4571, 267, 4, 54, "Subsection",ExpressionUUID->"a369de74-9faf-4384-a69f-115ba8117b0e"],
Cell[144237, 4577, 1655, 47, 73, "Input",ExpressionUUID->"403ae5a8-804e-42ce-b6e3-13019701a3ca"],
Cell[145895, 4626, 2368, 82, 54, InheritFromParent,ExpressionUUID->"99b54882-adc5-4989-a67c-7f8a64bb12f1"],
Cell[CellGroupData[{
Cell[148288, 4712, 210, 5, 30, "Input",ExpressionUUID->"a2246de0-247b-47e7-b234-c5904d12593c"],
Cell[148501, 4719, 2393, 83, 37, "Output",ExpressionUUID->"6dd402b4-471b-4b6c-a345-6740a72dc74f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[150943, 4808, 163, 3, 54, "Subsection",ExpressionUUID->"f0fad840-9a51-4598-a336-f6010eab6f4f"],
Cell[CellGroupData[{
Cell[151131, 4815, 169, 3, 45, "Subsubsection",ExpressionUUID->"0100de3f-03d7-479a-92a1-2b57b87402b8"],
Cell[151303, 4820, 275, 6, 35, "Text",ExpressionUUID->"2f416931-0fb8-4ab2-87e4-2c58d8361552"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[151639, 4833, 163, 3, 67, "Section",ExpressionUUID->"4bbae880-0036-4fe8-92ba-881fad0c5692"],
Cell[CellGroupData[{
Cell[151827, 4840, 181, 3, 54, "Subsection",ExpressionUUID->"debbdf6f-489d-40d2-ac38-c5f268f5945b"],
Cell[CellGroupData[{
Cell[152033, 4847, 165, 3, 45, "Subsubsection",ExpressionUUID->"253fb072-1c66-48df-adcf-e257fb8e3095"],
Cell[152201, 4852, 487, 12, 94, "Input",ExpressionUUID->"c41c6a41-8d05-4243-b6d3-7f905a7408da"],
Cell[CellGroupData[{
Cell[152713, 4868, 346, 10, 30, "Input",ExpressionUUID->"b9df1777-980f-4d19-8608-594712256e66"],
Cell[153062, 4880, 386, 10, 34, "Output",ExpressionUUID->"15cfe6ef-6110-47fc-9a6e-225e7c11fd93"]
}, Open  ]],
Cell[CellGroupData[{
Cell[153485, 4895, 388, 10, 30, "Input",ExpressionUUID->"34a236f3-4e9b-4062-ac6d-405f1fcf3c25"],
Cell[153876, 4907, 366, 9, 34, "Output",ExpressionUUID->"3f7f75ae-3cc1-4a6f-888f-b806dcc84514"]
}, Open  ]],
Cell[CellGroupData[{
Cell[154279, 4921, 922, 24, 30, "Input",ExpressionUUID->"b98943ae-b74e-430d-b50c-cae05c073fb0"],
Cell[155204, 4947, 469, 14, 34, "Output",ExpressionUUID->"ed307c75-2375-4077-bfef-ff73efd87b92"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[155722, 4967, 170, 3, 45, "Subsubsection",ExpressionUUID->"302f2e42-0c40-455d-b09a-858af2f87cb3"],
Cell[CellGroupData[{
Cell[155917, 4974, 1388, 39, 157, "Input",ExpressionUUID->"1740b88d-e221-4c66-8987-f8ad21585ef2"],
Cell[157308, 5015, 631, 17, 37, "Output",ExpressionUUID->"61998da2-2662-4ba3-8a49-acae75d556b9"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[158000, 5039, 172, 3, 54, "Subsection",ExpressionUUID->"80c5cb1e-0ba4-46dd-b7bf-6ae152818eee"],
Cell[CellGroupData[{
Cell[158197, 5046, 169, 3, 45, "Subsubsection",ExpressionUUID->"9c632aa3-6385-40ef-bd95-3a59949d5e1d"],
Cell[CellGroupData[{
Cell[158391, 5053, 1659, 48, 136, "Input",ExpressionUUID->"526426ee-ed51-4df0-932a-bf857b0af135"],
Cell[160053, 5103, 575, 16, 37, "Output",ExpressionUUID->"7465e783-00b5-4d5a-802a-459a2843767c"],
Cell[160631, 5121, 575, 16, 37, "Output",ExpressionUUID->"8c3d6c6c-7790-4a62-b4e3-73c3f8585394"],
Cell[161209, 5139, 577, 16, 37, "Output",ExpressionUUID->"9652b231-250e-41a6-a110-da6e188be9dd"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[161835, 5161, 169, 3, 45, "Subsubsection",ExpressionUUID->"a1d24c73-e40a-4495-bcdf-c5a436404351"],
Cell[CellGroupData[{
Cell[162029, 5168, 874, 25, 52, "Input",ExpressionUUID->"cbd98607-119a-4485-9b62-f06b6ac0a698"],
Cell[162906, 5195, 567, 16, 37, "Output",ExpressionUUID->"4d307046-b48c-4841-9f3d-09b86b84eae9"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[163534, 5218, 226, 4, 54, "Subsection",ExpressionUUID->"d0fd2db2-e2c7-4573-bf98-1135d8ec241f"],
Cell[CellGroupData[{
Cell[163785, 5226, 161, 3, 45, "Subsubsection",ExpressionUUID->"104291ab-c1d8-4b29-b796-3ef33849d56f"],
Cell[CellGroupData[{
Cell[163971, 5233, 975, 26, 157, "Input",ExpressionUUID->"ca8e6ffe-cc27-4263-accf-638c63757e9d"],
Cell[164949, 5261, 1591, 48, 69, "Output",ExpressionUUID->"0dd70654-2b1f-4c14-b4e9-e6b49e767e63"]
}, Open  ]]
}, Open  ]],
Cell[166567, 5313, 246, 4, 45, "Subsubsection",ExpressionUUID->"2af39c17-1b2d-4d29-9906-00225f5cd09a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[166850, 5322, 163, 3, 54, "Subsection",ExpressionUUID->"49853718-8813-4ebd-bb2b-7e34bf9e24bc"],
Cell[CellGroupData[{
Cell[167038, 5329, 166, 3, 45, "Subsubsection",ExpressionUUID->"41a975c3-1527-44cb-9b77-64acbf1e2983"],
Cell[167207, 5334, 296, 6, 35, "Text",ExpressionUUID->"4af936ad-a71a-4162-96d6-a622da35009b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[167540, 5345, 163, 3, 45, "Subsubsection",ExpressionUUID->"91278940-869d-46cd-b821-ca2147438351"],
Cell[167706, 5350, 223, 4, 35, "Text",ExpressionUUID->"c39ee50e-c671-4d5e-b8bb-19cfbb199372"]
}, Open  ]],
Cell[167944, 5357, 199, 3, 45, "Subsubsection",ExpressionUUID->"2c39ba29-665d-411c-80f4-c44afddcccba"],
Cell[168146, 5362, 182, 3, 37, "Subsubsection",ExpressionUUID->"a3f37dca-0d5b-4dc9-bf93-333cf9aa0226"],
Cell[CellGroupData[{
Cell[168353, 5369, 168, 3, 37, "Subsubsection",ExpressionUUID->"e25b13c5-30c7-424a-af80-f6af136576fd"],
Cell[168524, 5374, 237, 6, 35, "Text",ExpressionUUID->"655ead14-d5df-4342-bc4a-142f844d74f8"]
}, Open  ]]
}, Open  ]],
Cell[168788, 5384, 225, 4, 54, "Subsection",ExpressionUUID->"fb7746d1-9a18-4a7a-afd8-50d1ff6484f0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[169050, 5393, 210, 4, 67, "Section",ExpressionUUID->"977c5cbd-9f7b-4fcf-9b6c-4f7b666cc35e"],
Cell[169263, 5399, 172, 3, 54, "Subsection",ExpressionUUID->"30df6397-c44a-4796-8ef4-3283630799b6"],
Cell[169438, 5404, 170, 3, 38, "Subsection",ExpressionUUID->"7115331a-3710-413a-974d-588955fbae20"],
Cell[CellGroupData[{
Cell[169633, 5411, 163, 3, 38, "Subsection",ExpressionUUID->"f806dc49-74f6-4fd5-a225-731a86d87a48"],
Cell[169799, 5416, 451, 9, 81, "Text",ExpressionUUID->"1ef9e211-b575-4974-bf0e-f5ad2c4488dd"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[170299, 5431, 171, 3, 67, "Section",ExpressionUUID->"dc49d5f7-0f76-47d3-b4ed-9fc35c480593"],
Cell[CellGroupData[{
Cell[170495, 5438, 160, 3, 54, "Subsection",ExpressionUUID->"0d440f2b-903b-4e32-853b-fdae6b824d44"],
Cell[CellGroupData[{
Cell[170680, 5445, 1137, 30, 73, "Input",ExpressionUUID->"d85ca6d3-0f21-4a70-885f-f161a0eaabcb"],
Cell[171820, 5477, 795, 25, 51, "Output",ExpressionUUID->"3b1622d5-82c0-40ec-bcd0-32e35bdcb509"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[172664, 5508, 161, 3, 54, "Subsection",ExpressionUUID->"20f5b960-fa38-4707-8f0f-9476d5f44ae4"],
Cell[172828, 5513, 299, 7, 58, "Text",ExpressionUUID->"ceb09385-c211-4cb7-a243-1023c794d8f4"]
}, Open  ]]
}, Open  ]]
}
]
*)


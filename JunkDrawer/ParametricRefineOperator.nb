(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    294517,       8445]
NotebookOptionsPosition[    280230,       8209]
NotebookOutlinePosition[    280622,       8225]
CellTagsIndexPosition[    280579,       8222]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
A new version of parametric refine


\
\>", "Subsection",
 CellChangeTimes->{{3.8420759023082533`*^9, 
  3.8420759145113792`*^9}},ExpressionUUID->"e82dc81f-46ad-400d-99f9-\
b85a658cbaf7"],

Cell[BoxData[
 RowBox[{"Get", "[", "\"\<PDESymbolics2020`PDESymbolics2020`\>\"", 
  "]"}]], "Input",ExpressionUUID->"91c3c13c-23b3-4142-a13e-b0432f1d77d3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ParametricRefineOperatorX", "[", "variables_Association", "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"Function", "[", 
   RowBox[{"xp", ",", "\[IndentingNewLine]", 
    RowBox[{"Which", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xp", "===", "$Failed"}], ",", "\[IndentingNewLine]", "$Failed",
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Head", "[", "xp", "]"}], "===", "Piecewise"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"PiecewiseOperatorMap", "[", 
       RowBox[{"ParametricRefineOperatorX", ",", "variables", ",", "xp"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Head", "[", "xp", "]"}], "===", "List"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ParametricRefineOperatorX", "[", "variables", "]"}], "/@",
            "xp"}], ")"}], "//", "PiecewiseExpand"}], "//", 
        "PiecewiseListClean"}], "//", 
       RowBox[{"PiecewiseSimplifyOperator", "[", "variables", "]"}]}], ",", 
      "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xpp", "=", 
          RowBox[{
           RowBox[{"RegroupParametersOperator", "[", "variables", "]"}], "[", 
           "xp", "]"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"PiecewiseSimplifyOperator", "[", "variables", "]"}], "[", 
         RowBox[{"PiecewiseMap", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"xpp", "/.", " ", "#"}], "&"}], ",", 
           RowBox[{
            RowBox[{"MonomialDependenceOperator", "[", "variables", "]"}], 
            "[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Head", "[", "xpp", "]"}], "===", "Plus"}], ",", 
              RowBox[{"List", "@@", "xpp"}], ",", 
              RowBox[{"{", "xpp", "}"}]}], "]"}], "]"}]}], "]"}], "]"}]}], 
       "]"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.842075927721281*^9, 3.8420760052938023`*^9}, {
  3.842076083514552*^9, 3.8420760931528683`*^9}, {3.8420762102650013`*^9, 
  3.842076218254993*^9}, {3.842076318176757*^9, 3.842076350617676*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"e4f099fc-5e17-4b88-9e12-be73e3314dde"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "->", 
      RowBox[{"{", 
       RowBox[{"u", ",", "v"}], "}"}]}], ",", 
     RowBox[{"\"\<indVars\>\"", "->", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}]}], ",", 
     RowBox[{"\"\<pars\>\"", "->", 
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ParametricRefineOperatorX", "[", "variables", "]"}], "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"u", "[", 
       RowBox[{"x", ",", "y"}], "]"}], "^", "a"}], "+", 
     RowBox[{
      RowBox[{"u", "[", 
       RowBox[{"x", ",", "y"}], "]"}], "^", "b"}]}], ",", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"u", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "^", "a"}], " ", 
        RowBox[{"v", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}], ",", "x"}], "]"}], "-", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"u", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "^", "2"}], " ", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "^", "b"}]}], ",", "x"}], "]"}]}]}],
    "}"}], "]"}]}], "Input",
 CellChangeTimes->{
  3.842076036082055*^9, {3.8420761315757027`*^9, 3.8420761344342623`*^9}, {
   3.842076354936099*^9, 3.842076357898299*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"6a49e88f-5abf-4329-8ef7-e8d401e8c9c6"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"{", 
         RowBox[{"2", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", 
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["u", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "+", 
           RowBox[{
            SuperscriptBox["v", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x", ",", "y"}], "]"}]}]}], "}"}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", "0"}], "&&", 
         RowBox[{"b", "\[Equal]", "0"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox[
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "a"]}], ",", 
          RowBox[{
           RowBox[{"a", " ", 
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], 
             RowBox[{
              RowBox[{"-", "1"}], "+", "a"}]], " ", 
            RowBox[{"v", "[", 
             RowBox[{"x", ",", "y"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["u", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], " ", 
            SuperscriptBox[
             RowBox[{"v", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "a"], " ", 
            RowBox[{
             SuperscriptBox["u", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "a"], " ", 
            RowBox[{
             SuperscriptBox["v", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "-", 
           RowBox[{"a", " ", 
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"v", "[", 
              RowBox[{"x", ",", "y"}], "]"}], 
             RowBox[{
              RowBox[{"-", "1"}], "+", "a"}]], " ", 
            RowBox[{
             SuperscriptBox["v", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}]}]}], "}"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "\[Equal]", "b"}], "&&", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "b"}], "+", 
             SuperscriptBox["b", "2"]}], "\[NotEqual]", "0"}]}], ")"}], "||", 
         
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "\[Equal]", "b"}], "&&", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "b"}], "+", 
             SuperscriptBox["b", "2"]}], "\[NotEqual]", "0"}]}], ")"}], "||", 
         
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "\[Equal]", "b"}], "&&", 
           RowBox[{
            RowBox[{
             RowBox[{"2", " ", "b"}], "-", 
             RowBox[{"3", " ", 
              SuperscriptBox["b", "2"]}], "+", 
             SuperscriptBox["b", "3"]}], "\[NotEqual]", "0"}]}], ")"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"u", "[", 
            RowBox[{"x", ",", "y"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}]}], ")"}]}], ",", "0"}], "}"}], 
        RowBox[{
         RowBox[{"b", "\[Equal]", "1"}], "&&", 
         RowBox[{"a", "\[Equal]", "2"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "+", 
           SuperscriptBox[
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "a"]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", 
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["u", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "+", 
           RowBox[{"a", " ", 
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], 
             RowBox[{
              RowBox[{"-", "1"}], "+", "a"}]], " ", 
            RowBox[{"v", "[", 
             RowBox[{"x", ",", "y"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["u", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "a"], " ", 
            RowBox[{
             SuperscriptBox["v", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}]}]}], "}"}], 
        RowBox[{
         RowBox[{"b", "\[Equal]", "0"}], "&&", 
         RowBox[{"a", "\[NotEqual]", "0"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "+", 
           SuperscriptBox[
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "b"]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", 
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], " ", 
            SuperscriptBox[
             RowBox[{"v", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "b"], " ", 
            RowBox[{
             SuperscriptBox["u", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "+", 
           RowBox[{
            SuperscriptBox["v", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x", ",", "y"}], "]"}], "-", 
           RowBox[{"b", " ", 
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"v", "[", 
              RowBox[{"x", ",", "y"}], "]"}], 
             RowBox[{
              RowBox[{"-", "1"}], "+", "b"}]], " ", 
            RowBox[{
             SuperscriptBox["v", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}]}]}], "}"}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", "0"}], "&&", 
         RowBox[{"b", "\[NotEqual]", "0"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "a"], "+", 
           SuperscriptBox[
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "b"]}], ",", 
          RowBox[{
           RowBox[{"a", " ", 
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], 
             RowBox[{
              RowBox[{"-", "1"}], "+", "a"}]], " ", 
            RowBox[{"v", "[", 
             RowBox[{"x", ",", "y"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["u", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], " ", 
            SuperscriptBox[
             RowBox[{"v", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "b"], " ", 
            RowBox[{
             SuperscriptBox["u", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "a"], " ", 
            RowBox[{
             SuperscriptBox["v", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "-", 
           RowBox[{"b", " ", 
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"v", "[", 
              RowBox[{"x", ",", "y"}], "]"}], 
             RowBox[{
              RowBox[{"-", "1"}], "+", "b"}]], " ", 
            RowBox[{
             SuperscriptBox["v", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}]}]}], "}"}], 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "a"}], ")"}], " ", "a", " ", 
           RowBox[{"(", 
            RowBox[{"a", "-", "b"}], ")"}], " ", "b"}], "\[NotEqual]", "0"}], 
         "||", 
         RowBox[{
          RowBox[{"a", " ", 
           RowBox[{"(", 
            RowBox[{"a", "-", "b"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "b"}], ")"}], " ", "b"}], "\[NotEqual]",
           "0"}]}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{{3.8420760374045763`*^9, 3.842076046483144*^9}, {
   3.84207612507572*^9, 3.842076135162443*^9}, 3.8420762427714987`*^9, 
   3.842076358698428*^9},
 CellLabel->"Out[36]=",ExpressionUUID->"7a296dc1-addf-4be5-9c7d-06af210fcc3f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"%", "//", "PiecewiseExpand"}], "//", "PiecewiseListClean"}], "//", 
  RowBox[{"PiecewiseSimplifyOperator", "[", "variables", "]"}]}]], "Input",
 CellChangeTimes->{{3.8420761407834663`*^9, 3.842076155990334*^9}, {
  3.842076187601013*^9, 3.842076188156767*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"6dcdfd80-08cf-4390-99a9-12d53586f99b"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"{", 
         RowBox[{"2", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", 
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["u", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "+", 
           RowBox[{
            SuperscriptBox["v", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x", ",", "y"}], "]"}]}]}], "}"}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", "0"}], "&&", 
         RowBox[{"b", "\[Equal]", "0"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox[
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "a"]}], ",", 
          RowBox[{
           RowBox[{"a", " ", 
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], 
             RowBox[{
              RowBox[{"-", "1"}], "+", "a"}]], " ", 
            RowBox[{"v", "[", 
             RowBox[{"x", ",", "y"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["u", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], " ", 
            SuperscriptBox[
             RowBox[{"v", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "a"], " ", 
            RowBox[{
             SuperscriptBox["u", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "a"], " ", 
            RowBox[{
             SuperscriptBox["v", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "-", 
           RowBox[{"a", " ", 
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"v", "[", 
              RowBox[{"x", ",", "y"}], "]"}], 
             RowBox[{
              RowBox[{"-", "1"}], "+", "a"}]], " ", 
            RowBox[{
             SuperscriptBox["v", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}]}]}], "}"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "\[Equal]", "b"}], "&&", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "b"}], "+", 
             SuperscriptBox["b", "2"]}], "\[NotEqual]", "0"}]}], ")"}], "||", 
         
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "\[Equal]", "b"}], "&&", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "b"}], "+", 
             SuperscriptBox["b", "2"]}], "\[NotEqual]", "0"}]}], ")"}], "||", 
         
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "\[Equal]", "b"}], "&&", 
           RowBox[{
            RowBox[{
             RowBox[{"2", " ", "b"}], "-", 
             RowBox[{"3", " ", 
              SuperscriptBox["b", "2"]}], "+", 
             SuperscriptBox["b", "3"]}], "\[NotEqual]", "0"}]}], ")"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"u", "[", 
            RowBox[{"x", ",", "y"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}]}], ")"}]}], ",", "0"}], "}"}], 
        RowBox[{
         RowBox[{"b", "\[Equal]", "1"}], "&&", 
         RowBox[{"a", "\[Equal]", "2"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "+", 
           SuperscriptBox[
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "a"]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", 
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["u", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "+", 
           RowBox[{"a", " ", 
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], 
             RowBox[{
              RowBox[{"-", "1"}], "+", "a"}]], " ", 
            RowBox[{"v", "[", 
             RowBox[{"x", ",", "y"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["u", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "a"], " ", 
            RowBox[{
             SuperscriptBox["v", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}]}]}], "}"}], 
        RowBox[{
         RowBox[{"b", "\[Equal]", "0"}], "&&", 
         RowBox[{"a", "\[NotEqual]", "0"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "+", 
           SuperscriptBox[
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "b"]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", 
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], " ", 
            SuperscriptBox[
             RowBox[{"v", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "b"], " ", 
            RowBox[{
             SuperscriptBox["u", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "+", 
           RowBox[{
            SuperscriptBox["v", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x", ",", "y"}], "]"}], "-", 
           RowBox[{"b", " ", 
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"v", "[", 
              RowBox[{"x", ",", "y"}], "]"}], 
             RowBox[{
              RowBox[{"-", "1"}], "+", "b"}]], " ", 
            RowBox[{
             SuperscriptBox["v", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}]}]}], "}"}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", "0"}], "&&", 
         RowBox[{"b", "\[NotEqual]", "0"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "a"], "+", 
           SuperscriptBox[
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "b"]}], ",", 
          RowBox[{
           RowBox[{"a", " ", 
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], 
             RowBox[{
              RowBox[{"-", "1"}], "+", "a"}]], " ", 
            RowBox[{"v", "[", 
             RowBox[{"x", ",", "y"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["u", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], " ", 
            SuperscriptBox[
             RowBox[{"v", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "b"], " ", 
            RowBox[{
             SuperscriptBox["u", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "a"], " ", 
            RowBox[{
             SuperscriptBox["v", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "-", 
           RowBox[{"b", " ", 
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"v", "[", 
              RowBox[{"x", ",", "y"}], "]"}], 
             RowBox[{
              RowBox[{"-", "1"}], "+", "b"}]], " ", 
            RowBox[{
             SuperscriptBox["v", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}]}]}], "}"}], 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "a"}], ")"}], " ", "a", " ", 
           RowBox[{"(", 
            RowBox[{"a", "-", "b"}], ")"}], " ", "b"}], "\[NotEqual]", "0"}], 
         "||", 
         RowBox[{
          RowBox[{"a", " ", 
           RowBox[{"(", 
            RowBox[{"a", "-", "b"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "b"}], ")"}], " ", "b"}], "\[NotEqual]",
           "0"}]}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{{3.84207614502015*^9, 3.842076156474661*^9}, 
   3.8420761897092257`*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"b48b33b3-34f9-4af2-9ffd-d251c3755b3c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{
   RowBox[{
    RowBox[{"variables", "=", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<depVars\>\"", "->", 
        RowBox[{"{", 
         RowBox[{"u", ",", "v"}], "}"}]}], ",", 
       RowBox[{"\"\<indVars\>\"", "->", 
        RowBox[{"{", "x", "}"}]}], ",", 
       RowBox[{"\"\<pars\>\"", "->", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}]}], ",", 
       RowBox[{"\"\<expression\>\"", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"u", "[", "x", "]"}], "+", 
           RowBox[{
            RowBox[{"u", "[", "x", "]"}], "^", "a"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"u", "[", "x", "]"}], "^", "2"}], "+", 
           RowBox[{"7", " ", 
            RowBox[{
             RowBox[{"u", "[", "x", "]"}], "^", 
             RowBox[{"(", 
              RowBox[{"2", "-", "a"}], ")"}]}]}]}], ",", "1"}], "}"}]}], ",", 
       
       RowBox[{"\"\<result\>\"", "->", 
        RowBox[{"Piecewise", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"2", "*", 
                 RowBox[{"u", "[", "x", "]"}]}], ",", 
                RowBox[{
                 RowBox[{"u", "[", "x", "]"}], "*", 
                 RowBox[{"(", 
                  RowBox[{"7", "+", 
                   RowBox[{"u", "[", "x", "]"}]}], ")"}]}], ",", "1"}], "}"}],
               ",", 
              RowBox[{"a", "==", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", "+", 
                 RowBox[{"u", "[", "x", "]"}]}], ",", 
                RowBox[{"8", "*", 
                 RowBox[{
                  RowBox[{"u", "[", "x", "]"}], "^", "2"}]}], ",", "1"}], 
               "}"}], ",", 
              RowBox[{"a", "==", "0"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"u", "[", "x", "]"}], "+", 
                 RowBox[{
                  RowBox[{"u", "[", "x", "]"}], "^", "a"}]}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"u", "[", "x", "]"}], "^", 
                  RowBox[{"(", 
                   RowBox[{"2", "-", "a"}], ")"}]}], "*", 
                 RowBox[{"(", 
                  RowBox[{"7", "+", 
                   RowBox[{
                    RowBox[{"u", "[", "x", "]"}], "^", "a"}]}], ")"}]}], ",", 
                "1"}], "}"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "a"}], "+", 
                RowBox[{"a", "^", "2"}]}], "!=", "0"}]}], "}"}]}], "}"}], ",",
           "$Failed"}], "]"}]}]}], "]"}]}], ";"}], "\n", 
   RowBox[{"Get", "[", "test", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8420769471352043`*^9, 
  3.842076954589738*^9}},ExpressionUUID->"e90f28da-6104-4aca-a901-\
2064d5e4e4d8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ParametricRefineOperator", "[", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "->", 
      RowBox[{"{", 
       RowBox[{"u", ",", "v"}], "}"}]}], ",", 
     RowBox[{"\"\<indVars\>\"", "->", 
      RowBox[{"{", "x", "}"}]}], ",", 
     RowBox[{"\"\<pars\>\"", "->", 
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], "]"}], "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"u", "[", "x", "]"}], "+", 
     RowBox[{
      RowBox[{"u", "[", "x", "]"}], "^", "a"}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"u", "[", "x", "]"}], "^", "2"}], "+", 
     RowBox[{"7", " ", 
      RowBox[{
       RowBox[{"u", "[", "x", "]"}], "^", 
       RowBox[{"(", 
        RowBox[{"2", "-", "a"}], ")"}]}]}]}], ",", "1"}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8420774758734407`*^9, 3.842077483215293*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"b9d92f7d-ba1e-4c8c-92d1-502cb44ec55c"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"u", "[", "x", "]"}]}], ",", 
          RowBox[{
           RowBox[{"u", "[", "x", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{"7", "+", 
             RowBox[{"u", "[", "x", "]"}]}], ")"}]}], ",", "1"}], "}"}], 
        RowBox[{"a", "\[Equal]", "1"}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "+", 
           RowBox[{"u", "[", "x", "]"}]}], ",", 
          RowBox[{"8", " ", 
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], "2"]}], ",", "1"}], "}"}], 
        RowBox[{"a", "\[Equal]", "0"}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"u", "[", "x", "]"}], "+", 
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], "a"]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], 
            RowBox[{"2", "-", "a"}]], " ", 
           RowBox[{"(", 
            RowBox[{"7", "+", 
             SuperscriptBox[
              RowBox[{"u", "[", "x", "]"}], "a"]}], ")"}]}], ",", "1"}], 
         "}"}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "a"}], "+", 
          SuperscriptBox["a", "2"]}], "\[NotEqual]", "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{3.842077485660728*^9, 3.842077547017029*^9},
 CellLabel->"Out[49]=",ExpressionUUID->"40709cf9-5c7c-4b7d-80e7-dca88960ae5b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PiecewiseEqualOperator", "[", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "->", 
      RowBox[{"{", 
       RowBox[{"u", ",", "v"}], "}"}]}], ",", 
     RowBox[{"\"\<indVars\>\"", "->", 
      RowBox[{"{", "x", "}"}]}], ",", 
     RowBox[{"\"\<pars\>\"", "->", 
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], "]"}], "[", 
  RowBox[{"%", ",", 
   RowBox[{"Piecewise", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"2", "*", 
            RowBox[{"u", "[", "x", "]"}]}], ",", 
           RowBox[{
            RowBox[{"u", "[", "x", "]"}], "*", 
            RowBox[{"(", 
             RowBox[{"7", "+", 
              RowBox[{"u", "[", "x", "]"}]}], ")"}]}], ",", "1"}], "}"}], ",", 
         RowBox[{"a", "==", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "+", 
            RowBox[{"u", "[", "x", "]"}]}], ",", 
           RowBox[{"8", "*", 
            RowBox[{
             RowBox[{"u", "[", "x", "]"}], "^", "2"}]}], ",", "1"}], "}"}], 
         ",", 
         RowBox[{"a", "==", "0"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"u", "[", "x", "]"}], "+", 
            RowBox[{
             RowBox[{"u", "[", "x", "]"}], "^", "a"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"u", "[", "x", "]"}], "^", 
             RowBox[{"(", 
              RowBox[{"2", "-", "a"}], ")"}]}], "*", 
            RowBox[{"(", 
             RowBox[{"7", "+", 
              RowBox[{
               RowBox[{"u", "[", "x", "]"}], "^", "a"}]}], ")"}]}], ",", 
           "1"}], "}"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "a"}], ")"}], "a"}], "!=", "0"}]}], 
        "}"}]}], "}"}], ",", "$Failed"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.842077489113061*^9, 3.842077548082829*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"ccaa7cb5-6e8a-4c3a-9d48-b926388412d1"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.842077537177868*^9, 3.842077548945043*^9}},
 CellLabel->"Out[50]=",ExpressionUUID->"45154de3-dc02-4b5a-9367-32e6368bbea2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Piecewise", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"2", "*", 
           RowBox[{"u", "[", "x", "]"}]}], ",", " ", 
          RowBox[{
           RowBox[{"u", "[", "x", "]"}], "*", 
           RowBox[{"(", 
            RowBox[{"7", " ", "+", " ", 
             RowBox[{"u", "[", "x", "]"}]}], ")"}]}], ",", " ", "1"}], "}"}], 
        ",", " ", 
        RowBox[{"a", " ", "==", " ", "1"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", " ", "+", " ", 
           RowBox[{"u", "[", "x", "]"}]}], ",", " ", 
          RowBox[{"8", "*", 
           RowBox[{
            RowBox[{"u", "[", "x", "]"}], "^", "2"}]}], ",", " ", "1"}], 
         "}"}], ",", " ", 
        RowBox[{"a", " ", "==", " ", "0"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"u", "[", "x", "]"}], " ", "+", " ", 
           RowBox[{
            RowBox[{"u", "[", "x", "]"}], "^", "a"}]}], ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"u", "[", "x", "]"}], "^", 
            RowBox[{"(", 
             RowBox[{"2", " ", "-", " ", "a"}], ")"}]}], "*", 
           RowBox[{"(", 
            RowBox[{"7", " ", "+", " ", 
             RowBox[{
              RowBox[{"u", "[", "x", "]"}], "^", "a"}]}], ")"}]}], ",", " ", 
          "1"}], "}"}], ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "a"}], "+", 
          RowBox[{"a", "^", "2"}]}], " ", "!=", " ", "0"}]}], "}"}]}], "}"}], 
    ",", " ", "$Failed"}], "]"}], "\n"}]], "Input",
 CellChangeTimes->{{3.842077741465569*^9, 3.842077758042492*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"bafcfbe5-c906-4bed-9c03-f1338950fce4"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"u", "[", "x", "]"}]}], ",", 
          RowBox[{
           RowBox[{"u", "[", "x", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{"7", "+", 
             RowBox[{"u", "[", "x", "]"}]}], ")"}]}], ",", "1"}], "}"}], 
        RowBox[{"a", "\[Equal]", "1"}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "+", 
           RowBox[{"u", "[", "x", "]"}]}], ",", 
          RowBox[{"8", " ", 
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], "2"]}], ",", "1"}], "}"}], 
        RowBox[{"a", "\[Equal]", "0"}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"u", "[", "x", "]"}], "+", 
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], "a"]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], 
            RowBox[{"2", "-", "a"}]], " ", 
           RowBox[{"(", 
            RowBox[{"7", "+", 
             SuperscriptBox[
              RowBox[{"u", "[", "x", "]"}], "a"]}], ")"}]}], ",", "1"}], 
         "}"}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "a"}], "+", 
          SuperscriptBox["a", "2"]}], "\[NotEqual]", "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{3.842077758661034*^9},
 CellLabel->"Out[51]=",ExpressionUUID->"17259b8e-35c2-4059-9692-1e7bd90c10f5"]
}, Open  ]],

Cell[BoxData["\n"], "Input",
 CellChangeTimes->{{3.8420774600072412`*^9, 3.842077460009592*^9}, {
  3.842077524260553*^9, 3.842077534081107*^9}},
 EmphasizeSyntaxErrors->
  True,ExpressionUUID->"ed23faf6-90ca-4600-a06e-23839f19e641"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ParametricRefineOperatorX", "[", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "->", 
      RowBox[{"{", 
       RowBox[{"u", ",", "v"}], "}"}]}], ",", 
     RowBox[{"\"\<indVars\>\"", "->", 
      RowBox[{"{", "x", "}"}]}], ",", 
     RowBox[{"\"\<pars\>\"", "->", 
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}], "]"}], "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"u", "[", "x", "]"}], "+", 
     RowBox[{
      RowBox[{"u", "[", "x", "]"}], "^", "a"}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"u", "[", "x", "]"}], "^", "2"}], "+", 
     RowBox[{"7", " ", 
      RowBox[{
       RowBox[{"u", "[", "x", "]"}], "^", 
       RowBox[{"(", 
        RowBox[{"2", "-", "a"}], ")"}]}]}]}], ",", "1"}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.842076966188533*^9, 3.842077030428644*^9}, {
   3.8420771657252913`*^9, 3.8420771705652313`*^9}, 3.842077200858738*^9},
 CellLabel->"In[46]:=",ExpressionUUID->"06999095-f265-44a0-ae28-b63652981734"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"u", "[", "x", "]"}]}], ",", 
          RowBox[{
           RowBox[{"u", "[", "x", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{"7", "+", 
             RowBox[{"u", "[", "x", "]"}]}], ")"}]}], ",", "1"}], "}"}], 
        RowBox[{"a", "\[Equal]", "1"}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "+", 
           RowBox[{"u", "[", "x", "]"}]}], ",", 
          RowBox[{"8", " ", 
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], "2"]}], ",", "1"}], "}"}], 
        RowBox[{"a", "\[Equal]", "0"}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"u", "[", "x", "]"}], "+", 
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], "a"]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], 
            RowBox[{"2", "-", "a"}]], " ", 
           RowBox[{"(", 
            RowBox[{"7", "+", 
             SuperscriptBox[
              RowBox[{"u", "[", "x", "]"}], "a"]}], ")"}]}], ",", "1"}], 
         "}"}], 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "a"}], ")"}], " ", "a"}], "\[NotEqual]", 
         "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{{3.842076994259377*^9, 3.8420770309272757`*^9}, 
   3.842077135167509*^9, {3.842077168125276*^9, 3.842077171124365*^9}, 
   3.8420772013813877`*^9},
 CellLabel->"Out[46]=",ExpressionUUID->"b3c3f6cf-7521-43de-9d87-425a523a20b7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"u", "[", "x", "]"}]}], ",", 
          RowBox[{
           RowBox[{"u", "[", "x", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{"7", "+", 
             RowBox[{"u", "[", "x", "]"}]}], ")"}]}], ",", "1"}], "}"}], 
        RowBox[{"a", "\[Equal]", "1"}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "+", 
           RowBox[{"u", "[", "x", "]"}]}], ",", 
          RowBox[{"8", " ", 
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], "2"]}], ",", "1"}], "}"}], 
        RowBox[{"a", "\[Equal]", "0"}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"u", "[", "x", "]"}], "+", 
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], "a"]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], 
            RowBox[{"2", "-", "a"}]], " ", 
           RowBox[{"(", 
            RowBox[{"7", "+", 
             SuperscriptBox[
              RowBox[{"u", "[", "x", "]"}], "a"]}], ")"}]}], ",", "1"}], 
         "}"}], 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "a"}], ")"}], " ", "a"}], "\[NotEqual]", 
         "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Input",
 CellChangeTimes->{{3.842077136744067*^9, 
  3.842077142702071*^9}},ExpressionUUID->"5fb4cf17-9b1d-41b4-9ecd-\
b2aee4811300"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"u", "[", "x", "]"}]}], ",", 
          RowBox[{
           RowBox[{"u", "[", "x", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{"7", "+", 
             RowBox[{"u", "[", "x", "]"}]}], ")"}]}], ",", "1"}], "}"}], 
        RowBox[{"a", "\[Equal]", "1"}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "+", 
           RowBox[{"u", "[", "x", "]"}]}], ",", 
          RowBox[{"8", " ", 
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], "2"]}], ",", "1"}], "}"}], 
        RowBox[{"a", "\[Equal]", "0"}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"u", "[", "x", "]"}], "+", 
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], "a"]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], 
            RowBox[{"2", "-", "a"}]], " ", 
           RowBox[{"(", 
            RowBox[{"7", "+", 
             SuperscriptBox[
              RowBox[{"u", "[", "x", "]"}], "a"]}], ")"}]}], ",", "1"}], 
         "}"}], 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "a"}], ")"}], " ", "a"}], "\[NotEqual]", 
         "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{3.8420771374046507`*^9},
 CellLabel->"Out[43]=",ExpressionUUID->"31af8305-1fd1-41d4-a07e-a122470bc1b0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%39", "-", 
  RowBox[{"Piecewise", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"2", "*", 
           RowBox[{"u", "[", "x", "]"}]}], ",", 
          RowBox[{
           RowBox[{"u", "[", "x", "]"}], "*", 
           RowBox[{"(", 
            RowBox[{"7", "+", 
             RowBox[{"u", "[", "x", "]"}]}], ")"}]}], ",", "1"}], "}"}], ",", 
        
        RowBox[{"a", "==", "1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "+", 
           RowBox[{"u", "[", "x", "]"}]}], ",", 
          RowBox[{"8", "*", 
           RowBox[{
            RowBox[{"u", "[", "x", "]"}], "^", "2"}]}], ",", "1"}], "}"}], 
        ",", 
        RowBox[{"a", "==", "0"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"u", "[", "x", "]"}], "+", 
           RowBox[{
            RowBox[{"u", "[", "x", "]"}], "^", "a"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"u", "[", "x", "]"}], "^", 
            RowBox[{"(", 
             RowBox[{"2", "-", "a"}], ")"}]}], "*", 
           RowBox[{"(", 
            RowBox[{"7", "+", 
             RowBox[{
              RowBox[{"u", "[", "x", "]"}], "^", "a"}]}], ")"}]}], ",", "1"}],
          "}"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "a"}], "+", 
          RowBox[{"a", "^", "2"}]}], "!=", "0"}]}], "}"}]}], "}"}], ",", 
    "$Failed"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.842077078284617*^9, 3.8420770861449537`*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"b986e88b-dc1b-4822-99e6-3a619d32035b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   TagBox[GridBox[{
      {"\[Piecewise]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"u", "[", "x", "]"}]}], ",", 
            RowBox[{
             RowBox[{"u", "[", "x", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"7", "+", 
               RowBox[{"u", "[", "x", "]"}]}], ")"}]}], ",", "1"}], "}"}], 
          RowBox[{"a", "\[Equal]", "1"}]},
         {
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "+", 
             RowBox[{"u", "[", "x", "]"}]}], ",", 
            RowBox[{"8", " ", 
             SuperscriptBox[
              RowBox[{"u", "[", "x", "]"}], "2"]}], ",", "1"}], "}"}], 
          RowBox[{"a", "\[Equal]", "0"}]},
         {
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"u", "[", "x", "]"}], "+", 
             SuperscriptBox[
              RowBox[{"u", "[", "x", "]"}], "a"]}], ",", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"u", "[", "x", "]"}], 
              RowBox[{"2", "-", "a"}]], " ", 
             RowBox[{"(", 
              RowBox[{"7", "+", 
               SuperscriptBox[
                RowBox[{"u", "[", "x", "]"}], "a"]}], ")"}]}], ",", "1"}], 
           "}"}], 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "a"}], ")"}], " ", "a"}], 
           "\[NotEqual]", "0"}]},
         {"$Failed", 
          TagBox["True",
           "PiecewiseDefault",
           AutoDelete->True]}
        },
        AllowedDimensions->{2, Automatic},
        Editable->True,
        GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.84]}, 
            Offset[0.27999999999999997`]}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}},
        Selectable->True]}
     },
     GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.35]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    "Piecewise",
    DeleteWithContents->True,
    Editable->False,
    SelectWithContents->True,
    Selectable->False,
    StripWrapperBoxes->True], ")"}], "-", 
  RowBox[{"(", 
   TagBox[GridBox[{
      {"\[Piecewise]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"u", "[", "x", "]"}]}], ",", 
            RowBox[{
             RowBox[{"u", "[", "x", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"7", "+", 
               RowBox[{"u", "[", "x", "]"}]}], ")"}]}], ",", "1"}], "}"}], 
          RowBox[{"a", "\[Equal]", "1"}]},
         {
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "+", 
             RowBox[{"u", "[", "x", "]"}]}], ",", 
            RowBox[{"8", " ", 
             SuperscriptBox[
              RowBox[{"u", "[", "x", "]"}], "2"]}], ",", "1"}], "}"}], 
          RowBox[{"a", "\[Equal]", "0"}]},
         {
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"u", "[", "x", "]"}], "+", 
             SuperscriptBox[
              RowBox[{"u", "[", "x", "]"}], "a"]}], ",", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"u", "[", "x", "]"}], 
              RowBox[{"2", "-", "a"}]], " ", 
             RowBox[{"(", 
              RowBox[{"7", "+", 
               SuperscriptBox[
                RowBox[{"u", "[", "x", "]"}], "a"]}], ")"}]}], ",", "1"}], 
           "}"}], 
          RowBox[{
           RowBox[{
            RowBox[{"-", "a"}], "+", 
            SuperscriptBox["a", "2"]}], "\[NotEqual]", "0"}]},
         {"$Failed", 
          TagBox["True",
           "PiecewiseDefault",
           AutoDelete->True]}
        },
        AllowedDimensions->{2, Automatic},
        Editable->True,
        GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.84]}, 
            Offset[0.27999999999999997`]}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}},
        Selectable->True]}
     },
     GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.35]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    "Piecewise",
    DeleteWithContents->True,
    Editable->False,
    SelectWithContents->True,
    Selectable->False,
    StripWrapperBoxes->True], ")"}]}]], "Output",
 CellChangeTimes->{3.842077086669602*^9},
 CellLabel->"Out[40]=",ExpressionUUID->"c818f966-9a14-4ab3-8c1b-e917cc8b024b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "PiecewiseExpand"}]], "Input",
 CellChangeTimes->{{3.84207708949229*^9, 3.842077101249578*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"a09b6309-5d1c-4200-bda0-cb24c533d4a8"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", "0"}], "||", 
         RowBox[{"a", "\[Equal]", "1"}], "||", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "a"}], "+", 
           SuperscriptBox["a", "2"]}], "\[NotEqual]", "0"}]}]},
       {"0", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{3.842077101770753*^9},
 CellLabel->"Out[41]=",ExpressionUUID->"ae03f6ff-f6ca-4c7a-b0ec-2ed6c04a4865"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["OLD", "Subsection",
 CellChangeTimes->{{3.842075920492282*^9, 
  3.842075922052987*^9}},ExpressionUUID->"3fc9b2d4-6d1b-4a40-b988-\
bd43f1e434c7"],

Cell[BoxData[
 RowBox[{"Get", "[", "\"\<PDESymbolics2020`PDESymbolics2020`\>\"", 
  "]"}]], "Input",
 CellLabel->"In[8]:=",ExpressionUUID->"a7d33b02-2846-4a8d-90bc-13ae2fcaac2d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "->", 
      RowBox[{"{", 
       RowBox[{"u", ",", "v"}], "}"}]}], ",", 
     RowBox[{"\"\<indVars\>\"", "->", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}]}], ",", 
     RowBox[{"\"\<pars\>\"", "->", 
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ParametricRefineOperator", "[", "variables", "]"}], "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"u", "[", 
       RowBox[{"x", ",", "y"}], "]"}], "^", "a"}], "+", 
     RowBox[{
      RowBox[{"u", "[", 
       RowBox[{"x", ",", "y"}], "]"}], "^", "b"}]}], ",", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"u", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "^", "a"}], " ", 
        RowBox[{"v", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}], ",", "x"}], "]"}], "-", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"u", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "^", "2"}], " ", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "^", "b"}]}], ",", "x"}], "]"}]}]}],
    "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.842066097853827*^9, 3.8420660978573027`*^9}, {
  3.8420661372588463`*^9, 3.842066179957642*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"9a5eed4a-087a-4f70-919a-ba2d1b6dd931"],

Cell[BoxData[
 TemplateBox[{
  "Reduce", "nsmet", 
   "\"This system cannot be solved with the methods available to Reduce.\"", 
   2, 18, 6, 22405050993592677561, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.842066181912389*^9},
 CellLabel->
  "During evaluation of \
In[17]:=",ExpressionUUID->"7633714c-32c0-4495-99b7-f7afe4786409"],

Cell[BoxData[
 TemplateBox[{
  "Reduce", "nsmet", 
   "\"This system cannot be solved with the methods available to Reduce.\"", 
   2, 18, 7, 22405050993592677561, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8420661819399433`*^9},
 CellLabel->
  "During evaluation of \
In[17]:=",ExpressionUUID->"1d87e685-c3ae-4d8d-b2c4-ef9b3d0858e9"],

Cell[BoxData[
 TemplateBox[{
  "Reduce", "nsmet", 
   "\"This system cannot be solved with the methods available to Reduce.\"", 
   2, 18, 8, 22405050993592677561, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.84206618194549*^9},
 CellLabel->
  "During evaluation of \
In[17]:=",ExpressionUUID->"27a48f7d-ed7b-4c87-bf10-9314505e091f"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Reduce\\\", \\\"::\\\", \
\\\"nsmet\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"", 2, 18, 9, 22405050993592677561, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.84206618195255*^9},
 CellLabel->
  "During evaluation of \
In[17]:=",ExpressionUUID->"f860003b-d3d6-4ea7-8080-b4e4f111351e"],

Cell[BoxData[
 TemplateBox[{
  "Reduce", "naqs", 
   "\"\\!\\(\\*RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\
\[RightSkeleton]\\\"}]\\) is not a quantified system of equations and \
inequalities.\"", 2, 18, 10, 22405050993592677561, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.842066186323258*^9},
 CellLabel->
  "During evaluation of \
In[17]:=",ExpressionUUID->"99e3854c-8761-4126-abc0-66b4ca938a4c"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"{", 
         RowBox[{"2", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", 
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["u", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "+", 
           RowBox[{
            SuperscriptBox["v", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x", ",", "y"}], "]"}]}]}], "}"}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", "0"}], "&&", 
         RowBox[{"b", "\[Equal]", "0"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox[
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "a"]}], ",", 
          RowBox[{
           RowBox[{"a", " ", 
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], 
             RowBox[{
              RowBox[{"-", "1"}], "+", "a"}]], " ", 
            RowBox[{"v", "[", 
             RowBox[{"x", ",", "y"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["u", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], " ", 
            SuperscriptBox[
             RowBox[{"v", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "a"], " ", 
            RowBox[{
             SuperscriptBox["u", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "a"], " ", 
            RowBox[{
             SuperscriptBox["v", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "-", 
           RowBox[{"a", " ", 
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"v", "[", 
              RowBox[{"x", ",", "y"}], "]"}], 
             RowBox[{
              RowBox[{"-", "1"}], "+", "a"}]], " ", 
            RowBox[{
             SuperscriptBox["v", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}]}]}], "}"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"a", "-", "b"}], "\[Equal]", "0"}], "&&", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "b"}], "+", 
             SuperscriptBox["b", "2"]}], "\[NotEqual]", "0"}]}], ")"}], "||", 
         
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"a", "-", "b"}], "\[Equal]", "0"}], "&&", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "b"}], "+", 
             SuperscriptBox["b", "2"]}], "\[NotEqual]", "0"}]}], ")"}], "||", 
         
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"a", "-", "b"}], "\[Equal]", "0"}], "&&", 
           RowBox[{
            RowBox[{
             RowBox[{"2", " ", "b"}], "-", 
             RowBox[{"3", " ", 
              SuperscriptBox["b", "2"]}], "+", 
             SuperscriptBox["b", "3"]}], "\[NotEqual]", "0"}]}], ")"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"u", "[", 
            RowBox[{"x", ",", "y"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}]}], ")"}]}], ",", "0"}], "}"}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", "2"}], "&&", 
         RowBox[{"b", "\[Equal]", "1"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "+", 
           SuperscriptBox[
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "a"]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", 
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["u", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "+", 
           RowBox[{"a", " ", 
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], 
             RowBox[{
              RowBox[{"-", "1"}], "+", "a"}]], " ", 
            RowBox[{"v", "[", 
             RowBox[{"x", ",", "y"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["u", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "a"], " ", 
            RowBox[{
             SuperscriptBox["v", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}]}]}], "}"}], 
        RowBox[{
         RowBox[{"b", "\[Equal]", "0"}], "&&", 
         RowBox[{"a", "\[NotEqual]", "0"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "+", 
           SuperscriptBox[
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "b"]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", 
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], " ", 
            SuperscriptBox[
             RowBox[{"v", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "b"], " ", 
            RowBox[{
             SuperscriptBox["u", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "+", 
           RowBox[{
            SuperscriptBox["v", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x", ",", "y"}], "]"}], "-", 
           RowBox[{"b", " ", 
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"v", "[", 
              RowBox[{"x", ",", "y"}], "]"}], 
             RowBox[{
              RowBox[{"-", "1"}], "+", "b"}]], " ", 
            RowBox[{
             SuperscriptBox["v", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}]}]}], "}"}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", "0"}], "&&", 
         RowBox[{"b", "\[NotEqual]", "0"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "a"], "+", 
           SuperscriptBox[
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "b"]}], ",", 
          RowBox[{
           RowBox[{"a", " ", 
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], 
             RowBox[{
              RowBox[{"-", "1"}], "+", "a"}]], " ", 
            RowBox[{"v", "[", 
             RowBox[{"x", ",", "y"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["u", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], " ", 
            SuperscriptBox[
             RowBox[{"v", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "b"], " ", 
            RowBox[{
             SuperscriptBox["u", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "a"], " ", 
            RowBox[{
             SuperscriptBox["v", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "-", 
           RowBox[{"b", " ", 
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"v", "[", 
              RowBox[{"x", ",", "y"}], "]"}], 
             RowBox[{
              RowBox[{"-", "1"}], "+", "b"}]], " ", 
            RowBox[{
             SuperscriptBox["v", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}]}]}], "}"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "\[NotEqual]", "2"}], "&&", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", 
              SuperscriptBox["a", "2"], " ", "b"}], "+", 
             RowBox[{
              SuperscriptBox["a", "3"], " ", "b"}], "+", 
             RowBox[{"2", " ", "a", " ", 
              SuperscriptBox["b", "2"]}], "-", 
             RowBox[{
              SuperscriptBox["a", "2"], " ", 
              SuperscriptBox["b", "2"]}]}], "\[NotEqual]", "0"}]}], ")"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "\[NotEqual]", "2"}], "&&", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               SuperscriptBox["a", "2"]}], " ", "b"}], "+", 
             RowBox[{"a", " ", 
              SuperscriptBox["b", "2"]}], "+", 
             RowBox[{
              SuperscriptBox["a", "2"], " ", 
              SuperscriptBox["b", "2"]}], "-", 
             RowBox[{"a", " ", 
              SuperscriptBox["b", "3"]}]}], "\[NotEqual]", "0"}]}], ")"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", 
              SuperscriptBox["a", "2"], " ", "b"}], "+", 
             RowBox[{
              SuperscriptBox["a", "3"], " ", "b"}], "+", 
             RowBox[{"2", " ", "a", " ", 
              SuperscriptBox["b", "2"]}], "-", 
             RowBox[{
              SuperscriptBox["a", "2"], " ", 
              SuperscriptBox["b", "2"]}]}], "\[NotEqual]", "0"}], "&&", 
           RowBox[{"b", "\[NotEqual]", "1"}]}], ")"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               SuperscriptBox["a", "2"]}], " ", "b"}], "+", 
             RowBox[{"a", " ", 
              SuperscriptBox["b", "2"]}], "+", 
             RowBox[{
              SuperscriptBox["a", "2"], " ", 
              SuperscriptBox["b", "2"]}], "-", 
             RowBox[{"a", " ", 
              SuperscriptBox["b", "3"]}]}], "\[NotEqual]", "0"}], "&&", 
           RowBox[{"b", "\[NotEqual]", "1"}]}], ")"}]}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{
  3.842066107626443*^9, {3.842066178237088*^9, 3.842066186333517*^9}},
 CellLabel->"Out[18]=",ExpressionUUID->"dba04686-44b5-448e-81f7-bb650e578ffe"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"variables", "=", 
    RowBox[{"Association", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<depVars\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"u", ",", "v"}], "}"}]}], ",", 
       RowBox[{"\"\<indVars\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}]}], ",", 
       RowBox[{"\"\<pars\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}]}], ",", 
       RowBox[{"\"\<depth\>\"", "\[Rule]", "Infinity"}]}], 
      RowBox[{"(*", 
       RowBox[{",", " ", 
        RowBox[{"\"\<generators\>\"", "\[Rule]", 
         RowBox[{"{", "x", "}"}]}]}], "*)"}], "}"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"xp", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"u", "[", 
     RowBox[{"x", ",", "y"}], "]"}], "^", "a"}], "+", 
   RowBox[{
    RowBox[{"u", "[", 
     RowBox[{"x", ",", "y"}], "]"}], "^", "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"pre", "=", 
  RowBox[{
   RowBox[{"ParametricRefineOperator", "[", "variables", "]"}], "[", "xp", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.813483132434526*^9, 3.8134831537014303`*^9}, {
  3.813483263963238*^9, 3.81348334606999*^9}, {3.813483555740844*^9, 
  3.813483575492937*^9}, {3.8134836126041*^9, 3.813483617978293*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"39722a73-343d-4eb2-aa78-33cd592cfe2f"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"u", "[", 
    RowBox[{"x", ",", "y"}], "]"}], "2"], "+", 
  SuperscriptBox[
   RowBox[{"u", "[", 
    RowBox[{"x", ",", "y"}], "]"}], "a"]}]], "Output",
 CellChangeTimes->{
  3.8134831544151077`*^9, {3.8134832660609217`*^9, 3.8134832964083843`*^9}, 
   3.8134833471030207`*^9, {3.8134835617170153`*^9, 3.813483565795828*^9}, 
   3.813483618561908*^9},
 CellLabel->"Out[52]=",ExpressionUUID->"bad94690-07ea-4632-b6b4-62b138f1f768"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"u", "[", 
           RowBox[{"x", ",", "y"}], "]"}], "2"]}], 
        RowBox[{"a", "\[Equal]", "2"}]},
       {
        RowBox[{"1", "+", 
         SuperscriptBox[
          RowBox[{"u", "[", 
           RowBox[{"x", ",", "y"}], "]"}], "2"]}], 
        RowBox[{"a", "\[Equal]", "0"}]},
       {
        RowBox[{
         SuperscriptBox[
          RowBox[{"u", "[", 
           RowBox[{"x", ",", "y"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"u", "[", 
           RowBox[{"x", ",", "y"}], "]"}], "a"]}], 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "a"}], "+", 
          SuperscriptBox["a", "2"]}], "\[NotEqual]", "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{
  3.8134831544151077`*^9, {3.8134832660609217`*^9, 3.8134832964083843`*^9}, 
   3.8134833471030207`*^9, {3.8134835617170153`*^9, 3.813483565795828*^9}, 
   3.8134836186034727`*^9},
 CellLabel->"Out[53]=",ExpressionUUID->"204ceee0-4751-4995-8ff5-f49c804c16db"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"EquivalentsByIntegrationByPartsOperator", "[", "variables", "]"}], 
  "[", 
  RowBox[{
   RowBox[{
    RowBox[{"u", "[", "x", "]"}], "^", "a"}], " ", 
   RowBox[{
    RowBox[{"u", "'''"}], "[", "x", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.813483620584033*^9, 3.813483653324566*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"69047b14-63b4-44ac-8300-de203b72fffd"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "a"}], " ", 
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], 
            RowBox[{
             RowBox[{"-", "2"}], "+", "a"}]], " ", 
           SuperscriptBox[
            RowBox[{
             SuperscriptBox["u", "\[Prime]",
              MultilineFunction->None], "[", "x", "]"}], "3"]}], ",", 
          RowBox[{
           RowBox[{"-", "a"}], " ", 
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], 
            RowBox[{
             RowBox[{"-", "1"}], "+", "a"}]], " ", 
           RowBox[{
            SuperscriptBox["u", "\[Prime]",
             MultilineFunction->None], "[", "x", "]"}], " ", 
           RowBox[{
            SuperscriptBox["u", "\[Prime]\[Prime]",
             MultilineFunction->None], "[", "x", "]"}]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], "a"], " ", 
           RowBox[{
            SuperscriptBox["u", 
             TagBox[
              RowBox[{"(", "3", ")"}],
              Derivative],
             MultilineFunction->None], "[", "x", "]"}]}]}], "}"}], 
        RowBox[{
         RowBox[{"a", "\[NotEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "a"}], "+", 
           SuperscriptBox["a", "2"]}], "\[NotEqual]", "0"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "a"}], " ", 
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], 
            RowBox[{
             RowBox[{"-", "1"}], "+", "a"}]], " ", 
           RowBox[{
            SuperscriptBox["u", "\[Prime]",
             MultilineFunction->None], "[", "x", "]"}], " ", 
           RowBox[{
            SuperscriptBox["u", "\[Prime]\[Prime]",
             MultilineFunction->None], "[", "x", "]"}]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], "a"], " ", 
           RowBox[{
            SuperscriptBox["u", 
             TagBox[
              RowBox[{"(", "3", ")"}],
              Derivative],
             MultilineFunction->None], "[", "x", "]"}]}]}], "}"}], 
        RowBox[{"a", "\[NotEqual]", "0"}]},
       {
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], "a"], " ", 
          RowBox[{
           SuperscriptBox["u", 
            TagBox[
             RowBox[{"(", "3", ")"}],
             Derivative],
            MultilineFunction->None], "[", "x", "]"}]}], "}"}], 
        RowBox[{"a", "\[Equal]", "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{{3.813483644178101*^9, 3.8134836549356937`*^9}},
 CellLabel->"Out[55]=",ExpressionUUID->"b4c40b5d-5b32-406b-b5c1-cd38bb69875e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["NEW STUFF", "Section",
 CellChangeTimes->{{3.813380649272769*^9, 
  3.813380652414095*^9}},ExpressionUUID->"0733dbea-8a2e-4beb-a11e-\
2a46df5dd366"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "regroup", " ", "parameters", " ", "tries", " ", "to", " ", "write", " ", 
     "expressions", " ", "with", " ", "parameters", " ", "as", " ", 
     "coefficients", " ", "in", " ", "a", " ", "nicer", " ", "way", " ", 
     "for", " ", "example", "\[IndentingNewLine]", "1"}], "+", 
    RowBox[{"a", " ", "x"}], " ", "+", 
    RowBox[{
     RowBox[{"a", "^", "2"}], " ", "x", " ", "becomes", 
     RowBox[{"(", 
      RowBox[{"1", "+", "a", " ", "+", 
       RowBox[{"a", "^", "2"}]}], ")"}], " ", "x"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"RegroupParametersOperator", "[", "variables_Association", "]"}], 
    ":=", "\[IndentingNewLine]", 
    RowBox[{"Function", "[", 
     RowBox[{"xp", ",", "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xp", "===", "$Failed"}], ",", "$Failed", ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Head", "[", "xp", "]"}], "===", "Piecewise"}], ",", 
        RowBox[{"PiecewiseOperatorMap", "[", 
         RowBox[{"RegroupParametersOperator", ",", "variables", ",", "xp"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Head", "[", "xp", "]"}], "===", "List"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{"RegroupParametersOperator", "[", "variables", "]"}], ",", 
           " ", "xp"}], "]"}], "//", "PiecewiseExpand"}], ",", 
        "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "collectables", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"collectables", "=", 
            RowBox[{"Complement", "[", 
             RowBox[{
              RowBox[{"Variables", "[", "xp", "]"}], ",", " ", 
              RowBox[{"Lookup", "[", 
               RowBox[{"variables", ",", "\"\<pars\>\"", ",", 
                RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Collect", "[", 
            RowBox[{"xp", ",", " ", "collectables"}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ParametricRefineOperator2", "[", "variables_Association", "]"}],
      ":=", "\[IndentingNewLine]", 
     RowBox[{"Function", "[", 
      RowBox[{"xp", ",", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"xp", "===", "$Failed"}], ",", "$Failed", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Head", "[", "xp", "]"}], "===", "Piecewise"}], ",", 
         RowBox[{"PiecewiseOperatorMap", "[", 
          RowBox[{"ParametricRefineOperator2", ",", "variables", ",", "xp"}], 
          "]"}], ",", 
         RowBox[{
          RowBox[{"Head", "[", "xp", "]"}], "===", "List"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ParametricRefineOperator2", "[", "variables", "]"}], "/@",
              "xp"}], ")"}], "//", "PiecewiseExpand"}], "//", 
          "PiecewiseSimplify"}], ",", "\[IndentingNewLine]", "True", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"xpp", "=", 
             RowBox[{
              RowBox[{"RegroupParametersOperator", "[", "variables", "]"}], 
              "[", "xp", "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"PiecewiseSimplify", "[", 
            RowBox[{"PiecewiseMap", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"xpp", "/.", "#"}], "&"}], ",", 
              RowBox[{
               RowBox[{"MonomialDependenceOperator2", "[", "variables", "]"}],
                "[", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Head", "[", "xpp", "]"}], "===", "Plus"}], ",", 
                 " ", 
                 RowBox[{"List", "@@", "xpp"}], ",", " ", 
                 RowBox[{"{", "xpp", "}"}]}], "]"}], "]"}]}], "]"}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "]"}]}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "cleans", " ", "up", " ", "rules", " ", "to", " ", "avoid", " ", 
      "things", " ", "like", " ", "a"}], "\[Rule]", 
     RowBox[{
      RowBox[{"b", " ", "&&", " ", "a"}], "\[Rule]", "0"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rulesclean", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Solve", "[", 
         RowBox[{"And", "@@", 
          RowBox[{"(", 
           RowBox[{"#", "/.", 
            RowBox[{"Rule", "\[Rule]", "Equal"}]}], ")"}]}], "]"}], "//", 
        "Flatten"}], ")"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
     "MonomialDependenceOperator2", "[", "variables_Association", "]"}], ":=",
      "\[IndentingNewLine]", 
     RowBox[{"Function", "[", 
      RowBox[{"monomials", ",", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"monomials", "===", "$Failed"}], ",", "\[IndentingNewLine]", 
         "$Failed", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Head", "[", "monomials", "]"}], "===", "Piecewise"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PiecewiseOperatorMap", "[", 
          RowBox[{
          "MonomialDependenceOperator2", ",", "variables", ",", "monomials"}],
           "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Head", "[", "monomials", "]"}], "===", "List"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "generators", ",", "sol", ",", " ", "depVars", ",", " ", 
             "indVars", ",", " ", "pars", ",", " ", "localvariables", ",", 
             "zerosofmonomials", ",", "quotients", ",", " ", "derivatives", 
             ",", "zerosofderivatives", ",", "constantmonomials"}], "}"}], 
           ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "generic", " ", "functions", " ", "are", " ", "handled", " ", 
             "here", " ", "like", " ", "dependent", " ", "variables"}], " ", 
            "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"depVars", "=", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"Lookup", "[", 
                RowBox[{"variables", ",", " ", "\"\<depVars\>\"", ",", 
                 RowBox[{"{", "}"}]}], "]"}], ",", 
               RowBox[{"Lookup", "[", 
                RowBox[{"variables", ",", "\"\<genFuns\>\"", ",", 
                 RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], ";", " ", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "generators", " ", "are", " ", "handled", " ", "like", " ", 
              "independent", " ", "variables"}], " ", "*)"}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"indVars", "=", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"Lookup", "[", 
                RowBox[{"variables", ",", "\"\<indVars\>\"", ",", 
                 RowBox[{"{", "}"}]}], "]"}], ",", 
               RowBox[{"Lookup", "[", 
                RowBox[{"variables", ",", "\"\<generators\>\"", ",", 
                 RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"pars", "=", 
             RowBox[{"Lookup", "[", 
              RowBox[{"variables", ",", " ", "\"\<pars\>\"", ",", 
               RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "compute", " ", "the", " ", "generators", " ", "from", " ", 
              "the", " ", "expressions"}], " ", "*)"}], "\[IndentingNewLine]",
             "\[IndentingNewLine]", 
            RowBox[{"generators", "=", 
             RowBox[{"DeleteDuplicates", "@", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"Join", "@@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"DeleteDuplicates", "/@", 
                    RowBox[{"Cases", "[", 
                    RowBox[{"monomials", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Derivative", "[", "__", "]"}], "[", "#", "]"}], 
                    "[", "__", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}]}], "&"}], "/@",
                    "depVars"}], ")"}]}], ",", 
                RowBox[{"Join", "@@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"DeleteDuplicates", "/@", 
                    RowBox[{"Cases", "[", 
                    RowBox[{"monomials", ",", 
                    RowBox[{"#", "[", "__", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}]}], "&"}], "/@",
                    "depVars"}], ")"}]}], ",", "indVars"}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", "monomials", "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Print", "[", "generators", "]"}], ";"}], 
             "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"localvariables", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"variables", ",", " ", 
               RowBox[{"\"\<generators\>\"", "\[Rule]", "generators"}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "compute", " ", "when", " ", "the", " ", "monomials", " ", "are",
               " ", "zero"}], " ", "*)"}], "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"zerosofmonomials", "=", 
             RowBox[{
              RowBox[{"EqualToZeroOperator", "[", "localvariables", "]"}], "/@", 
              RowBox[{"Flatten", "[", "monomials", "]"}]}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", "zerosofmonomials", "]"}], ";"}], "*)"}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "compute", " ", "when", " ", "monomials", " ", "are", " ", 
              "constant"}], " ", "*)"}], "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"constantmonomials", "=", 
             RowBox[{
              RowBox[{"EqualToZeroOperator", "[", "localvariables", "]"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Grad", "[", 
                  RowBox[{"#", ",", "generators"}], "]"}], "&"}], "/@", 
                "monomials"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", "constantmonomials", "]"}], ";"}], 
             "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"compute", " ", "quotients"}], " ", "*)"}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"quotients", "=", "\[IndentingNewLine]", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"With", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"nonzeromonomials", "=", 
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", "monomials", "]"}], ",", " ", 
                    RowBox[{
                    RowBox[{"#", "=!=", "0"}], "&"}]}], "]"}]}], "}"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Flatten", "[", "monomials", "]"}], "/", "#"}], 
                    ")"}], "&"}], "/@", "nonzeromonomials"}]}], 
                  "\[IndentingNewLine]", "]"}], "//", "Flatten"}], "//", 
                "DeleteDuplicates"}], ",", " ", 
               RowBox[{
                RowBox[{"#", "=!=", "1"}], "&"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", "quotients", "]"}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"Print", "[", "generators", "]"}], ";"}], "*)"}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"derivatives", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"Grad", "[", 
                RowBox[{"#", ",", "generators"}], "]"}], "&"}], "/@", 
              "quotients"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", "derivatives", "]"}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"Print", "[", "localvariables", "]"}], ";"}], "*)"}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"zerosofderivatives", "=", 
             RowBox[{
              RowBox[{"EqualToZeroOperator", "[", "localvariables", "]"}], "/@",
               "derivatives"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", "zerosofderivatives", "]"}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Piecewise", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"{", "}"}]}], "]"}], "&"}], "/@", 
                 RowBox[{"Select", "[", " ", 
                  RowBox[{
                   RowBox[{"Join", "[", 
                    RowBox[{
                    "zerosofmonomials", ",", " ", "zerosofderivatives", ",", 
                    " ", "constantmonomials"}], "]"}], ",", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "=!=", "True"}], "&&", 
                    RowBox[{"#", "=!=", "False"}]}], "&"}]}], "]"}]}], "//", 
                "PiecewiseExpand"}], "]"}], ";", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"Print", "[", "\"\<zbric\>\"", "]"}], ";"}], "*)"}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"PiecewiseMap", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"rulesclean", "[", 
                RowBox[{"DeleteDuplicates", "[", 
                 RowBox[{"Flatten", "[", "#", "]"}], "]"}], "]"}], "&"}], ",",
               " ", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Piecewise", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"{", "}"}]}], "]"}], "&"}], "/@", 
                RowBox[{"Select", "[", " ", 
                 RowBox[{
                  RowBox[{"Join", "[", 
                   RowBox[{
                   "zerosofmonomials", ",", " ", "zerosofderivatives", ",", 
                    " ", "constantmonomials"}], "]"}], ",", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "=!=", "True"}], "&&", 
                    RowBox[{"#", "=!=", "False"}]}], "&"}]}], "]"}]}], "//", 
               "PiecewiseExpand"}]}], "]"}]}]}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.81338065513512*^9, 3.813380655974469*^9}, {
   3.8133806934013357`*^9, 3.81338079239434*^9}, {3.81338098039685*^9, 
   3.813380997910955*^9}, {3.813381183907743*^9, 3.813381188254781*^9}, {
   3.813381481955858*^9, 3.813381593707984*^9}, {3.813381775614506*^9, 
   3.813381785777076*^9}, {3.813390354119866*^9, 3.8133903897630787`*^9}, {
   3.813390420237945*^9, 3.813390494393862*^9}, {3.813390577468165*^9, 
   3.813390675830944*^9}, {3.813391249156793*^9, 3.81339126623158*^9}, {
   3.81339474322738*^9, 3.8133948230506487`*^9}, {3.813397716984329*^9, 
   3.813397740215185*^9}, {3.813397774614156*^9, 3.81339779114027*^9}, {
   3.8133980853393707`*^9, 3.813398127233382*^9}, {3.813398897264154*^9, 
   3.8133989630122137`*^9}, {3.813399223156748*^9, 3.813399341729561*^9}, {
   3.813399567893517*^9, 3.813399581244812*^9}, {3.8134586535184402`*^9, 
   3.8134587267619953`*^9}, {3.813458769344079*^9, 3.813459057590022*^9}, {
   3.813459135930909*^9, 3.813459163716359*^9}, {3.8134599970473547`*^9, 
   3.81345999904148*^9}, {3.813460505418314*^9, 3.813460505581175*^9}, {
   3.8134605660341463`*^9, 3.813460724505085*^9}, {3.813460825969811*^9, 
   3.813461207057342*^9}, {3.81346124939939*^9, 3.813461256598001*^9}, {
   3.8134612879853067`*^9, 3.813461297500085*^9}, {3.81346134840343*^9, 
   3.813461377374083*^9}, {3.813461435947757*^9, 3.813461460994985*^9}, {
   3.813461549751093*^9, 3.813461751488296*^9}, {3.813461788240943*^9, 
   3.8134618586348953`*^9}, {3.813462535168528*^9, 3.8134625695568542`*^9}, {
   3.813462611903099*^9, 3.813462701815598*^9}, {3.813462733486271*^9, 
   3.813462743454177*^9}, {3.813462967548655*^9, 3.813463019978422*^9}, {
   3.8134642192708263`*^9, 3.813464245099341*^9}, {3.81346428338947*^9, 
   3.8134643486359043`*^9}, {3.8134644672442303`*^9, 3.813464475792646*^9}, 
   3.81346485925093*^9, {3.8134649009113703`*^9, 3.813464928034108*^9}, {
   3.813465015773713*^9, 3.81346506964599*^9}, 3.8134703981501513`*^9, {
   3.813470714820231*^9, 3.813470776007805*^9}, {3.81347089859999*^9, 
   3.813470902456895*^9}, {3.8134709416335382`*^9, 3.813471054819642*^9}, {
   3.813471093318364*^9, 3.813471098712126*^9}, {3.8134711704308777`*^9, 
   3.813471206413576*^9}, {3.813471357543427*^9, 3.813471409503427*^9}, {
   3.813471697631673*^9, 3.813471711312544*^9}, {3.813471789102961*^9, 
   3.813471823902759*^9}, {3.8134718583871717`*^9, 3.813471864000474*^9}, {
   3.813472155092988*^9, 3.8134721558338833`*^9}, {3.813472208950966*^9, 
   3.813472223059245*^9}, {3.813482071148164*^9, 3.813482085948462*^9}, {
   3.813482676414042*^9, 
   3.813482680513111*^9}},ExpressionUUID->"0012a7e1-7443-4481-ae38-\
2fc67e94c83c"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.813461380611845*^9},ExpressionUUID->"2f8c2415-4369-4be2-8653-\
936f755e64b8"],

Cell[CellGroupData[{

Cell[BoxData["variables"], "Input",
 CellChangeTimes->{{3.813472862318447*^9, 3.813472863544077*^9}},
 CellLabel->
  "In[627]:=",ExpressionUUID->"810f532f-4770-4e82-9c69-5ed5ce4d6aa5"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"depVars\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"u", ",", "v"}], "}"}]}], ",", 
   RowBox[{"\<\"indVars\"\>", "\[Rule]", 
    RowBox[{"{", "x", "}"}]}], ",", 
   RowBox[{"\<\"pars\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"a", ",", "b"}], "}"}]}], ",", 
   RowBox[{"\<\"depth\"\>", "\[Rule]", "\[Infinity]"}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.813472863993297*^9},
 CellLabel->
  "Out[627]=",ExpressionUUID->"173bada5-7c6b-412e-adb5-f3cc84b0231b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"MonomialDependenceOperator2", "[", "variables", "]"}], "[", 
  RowBox[{"{", " ", 
   RowBox[{"a", " ", "x"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MonomialDependenceOperator", "[", "variables", "]"}], "[", 
  RowBox[{"{", " ", 
   RowBox[{"a", " ", "x"}], " ", "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8134644104395523`*^9, 3.813464447748219*^9}, {
  3.813464483571855*^9, 3.813464496893977*^9}, {3.813464534377851*^9, 
  3.813464579753886*^9}, {3.81346464136059*^9, 3.813464678090658*^9}, {
  3.813464879765799*^9, 3.8134648818704643`*^9}, {3.8134651107687073`*^9, 
  3.81346514297231*^9}, {3.8134707836145678`*^9, 3.813470788867318*^9}, {
  3.813472871782031*^9, 
  3.813472898418126*^9}},ExpressionUUID->"c35ae6af-f85f-4942-b518-\
f97504ca720b"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"{", 
         RowBox[{"a", "\[Rule]", "0"}], "}"}], 
        RowBox[{"a", "\[Equal]", "0"}]},
       {
        RowBox[{"{", "}"}], 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{{3.8134644503399487`*^9, 3.8134644554990597`*^9}, 
   3.8134645004958*^9, {3.813464561788146*^9, 3.81346458131397*^9}, {
   3.813464652952433*^9, 3.8134646787043743`*^9}, 3.813464882407187*^9, 
   3.8134649317035027`*^9, {3.8134651147230873`*^9, 3.8134651434561777`*^9}, {
   3.813470781679261*^9, 3.813470789651402*^9}, 3.813471183886244*^9, 
   3.813472161307033*^9, 3.813472879857944*^9},
 CellLabel->
  "Out[628]=",ExpressionUUID->"44717960-9371-4812-8894-f5a46f43b447"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{{3.8134644503399487`*^9, 3.8134644554990597`*^9}, 
   3.8134645004958*^9, {3.813464561788146*^9, 3.81346458131397*^9}, {
   3.813464652952433*^9, 3.8134646787043743`*^9}, 3.813464882407187*^9, 
   3.8134649317035027`*^9, {3.8134651147230873`*^9, 3.8134651434561777`*^9}, {
   3.813470781679261*^9, 3.813470789651402*^9}, 3.813471183886244*^9, 
   3.813472161307033*^9, 3.813472879870405*^9},
 CellLabel->
  "Out[629]=",ExpressionUUID->"0f1fc0ea-1e98-4e53-a67f-226e57d93fec"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ParametricRefineOperator2", "[", "variables", "]"}], "[", 
  RowBox[{
   RowBox[{"a", " ", "x"}], "+", " ", 
   RowBox[{
    RowBox[{"a", "^", "2"}], " ", "x"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ParametricRefineOperator", "[", "variables", "]"}], "[", 
  RowBox[{
   RowBox[{"a", " ", "x"}], "+", 
   RowBox[{
    RowBox[{"a", "^", "2"}], " ", "x"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.813472916224365*^9, 3.813472935165716*^9}},
 CellLabel->
  "In[632]:=",ExpressionUUID->"6b317fdd-cc2a-4fc8-a3d2-57d51fe31ae8"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {"0", 
        RowBox[{
         RowBox[{"a", "\[Equal]", 
          RowBox[{"-", "1"}]}], "||", 
         RowBox[{"a", "\[Equal]", "0"}]}]},
       {
        RowBox[{"a", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "a"}], ")"}], " ", "x"}], 
        RowBox[{
         RowBox[{"a", "+", 
          SuperscriptBox["a", "2"]}], "\[NotEqual]", "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{{3.813472920229607*^9, 3.8134729357648582`*^9}},
 CellLabel->
  "Out[632]=",ExpressionUUID->"9084960a-abae-43dd-8a52-ae087f410889"],

Cell[BoxData[
 RowBox[{"a", " ", 
  RowBox[{"(", 
   RowBox[{"1", "+", "a"}], ")"}], " ", "x"}]], "Output",
 CellChangeTimes->{{3.813472920229607*^9, 3.813472935777443*^9}},
 CellLabel->
  "Out[633]=",ExpressionUUID->"f56b070a-9e42-4bd2-9370-9abd889539f3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"MonomialDependenceOperator2", "[", "variables", "]"}], "[", 
  RowBox[{"{", " ", 
   RowBox[{
    RowBox[{"x", "^", "2"}], ",", " ", 
    RowBox[{"3", " ", 
     RowBox[{"x", "^", "a"}]}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.8134611834748497`*^9, 3.813461237078487*^9}, {
  3.813461324946516*^9, 3.813461333130682*^9}, {3.813463050693719*^9, 
  3.8134630573883533`*^9}, {3.813464362467121*^9, 3.813464394782048*^9}},
 CellLabel->
  "In[436]:=",ExpressionUUID->"46d44c77-ca62-44e5-8872-917e526ae10d"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"{", 
         RowBox[{"a", "\[Rule]", "2"}], "}"}], 
        RowBox[{"a", "\[Equal]", "2"}]},
       {
        RowBox[{"{", 
         RowBox[{"a", "\[Rule]", "0"}], "}"}], 
        RowBox[{"a", "\[Equal]", "0"}]},
       {
        RowBox[{"{", "}"}], 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{{3.813461219334159*^9, 3.813461259993595*^9}, 
   3.813461300977994*^9, 3.813461333875862*^9, {3.813461367542292*^9, 
   3.8134613842004757`*^9}, {3.813461442958701*^9, 3.813461464811551*^9}, 
   3.8134615308025503`*^9, {3.813461598749679*^9, 3.8134616309480953`*^9}, 
   3.81346170788933*^9, 3.8134617551816483`*^9, {3.813461798770005*^9, 
   3.813461820636695*^9}, 3.813461863418119*^9, 3.813462580073641*^9, 
   3.8134627143428087`*^9, 3.813462750166815*^9, {3.813462980822701*^9, 
   3.8134630231971416`*^9}, 3.813463058086234*^9, 3.813464249705657*^9, {
   3.8134642978111134`*^9, 3.8134643113691998`*^9}, {3.813464353039421*^9, 
   3.8134643954640007`*^9}, 3.8134708306790237`*^9},
 CellLabel->
  "Out[436]=",ExpressionUUID->"d8946dc1-e263-4b79-aac7-e421360f35af"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{"MonomialDependenceOperator2", "[", "variables", "]"}], "[", 
   RowBox[{"{", " ", 
    RowBox[{
     RowBox[{"u", "[", "x", "]"}], "^", "a"}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.813397753522084*^9, 3.81339777085713*^9}, {
  3.813470858211227*^9, 3.813470863338489*^9}},
 CellLabel->
  "In[457]:=",ExpressionUUID->"5e2eddc9-b877-4932-a004-406748678526"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"{", 
         RowBox[{"a", "\[Rule]", "0"}], "}"}], 
        RowBox[{"a", "\[Equal]", "0"}]},
       {
        RowBox[{"{", "}"}], 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{3.813470864045834*^9, 3.813470919547576*^9},
 CellLabel->
  "Out[457]=",ExpressionUUID->"5487e5b4-dab4-45b4-8f4b-81618cfa654b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<depVars\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"u", ",", "v"}], "}"}]}], ",", 
      RowBox[{"\"\<indVars\>\"", "\[Rule]", 
       RowBox[{"{", "x", "}"}]}], ",", 
      RowBox[{"\"\<pars\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}]}], ",", 
      RowBox[{"\"\<depth\>\"", "\[Rule]", "Infinity"}]}], 
     RowBox[{"(*", 
      RowBox[{",", " ", 
       RowBox[{"\"\<generators\>\"", "\[Rule]", 
        RowBox[{"{", "x", "}"}]}]}], "*)"}], "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.813459075087*^9, 3.813459114455614*^9}, {
  3.813461519608964*^9, 3.813461521769853*^9}, {3.8134704269272118`*^9, 
  3.813470434666994*^9}},
 CellLabel->
  "In[456]:=",ExpressionUUID->"08d58a2e-be1d-41c4-bae6-16de9ece682e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"xp", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"u", "[", "x", "]"}], "^", "a"}], "+", 
   RowBox[{
    RowBox[{"a", "^", "2"}], " ", 
    RowBox[{"u", "[", "x", "]"}]}], " ", "+", " ", 
   RowBox[{
    RowBox[{"u", "[", "x", "]"}], "^", "b"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"mdr", "=", 
  RowBox[{
   RowBox[{"MonomialDependenceOperator2", "[", "variables", "]"}], "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"u", "[", "x", "]"}], "^", "a"}], ",", " ", 
     RowBox[{
      RowBox[{"a", "^", "2"}], " ", 
      RowBox[{"u", "[", "x", "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"u", "[", "x", "]"}], "^", "b"}]}], "}"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8134723514884653`*^9, 3.813472352427908*^9}},
 CellLabel->
  "In[605]:=",ExpressionUUID->"90ac1727-f160-416c-b856-5cb764713375"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["a", "2"], " ", 
   RowBox[{"u", "[", "x", "]"}]}], "+", 
  SuperscriptBox[
   RowBox[{"u", "[", "x", "]"}], "a"], "+", 
  SuperscriptBox[
   RowBox[{"u", "[", "x", "]"}], "b"]}]], "Output",
 CellChangeTimes->{
  3.813471312056674*^9, 3.813471374911467*^9, 3.81347141607027*^9, 
   3.813471730153282*^9, {3.8134718068996468`*^9, 3.813471833751501*^9}, 
   3.8134721663935747`*^9, 3.813472231164674*^9, {3.813472284289845*^9, 
   3.813472353069377*^9}},
 CellLabel->
  "Out[605]=",ExpressionUUID->"1595924d-b236-45fc-bcfa-b444d2fc7598"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"{", "}"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "\[Equal]", "0"}], "&&", 
           RowBox[{
            RowBox[{"a", "-", "b"}], "\[Equal]", "0"}], "&&", 
           RowBox[{"b", "\[Equal]", "1"}]}], ")"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "\[Equal]", "1"}], "&&", 
           RowBox[{
            RowBox[{"a", "-", "b"}], "\[Equal]", "0"}], "&&", 
           RowBox[{"b", "\[Equal]", "0"}]}], ")"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "\[NotEqual]", "0"}], "&&", 
           RowBox[{"a", "\[NotEqual]", "1"}], "&&", 
           RowBox[{
            RowBox[{"a", "-", "b"}], "\[NotEqual]", "0"}], "&&", 
           RowBox[{"b", "\[NotEqual]", "0"}], "&&", 
           RowBox[{"b", "\[NotEqual]", "1"}]}], ")"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", "\[Rule]", "0"}], ",", 
          RowBox[{"b", "\[Rule]", "0"}]}], "}"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "\[Equal]", "0"}], "&&", 
           RowBox[{
            RowBox[{"a", "-", "b"}], "\[Equal]", "0"}]}], ")"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "\[Equal]", "0"}], "&&", 
           RowBox[{"b", "\[Equal]", "0"}]}], ")"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "\[NotEqual]", "1"}], "&&", 
           RowBox[{
            RowBox[{"a", "-", "b"}], "\[Equal]", "0"}], "&&", 
           RowBox[{"b", "\[Equal]", "0"}]}], ")"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", "\[Rule]", "0"}], ",", 
          RowBox[{"b", "\[Rule]", "1"}]}], "}"}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", "0"}], "&&", 
         RowBox[{"b", "\[Equal]", "1"}]}]},
       {
        RowBox[{"{", 
         RowBox[{"a", "\[Rule]", "0"}], "}"}], 
        RowBox[{"a", "\[Equal]", "0"}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", "\[Rule]", "1"}], ",", 
          RowBox[{"b", "\[Rule]", "1"}]}], "}"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "\[Equal]", "1"}], "&&", 
           RowBox[{
            RowBox[{"a", "-", "b"}], "\[Equal]", "0"}], "&&", 
           RowBox[{"b", "\[NotEqual]", "0"}]}], ")"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "\[Equal]", "1"}], "&&", 
           RowBox[{"b", "\[Equal]", "1"}]}], ")"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"a", "-", "b"}], "\[Equal]", "0"}], "&&", 
           RowBox[{"b", "\[Equal]", "1"}]}], ")"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", "\[Rule]", "1"}], ",", 
          RowBox[{"b", "\[Rule]", "0"}]}], "}"}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", "1"}], "&&", 
         RowBox[{"b", "\[Equal]", "0"}]}]},
       {
        RowBox[{"{", 
         RowBox[{"a", "\[Rule]", "1"}], "}"}], 
        RowBox[{"a", "\[Equal]", "1"}]},
       {
        RowBox[{"{", 
         RowBox[{"b", "\[Rule]", "a"}], "}"}], 
        RowBox[{
         RowBox[{"a", "-", "b"}], "\[Equal]", "0"}]},
       {
        RowBox[{"{", 
         RowBox[{"b", "\[Rule]", "1"}], "}"}], 
        RowBox[{"b", "\[Equal]", "1"}]},
       {
        RowBox[{"{", 
         RowBox[{"b", "\[Rule]", "0"}], "}"}], 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{
  3.813471312056674*^9, 3.813471374911467*^9, 3.81347141607027*^9, 
   3.813471730153282*^9, {3.8134718068996468`*^9, 3.813471833751501*^9}, 
   3.8134721663935747`*^9, 3.813472231164674*^9, {3.813472284289845*^9, 
   3.813472353187737*^9}},
 CellLabel->
  "Out[606]=",ExpressionUUID->"00e0a09d-18ca-4d05-a190-2416cfe046ce"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PiecewiseMap", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"xp", "/.", "#"}], ")"}], "-", "xp"}], "&"}], ",", "mdr"}], 
   "]"}], "//", "PiecewiseFullSimplify"}]], "Input",
 CellChangeTimes->{{3.813472248074604*^9, 3.813472400824894*^9}},
 CellLabel->
  "In[612]:=",ExpressionUUID->"38dd67e6-ef67-4fd5-b7b3-6286f5a8f17c"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {"0", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "\[Equal]", "0"}], "&&", 
           RowBox[{"b", "\[Equal]", "0"}]}], ")"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "\[Equal]", "0"}], "&&", 
           RowBox[{"b", "\[Equal]", "1"}]}], ")"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "\[Equal]", "0"}], "&&", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "b"}], "+", 
             SuperscriptBox["b", "2"]}], "\[NotEqual]", "0"}]}], ")"}], "||", 
         
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "\[Equal]", "1"}], "&&", 
           RowBox[{"b", "\[Equal]", "0"}]}], ")"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "\[Equal]", "1"}], "&&", 
           RowBox[{"b", "\[Equal]", "1"}]}], ")"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "\[Equal]", "1"}], "&&", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "b"}], "+", 
             SuperscriptBox["b", "2"]}], "\[NotEqual]", "0"}]}], ")"}], "||", 
         
         RowBox[{"(", 
          RowBox[{
           RowBox[{"b", "\[Equal]", "0"}], "&&", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "a"}], "+", 
             SuperscriptBox["a", "2"]}], "\[NotEqual]", "0"}]}], ")"}], "||", 
         
         RowBox[{"(", 
          RowBox[{
           RowBox[{"b", "\[Equal]", "1"}], "&&", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "a"}], "+", 
             SuperscriptBox["a", "2"]}], "\[NotEqual]", "0"}]}], ")"}], "||", 
         
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", "b"}], "+", 
             SuperscriptBox["b", "2"]}], "\[NotEqual]", "0"}], "&&", 
           RowBox[{
            RowBox[{"a", "-", "b"}], "\[Equal]", "0"}]}], ")"}], "||", 
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox["a", "2"], " ", "b"}], "-", 
           RowBox[{
            SuperscriptBox["a", "3"], " ", "b"}], "-", 
           RowBox[{"a", " ", 
            SuperscriptBox["b", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["a", "3"], " ", 
            SuperscriptBox["b", "2"]}], "+", 
           RowBox[{"a", " ", 
            SuperscriptBox["b", "3"]}], "-", 
           RowBox[{
            SuperscriptBox["a", "2"], " ", 
            SuperscriptBox["b", "3"]}]}], "\[NotEqual]", "0"}]}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{{3.8134723875460873`*^9, 3.813472401880341*^9}},
 CellLabel->
  "Out[612]=",ExpressionUUID->"130309c2-2546-40ea-b434-b6e6ee6099a5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reduce", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", "\[Equal]", "0"}], "&&", 
      RowBox[{"b", "\[Equal]", "0"}]}], ")"}], "||", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", "\[Equal]", "0"}], "&&", 
      RowBox[{"b", "\[Equal]", "1"}]}], ")"}], "||", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", "\[Equal]", "0"}], "&&", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "b"}], "+", 
        SuperscriptBox["b", "2"]}], "\[NotEqual]", "0"}]}], ")"}], "||", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", "\[Equal]", "1"}], "&&", 
      RowBox[{"b", "\[Equal]", "0"}]}], ")"}], "||", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", "\[Equal]", "1"}], "&&", 
      RowBox[{"b", "\[Equal]", "1"}]}], ")"}], "||", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", "\[Equal]", "1"}], "&&", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "b"}], "+", 
        SuperscriptBox["b", "2"]}], "\[NotEqual]", "0"}]}], ")"}], "||", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"b", "\[Equal]", "0"}], "&&", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "a"}], "+", 
        SuperscriptBox["a", "2"]}], "\[NotEqual]", "0"}]}], ")"}], "||", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"b", "\[Equal]", "1"}], "&&", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "a"}], "+", 
        SuperscriptBox["a", "2"]}], "\[NotEqual]", "0"}]}], ")"}], "||", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", "b"}], "+", 
        SuperscriptBox["b", "2"]}], "\[NotEqual]", "0"}], "&&", 
      RowBox[{
       RowBox[{"a", "-", "b"}], "\[Equal]", "0"}]}], ")"}], "||", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["a", "2"], " ", "b"}], "-", 
      RowBox[{
       SuperscriptBox["a", "3"], " ", "b"}], "-", 
      RowBox[{"a", " ", 
       SuperscriptBox["b", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["a", "3"], " ", 
       SuperscriptBox["b", "2"]}], "+", 
      RowBox[{"a", " ", 
       SuperscriptBox["b", "3"]}], "-", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["b", "3"]}]}], "\[NotEqual]", "0"}]}], ",", " ", 
   "Reals"}], "]"}]], "Input",
 CellChangeTimes->{{3.8134725675137*^9, 3.8134725730541553`*^9}},
 CellLabel->
  "In[613]:=",ExpressionUUID->"c7f33f14-56e2-45ea-a798-653bd2a3be79"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.813472573742072*^9},
 CellLabel->
  "Out[613]=",ExpressionUUID->"22ed291b-5261-4169-ad80-79960902bb13"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8134831118283367`*^9, 
  3.8134831150210257`*^9}},ExpressionUUID->"d0848d67-a1f5-411b-b951-\
97734142d836"],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8134829990954103`*^9, 3.813483006195261*^9}, 
   3.813483109401806*^9},ExpressionUUID->"636fd70a-442a-46b2-b68f-\
97475ec73f7d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"u", "[", "x", "]"}], "+", 
  SuperscriptBox[
   RowBox[{"u", "[", "x", "]"}], "a"]}]], "Output",
 CellChangeTimes->{3.813483007062469*^9, 3.8134830660481167`*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"95e66b8f-66db-4b39-adf6-2cd4ea330129"],

Cell[BoxData[
 TemplateBox[{
  "ReplaceAll", "reps", 
   "\"\\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"PDESymbolics2020`Private`MonomialDependenceOperator2\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftAssociation]\\\", \
RowBox[{RowBox[{\\\"\\\\\\\"depVars\\\\\\\"\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"u\\\", \\\",\\\", \\\"v\\\"}], \\\"}\\\"}]}], \
\\\",\\\", RowBox[{\\\"\\\\\\\"indVars\\\\\\\"\\\", \\\"\[Rule]\\\", RowBox[{\
\\\"{\\\", \\\"x\\\", \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"\\\\\\\"pars\\\\\\\"\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"a\\\", \\\",\\\", \\\"b\\\"}], \\\"}\\\"}]}], \\\",\\\", RowBox[{\
\\\"\\\\\\\"depth\\\\\\\"\\\", \\\"\[Rule]\\\", \\\"\[Infinity]\\\"}]}], \\\"\
\[RightAssociation]\\\"}], \\\"]\\\"}], \\\"[\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"u\\\", \\\"[\\\", \\\"x\\\", \\\"]\\\"}], \\\",\\\", \
SuperscriptBox[RowBox[{\\\"u\\\", \\\"[\\\", \\\"x\\\", \\\"]\\\"}], \
\\\"a\\\"]}], \\\"}\\\"}], \\\"]\\\"}], \\\"}\\\"}]\\) is neither a list of \
replacement rules nor a valid dispatch table, and so cannot be used for \
replacing.\"", 2, 14, 2, 26758558936516878798, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.813483066050538*^9},
 CellLabel->
  "During evaluation of \
In[13]:=",ExpressionUUID->"8208a496-54cd-4f1c-a60e-7fcde9d92696"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"u", "[", "x", "]"}], "+", 
   SuperscriptBox[
    RowBox[{"u", "[", "x", "]"}], "a"]}], "/.", "\[VeryThinSpace]", 
  RowBox[{
   RowBox[{"PDESymbolics2020`Private`MonomialDependenceOperator2", "[", 
    RowBox[{"\[LeftAssociation]", 
     RowBox[{
      RowBox[{"\<\"depVars\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"u", ",", "v"}], "}"}]}], ",", 
      RowBox[{"\<\"indVars\"\>", "\[Rule]", 
       RowBox[{"{", "x", "}"}]}], ",", 
      RowBox[{"\<\"pars\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}]}], ",", 
      RowBox[{"\<\"depth\"\>", "\[Rule]", "\[Infinity]"}]}], 
     "\[RightAssociation]"}], "]"}], "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"u", "[", "x", "]"}], ",", 
     SuperscriptBox[
      RowBox[{"u", "[", "x", "]"}], "a"]}], "}"}], "]"}]}]], "Output",
 CellChangeTimes->{3.813483007062469*^9, 3.8134830660649233`*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"fb716a9e-2d1f-42d0-ace4-1611217a41f4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ParametricRefineOperator2", "[", "variables", "]"}], "[", "xp", 
    "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ParametricRefineOperator", "[", "variables", "]"}], "[", "xp", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.813470442544445*^9, 3.81347053585773*^9}, {
   3.813470588592041*^9, 3.813470589405801*^9}, {3.813471031332423*^9, 
   3.813471034513155*^9}, {3.813471127533242*^9, 3.8134711495037413`*^9}, {
   3.8134712227619553`*^9, 3.813471271202961*^9}, 3.8134713101602983`*^9},
 CellLabel->
  "In[614]:=",ExpressionUUID->"5a1cf9dc-2fb7-487f-aa6c-2befdb66aca3"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          RowBox[{"u", "[", "x", "]"}]}], "+", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], "a"], "+", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], "b"]}], 
        RowBox[{
         RowBox[{
          RowBox[{
           SuperscriptBox["a", "2"], " ", "b"}], "-", 
          RowBox[{
           SuperscriptBox["a", "3"], " ", "b"}], "-", 
          RowBox[{"a", " ", 
           SuperscriptBox["b", "2"]}], "+", 
          RowBox[{
           SuperscriptBox["a", "3"], " ", 
           SuperscriptBox["b", "2"]}], "+", 
          RowBox[{"a", " ", 
           SuperscriptBox["b", "3"]}], "-", 
          RowBox[{
           SuperscriptBox["a", "2"], " ", 
           SuperscriptBox["b", "3"]}]}], "\[NotEqual]", "0"}]},
       {
        RowBox[{"1", "+", 
         RowBox[{"u", "[", "x", "]"}]}], 
        RowBox[{
         RowBox[{"b", "\[Equal]", "1"}], "&&", 
         RowBox[{"a", "\[Equal]", "0"}]}]},
       {"2", 
        RowBox[{
         RowBox[{"b", "\[Equal]", "0"}], "&&", 
         RowBox[{"a", "\[Equal]", "0"}]}]},
       {
        RowBox[{"1", "+", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], "b"]}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", "0"}], "&&", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "b"}], "+", 
           SuperscriptBox["b", "2"]}], "\[NotEqual]", "0"}]}]},
       {
        RowBox[{"3", " ", 
         RowBox[{"u", "[", "x", "]"}]}], 
        RowBox[{
         RowBox[{"b", "\[Equal]", "1"}], "&&", 
         RowBox[{"a", "\[Equal]", "1"}]}]},
       {
        RowBox[{"1", "+", 
         RowBox[{"2", " ", 
          RowBox[{"u", "[", "x", "]"}]}]}], 
        RowBox[{
         RowBox[{"b", "\[Equal]", "0"}], "&&", 
         RowBox[{"a", "\[Equal]", "1"}]}]},
       {
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"u", "[", "x", "]"}]}], "+", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], "b"]}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", "1"}], "&&", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "b"}], "+", 
           SuperscriptBox["b", "2"]}], "\[NotEqual]", "0"}]}]},
       {
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["a", "2"]}], ")"}], " ", 
          RowBox[{"u", "[", "x", "]"}]}], "+", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], "a"]}], 
        RowBox[{
         RowBox[{"b", "\[Equal]", "1"}], "&&", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "a"}], "+", 
           SuperscriptBox["a", "2"]}], "\[NotEqual]", "0"}]}]},
       {
        RowBox[{
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          RowBox[{"u", "[", "x", "]"}]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], "a"]}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"a", "-", "b"}], "\[Equal]", "0"}], "&&", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "b"}], "+", 
           SuperscriptBox["b", "2"]}], "\[NotEqual]", "0"}]}]},
       {
        RowBox[{"1", "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          RowBox[{"u", "[", "x", "]"}]}], "+", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], "a"]}], 
        RowBox[{
         RowBox[{"b", "\[Equal]", "0"}], "&&", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "a"}], "+", 
           SuperscriptBox["a", "2"]}], "\[NotEqual]", "0"}]}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{{3.813470449469595*^9, 3.813470538528267*^9}, 
   3.8134705903159227`*^9, {3.813470840670911*^9, 3.81347087090793*^9}, 
   3.813470910918387*^9, 3.813470968909997*^9, {3.813471026524975*^9, 
   3.8134710350812683`*^9}, {3.813471121842224*^9, 3.8134711503831367`*^9}, {
   3.813471193567507*^9, 3.813471271892144*^9}, 3.813472171646791*^9, 
   3.813472615172179*^9},
 CellLabel->
  "Out[614]=",ExpressionUUID->"21099edc-800e-4b5f-8604-4a8a00e1e6a4"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {"2", 
        RowBox[{
         RowBox[{"b", "\[Equal]", "0"}], "&&", 
         RowBox[{"a", "\[Equal]", "0"}]}]},
       {
        RowBox[{"1", "+", 
         RowBox[{"u", "[", "x", "]"}]}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", "0"}], "&&", 
         RowBox[{"b", "\[Equal]", "1"}]}]},
       {
        RowBox[{"1", "+", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], "b"]}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", "0"}], "&&", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "b"}], "+", 
           SuperscriptBox["b", "2"]}], "\[NotEqual]", "0"}]}]},
       {
        RowBox[{"3", " ", 
         RowBox[{"u", "[", "x", "]"}]}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", "1"}], "&&", 
         RowBox[{"b", "\[Equal]", "1"}]}]},
       {
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"u", "[", "x", "]"}]}], "+", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], "b"]}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", "1"}], "&&", 
         RowBox[{"b", "\[NotEqual]", "1"}]}]},
       {
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["a", "2"]}], ")"}], " ", 
          RowBox[{"u", "[", "x", "]"}]}], "+", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], "a"]}], 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "a"}], "+", 
           SuperscriptBox["a", "2"]}], "\[NotEqual]", "0"}], "&&", 
         RowBox[{"b", "\[Equal]", "1"}]}]},
       {
        RowBox[{
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          RowBox[{"u", "[", "x", "]"}]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], "a"]}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"a", "-", "b"}], "\[Equal]", "0"}], "&&", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "b"}], "+", 
           SuperscriptBox["b", "2"]}], "\[NotEqual]", "0"}]}]},
       {
        RowBox[{"1", "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          RowBox[{"u", "[", "x", "]"}]}], "+", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], "a"]}], 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "a"}], "+", 
           SuperscriptBox["a", "2"]}], "\[NotEqual]", "0"}], "&&", 
         RowBox[{"b", "\[Equal]", "0"}]}]},
       {
        RowBox[{
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          RowBox[{"u", "[", "x", "]"}]}], "+", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], "a"], "+", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], "b"]}], 
        RowBox[{
         RowBox[{
          SuperscriptBox["a", "2"], "-", 
          SuperscriptBox["a", "3"], "-", 
          RowBox[{"a", " ", "b"}], "+", 
          RowBox[{
           SuperscriptBox["a", "3"], " ", "b"}], "+", 
          RowBox[{"a", " ", 
           SuperscriptBox["b", "2"]}], "-", 
          RowBox[{
           SuperscriptBox["a", "2"], " ", 
           SuperscriptBox["b", "2"]}]}], "\[NotEqual]", "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{{3.813470449469595*^9, 3.813470538528267*^9}, 
   3.8134705903159227`*^9, {3.813470840670911*^9, 3.81347087090793*^9}, 
   3.813470910918387*^9, 3.813470968909997*^9, {3.813471026524975*^9, 
   3.8134710350812683`*^9}, {3.813471121842224*^9, 3.8134711503831367`*^9}, {
   3.813471193567507*^9, 3.813471271892144*^9}, 3.813472171646791*^9, 
   3.813472615302527*^9},
 CellLabel->
  "Out[615]=",ExpressionUUID->"3a9e047b-6ae9-4bb7-bfbe-100db19b6170"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"MonomialDependenceOperator2", "[", "variables", "]"}], "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"u", "[", "x", "]"}], "^", "2"}], ",", " ", 
    RowBox[{
     RowBox[{"u", "[", "x", "]"}], "^", "a"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.8133935422213173`*^9, 3.81339355736928*^9}, 
   3.813472633291231*^9},
 CellLabel->
  "In[617]:=",ExpressionUUID->"6df87061-a787-4237-8f04-1d46dca63893"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"{", 
         RowBox[{"a", "\[Rule]", "2"}], "}"}], 
        RowBox[{"a", "\[Equal]", "2"}]},
       {
        RowBox[{"{", 
         RowBox[{"a", "\[Rule]", "0"}], "}"}], 
        RowBox[{"a", "\[Equal]", "0"}]},
       {
        RowBox[{"{", "}"}], 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{
  3.813393558286978*^9, 3.813393628556396*^9, 3.8133937442983093`*^9, {
   3.813393885223287*^9, 3.8133939134904423`*^9}, 3.81339426335956*^9, 
   3.81339443034391*^9, 3.813472198135988*^9, {3.813472630460291*^9, 
   3.813472634148568*^9}},
 CellLabel->
  "Out[617]=",ExpressionUUID->"139cfd6a-2c07-4a42-8d58-8891e8533e58"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["variables"], "Input",
 CellChangeTimes->{{3.81347358206032*^9, 3.8134735831179934`*^9}},
 CellLabel->
  "In[644]:=",ExpressionUUID->"2e67968b-313b-41d7-b98d-b0b0b2e6b804"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"depVars\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"u", ",", "v"}], "}"}]}], ",", 
   RowBox[{"\<\"indVars\"\>", "\[Rule]", 
    RowBox[{"{", "x", "}"}]}], ",", 
   RowBox[{"\<\"pars\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"a", ",", "b"}], "}"}]}], ",", 
   RowBox[{"\<\"depth\"\>", "\[Rule]", "\[Infinity]"}], ",", 
   RowBox[{"\<\"generators\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"u", "[", "x", "]"}], ",", 
      RowBox[{
       SuperscriptBox["u", "\[Prime]",
        MultilineFunction->None], "[", "x", "]"}], ",", 
      RowBox[{
       SuperscriptBox["u", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "x", "]"}]}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.8134735835225143`*^9},
 CellLabel->
  "Out[644]=",ExpressionUUID->"a047eb2c-14c3-451e-bedd-fa00aec0020c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RegroupParametersOperator", "[", "variables", "]"}], "[", 
  RowBox[{
   RowBox[{
    RowBox[{"E", "^", "a"}], " ", 
    RowBox[{"u", "[", "x", "]"}]}], "+", 
   RowBox[{"a", " ", 
    RowBox[{"u", "[", "x", "]"}]}], "+", 
   RowBox[{
    RowBox[{"b", "^", "a"}], " ", 
    RowBox[{"u", "[", "x", "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.813391204188387*^9, 3.813391228157261*^9}, {
  3.813391281256592*^9, 3.813391283843503*^9}},
 CellLabel->
  "In[618]:=",ExpressionUUID->"3c933dc7-793e-4119-b408-5616779acbe8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["b", "a"], " ", 
   RowBox[{"u", "[", "x", "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"a", "+", 
     SuperscriptBox["\[ExponentialE]", "a"]}], ")"}], " ", 
   RowBox[{"u", "[", "x", "]"}]}]}]], "Output",
 CellChangeTimes->{3.813472637454184*^9},
 CellLabel->
  "Out[618]=",ExpressionUUID->"16225798-870a-490f-b609-ad9eee094664"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["variables"], "Input",
 CellChangeTimes->{{3.813392400473909*^9, 3.8133924023143187`*^9}},
 CellLabel->
  "In[140]:=",ExpressionUUID->"2d473230-ed1a-40b1-b219-46c1f8bfa46d"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"generators\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}]}], ",", 
   RowBox[{"\<\"pars\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"a", ",", "b"}], "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.813392402735112*^9},
 CellLabel->
  "Out[140]=",ExpressionUUID->"e5458f28-bc44-49b6-b11a-21bb7b709e61"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<depVars\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"u", ",", "v"}], "}"}]}], ",", 
      RowBox[{"\"\<indVars\>\"", "\[Rule]", 
       RowBox[{"{", "x", "}"}]}], ",", 
      RowBox[{"\"\<pars\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}]}], ",", 
      RowBox[{"\"\<depth\>\"", "\[Rule]", "Infinity"}]}], 
     RowBox[{"(*", 
      RowBox[{",", " ", 
       RowBox[{"\"\<generators\>\"", "\[Rule]", 
        RowBox[{"{", "x", "}"}]}]}], "*)"}], "}"}], "]"}]}], ";", 
  RowBox[{"variables", "=", 
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<depVars\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"u", ",", "v"}], "}"}]}], ",", 
      RowBox[{"\"\<indVars\>\"", "\[Rule]", 
       RowBox[{"{", "x", "}"}]}], ",", 
      RowBox[{"\"\<pars\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}]}], ",", 
      RowBox[{"\"\<depth\>\"", "\[Rule]", "Infinity"}], ",", " ", 
      RowBox[{"\"\<generators\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"x", ",", " ", 
         RowBox[{"u", "[", "x", "]"}], ",", " ", 
         RowBox[{
          RowBox[{"u", "'"}], "[", "x", "]"}], ",", " ", 
         RowBox[{
          RowBox[{"u", "''"}], "[", "x", "]"}]}], "}"}]}]}], "}"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.813473397134007*^9, 3.81347341428758*^9}},
 CellLabel->
  "In[641]:=",ExpressionUUID->"425692f7-2ad3-4559-b5a6-d3b29d06abcd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ZerosOperator", "[", "variables", "]"}], "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "a"}], "+", 
     SuperscriptBox["a", "2"]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"u", "[", "x", "]"}], 
    RowBox[{
     RowBox[{"-", "2"}], "+", "a"}]], " ", 
   SuperscriptBox[
    RowBox[{
     SuperscriptBox["u", "\[Prime]",
      MultilineFunction->None], "[", "x", "]"}], "2"], " ", 
   RowBox[{
    SuperscriptBox["u", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "x", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.813392373374255*^9, 3.813392384573447*^9}, {
  3.813472667066162*^9, 3.8134726695455713`*^9}},
 CellLabel->
  "In[642]:=",ExpressionUUID->"732d2f56-af07-4c8c-ab94-10fd524d6e9c"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"a", "\[Rule]", "0"}], "}"}], "}"}], 
        RowBox[{"a", "\[Equal]", "0"}]},
       {
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"a", "\[Rule]", "1"}], "}"}], "}"}], 
        RowBox[{"a", "\[Equal]", "1"}]},
       {
        RowBox[{"{", "}"}], 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{3.8133923855099163`*^9, 3.813392494051054*^9, 
  3.8133925242229433`*^9, 3.813472670321961*^9, 3.813473278041222*^9, 
  3.813473419004347*^9},
 CellLabel->
  "Out[642]=",ExpressionUUID->"90eda4b3-abcd-4f1e-a792-6b119ec49a4c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SolveAlways", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "a"}], "+", 
       SuperscriptBox["a", "2"]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"u", "[", "x", "]"}], 
      RowBox[{
       RowBox[{"-", "2"}], "+", "a"}]], " ", 
     SuperscriptBox[
      RowBox[{
       SuperscriptBox["u", "\[Prime]",
        MultilineFunction->None], "[", "x", "]"}], "2"], " ", 
     RowBox[{
      SuperscriptBox["u", "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "x", "]"}]}], "\[Equal]", "0"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"u", "[", "x", "]"}], ",", 
     RowBox[{
      RowBox[{"u", "'"}], "[", "x", "]"}], ",", " ", 
     RowBox[{
      RowBox[{"u", "''"}], "[", "x", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.813473319131537*^9, 3.813473359837008*^9}, {
  3.813473434963071*^9, 3.81347343740306*^9}},
 CellLabel->
  "In[643]:=",ExpressionUUID->"a821a28e-2909-4249-a848-69f22382c631"],

Cell[BoxData[
 TemplateBox[{
  "SolveAlways", "dinv", 
   "\"The expression \\!\\(\\*SuperscriptBox[RowBox[{\\\"u\\\", \\\"[\\\", \\\
\"x\\\", \\\"]\\\"}], RowBox[{RowBox[{\\\"-\\\", \\\"2\\\"}], \\\"+\\\", \
\\\"a\\\"}]]\\) involves unknowns in more than one argument, so inverse \
functions cannot be used.\"", 2, 643, 64, 26758021880991300551, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.813473437965315*^9},
 CellLabel->
  "During evaluation of \
In[643]:=",ExpressionUUID->"247a07c9-3e92-41d7-a063-7e87f7ceab68"],

Cell[BoxData[
 TemplateBox[{
  "SolveAlways", "dinv", 
   "\"The expression \\!\\(\\*SuperscriptBox[RowBox[{\\\"u\\\", \\\"[\\\", \\\
\"x\\\", \\\"]\\\"}], RowBox[{RowBox[{\\\"-\\\", \\\"2\\\"}], \\\"+\\\", \
\\\"a\\\"}]]\\) involves unknowns in more than one argument, so inverse \
functions cannot be used.\"", 2, 643, 65, 26758021880991300551, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.813473438009553*^9},
 CellLabel->
  "During evaluation of \
In[643]:=",ExpressionUUID->"566eb007-38a3-4fef-b594-f832d57416bd"],

Cell[BoxData[
 RowBox[{"SolveAlways", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "a"}], "+", 
       SuperscriptBox["a", "2"]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"u", "[", "x", "]"}], 
      RowBox[{
       RowBox[{"-", "2"}], "+", "a"}]], " ", 
     SuperscriptBox[
      RowBox[{
       SuperscriptBox["u", "\[Prime]",
        MultilineFunction->None], "[", "x", "]"}], "2"], " ", 
     RowBox[{
      SuperscriptBox["u", "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "x", "]"}]}], "\[Equal]", "0"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"u", "[", "x", "]"}], ",", 
     RowBox[{
      SuperscriptBox["u", "\[Prime]",
       MultilineFunction->None], "[", "x", "]"}], ",", 
     RowBox[{
      SuperscriptBox["u", "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "x", "]"}]}], "}"}]}], "]"}]], "Output",\

 CellChangeTimes->{{3.81347334098743*^9, 3.813473362422173*^9}, 
   3.813473438029873*^9},
 CellLabel->
  "Out[643]=",ExpressionUUID->"5abc8408-89e2-48ec-b7f0-593aeb156d91"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ParametricRefineOperator", "[", "variables", "]"}], "[", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "a"}], " ", 
    SuperscriptBox[
     RowBox[{"u", "[", "x", "]"}], 
     RowBox[{
      RowBox[{"-", "2"}], "+", "a"}]], " ", 
    SuperscriptBox[
     RowBox[{
      SuperscriptBox["u", "\[Prime]",
       MultilineFunction->None], "[", "x", "]"}], "2"], " ", 
    RowBox[{
     SuperscriptBox["u", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "x", "]"}]}], "+", 
   RowBox[{
    SuperscriptBox["a", "2"], " ", 
    SuperscriptBox[
     RowBox[{"u", "[", "x", "]"}], 
     RowBox[{
      RowBox[{"-", "2"}], "+", "a"}]], " ", 
    SuperscriptBox[
     RowBox[{
      SuperscriptBox["u", "\[Prime]",
       MultilineFunction->None], "[", "x", "]"}], "2"], " ", 
    RowBox[{
     SuperscriptBox["u", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "x", "]"}]}], "+", 
   RowBox[{
    RowBox[{"u", "''"}], "[", "x", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{3.8134729882589817`*^9},
 CellLabel->
  "In[636]:=",ExpressionUUID->"0b136d81-4628-4018-b7db-2dd8f67b9e7d"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{
         SuperscriptBox["u", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "x", "]"}], 
        RowBox[{"a", "\[Equal]", "0"}]},
       {
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "a"}], ")"}], " ", "a", " ", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], 
             RowBox[{
              RowBox[{"-", "2"}], "+", "a"}]], " ", 
            SuperscriptBox[
             RowBox[{
              SuperscriptBox["u", "\[Prime]",
               MultilineFunction->None], "[", "x", "]"}], "2"]}]}], ")"}], 
         " ", 
         RowBox[{
          SuperscriptBox["u", "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "x", "]"}]}], 
        RowBox[{"a", "\[NotEqual]", "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{3.813472991052569*^9, 3.813473094695434*^9},
 CellLabel->
  "Out[636]=",ExpressionUUID->"2a5bd022-f0ed-4bd7-a6af-59c3290c988c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ParametricRefineOperator2", "[", "variables", "]"}], "[", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "a"}], " ", 
    SuperscriptBox[
     RowBox[{"u", "[", "x", "]"}], 
     RowBox[{
      RowBox[{"-", "2"}], "+", "a"}]], " ", 
    SuperscriptBox[
     RowBox[{
      SuperscriptBox["u", "\[Prime]",
       MultilineFunction->None], "[", "x", "]"}], "2"], " ", 
    RowBox[{
     SuperscriptBox["u", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "x", "]"}]}], "+", 
   RowBox[{
    SuperscriptBox["a", "2"], " ", 
    SuperscriptBox[
     RowBox[{"u", "[", "x", "]"}], 
     RowBox[{
      RowBox[{"-", "2"}], "+", "a"}]], " ", 
    SuperscriptBox[
     RowBox[{
      SuperscriptBox["u", "\[Prime]",
       MultilineFunction->None], "[", "x", "]"}], "2"], " ", 
    RowBox[{
     SuperscriptBox["u", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "x", "]"}]}], "+", 
   RowBox[{
    RowBox[{"u", "''"}], "[", "x", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.8133808509930267`*^9, {3.813380969975277*^9, 3.8133810076689587`*^9}, {
   3.813381794831646*^9, 3.813381796182509*^9}},
 CellLabel->
  "In[637]:=",ExpressionUUID->"f605c27b-ac1f-4358-b99c-7e2a772bd51f"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{
         SuperscriptBox["u", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "x", "]"}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", "0"}], "||", 
         RowBox[{"a", "\[Equal]", "1"}]}]},
       {
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "a"}], ")"}], " ", "a", " ", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], 
             RowBox[{
              RowBox[{"-", "2"}], "+", "a"}]], " ", 
            SuperscriptBox[
             RowBox[{
              SuperscriptBox["u", "\[Prime]",
               MultilineFunction->None], "[", "x", "]"}], "2"]}]}], ")"}], 
         " ", 
         RowBox[{
          SuperscriptBox["u", "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "x", "]"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "a"}], "+", 
          SuperscriptBox["a", "2"]}], "\[NotEqual]", "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{{3.813390658031382*^9, 3.813390684441553*^9}, 
   3.8133923604670553`*^9, 3.813392557222028*^9, 3.813472682529896*^9, 
   3.813473006702196*^9, 3.813473099110331*^9},
 CellLabel->
  "Out[637]=",ExpressionUUID->"551dfa82-548d-4eb3-86a2-bc34691ce52b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ParametricRefineOperator2", "[", "variables", "]"}], "[", "   ", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "a"}], " ", 
    SuperscriptBox[
     RowBox[{"u", "[", "x", "]"}], 
     RowBox[{
      RowBox[{"-", "2"}], "+", "a"}]], " ", 
    SuperscriptBox[
     RowBox[{
      SuperscriptBox["u", "\[Prime]",
       MultilineFunction->None], "[", "x", "]"}], "2"], " ", 
    RowBox[{
     SuperscriptBox["u", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "x", "]"}]}], "+", 
   RowBox[{
    RowBox[{"a", "^", "2"}], 
    SuperscriptBox[
     RowBox[{"u", "[", "x", "]"}], 
     RowBox[{
      RowBox[{"-", "2"}], "+", "a"}]], " ", 
    SuperscriptBox[
     RowBox[{
      SuperscriptBox["u", "\[Prime]",
       MultilineFunction->None], "[", "x", "]"}], "2"], " ", 
    RowBox[{
     SuperscriptBox["u", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "x", "]"}]}], "+", 
   RowBox[{"a", " ", 
    SuperscriptBox[
     RowBox[{"u", "[", "x", "]"}], 
     RowBox[{
      RowBox[{"-", "1"}], "+", "a"}]], " ", 
    SuperscriptBox[
     RowBox[{
      SuperscriptBox["u", "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "x", "]"}], "2"]}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.813380859727569*^9, {3.813472720741914*^9, 3.813472741632415*^9}},
 CellLabel->
  "In[623]:=",ExpressionUUID->"5d4e6552-774a-4576-8205-937804902971"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {"0", 
        RowBox[{"a", "\[Equal]", "0"}]},
       {
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["u", "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "x", "]"}], "2"], 
        RowBox[{"a", "\[Equal]", "1"}]},
       {
        RowBox[{"a", " ", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], 
          RowBox[{
           RowBox[{"-", "2"}], "+", "a"}]], " ", 
         RowBox[{
          SuperscriptBox["u", "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "x", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "a"}], ")"}], " ", 
            SuperscriptBox[
             RowBox[{
              SuperscriptBox["u", "\[Prime]",
               MultilineFunction->None], "[", "x", "]"}], "2"]}], "+", 
           RowBox[{
            RowBox[{"u", "[", "x", "]"}], " ", 
            RowBox[{
             SuperscriptBox["u", "\[Prime]\[Prime]",
              MultilineFunction->None], "[", "x", "]"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "a"}], "+", 
          SuperscriptBox["a", "2"]}], "\[NotEqual]", "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{{3.813380856098033*^9, 3.813380860258169*^9}, 
   3.8134727053970833`*^9, 3.813472743295867*^9},
 CellLabel->
  "Out[623]=",ExpressionUUID->"969daa1d-7673-4611-bb1a-bc483cbcfda8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ParametricRefineOperator2", "[", "variables", "]"}], "[", "%", 
  "]"}]], "Input",
 CellChangeTimes->{{3.813472748484948*^9, 3.813472750119554*^9}},
 CellLabel->
  "In[626]:=",ExpressionUUID->"d95c1602-c59d-48be-8687-2e5d8861e548"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {"0", 
        RowBox[{"a", "\[Equal]", "0"}]},
       {
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["u", "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "x", "]"}], "2"], 
        RowBox[{"a", "\[Equal]", "1"}]},
       {
        RowBox[{"a", " ", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], 
          RowBox[{
           RowBox[{"-", "2"}], "+", "a"}]], " ", 
         RowBox[{
          SuperscriptBox["u", "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "x", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "a"}], ")"}], " ", 
            SuperscriptBox[
             RowBox[{
              SuperscriptBox["u", "\[Prime]",
               MultilineFunction->None], "[", "x", "]"}], "2"]}], "+", 
           RowBox[{
            RowBox[{"u", "[", "x", "]"}], " ", 
            RowBox[{
             SuperscriptBox["u", "\[Prime]\[Prime]",
              MultilineFunction->None], "[", "x", "]"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "a"}], "+", 
          SuperscriptBox["a", "2"]}], "\[NotEqual]", "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{{3.813472750734744*^9, 3.8134727573238773`*^9}},
 CellLabel->
  "Out[626]=",ExpressionUUID->"f299ed1e-8e9e-44c1-8885-8ac525348d02"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Old STUFF", "Section",
 CellChangeTimes->{{3.813380643989338*^9, 
  3.81338064721357*^9}},ExpressionUUID->"db199536-bf21-46a9-a54e-\
ed28576fc737"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ParametricRefine", "[", 
     RowBox[{"$Failed", ",", "depVars_List", ",", "indVars_List", ",", 
      RowBox[{"pars_List:", 
       RowBox[{"{", "}"}]}]}], "]"}], ":=", "$Failed"}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ParametricRefine", "[", 
     RowBox[{"xp_Piecewise", ",", "depVars_List", ",", "indVars_List", ",", 
      RowBox[{"pars_List:", 
       RowBox[{"{", "}"}]}]}], "]"}], ":=", 
    RowBox[{"PiecewiseMap", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ParametricRefine", "[", 
        RowBox[{"#", ",", "depVars", ",", "indVars", ",", "pars"}], "]"}], 
       "&"}], ",", "xp"}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ParametricRefine", "[", 
     RowBox[{"xp_List", ",", "depVars_List", ",", "indVars_List", ",", 
      RowBox[{"pars_List:", 
       RowBox[{"{", "}"}]}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"ParametricRefine", "[", 
          RowBox[{"#", ",", "depVars", ",", "indVars", ",", "pars"}], "]"}], 
         "&"}], "/@", "xp"}], ")"}], "//", "PiecewiseExpand"}], "//", 
     "SimplifyPiecewise"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ParametricRefine", "[", 
     RowBox[{"xp_Plus", ",", "depVars_List", ",", "indVars_List", ",", 
      RowBox[{"pars_List:", 
       RowBox[{"{", "}"}]}]}], "]"}], ":=", 
    RowBox[{"SimplifyPiecewise", "[", 
     RowBox[{"PiecewiseMap", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"xp", "/.", "#"}], "&"}], ",", 
       RowBox[{"MonomialDependence", "[", 
        RowBox[{
         RowBox[{"List", "@@", "xp"}], ",", "depVars", ",", "indVars", ",", 
         "pars"}], "]"}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ParametricRefine", "[", 
     RowBox[{"xp_", ",", 
      RowBox[{"depVars_List:", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"indVars_List:", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"pars_List:", 
       RowBox[{"{", "}"}]}]}], "]"}], ":=", "xp"}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ParametricRefineOperator", "[", "variables_Association", "]"}], ":=", 
    RowBox[{
     RowBox[{"ParametricRefine", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Lookup", "[", 
          RowBox[{"variables", ",", "\"\<depVars\>\"", ",", 
           RowBox[{"{", "}"}]}], "]"}], ",", 
         RowBox[{"Lookup", "[", 
          RowBox[{"variables", ",", "\"\<genFuns\>\"", ",", 
           RowBox[{"{", "}"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"Lookup", "[", 
        RowBox[{"variables", ",", "\"\<indVars\>\"", ",", 
         RowBox[{"{", "}"}]}], "]"}], ",", 
       RowBox[{"Lookup", "[", 
        RowBox[{"variables", ",", "\"\<pars\>\"", ",", 
         RowBox[{"{", "}"}]}], "]"}]}], "]"}], "&"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n"}], "Input",
 CellChangeTimes->{{3.798784041769432*^9, 
  3.7987840417736073`*^9}},ExpressionUUID->"682ab97a-879f-4330-8a15-\
37a6af2dd0f1"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.798785293591631*^9},ExpressionUUID->"b00026b7-8b66-4a11-a136-\
84d5547d472e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AssociationThread", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\"\<1\>\"", ",", "a"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\"\<2\>\"", " ", ",", "b"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7987852002436543`*^9, 3.7987852932015953`*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"6374f263-8cd5-4bf8-883d-045bcd117af2"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"1\"\>", "\[Rule]", "\<\"2\"\>"}], ",", 
   RowBox[{"a", "\[Rule]", "b"}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.798785225861718*^9, {3.798785266012734*^9, 3.798785295610816*^9}},
 CellLabel->"Out[13]=",ExpressionUUID->"24845695-be98-416a-94bb-e7bebc7b8405"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ParametricRefineOperator", "[", "variables_Association", "]"}], ":=",
    "\[IndentingNewLine]", 
   RowBox[{"Function", "[", 
    RowBox[{"xp", ",", "\[IndentingNewLine]", "    ", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "  ", 
      RowBox[{
       RowBox[{"xp", "===", "$Failed"}], ",", "\[IndentingNewLine]", 
       "$Failed", ",", "\[IndentingNewLine]", "   ", 
       RowBox[{
        RowBox[{"Head", "[", "xp", "]"}], "===", "Piecewise"}], ",", "  ", 
       "\[IndentingNewLine]", 
       RowBox[{"PiecewiseOperatorMap", "[", 
        RowBox[{"ParametricRefineOperator", ",", "variables", ",", "xp"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Head", "[", "xp", "]"}], "===", "List"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ParametricRefineOperator", "[", "variables", "]"}], "/@", 
           "xp"}], ")"}], "//", "PiecewiseExpand"}], "//", 
        "SimplifyPiecewise"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Head", "[", "xp", "]"}], "===", "Plus"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PiecewiseSimplify", "[", 
        RowBox[{"PiecewiseMap", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"xp", "/.", "#"}], "&"}], "/@", 
          RowBox[{
           RowBox[{"MonomialDependenceOperator", "[", "variables", "]"}], "[", 
           RowBox[{"List", "@@", "xp"}], "]"}]}], "]"}], "]"}], ",", " ", 
       "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", "xp"}], 
      "\[IndentingNewLine]", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.798803558681099*^9, 3.798803584929351*^9}, {
   3.798803622811304*^9, 3.79880362313973*^9}, {3.798803661744624*^9, 
   3.798803690137115*^9}, 3.79880374483296*^9, {3.7988050855274563`*^9, 
   3.7988052101798363`*^9}, {3.798805253931074*^9, 
   3.798805264398087*^9}},ExpressionUUID->"19bf051c-b6b3-4f62-84bd-\
9e8aa2339f90"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<indVars\>\"", "\[Rule]", 
       RowBox[{"{", "x", "}"}]}], ",", " ", 
      RowBox[{"\"\<depVars\>\"", "\[Rule]", 
       RowBox[{"{", "u", "}"}]}], ",", " ", 
      RowBox[{"\"\<pars\>\"", "\[Rule]", 
       RowBox[{"{", "a", "}"}]}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ParametricRefineOperator", "[", "variables", "]"}], "[", 
  RowBox[{
   RowBox[{
    RowBox[{"u", "[", "x", "]"}], "^", "a"}], "+", 
   RowBox[{
    RowBox[{"u", "[", "x", "]"}], "^", "2"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.798803780895239*^9, 3.798803790834023*^9}, 
   3.798805076499181*^9, {3.798805360197353*^9, 3.7988054605582457`*^9}, {
   3.798807572013888*^9, 3.798807576412241*^9}, {3.798807802372775*^9, 
   3.798807802616207*^9}, 3.798808612146659*^9},
 CellLabel->"In[81]:=",ExpressionUUID->"40c4aa1a-1e29-44f3-955c-43aed36f8977"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], "2"]}], 
        RowBox[{"a", "\[Equal]", "2"}]},
       {
        RowBox[{
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], "a"]}], 
        RowBox[{"a", "\[NotEqual]", "2"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{{3.798805396678507*^9, 3.7988054163674097`*^9}, 
   3.7988054611730947`*^9, 3.798807577106173*^9, 3.7988078055692043`*^9, 
   3.7988085365789022`*^9, {3.798808607841968*^9, 3.7988086127241297`*^9}},
 CellLabel->"Out[82]=",ExpressionUUID->"4de09a5c-5054-4db4-b82d-f252801461cb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"variables", "=", 
  RowBox[{"Association", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}], ",", " ", 
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", "u", "}"}]}], ",", " ", 
     RowBox[{"\"\<pars\>\"", "\[Rule]", 
      RowBox[{"{", "a", "}"}]}], ",", " ", 
     RowBox[{"\"\<domain\>\"", "\[Rule]", "Complexes"}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MonomialDependenceOperator", "[", "variables", "]"}], "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"u", "[", "x", "]"}], "^", "2"}], ",", " ", 
    RowBox[{
     RowBox[{"u", "[", "x", "]"}], "^", "a"}], ",", " ", 
    RowBox[{
     RowBox[{"u", "'"}], "[", "x", "]"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"u", "'"}], "[", "x", "]"}], "^", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "^", "3"}], "+", "2"}], ")"}]}]}], "}"}], "]"}]}], "Input",\

 CellChangeTimes->{{3.798805699412743*^9, 3.7988057061717863`*^9}, {
  3.7988060346813793`*^9, 3.798806034911083*^9}, {3.798806151881811*^9, 
  3.7988061546784687`*^9}, {3.798807602718834*^9, 3.798807618484703*^9}, {
  3.798807672104803*^9, 3.798807735628953*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"fc33d039-93a3-401f-a337-844644e44bc8"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"indVars\"\>", "\[Rule]", 
    RowBox[{"{", "x", "}"}]}], ",", 
   RowBox[{"\<\"depVars\"\>", "\[Rule]", 
    RowBox[{"{", "u", "}"}]}], ",", 
   RowBox[{"\<\"pars\"\>", "\[Rule]", 
    RowBox[{"{", "a", "}"}]}], ",", 
   RowBox[{"\<\"domain\"\>", "\[Rule]", 
    TemplateBox[{},
     "Complexes"]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.798805471761889*^9, {3.798805700154579*^9, 3.798805706907324*^9}, 
   3.798805945851965*^9, {3.798806024230068*^9, 3.798806035597386*^9}, 
   3.798806155281704*^9, 3.798806256362781*^9, {3.798806538259413*^9, 
   3.798806542672426*^9}, 3.7988066634403563`*^9, 3.798806696259972*^9, {
   3.798807325008069*^9, 3.798807329606243*^9}, 3.7988075415510483`*^9, {
   3.7988075863110733`*^9, 3.798807618895344*^9}, {3.7988076691567163`*^9, 
   3.798807697954587*^9}, 3.798807736337936*^9, 3.798808615540103*^9},
 CellLabel->"Out[83]=",ExpressionUUID->"2fe0dd14-061a-49d6-ac8c-20880dc90dc1"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"{", 
         RowBox[{"a", "\[Rule]", "2"}], "}"}], 
        RowBox[{"a", "\[Equal]", "2"}]},
       {
        RowBox[{"{", 
         RowBox[{"a", "\[Rule]", 
          RowBox[{"-", "1"}]}], "}"}], 
        RowBox[{"a", "\[Equal]", 
         RowBox[{"-", "1"}]}]},
       {
        RowBox[{"{", 
         RowBox[{"a", "\[Rule]", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"1", "/", "3"}]]}], "}"}], 
        RowBox[{"a", "\[Equal]", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], 
          RowBox[{"1", "/", "3"}]]}]},
       {
        RowBox[{"{", 
         RowBox[{"a", "\[Rule]", 
          RowBox[{"-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], 
            RowBox[{"2", "/", "3"}]]}]}], "}"}], 
        RowBox[{"a", "\[Equal]", 
         RowBox[{"-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"2", "/", "3"}]]}]}]},
       {
        RowBox[{"{", "}"}], 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{
  3.798805471761889*^9, {3.798805700154579*^9, 3.798805706907324*^9}, 
   3.798805945851965*^9, {3.798806024230068*^9, 3.798806035597386*^9}, 
   3.798806155281704*^9, 3.798806256362781*^9, {3.798806538259413*^9, 
   3.798806542672426*^9}, 3.7988066634403563`*^9, 3.798806696259972*^9, {
   3.798807325008069*^9, 3.798807329606243*^9}, 3.7988075415510483`*^9, {
   3.7988075863110733`*^9, 3.798807618895344*^9}, {3.7988076691567163`*^9, 
   3.798807697954587*^9}, 3.798807736337936*^9, 3.798808615947164*^9},
 CellLabel->"Out[84]=",ExpressionUUID->"90da747a-063d-4d13-93d8-ca556fa77b43"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"EqualToZeroOperator", "[", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\"\<pars\>\"", "\[Rule]", 
      RowBox[{"{", "a", "}"}]}], ",", 
     RowBox[{"\"\<generators\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"u", "[", "x", "]"}], "}"}]}], ",", 
     RowBox[{"\"\<facts\>\"", "\[Rule]", "True"}], ",", 
     RowBox[{"\"\<domain\>\"", "\[Rule]", 
      TemplateBox[{},
       "Reals"]}]}], "\[RightAssociation]"}], "]"}], "[", 
  SuperscriptBox[
   RowBox[{"u", "[", "x", "]"}], 
   RowBox[{"2", "-", "a"}]], "]"}]], "Input",
 CellChangeTimes->{{3.7988060751777554`*^9, 3.798806112418599*^9}, 
   3.7988086336383*^9},
 CellLabel->"In[86]:=",ExpressionUUID->"176bc7a7-1e9e-4543-8e61-b0a5d8592b68"],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{3.798808634225183*^9},
 CellLabel->"Out[86]=",ExpressionUUID->"0eb4bd9e-fc76-4cd6-a84c-9a8622b31872"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Not passing tests", "Section",
 CellChangeTimes->{{3.8134890501445503`*^9, 
  3.8134890549294786`*^9}},ExpressionUUID->"2756629a-00e7-4d59-aa42-\
f93d4db73d60"],

Cell[CellGroupData[{

Cell["Just the order", "Subsubsection",
 CellChangeTimes->{{3.813489237531793*^9, 
  3.8134892442422457`*^9}},ExpressionUUID->"bc14ef9f-3e03-492d-9068-\
34b0ae5d1caa"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Piecewise", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{
        RowBox[{"a", "\[Equal]", "0"}], "&&", 
        RowBox[{"b", "\[Equal]", "0"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "+", "b", "+", 
        RowBox[{
         RowBox[{"u", "[", "x", "]"}], "^", "b"}]}], ",", 
       RowBox[{
        RowBox[{"a", "\[Equal]", "0"}], "&&", 
        RowBox[{"b", "\[NotEqual]", "0"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "+", "a", "+", 
        RowBox[{
         RowBox[{"u", "[", "x", "]"}], "^", "a"}]}], ",", 
       RowBox[{
        RowBox[{"a", "\[NotEqual]", "0"}], "&&", 
        RowBox[{"b", "\[Equal]", "0"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", "*", 
        RowBox[{"(", 
         RowBox[{"a", "+", 
          RowBox[{
           RowBox[{"u", "[", "x", "]"}], "^", "a"}]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "-", "b"}], "\[Equal]", "0"}], "&&", 
        RowBox[{"b", "\[NotEqual]", "0"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "+", "b", "+", 
        RowBox[{
         RowBox[{"u", "[", "x", "]"}], "^", "a"}], "+", 
        RowBox[{
         RowBox[{"u", "[", "x", "]"}], "^", "b"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"a", "^", "2"}], "*", "b"}], "-", 
         RowBox[{"a", "*", 
          RowBox[{"b", "^", "2"}]}]}], "\[NotEqual]", "0"}]}], "}"}]}], "}"}],
    ",", "$Failed"}], "]"}], "\n", 
 RowBox[{"Piecewise", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{
        RowBox[{"b", "\[Equal]", "0"}], "&&", 
        RowBox[{"a", "\[Equal]", "0"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "+", "b", "+", 
        RowBox[{
         RowBox[{"u", "[", "x", "]"}], "^", "b"}]}], ",", 
       RowBox[{
        RowBox[{"a", "\[Equal]", "0"}], "&&", 
        RowBox[{"b", "\[NotEqual]", "0"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "+", "a", "+", 
        RowBox[{
         RowBox[{"u", "[", "x", "]"}], "^", "a"}]}], ",", 
       RowBox[{
        RowBox[{"b", "\[Equal]", "0"}], "&&", 
        RowBox[{"a", "\[NotEqual]", "0"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", "*", 
        RowBox[{"(", 
         RowBox[{"a", "+", 
          RowBox[{
           RowBox[{"u", "[", "x", "]"}], "^", "a"}]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "-", "b"}], "\[Equal]", "0"}], "&&", 
        RowBox[{"b", "\[NotEqual]", "0"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "+", "b", "+", 
        RowBox[{
         RowBox[{"u", "[", "x", "]"}], "^", "a"}], "+", 
        RowBox[{
         RowBox[{"u", "[", "x", "]"}], "^", "b"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"a", "^", "2"}], "*", "b"}], "-", 
         RowBox[{"a", "*", 
          RowBox[{"b", "^", "2"}]}]}], "\[NotEqual]", "0"}]}], "}"}]}], "}"}],
    ",", "$Failed"}], "]"}]}], "Input",
 CellChangeTimes->{{3.813489044481551*^9, 3.813489066911171*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"8d9d82a0-6c9b-4d54-b554-e51e9291ef90"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {"2", 
        RowBox[{
         RowBox[{"a", "\[Equal]", "0"}], "&&", 
         RowBox[{"b", "\[Equal]", "0"}]}]},
       {
        RowBox[{"1", "+", "b", "+", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], "b"]}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", "0"}], "&&", 
         RowBox[{"b", "\[NotEqual]", "0"}]}]},
       {
        RowBox[{"1", "+", "a", "+", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], "a"]}], 
        RowBox[{
         RowBox[{"a", "\[NotEqual]", "0"}], "&&", 
         RowBox[{"b", "\[Equal]", "0"}]}]},
       {
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"a", "+", 
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], "a"]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"a", "-", "b"}], "\[Equal]", "0"}], "&&", 
         RowBox[{"b", "\[NotEqual]", "0"}]}]},
       {
        RowBox[{"a", "+", "b", "+", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], "a"], "+", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], "b"]}], 
        RowBox[{
         RowBox[{
          RowBox[{
           SuperscriptBox["a", "2"], " ", "b"}], "-", 
          RowBox[{"a", " ", 
           SuperscriptBox["b", "2"]}]}], "\[NotEqual]", "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{3.813489068247542*^9},
 CellLabel->"Out[82]=",ExpressionUUID->"2daa2107-3b50-4159-81db-6c38601ebbb7"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {"2", 
        RowBox[{
         RowBox[{"b", "\[Equal]", "0"}], "&&", 
         RowBox[{"a", "\[Equal]", "0"}]}]},
       {
        RowBox[{"1", "+", "b", "+", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], "b"]}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", "0"}], "&&", 
         RowBox[{"b", "\[NotEqual]", "0"}]}]},
       {
        RowBox[{"1", "+", "a", "+", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], "a"]}], 
        RowBox[{
         RowBox[{"b", "\[Equal]", "0"}], "&&", 
         RowBox[{"a", "\[NotEqual]", "0"}]}]},
       {
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"a", "+", 
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], "a"]}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"a", "-", "b"}], "\[Equal]", "0"}], "&&", 
         RowBox[{"b", "\[NotEqual]", "0"}]}]},
       {
        RowBox[{"a", "+", "b", "+", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], "a"], "+", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], "b"]}], 
        RowBox[{
         RowBox[{
          RowBox[{
           SuperscriptBox["a", "2"], " ", "b"}], "-", 
          RowBox[{"a", " ", 
           SuperscriptBox["b", "2"]}]}], "\[NotEqual]", "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{3.8134890682502403`*^9},
 CellLabel->"Out[83]=",ExpressionUUID->"b6b74ad7-352d-4d9a-a230-8a0562abb0db"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"u", "[", 
      RowBox[{"x", ",", "y"}], "]"}], "^", "a"}], "+", 
    RowBox[{
     RowBox[{"u", "[", 
      RowBox[{"x", ",", "y"}], "]"}], "^", "b"}]}], ",", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"u", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "^", "a"}], " ", 
       RowBox[{"v", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], ",", "x"}], "]"}], "-", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"u", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "^", "2"}], " ", 
       RowBox[{
        RowBox[{"v", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "^", "b"}]}], ",", "x"}], "]"}]}]}], 
  "}"}], "\[IndentingNewLine]", 
 RowBox[{"Piecewise", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], "*", 
           RowBox[{"u", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "*", 
           RowBox[{
            RowBox[{
             RowBox[{"Derivative", "[", 
              RowBox[{"1", ",", "0"}], "]"}], "[", "u", "]"}], "[", 
            RowBox[{"x", ",", "y"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{
            RowBox[{"Derivative", "[", 
             RowBox[{"1", ",", "0"}], "]"}], "[", "v", "]"}], "[", 
           RowBox[{"x", ",", "y"}], "]"}]}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"b", "\[Equal]", "0"}], "&&", 
        RowBox[{"a", "\[Equal]", "0"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"2", "*", 
          RowBox[{
           RowBox[{"u", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "^", "a"}]}], ",", 
         RowBox[{
          RowBox[{"a", "*", 
           RowBox[{
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "a"}], ")"}]}], "*", 
           RowBox[{"v", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "*", 
           RowBox[{
            RowBox[{
             RowBox[{"Derivative", "[", 
              RowBox[{"1", ",", "0"}], "]"}], "[", "u", "]"}], "[", 
            RowBox[{"x", ",", "y"}], "]"}]}], "-", 
          RowBox[{"2", "*", 
           RowBox[{"u", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "*", 
           RowBox[{
            RowBox[{"v", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "^", "a"}], "*", 
           RowBox[{
            RowBox[{
             RowBox[{"Derivative", "[", 
              RowBox[{"1", ",", "0"}], "]"}], "[", "u", "]"}], "[", 
            RowBox[{"x", ",", "y"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "^", "a"}], "*", 
           RowBox[{
            RowBox[{
             RowBox[{"Derivative", "[", 
              RowBox[{"1", ",", "0"}], "]"}], "[", "v", "]"}], "[", 
            RowBox[{"x", ",", "y"}], "]"}]}], "-", 
          RowBox[{"a", "*", 
           RowBox[{
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "^", "2"}], "*", 
           RowBox[{
            RowBox[{"v", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "a"}], ")"}]}], "*", 
           RowBox[{
            RowBox[{
             RowBox[{"Derivative", "[", 
              RowBox[{"1", ",", "0"}], "]"}], "[", "v", "]"}], "[", 
            RowBox[{"x", ",", "y"}], "]"}]}]}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"a", "-", "b"}], "\[Equal]", "0"}], "&&", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], "*", "b"}], "+", 
            RowBox[{"b", "^", "2"}]}], "\[NotEqual]", "0"}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"a", "-", "b"}], "\[Equal]", "0"}], "&&", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "b"}], "+", 
            RowBox[{"b", "^", "2"}]}], "\[NotEqual]", "0"}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"a", "-", "b"}], "\[Equal]", "0"}], "&&", 
          RowBox[{
           RowBox[{
            RowBox[{"2", "*", "b"}], "-", 
            RowBox[{"3", "*", 
             RowBox[{"b", "^", "2"}]}], "+", 
            RowBox[{"b", "^", "3"}]}], "\[NotEqual]", "0"}]}], ")"}]}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"u", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "^", "b"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], "*", 
           RowBox[{"u", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "*", 
           RowBox[{
            RowBox[{"v", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "^", "b"}], "*", 
           RowBox[{
            RowBox[{
             RowBox[{"Derivative", "[", 
              RowBox[{"1", ",", "0"}], "]"}], "[", "u", "]"}], "[", 
            RowBox[{"x", ",", "y"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{
            RowBox[{"Derivative", "[", 
             RowBox[{"1", ",", "0"}], "]"}], "[", "v", "]"}], "[", 
           RowBox[{"x", ",", "y"}], "]"}], "-", 
          RowBox[{"b", "*", 
           RowBox[{
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "^", "2"}], "*", 
           RowBox[{
            RowBox[{"v", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "b"}], ")"}]}], "*", 
           RowBox[{
            RowBox[{
             RowBox[{"Derivative", "[", 
              RowBox[{"1", ",", "0"}], "]"}], "[", "v", "]"}], "[", 
            RowBox[{"x", ",", "y"}], "]"}]}]}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"a", "\[Equal]", "0"}], "&&", 
        RowBox[{"b", "\[NotEqual]", "0"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"u", "[", 
           RowBox[{"x", ",", "y"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], ")"}]}], ",", "0"}], "}"}], 
       ",", 
       RowBox[{
        RowBox[{"b", "\[Equal]", "1"}], "&&", 
        RowBox[{"a", "\[Equal]", "2"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"u", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "^", "a"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], "*", 
           RowBox[{"u", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "*", 
           RowBox[{
            RowBox[{
             RowBox[{"Derivative", "[", 
              RowBox[{"1", ",", "0"}], "]"}], "[", "u", "]"}], "[", 
            RowBox[{"x", ",", "y"}], "]"}]}], "+", 
          RowBox[{"a", "*", 
           RowBox[{
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "a"}], ")"}]}], "*", 
           RowBox[{"v", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "*", 
           RowBox[{
            RowBox[{
             RowBox[{"Derivative", "[", 
              RowBox[{"1", ",", "0"}], "]"}], "[", "u", "]"}], "[", 
            RowBox[{"x", ",", "y"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "^", "a"}], "*", 
           RowBox[{
            RowBox[{
             RowBox[{"Derivative", "[", 
              RowBox[{"1", ",", "0"}], "]"}], "[", "v", "]"}], "[", 
            RowBox[{"x", ",", "y"}], "]"}]}]}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"b", "\[Equal]", "0"}], "&&", 
        RowBox[{"a", "\[NotEqual]", "0"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"u", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "^", "a"}], "+", 
          RowBox[{
           RowBox[{"u", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "^", "b"}]}], ",", 
         RowBox[{
          RowBox[{"a", "*", 
           RowBox[{
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "a"}], ")"}]}], "*", 
           RowBox[{"v", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "*", 
           RowBox[{
            RowBox[{
             RowBox[{"Derivative", "[", 
              RowBox[{"1", ",", "0"}], "]"}], "[", "u", "]"}], "[", 
            RowBox[{"x", ",", "y"}], "]"}]}], "-", 
          RowBox[{"2", "*", 
           RowBox[{"u", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "*", 
           RowBox[{
            RowBox[{"v", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "^", "b"}], "*", 
           RowBox[{
            RowBox[{
             RowBox[{"Derivative", "[", 
              RowBox[{"1", ",", "0"}], "]"}], "[", "u", "]"}], "[", 
            RowBox[{"x", ",", "y"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "^", "a"}], "*", 
           RowBox[{
            RowBox[{
             RowBox[{"Derivative", "[", 
              RowBox[{"1", ",", "0"}], "]"}], "[", "v", "]"}], "[", 
            RowBox[{"x", ",", "y"}], "]"}]}], "-", 
          RowBox[{"b", "*", 
           RowBox[{
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "^", "2"}], "*", 
           RowBox[{
            RowBox[{"v", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "b"}], ")"}]}], "*", 
           RowBox[{
            RowBox[{
             RowBox[{"Derivative", "[", 
              RowBox[{"1", ",", "0"}], "]"}], "[", "v", "]"}], "[", 
            RowBox[{"x", ",", "y"}], "]"}]}]}]}], "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], "*", 
           RowBox[{"a", "^", "2"}], "*", "b"}], "+", 
          RowBox[{
           RowBox[{"a", "^", "3"}], "*", "b"}], "+", 
          RowBox[{"2", "*", "a", "*", 
           RowBox[{"b", "^", "2"}]}], "-", 
          RowBox[{
           RowBox[{"a", "^", "2"}], "*", 
           RowBox[{"b", "^", "2"}]}]}], "\[NotEqual]", "0"}], "||", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"a", "^", "2"}], "*", "b"}], ")"}]}], "+", 
          RowBox[{"a", "*", 
           RowBox[{"b", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"a", "^", "2"}], "*", 
           RowBox[{"b", "^", "2"}]}], "-", 
          RowBox[{"a", "*", 
           RowBox[{"b", "^", "3"}]}]}], "\[NotEqual]", "0"}]}]}], "}"}]}], 
    "}"}], ",", "$Failed"}], "]"}], "\n", 
 RowBox[{"Piecewise", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], "*", 
           RowBox[{"u", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "*", 
           RowBox[{
            RowBox[{
             RowBox[{"Derivative", "[", 
              RowBox[{"1", ",", "0"}], "]"}], "[", "u", "]"}], "[", 
            RowBox[{"x", ",", "y"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{
            RowBox[{"Derivative", "[", 
             RowBox[{"1", ",", "0"}], "]"}], "[", "v", "]"}], "[", 
           RowBox[{"x", ",", "y"}], "]"}]}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"b", "\[Equal]", "0"}], "&&", 
        RowBox[{"a", "\[Equal]", "0"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"2", "*", 
          RowBox[{
           RowBox[{"u", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "^", "a"}]}], ",", 
         RowBox[{
          RowBox[{"a", "*", 
           RowBox[{
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "a"}], ")"}]}], "*", 
           RowBox[{"v", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "*", 
           RowBox[{
            RowBox[{
             RowBox[{"Derivative", "[", 
              RowBox[{"1", ",", "0"}], "]"}], "[", "u", "]"}], "[", 
            RowBox[{"x", ",", "y"}], "]"}]}], "-", 
          RowBox[{"2", "*", 
           RowBox[{"u", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "*", 
           RowBox[{
            RowBox[{"v", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "^", "a"}], "*", 
           RowBox[{
            RowBox[{
             RowBox[{"Derivative", "[", 
              RowBox[{"1", ",", "0"}], "]"}], "[", "u", "]"}], "[", 
            RowBox[{"x", ",", "y"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "^", "a"}], "*", 
           RowBox[{
            RowBox[{
             RowBox[{"Derivative", "[", 
              RowBox[{"1", ",", "0"}], "]"}], "[", "v", "]"}], "[", 
            RowBox[{"x", ",", "y"}], "]"}]}], "-", 
          RowBox[{"a", "*", 
           RowBox[{
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "^", "2"}], "*", 
           RowBox[{
            RowBox[{"v", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "a"}], ")"}]}], "*", 
           RowBox[{
            RowBox[{
             RowBox[{"Derivative", "[", 
              RowBox[{"1", ",", "0"}], "]"}], "[", "v", "]"}], "[", 
            RowBox[{"x", ",", "y"}], "]"}]}]}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"a", "-", "b"}], "\[Equal]", "0"}], "&&", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], "*", "b"}], "+", 
            RowBox[{"b", "^", "2"}]}], "\[NotEqual]", "0"}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"a", "-", "b"}], "\[Equal]", "0"}], "&&", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "b"}], "+", 
            RowBox[{"b", "^", "2"}]}], "\[NotEqual]", "0"}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"a", "-", "b"}], "\[Equal]", "0"}], "&&", 
          RowBox[{
           RowBox[{
            RowBox[{"2", "*", "b"}], "-", 
            RowBox[{"3", "*", 
             RowBox[{"b", "^", "2"}]}], "+", 
            RowBox[{"b", "^", "3"}]}], "\[NotEqual]", "0"}]}], ")"}]}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"u", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "^", "b"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], "*", 
           RowBox[{"u", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "*", 
           RowBox[{
            RowBox[{"v", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "^", "b"}], "*", 
           RowBox[{
            RowBox[{
             RowBox[{"Derivative", "[", 
              RowBox[{"1", ",", "0"}], "]"}], "[", "u", "]"}], "[", 
            RowBox[{"x", ",", "y"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{
            RowBox[{"Derivative", "[", 
             RowBox[{"1", ",", "0"}], "]"}], "[", "v", "]"}], "[", 
           RowBox[{"x", ",", "y"}], "]"}], "-", 
          RowBox[{"b", "*", 
           RowBox[{
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "^", "2"}], "*", 
           RowBox[{
            RowBox[{"v", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "b"}], ")"}]}], "*", 
           RowBox[{
            RowBox[{
             RowBox[{"Derivative", "[", 
              RowBox[{"1", ",", "0"}], "]"}], "[", "v", "]"}], "[", 
            RowBox[{"x", ",", "y"}], "]"}]}]}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"a", "\[Equal]", "0"}], "&&", 
        RowBox[{"b", "\[NotEqual]", "0"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"u", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "^", "a"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], "*", 
           RowBox[{"u", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "*", 
           RowBox[{
            RowBox[{
             RowBox[{"Derivative", "[", 
              RowBox[{"1", ",", "0"}], "]"}], "[", "u", "]"}], "[", 
            RowBox[{"x", ",", "y"}], "]"}]}], "+", 
          RowBox[{"a", "*", 
           RowBox[{
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "a"}], ")"}]}], "*", 
           RowBox[{"v", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "*", 
           RowBox[{
            RowBox[{
             RowBox[{"Derivative", "[", 
              RowBox[{"1", ",", "0"}], "]"}], "[", "u", "]"}], "[", 
            RowBox[{"x", ",", "y"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "^", "a"}], "*", 
           RowBox[{
            RowBox[{
             RowBox[{"Derivative", "[", 
              RowBox[{"1", ",", "0"}], "]"}], "[", "v", "]"}], "[", 
            RowBox[{"x", ",", "y"}], "]"}]}]}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"b", "\[Equal]", "0"}], "&&", 
        RowBox[{"a", "\[NotEqual]", "0"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"u", "[", 
           RowBox[{"x", ",", "y"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], ")"}]}], ",", "0"}], "}"}], 
       ",", 
       RowBox[{
        RowBox[{"b", "\[Equal]", "1"}], "&&", 
        RowBox[{"a", "\[Equal]", "2"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"u", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "^", "a"}], "+", 
          RowBox[{
           RowBox[{"u", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "^", "b"}]}], ",", 
         RowBox[{
          RowBox[{"a", "*", 
           RowBox[{
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "a"}], ")"}]}], "*", 
           RowBox[{"v", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "*", 
           RowBox[{
            RowBox[{
             RowBox[{"Derivative", "[", 
              RowBox[{"1", ",", "0"}], "]"}], "[", "u", "]"}], "[", 
            RowBox[{"x", ",", "y"}], "]"}]}], "-", 
          RowBox[{"2", "*", 
           RowBox[{"u", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "*", 
           RowBox[{
            RowBox[{"v", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "^", "b"}], "*", 
           RowBox[{
            RowBox[{
             RowBox[{"Derivative", "[", 
              RowBox[{"1", ",", "0"}], "]"}], "[", "u", "]"}], "[", 
            RowBox[{"x", ",", "y"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "^", "a"}], "*", 
           RowBox[{
            RowBox[{
             RowBox[{"Derivative", "[", 
              RowBox[{"1", ",", "0"}], "]"}], "[", "v", "]"}], "[", 
            RowBox[{"x", ",", "y"}], "]"}]}], "-", 
          RowBox[{"b", "*", 
           RowBox[{
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "^", "2"}], "*", 
           RowBox[{
            RowBox[{"v", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "b"}], ")"}]}], "*", 
           RowBox[{
            RowBox[{
             RowBox[{"Derivative", "[", 
              RowBox[{"1", ",", "0"}], "]"}], "[", "v", "]"}], "[", 
            RowBox[{"x", ",", "y"}], "]"}]}]}]}], "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], "*", 
           RowBox[{"a", "^", "2"}], "*", "b"}], "+", 
          RowBox[{
           RowBox[{"a", "^", "3"}], "*", "b"}], "+", 
          RowBox[{"2", "*", "a", "*", 
           RowBox[{"b", "^", "2"}]}], "-", 
          RowBox[{
           RowBox[{"a", "^", "2"}], "*", 
           RowBox[{"b", "^", "2"}]}]}], "\[NotEqual]", "0"}], "||", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"a", "^", "2"}], "*", "b"}], ")"}]}], "+", 
          RowBox[{"a", "*", 
           RowBox[{"b", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"a", "^", "2"}], "*", 
           RowBox[{"b", "^", "2"}]}], "-", 
          RowBox[{"a", "*", 
           RowBox[{"b", "^", "3"}]}]}], "\[NotEqual]", "0"}]}]}], "}"}]}], 
    "}"}], ",", "$Failed"}], "]"}]}], "Input",
 CellChangeTimes->{{3.813489917291318*^9, 3.8134899388300467`*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"4d5a4588-7d5d-430c-bea9-8a7ee1f1b98a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"u", "[", 
      RowBox[{"x", ",", "y"}], "]"}], "a"], "+", 
    SuperscriptBox[
     RowBox[{"u", "[", 
      RowBox[{"x", ",", "y"}], "]"}], "b"]}], ",", 
   RowBox[{
    RowBox[{"a", " ", 
     SuperscriptBox[
      RowBox[{"u", "[", 
       RowBox[{"x", ",", "y"}], "]"}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", "a"}]], " ", 
     RowBox[{"v", "[", 
      RowBox[{"x", ",", "y"}], "]"}], " ", 
     RowBox[{
      SuperscriptBox["u", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y"}], "]"}]}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"u", "[", 
      RowBox[{"x", ",", "y"}], "]"}], " ", 
     SuperscriptBox[
      RowBox[{"v", "[", 
       RowBox[{"x", ",", "y"}], "]"}], "b"], " ", 
     RowBox[{
      SuperscriptBox["u", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"u", "[", 
       RowBox[{"x", ",", "y"}], "]"}], "a"], " ", 
     RowBox[{
      SuperscriptBox["v", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y"}], "]"}]}], "-", 
    RowBox[{"b", " ", 
     SuperscriptBox[
      RowBox[{"u", "[", 
       RowBox[{"x", ",", "y"}], "]"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"v", "[", 
       RowBox[{"x", ",", "y"}], "]"}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", "b"}]], " ", 
     RowBox[{
      SuperscriptBox["v", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y"}], "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.813490048672226*^9},
 CellLabel->"Out[99]=",ExpressionUUID->"bfff7370-1f4a-4cad-ba34-eac0cb2ae0ac"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"{", 
         RowBox[{"2", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", 
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["u", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "+", 
           RowBox[{
            SuperscriptBox["v", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x", ",", "y"}], "]"}]}]}], "}"}], 
        RowBox[{
         RowBox[{"b", "\[Equal]", "0"}], "&&", 
         RowBox[{"a", "\[Equal]", "0"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox[
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "a"]}], ",", 
          RowBox[{
           RowBox[{"a", " ", 
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], 
             RowBox[{
              RowBox[{"-", "1"}], "+", "a"}]], " ", 
            RowBox[{"v", "[", 
             RowBox[{"x", ",", "y"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["u", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], " ", 
            SuperscriptBox[
             RowBox[{"v", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "a"], " ", 
            RowBox[{
             SuperscriptBox["u", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "a"], " ", 
            RowBox[{
             SuperscriptBox["v", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "-", 
           RowBox[{"a", " ", 
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"v", "[", 
              RowBox[{"x", ",", "y"}], "]"}], 
             RowBox[{
              RowBox[{"-", "1"}], "+", "a"}]], " ", 
            RowBox[{
             SuperscriptBox["v", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}]}]}], "}"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"a", "-", "b"}], "\[Equal]", "0"}], "&&", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "b"}], "+", 
             SuperscriptBox["b", "2"]}], "\[NotEqual]", "0"}]}], ")"}], "||", 
         
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"a", "-", "b"}], "\[Equal]", "0"}], "&&", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "b"}], "+", 
             SuperscriptBox["b", "2"]}], "\[NotEqual]", "0"}]}], ")"}], "||", 
         
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"a", "-", "b"}], "\[Equal]", "0"}], "&&", 
           RowBox[{
            RowBox[{
             RowBox[{"2", " ", "b"}], "-", 
             RowBox[{"3", " ", 
              SuperscriptBox["b", "2"]}], "+", 
             SuperscriptBox["b", "3"]}], "\[NotEqual]", "0"}]}], ")"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "+", 
           SuperscriptBox[
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "b"]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", 
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], " ", 
            SuperscriptBox[
             RowBox[{"v", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "b"], " ", 
            RowBox[{
             SuperscriptBox["u", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "+", 
           RowBox[{
            SuperscriptBox["v", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x", ",", "y"}], "]"}], "-", 
           RowBox[{"b", " ", 
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"v", "[", 
              RowBox[{"x", ",", "y"}], "]"}], 
             RowBox[{
              RowBox[{"-", "1"}], "+", "b"}]], " ", 
            RowBox[{
             SuperscriptBox["v", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}]}]}], "}"}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", "0"}], "&&", 
         RowBox[{"b", "\[NotEqual]", "0"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"u", "[", 
            RowBox[{"x", ",", "y"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}]}], ")"}]}], ",", "0"}], "}"}], 
        RowBox[{
         RowBox[{"b", "\[Equal]", "1"}], "&&", 
         RowBox[{"a", "\[Equal]", "2"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "+", 
           SuperscriptBox[
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "a"]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", 
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["u", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "+", 
           RowBox[{"a", " ", 
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], 
             RowBox[{
              RowBox[{"-", "1"}], "+", "a"}]], " ", 
            RowBox[{"v", "[", 
             RowBox[{"x", ",", "y"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["u", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "a"], " ", 
            RowBox[{
             SuperscriptBox["v", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}]}]}], "}"}], 
        RowBox[{
         RowBox[{"b", "\[Equal]", "0"}], "&&", 
         RowBox[{"a", "\[NotEqual]", "0"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "a"], "+", 
           SuperscriptBox[
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "b"]}], ",", 
          RowBox[{
           RowBox[{"a", " ", 
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], 
             RowBox[{
              RowBox[{"-", "1"}], "+", "a"}]], " ", 
            RowBox[{"v", "[", 
             RowBox[{"x", ",", "y"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["u", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], " ", 
            SuperscriptBox[
             RowBox[{"v", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "b"], " ", 
            RowBox[{
             SuperscriptBox["u", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "a"], " ", 
            RowBox[{
             SuperscriptBox["v", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "-", 
           RowBox[{"b", " ", 
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"v", "[", 
              RowBox[{"x", ",", "y"}], "]"}], 
             RowBox[{
              RowBox[{"-", "1"}], "+", "b"}]], " ", 
            RowBox[{
             SuperscriptBox["v", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}]}]}], "}"}], 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", 
            SuperscriptBox["a", "2"], " ", "b"}], "+", 
           RowBox[{
            SuperscriptBox["a", "3"], " ", "b"}], "+", 
           RowBox[{"2", " ", "a", " ", 
            SuperscriptBox["b", "2"]}], "-", 
           RowBox[{
            SuperscriptBox["a", "2"], " ", 
            SuperscriptBox["b", "2"]}]}], "\[NotEqual]", "0"}], "||", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["a", "2"]}], " ", "b"}], "+", 
           RowBox[{"a", " ", 
            SuperscriptBox["b", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["a", "2"], " ", 
            SuperscriptBox["b", "2"]}], "-", 
           RowBox[{"a", " ", 
            SuperscriptBox["b", "3"]}]}], "\[NotEqual]", "0"}]}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{3.813490048679112*^9},
 CellLabel->
  "Out[100]=",ExpressionUUID->"fd56b42c-915b-4c29-adde-bda712df2211"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"{", 
         RowBox[{"2", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", 
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["u", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "+", 
           RowBox[{
            SuperscriptBox["v", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x", ",", "y"}], "]"}]}]}], "}"}], 
        RowBox[{
         RowBox[{"b", "\[Equal]", "0"}], "&&", 
         RowBox[{"a", "\[Equal]", "0"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox[
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "a"]}], ",", 
          RowBox[{
           RowBox[{"a", " ", 
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], 
             RowBox[{
              RowBox[{"-", "1"}], "+", "a"}]], " ", 
            RowBox[{"v", "[", 
             RowBox[{"x", ",", "y"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["u", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], " ", 
            SuperscriptBox[
             RowBox[{"v", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "a"], " ", 
            RowBox[{
             SuperscriptBox["u", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "a"], " ", 
            RowBox[{
             SuperscriptBox["v", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "-", 
           RowBox[{"a", " ", 
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"v", "[", 
              RowBox[{"x", ",", "y"}], "]"}], 
             RowBox[{
              RowBox[{"-", "1"}], "+", "a"}]], " ", 
            RowBox[{
             SuperscriptBox["v", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}]}]}], "}"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"a", "-", "b"}], "\[Equal]", "0"}], "&&", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "b"}], "+", 
             SuperscriptBox["b", "2"]}], "\[NotEqual]", "0"}]}], ")"}], "||", 
         
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"a", "-", "b"}], "\[Equal]", "0"}], "&&", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "b"}], "+", 
             SuperscriptBox["b", "2"]}], "\[NotEqual]", "0"}]}], ")"}], "||", 
         
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"a", "-", "b"}], "\[Equal]", "0"}], "&&", 
           RowBox[{
            RowBox[{
             RowBox[{"2", " ", "b"}], "-", 
             RowBox[{"3", " ", 
              SuperscriptBox["b", "2"]}], "+", 
             SuperscriptBox["b", "3"]}], "\[NotEqual]", "0"}]}], ")"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "+", 
           SuperscriptBox[
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "b"]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", 
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], " ", 
            SuperscriptBox[
             RowBox[{"v", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "b"], " ", 
            RowBox[{
             SuperscriptBox["u", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "+", 
           RowBox[{
            SuperscriptBox["v", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x", ",", "y"}], "]"}], "-", 
           RowBox[{"b", " ", 
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"v", "[", 
              RowBox[{"x", ",", "y"}], "]"}], 
             RowBox[{
              RowBox[{"-", "1"}], "+", "b"}]], " ", 
            RowBox[{
             SuperscriptBox["v", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}]}]}], "}"}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", "0"}], "&&", 
         RowBox[{"b", "\[NotEqual]", "0"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "+", 
           SuperscriptBox[
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "a"]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", 
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["u", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "+", 
           RowBox[{"a", " ", 
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], 
             RowBox[{
              RowBox[{"-", "1"}], "+", "a"}]], " ", 
            RowBox[{"v", "[", 
             RowBox[{"x", ",", "y"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["u", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "a"], " ", 
            RowBox[{
             SuperscriptBox["v", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}]}]}], "}"}], 
        RowBox[{
         RowBox[{"b", "\[Equal]", "0"}], "&&", 
         RowBox[{"a", "\[NotEqual]", "0"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"u", "[", 
            RowBox[{"x", ",", "y"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}]}], ")"}]}], ",", "0"}], "}"}], 
        RowBox[{
         RowBox[{"b", "\[Equal]", "1"}], "&&", 
         RowBox[{"a", "\[Equal]", "2"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "a"], "+", 
           SuperscriptBox[
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "b"]}], ",", 
          RowBox[{
           RowBox[{"a", " ", 
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], 
             RowBox[{
              RowBox[{"-", "1"}], "+", "a"}]], " ", 
            RowBox[{"v", "[", 
             RowBox[{"x", ",", "y"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["u", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y"}], "]"}], " ", 
            SuperscriptBox[
             RowBox[{"v", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "b"], " ", 
            RowBox[{
             SuperscriptBox["u", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "a"], " ", 
            RowBox[{
             SuperscriptBox["v", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "-", 
           RowBox[{"b", " ", 
            SuperscriptBox[
             RowBox[{"u", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"v", "[", 
              RowBox[{"x", ",", "y"}], "]"}], 
             RowBox[{
              RowBox[{"-", "1"}], "+", "b"}]], " ", 
            RowBox[{
             SuperscriptBox["v", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x", ",", "y"}], "]"}]}]}]}], "}"}], 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", 
            SuperscriptBox["a", "2"], " ", "b"}], "+", 
           RowBox[{
            SuperscriptBox["a", "3"], " ", "b"}], "+", 
           RowBox[{"2", " ", "a", " ", 
            SuperscriptBox["b", "2"]}], "-", 
           RowBox[{
            SuperscriptBox["a", "2"], " ", 
            SuperscriptBox["b", "2"]}]}], "\[NotEqual]", "0"}], "||", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["a", "2"]}], " ", "b"}], "+", 
           RowBox[{"a", " ", 
            SuperscriptBox["b", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["a", "2"], " ", 
            SuperscriptBox["b", "2"]}], "-", 
           RowBox[{"a", " ", 
            SuperscriptBox["b", "3"]}]}], "\[NotEqual]", "0"}]}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{3.8134900486844597`*^9},
 CellLabel->
  "Out[101]=",ExpressionUUID->"c19168f9-a71d-4256-b113-ab032c60486e"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.813490052190982*^9, 
  3.813490056337955*^9}},ExpressionUUID->"8e29f160-4d99-4b49-9c76-\
9e93d092c3d8"],

Cell[BoxData[
 RowBox[{"expression", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"u", "[", 
       RowBox[{"x", ",", "y"}], "]"}], "^", "a"}], "+", 
     RowBox[{
      RowBox[{"u", "[", 
       RowBox[{"x", ",", "y"}], "]"}], "^", "b"}]}], ",", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"u", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "^", "a"}], " ", 
        RowBox[{"v", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}], ",", "x"}], "]"}], "-", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"u", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "^", "2"}], " ", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "^", "b"}]}], ",", "x"}], "]"}]}]}],
    "}"}]}]], "Input",
 CellChangeTimes->{{3.81348997950427*^9, 3.8134900340633087`*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"f9d40e7c-5d84-4b52-98ef-7475afe14781"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"u", "[", 
      RowBox[{"x", ",", "y"}], "]"}], "a"], "+", 
    SuperscriptBox[
     RowBox[{"u", "[", 
      RowBox[{"x", ",", "y"}], "]"}], "b"]}], ",", 
   RowBox[{
    RowBox[{"a", " ", 
     SuperscriptBox[
      RowBox[{"u", "[", 
       RowBox[{"x", ",", "y"}], "]"}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", "a"}]], " ", 
     RowBox[{"v", "[", 
      RowBox[{"x", ",", "y"}], "]"}], " ", 
     RowBox[{
      SuperscriptBox["u", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y"}], "]"}]}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"u", "[", 
      RowBox[{"x", ",", "y"}], "]"}], " ", 
     SuperscriptBox[
      RowBox[{"v", "[", 
       RowBox[{"x", ",", "y"}], "]"}], "b"], " ", 
     RowBox[{
      SuperscriptBox["u", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"u", "[", 
       RowBox[{"x", ",", "y"}], "]"}], "a"], " ", 
     RowBox[{
      SuperscriptBox["v", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y"}], "]"}]}], "-", 
    RowBox[{"b", " ", 
     SuperscriptBox[
      RowBox[{"u", "[", 
       RowBox[{"x", ",", "y"}], "]"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"v", "[", 
       RowBox[{"x", ",", "y"}], "]"}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", "b"}]], " ", 
     RowBox[{
      SuperscriptBox["v", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y"}], "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.813489924103427*^9, 3.813489939438279*^9}, {
  3.813489989867948*^9, 3.81349003526723*^9}},
 CellLabel->"Out[98]=",ExpressionUUID->"16fa72ed-230a-4b0a-bb76-82917b1d490d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(", 
  RowBox[{"expression", " ", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "\[Rule]", "b"}], ",", 
     RowBox[{"b", "\[Rule]", "0"}]}], "}"}]}], ")"}]], "Input",
 CellChangeTimes->{{3.813490038486066*^9, 3.8134900605731*^9}, {
  3.813490119008466*^9, 3.813490199047275*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"5a5f666a-90b8-4912-974c-a5d74250c094"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"1", "+", 
    SuperscriptBox[
     RowBox[{"u", "[", 
      RowBox[{"x", ",", "y"}], "]"}], "b"]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", 
     RowBox[{"u", "[", 
      RowBox[{"x", ",", "y"}], "]"}], " ", 
     RowBox[{
      SuperscriptBox["u", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y"}], "]"}]}], "+", 
    RowBox[{"b", " ", 
     SuperscriptBox[
      RowBox[{"u", "[", 
       RowBox[{"x", ",", "y"}], "]"}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", "b"}]], " ", 
     RowBox[{"v", "[", 
      RowBox[{"x", ",", "y"}], "]"}], " ", 
     RowBox[{
      SuperscriptBox["u", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"u", "[", 
       RowBox[{"x", ",", "y"}], "]"}], "b"], " ", 
     RowBox[{
      SuperscriptBox["v", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y"}], "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8134900608842983`*^9, {3.813490121840287*^9, 3.8134902000222607`*^9}},
 CellLabel->
  "Out[109]=",ExpressionUUID->"adf9f299-04ce-4e67-8d1d-02d0080b9fcf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Piecewise", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"2", "*", 
          RowBox[{"u", "[", "x", "]"}]}], ",", 
         RowBox[{
          RowBox[{"u", "[", "x", "]"}], "*", 
          RowBox[{"(", 
           RowBox[{"7", "+", 
            RowBox[{"u", "[", "x", "]"}]}], ")"}]}], ",", "1"}], "}"}], ",", 
       RowBox[{"a", "\[Equal]", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "+", 
          RowBox[{"u", "[", "x", "]"}]}], ",", 
         RowBox[{"8", "*", 
          RowBox[{
           RowBox[{"u", "[", "x", "]"}], "^", "2"}]}], ",", "1"}], "}"}], ",", 
       RowBox[{"a", "\[Equal]", "0"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"u", "[", "x", "]"}], "+", 
          RowBox[{
           RowBox[{"u", "[", "x", "]"}], "^", "a"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"u", "[", "x", "]"}], "^", 
           RowBox[{"(", 
            RowBox[{"2", "-", "a"}], ")"}]}], "*", 
          RowBox[{"(", 
           RowBox[{"7", "+", 
            RowBox[{
             RowBox[{"u", "[", "x", "]"}], "^", "a"}]}], ")"}]}], ",", "1"}], 
        "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "a"}], "+", 
         RowBox[{"a", "^", "2"}]}], "\[NotEqual]", "0"}]}], "}"}]}], "}"}], 
   ",", "$Failed"}], "]"}], "\n", 
 RowBox[{"Piecewise", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"2", "*", 
          RowBox[{"u", "[", "x", "]"}]}], ",", 
         RowBox[{
          RowBox[{"u", "[", "x", "]"}], "*", 
          RowBox[{"(", 
           RowBox[{"7", "+", 
            RowBox[{"u", "[", "x", "]"}]}], ")"}]}], ",", "1"}], "}"}], ",", 
       RowBox[{"a", "\[Equal]", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"u", "[", "x", "]"}], "+", 
          RowBox[{
           RowBox[{"u", "[", "x", "]"}], "^", "a"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"u", "[", "x", "]"}], "^", 
           RowBox[{"(", 
            RowBox[{"2", "-", "a"}], ")"}]}], "*", 
          RowBox[{"(", 
           RowBox[{"7", "+", 
            RowBox[{
             RowBox[{"u", "[", "x", "]"}], "^", "a"}]}], ")"}]}], ",", "1"}], 
        "}"}], ",", 
       RowBox[{"a", "\[NotEqual]", "1"}]}], "}"}]}], "}"}], ",", "$Failed"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.813490246616103*^9, 3.813490251783613*^9}},
 CellLabel->
  "In[110]:=",ExpressionUUID->"f426037d-ffec-46a2-8922-50e17f03dd3f"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"u", "[", "x", "]"}]}], ",", 
          RowBox[{
           RowBox[{"u", "[", "x", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{"7", "+", 
             RowBox[{"u", "[", "x", "]"}]}], ")"}]}], ",", "1"}], "}"}], 
        RowBox[{"a", "\[Equal]", "1"}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "+", 
           RowBox[{"u", "[", "x", "]"}]}], ",", 
          RowBox[{"8", " ", 
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], "2"]}], ",", "1"}], "}"}], 
        RowBox[{"a", "\[Equal]", "0"}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"u", "[", "x", "]"}], "+", 
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], "a"]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], 
            RowBox[{"2", "-", "a"}]], " ", 
           RowBox[{"(", 
            RowBox[{"7", "+", 
             SuperscriptBox[
              RowBox[{"u", "[", "x", "]"}], "a"]}], ")"}]}], ",", "1"}], 
         "}"}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "a"}], "+", 
          SuperscriptBox["a", "2"]}], "\[NotEqual]", "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{3.813490252460702*^9},
 CellLabel->
  "Out[110]=",ExpressionUUID->"a241f1fc-0a72-4e61-98c2-5cbe4ca9ccbd"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"u", "[", "x", "]"}]}], ",", 
          RowBox[{
           RowBox[{"u", "[", "x", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{"7", "+", 
             RowBox[{"u", "[", "x", "]"}]}], ")"}]}], ",", "1"}], "}"}], 
        RowBox[{"a", "\[Equal]", "1"}]},
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"u", "[", "x", "]"}], "+", 
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], "a"]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"u", "[", "x", "]"}], 
            RowBox[{"2", "-", "a"}]], " ", 
           RowBox[{"(", 
            RowBox[{"7", "+", 
             SuperscriptBox[
              RowBox[{"u", "[", "x", "]"}], "a"]}], ")"}]}], ",", "1"}], 
         "}"}], 
        RowBox[{"a", "\[NotEqual]", "1"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{3.8134902524645042`*^9},
 CellLabel->
  "Out[111]=",ExpressionUUID->"0db0e268-fad6-4777-aa60-d6d907e50ce9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Piecewise", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"3", "*", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", "1", "]"}], "[", "u", "]"}], "[", "x", 
          "]"}], "^", "2"}]}], ",", 
       RowBox[{
        RowBox[{"b", "\[Equal]", "4"}], "&&", 
        RowBox[{"a", "\[Equal]", "2"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"2", "*", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Derivative", "[", "1", "]"}], "[", "u", "]"}], "[", "x", 
           "]"}], "^", "2"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", "1", "]"}], "[", "u", "]"}], "[", "x", 
          "]"}], "^", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "b"}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{"a", "\[Equal]", "2"}], "&&", 
        RowBox[{"b", "\[NotEqual]", "4"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"2", "*", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Derivative", "[", "1", "]"}], "[", "u", "]"}], "[", "x", 
           "]"}], "^", "2"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", "1", "]"}], "[", "u", "]"}], "[", "x", 
          "]"}], "^", "a"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "-", "b"}], "\[Equal]", 
         RowBox[{"-", "2"}]}], "&&", 
        RowBox[{"b", "\[NotEqual]", "4"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", "1", "]"}], "[", "u", "]"}], "[", "x", 
          "]"}], "^", "2"}], "+", 
        RowBox[{"2", "*", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Derivative", "[", "1", "]"}], "[", "u", "]"}], "[", "x", 
           "]"}], "^", "a"}]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"2", "*", "a"}], "-", "b"}], "\[Equal]", "0"}], "&&", 
        RowBox[{"b", "\[NotEqual]", "4"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", "1", "]"}], "[", "u", "]"}], "[", "x", 
          "]"}], "^", "2"}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", "1", "]"}], "[", "u", "]"}], "[", "x", 
          "]"}], "^", 
         RowBox[{"(", 
          RowBox[{"4", "-", "a"}], ")"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", "1", "]"}], "[", "u", "]"}], "[", "x", 
          "]"}], "^", "a"}]}], ",", 
       RowBox[{
        RowBox[{"a", "\[NotEqual]", "2"}], "&&", 
        RowBox[{"b", "\[Equal]", "4"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", "1", "]"}], "[", "u", "]"}], "[", "x", 
          "]"}], "^", "2"}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", "1", "]"}], "[", "u", "]"}], "[", "x", 
          "]"}], "^", "a"}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", "1", "]"}], "[", "u", "]"}], "[", "x", 
          "]"}], "^", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "a"}], "+", "b"}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", "8"}], "*", "a"}], "+", 
         RowBox[{"2", "*", 
          RowBox[{"a", "^", "3"}]}], "+", 
         RowBox[{"4", "*", "b"}], "+", 
         RowBox[{"4", "*", "a", "*", "b"}], "-", 
         RowBox[{"3", "*", 
          RowBox[{"a", "^", "2"}], "*", "b"}], "-", 
         RowBox[{"2", "*", 
          RowBox[{"b", "^", "2"}]}], "+", 
         RowBox[{"a", "*", 
          RowBox[{"b", "^", "2"}]}]}], "\[NotEqual]", "0"}]}], "}"}]}], "}"}],
    ",", "$Failed"}], "]"}], "\n", 
 RowBox[{"Piecewise", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"3", "*", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", "1", "]"}], "[", "u", "]"}], "[", "x", 
          "]"}], "^", "2"}]}], ",", 
       RowBox[{
        RowBox[{"b", "\[Equal]", "4"}], "&&", 
        RowBox[{"a", "\[Equal]", "2"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"2", "*", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Derivative", "[", "1", "]"}], "[", "u", "]"}], "[", "x", 
           "]"}], "^", "2"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", "1", "]"}], "[", "u", "]"}], "[", "x", 
          "]"}], "^", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "b"}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{"a", "\[Equal]", "2"}], "&&", 
        RowBox[{"b", "\[NotEqual]", "4"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"2", "*", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Derivative", "[", "1", "]"}], "[", "u", "]"}], "[", "x", 
           "]"}], "^", "2"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", "1", "]"}], "[", "u", "]"}], "[", "x", 
          "]"}], "^", "a"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "-", "b"}], "\[Equal]", 
         RowBox[{"-", "2"}]}], "&&", 
        RowBox[{"b", "\[NotEqual]", "4"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", "1", "]"}], "[", "u", "]"}], "[", "x", 
          "]"}], "^", "2"}], "+", 
        RowBox[{"2", "*", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Derivative", "[", "1", "]"}], "[", "u", "]"}], "[", "x", 
           "]"}], "^", "a"}]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"2", "*", "a"}], "-", "b"}], "\[Equal]", "0"}], "&&", 
        RowBox[{"b", "\[NotEqual]", "4"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", "1", "]"}], "[", "u", "]"}], "[", "x", 
          "]"}], "^", "2"}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", "1", "]"}], "[", "u", "]"}], "[", "x", 
          "]"}], "^", "a"}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", "1", "]"}], "[", "u", "]"}], "[", "x", 
          "]"}], "^", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "a"}], "+", "b"}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", "8"}], "*", "a"}], "+", 
         RowBox[{"2", "*", 
          RowBox[{"a", "^", "3"}]}], "+", 
         RowBox[{"4", "*", "b"}], "+", 
         RowBox[{"4", "*", "a", "*", "b"}], "-", 
         RowBox[{"3", "*", 
          RowBox[{"a", "^", "2"}], "*", "b"}], "-", 
         RowBox[{"2", "*", 
          RowBox[{"b", "^", "2"}]}], "+", 
         RowBox[{"a", "*", 
          RowBox[{"b", "^", "2"}]}]}], "\[NotEqual]", "0"}]}], "}"}]}], "}"}],
    ",", "$Failed"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8134903217661657`*^9, 3.813490327833967*^9}},
 CellLabel->
  "In[112]:=",ExpressionUUID->"f6ab6781-1fda-4048-8c60-6ede268b2c92"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"3", " ", 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox["u", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}], "2"]}], 
        RowBox[{
         RowBox[{"b", "\[Equal]", "4"}], "&&", 
         RowBox[{"a", "\[Equal]", "2"}]}]},
       {
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["u", "\[Prime]",
             MultilineFunction->None], "[", "x", "]"}], "2"]}], "+", 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox["u", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}], 
          RowBox[{
           RowBox[{"-", "2"}], "+", "b"}]]}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", "2"}], "&&", 
         RowBox[{"b", "\[NotEqual]", "4"}]}]},
       {
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["u", "\[Prime]",
             MultilineFunction->None], "[", "x", "]"}], "2"]}], "+", 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox["u", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}], "a"]}], 
        RowBox[{
         RowBox[{
          RowBox[{"a", "-", "b"}], "\[Equal]", 
          RowBox[{"-", "2"}]}], "&&", 
         RowBox[{"b", "\[NotEqual]", "4"}]}]},
       {
        RowBox[{
         SuperscriptBox[
          RowBox[{
           SuperscriptBox["u", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}], "2"], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["u", "\[Prime]",
             MultilineFunction->None], "[", "x", "]"}], "a"]}]}], 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"2", " ", "a"}], "-", "b"}], "\[Equal]", "0"}], "&&", 
         RowBox[{"b", "\[NotEqual]", "4"}]}]},
       {
        RowBox[{
         SuperscriptBox[
          RowBox[{
           SuperscriptBox["u", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox["u", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}], 
          RowBox[{"4", "-", "a"}]], "+", 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox["u", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}], "a"]}], 
        RowBox[{
         RowBox[{"a", "\[NotEqual]", "2"}], "&&", 
         RowBox[{"b", "\[Equal]", "4"}]}]},
       {
        RowBox[{
         SuperscriptBox[
          RowBox[{
           SuperscriptBox["u", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox["u", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}], "a"], "+", 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox["u", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}], 
          RowBox[{
           RowBox[{"-", "a"}], "+", "b"}]]}], 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "8"}], " ", "a"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["a", "3"]}], "+", 
          RowBox[{"4", " ", "b"}], "+", 
          RowBox[{"4", " ", "a", " ", "b"}], "-", 
          RowBox[{"3", " ", 
           SuperscriptBox["a", "2"], " ", "b"}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["b", "2"]}], "+", 
          RowBox[{"a", " ", 
           SuperscriptBox["b", "2"]}]}], "\[NotEqual]", "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{3.813490328529583*^9},
 CellLabel->
  "Out[112]=",ExpressionUUID->"2fe62015-da79-4aec-b690-ede2e6b9de56"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"3", " ", 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox["u", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}], "2"]}], 
        RowBox[{
         RowBox[{"b", "\[Equal]", "4"}], "&&", 
         RowBox[{"a", "\[Equal]", "2"}]}]},
       {
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["u", "\[Prime]",
             MultilineFunction->None], "[", "x", "]"}], "2"]}], "+", 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox["u", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}], 
          RowBox[{
           RowBox[{"-", "2"}], "+", "b"}]]}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", "2"}], "&&", 
         RowBox[{"b", "\[NotEqual]", "4"}]}]},
       {
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["u", "\[Prime]",
             MultilineFunction->None], "[", "x", "]"}], "2"]}], "+", 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox["u", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}], "a"]}], 
        RowBox[{
         RowBox[{
          RowBox[{"a", "-", "b"}], "\[Equal]", 
          RowBox[{"-", "2"}]}], "&&", 
         RowBox[{"b", "\[NotEqual]", "4"}]}]},
       {
        RowBox[{
         SuperscriptBox[
          RowBox[{
           SuperscriptBox["u", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}], "2"], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["u", "\[Prime]",
             MultilineFunction->None], "[", "x", "]"}], "a"]}]}], 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"2", " ", "a"}], "-", "b"}], "\[Equal]", "0"}], "&&", 
         RowBox[{"b", "\[NotEqual]", "4"}]}]},
       {
        RowBox[{
         SuperscriptBox[
          RowBox[{
           SuperscriptBox["u", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox["u", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}], "a"], "+", 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox["u", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}], 
          RowBox[{
           RowBox[{"-", "a"}], "+", "b"}]]}], 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "8"}], " ", "a"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["a", "3"]}], "+", 
          RowBox[{"4", " ", "b"}], "+", 
          RowBox[{"4", " ", "a", " ", "b"}], "-", 
          RowBox[{"3", " ", 
           SuperscriptBox["a", "2"], " ", "b"}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["b", "2"]}], "+", 
          RowBox[{"a", " ", 
           SuperscriptBox["b", "2"]}]}], "\[NotEqual]", "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{3.8134903285350246`*^9},
 CellLabel->
  "Out[113]=",ExpressionUUID->"845976fe-e6a7-4b8e-ac2a-73a6b5f05b79"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", "8"}], " ", "a"}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["a", "3"]}], "+", 
     RowBox[{"4", " ", "b"}], "+", 
     RowBox[{"4", " ", "a", " ", "b"}], "-", 
     RowBox[{"3", " ", 
      SuperscriptBox["a", "2"], " ", "b"}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["b", "2"]}], "+", 
     RowBox[{"a", " ", 
      SuperscriptBox["b", "2"]}]}], "\[Equal]", "0"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.813490404977949*^9, 3.813490413403146*^9}},
 CellLabel->
  "In[114]:=",ExpressionUUID->"f5f2adc5-b41e-47b5-9d9f-2643f2baff0e"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    114, 36, 31655327415688861920, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.813490414680538*^9},
 CellLabel->
  "During evaluation of \
In[114]:=",ExpressionUUID->"0018df51-6d5d-4b2e-a7c6-55b3580ac251"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"a", "\[Rule]", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"b", "\[Rule]", 
     RowBox[{"2", " ", "a"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"b", "\[Rule]", 
     RowBox[{"2", "+", "a"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8134904146897297`*^9},
 CellLabel->
  "Out[114]=",ExpressionUUID->"bd426505-7b80-4592-bcf8-18ebf1289ba5"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1022, 716},
WindowMargins->{{Automatic, 39}, {Automatic, 0}},
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (May 11, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"f61e8c0c-5181-4e87-91b0-f4626829ba7f"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 197, 8, 135, "Subsection",ExpressionUUID->"e82dc81f-46ad-400d-99f9-b85a658cbaf7"],
Cell[780, 32, 155, 2, 30, "Input",ExpressionUUID->"91c3c13c-23b3-4142-a13e-b0432f1d77d3"],
Cell[938, 36, 2399, 55, 325, "Input",ExpressionUUID->"e4f099fc-5e17-4b88-9e12-be73e3314dde"],
Cell[CellGroupData[{
Cell[3362, 95, 1552, 47, 73, "Input",ExpressionUUID->"6a49e88f-5abf-4329-8ef7-e8d401e8c9c6"],
Cell[4917, 144, 12443, 362, 305, "Output",ExpressionUUID->"7a296dc1-addf-4be5-9c7d-06af210fcc3f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17397, 511, 386, 7, 30, "Input",ExpressionUUID->"6dcdfd80-08cf-4390-99a9-12d53586f99b"],
Cell[17786, 520, 12369, 361, 305, "Output",ExpressionUUID->"b48b33b3-34f9-4af2-9ffd-d251c3755b3c"]
}, Open  ]],
Cell[30170, 884, 3102, 86, 136, "Input",ExpressionUUID->"e90f28da-6104-4aca-a901-2064d5e4e4d8"],
Cell[CellGroupData[{
Cell[33297, 974, 983, 29, 52, "Input",ExpressionUUID->"b9d92f7d-ba1e-4c8c-92d1-502cb44ec55c"],
Cell[34283, 1005, 2591, 77, 97, "Output",ExpressionUUID->"40709cf9-5c7c-4b7d-80e7-dca88960ae5b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36911, 1087, 2240, 66, 73, "Input",ExpressionUUID->"ccaa7cb5-6e8a-4c3a-9d48-b926388412d1"],
Cell[39154, 1155, 176, 2, 34, "Output",ExpressionUUID->"45154de3-dc02-4b5a-9367-32e6368bbea2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39367, 1162, 1895, 54, 73, "Input",ExpressionUUID->"bafcfbe5-c906-4bed-9c03-f1338950fce4"],
Cell[41265, 1218, 2569, 77, 120, "Output",ExpressionUUID->"17259b8e-35c2-4059-9692-1e7bd90c10f5"]
}, Open  ]],
Cell[43849, 1298, 233, 4, 52, "Input",ExpressionUUID->"ed23faf6-90ca-4600-a06e-23839f19e641"],
Cell[CellGroupData[{
Cell[44107, 1306, 1058, 30, 52, "Input",ExpressionUUID->"06999095-f265-44a0-ae28-b63652981734"],
Cell[45168, 1338, 2738, 81, 97, "Output",ExpressionUUID->"b3c3f6cf-7521-43de-9d87-425a523a20b7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47943, 1424, 2616, 80, 93, "Input",ExpressionUUID->"5fb4cf17-9b1d-41b4-9ecd-b2aee4811300"],
Cell[50562, 1506, 2614, 79, 97, "Output",ExpressionUUID->"31af8305-1fd1-41d4-a07e-a122470bc1b0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53213, 1590, 1761, 54, 52, "Input",ExpressionUUID->"b986e88b-dc1b-4822-99e6-3a619d32035b"],
Cell[54977, 1646, 5404, 157, 97, "Output",ExpressionUUID->"c818f966-9a14-4ab3-8c1b-e917cc8b024b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60418, 1808, 208, 3, 30, "Input",ExpressionUUID->"a09b6309-5d1c-4200-bda0-cb24c533d4a8"],
Cell[60629, 1813, 1600, 47, 53, "Output",ExpressionUUID->"ae03f6ff-f6ca-4c7a-b0ec-2ed6c04a4865"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[62278, 1866, 151, 3, 54, "Subsection",ExpressionUUID->"3fc9b2d4-6d1b-4a40-b988-bd43f1e434c7"],
Cell[62432, 1871, 178, 3, 30, "Input",ExpressionUUID->"a7d33b02-2846-4a8d-90bc-13ae2fcaac2d"],
Cell[CellGroupData[{
Cell[62635, 1878, 1525, 46, 52, "Input",ExpressionUUID->"9a5eed4a-087a-4f70-919a-ba2d1b6dd931"],
Cell[64163, 1926, 361, 9, 28, "Message",ExpressionUUID->"7633714c-32c0-4495-99b7-f7afe4786409"],
Cell[64527, 1937, 363, 9, 28, "Message",ExpressionUUID->"1d87e685-c3ae-4d8d-b2c4-ef9b3d0858e9"],
Cell[64893, 1948, 360, 9, 28, "Message",ExpressionUUID->"27a48f7d-ed7b-4c87-bf10-9314505e091f"],
Cell[65256, 1959, 450, 10, 28, "Message",ExpressionUUID->"f860003b-d3d6-4ea7-8080-b4e4f111351e"],
Cell[65709, 1971, 435, 10, 28, "Message",ExpressionUUID->"99e3854c-8761-4126-abc0-66b4ca938a4c"],
Cell[66147, 1983, 14189, 408, 331, "Output",ExpressionUUID->"dba04686-44b5-448e-81f7-bb650e578ffe"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80373, 2396, 1412, 37, 115, "Input",ExpressionUUID->"39722a73-343d-4eb2-aa78-33cd592cfe2f"],
Cell[81788, 2435, 484, 12, 34, "Output",ExpressionUUID->"bad94690-07ea-4632-b6b4-62b138f1f768"],
Cell[82275, 2449, 2202, 65, 93, "Output",ExpressionUUID->"204ceee0-4751-4995-8ff5-f49c804c16db"]
}, Open  ]],
Cell[CellGroupData[{
Cell[84514, 2519, 404, 10, 30, "Input",ExpressionUUID->"69047b14-63b4-44ac-8300-de203b72fffd"],
Cell[84921, 2531, 3916, 114, 103, "Output",ExpressionUUID->"b4c40b5d-5b32-406b-b5c1-cd38bb69875e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[88886, 2651, 154, 3, 67, "Section",ExpressionUUID->"0733dbea-8a2e-4beb-a11e-2a46df5dd366"],
Cell[89043, 2656, 19785, 416, 2572, "Input",ExpressionUUID->"0012a7e1-7443-4481-ae38-2fc67e94c83c"],
Cell[108831, 3074, 147, 3, 52, "Input",ExpressionUUID->"2f8c2415-4369-4be2-8653-936f755e64b8"],
Cell[CellGroupData[{
Cell[109003, 3081, 184, 3, 30, "Input",ExpressionUUID->"810f532f-4770-4e82-9c69-5ed5ce4d6aa5"],
Cell[109190, 3086, 564, 15, 37, "Output",ExpressionUUID->"173bada5-7c6b-412e-adb5-f3cc84b0231b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[109791, 3106, 812, 16, 52, "Input",ExpressionUUID->"c35ae6af-f85f-4942-b518-f97504ca720b"],
Cell[110606, 3124, 1783, 48, 51, "Output",ExpressionUUID->"44717960-9371-4812-8894-f5a46f43b447"],
Cell[112392, 3174, 539, 9, 34, "Output",ExpressionUUID->"0f1fc0ea-1e98-4e53-a67f-226e57d93fec"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112968, 3188, 576, 15, 52, "Input",ExpressionUUID->"6b317fdd-cc2a-4fc8-a3d2-57d51fe31ae8"],
Cell[113547, 3205, 1671, 50, 71, "Output",ExpressionUUID->"9084960a-abae-43dd-8a52-ae087f410889"],
Cell[115221, 3257, 256, 6, 34, "Output",ExpressionUUID->"f56b070a-9e42-4bd2-9370-9abd889539f3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[115514, 3268, 546, 12, 30, "Input",ExpressionUUID->"46d44c77-ca62-44e5-8872-917e526ae10d"],
Cell[116063, 3282, 2199, 56, 69, "Output",ExpressionUUID->"d8946dc1-e263-4b79-aac7-e421360f35af"]
}, Open  ]],
Cell[CellGroupData[{
Cell[118299, 3343, 484, 11, 94, "Input",ExpressionUUID->"5e2eddc9-b877-4932-a004-406748678526"],
Cell[118786, 3356, 1436, 43, 51, "Output",ExpressionUUID->"5487e5b4-dab4-45b4-8f4b-81618cfa654b"]
}, Open  ]],
Cell[120237, 3402, 903, 23, 52, "Input",ExpressionUUID->"08d58a2e-be1d-41c4-bae6-16de9ece682e"],
Cell[CellGroupData[{
Cell[121165, 3429, 846, 24, 52, "Input",ExpressionUUID->"90ac1727-f160-416c-b856-5cb764713375"],
Cell[122014, 3455, 588, 15, 35, "Output",ExpressionUUID->"1595924d-b236-45fc-bcfa-b444d2fc7598"],
Cell[122605, 3472, 4909, 142, 195, "Output",ExpressionUUID->"00e0a09d-18ca-4d05-a190-2416cfe046ce"]
}, Open  ]],
Cell[CellGroupData[{
Cell[127551, 3619, 392, 11, 30, "Input",ExpressionUUID->"38dd67e6-ef67-4fd5-b7b3-6286f5a8f17c"],
Cell[127946, 3632, 3847, 112, 103, "Output",ExpressionUUID->"130309c2-2546-40ea-b434-b6e6ee6099a5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[131830, 3749, 2385, 75, 79, "Input",ExpressionUUID->"c7f33f14-56e2-45ea-a798-653bd2a3be79"],
Cell[134218, 3826, 156, 3, 34, "Output",ExpressionUUID->"22ed291b-5261-4169-ad80-79960902bb13"]
}, Open  ]],
Cell[134389, 3832, 156, 3, 30, "Input",ExpressionUUID->"d0848d67-a1f5-411b-b951-97734142d836"],
Cell[CellGroupData[{
Cell[134570, 3839, 177, 3, 30, "Input",ExpressionUUID->"636fd70a-442a-46b2-b68f-97475ec73f7d"],
Cell[134750, 3844, 276, 6, 34, "Output",ExpressionUUID->"95e66b8f-66db-4b39-adf6-2cd4ea330129"],
Cell[135029, 3852, 1343, 23, 43, "Message",ExpressionUUID->"8208a496-54cd-4f1c-a60e-7fcde9d92696"],
Cell[136375, 3877, 1017, 26, 60, "Output",ExpressionUUID->"fb716a9e-2d1f-42d0-ace4-1611217a41f4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[137429, 3908, 668, 14, 73, "Input",ExpressionUUID->"5a1cf9dc-2fb7-487f-aa6c-2befdb66aca3"],
Cell[138100, 3924, 5246, 156, 231, "Output",ExpressionUUID->"21099edc-800e-4b5f-8604-4a8a00e1e6a4"],
Cell[143349, 4082, 4807, 142, 213, "Output",ExpressionUUID->"3a9e047b-6ae9-4bb7-bfbe-100db19b6170"]
}, Open  ]],
Cell[CellGroupData[{
Cell[148193, 4229, 456, 12, 30, "Input",ExpressionUUID->"6df87061-a787-4237-8f04-1d46dca63893"],
Cell[148652, 4243, 1753, 51, 69, "Output",ExpressionUUID->"139cfd6a-2c07-4a42-8d58-8891e8533e58"]
}, Open  ]],
Cell[CellGroupData[{
Cell[150442, 4299, 185, 3, 30, "Input",ExpressionUUID->"2e67968b-313b-41d7-b98d-b0b0b2e6b804"],
Cell[150630, 4304, 936, 25, 37, "Output",ExpressionUUID->"a047eb2c-14c3-451e-bedd-fa00aec0020c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[151603, 4334, 557, 15, 30, "Input",ExpressionUUID->"3c933dc7-793e-4119-b408-5616779acbe8"],
Cell[152163, 4351, 394, 12, 37, "Output",ExpressionUUID->"16225798-870a-490f-b609-ad9eee094664"]
}, Open  ]],
Cell[CellGroupData[{
Cell[152594, 4368, 186, 3, 30, "Input",ExpressionUUID->"2d473230-ed1a-40b1-b219-46c1f8bfa46d"],
Cell[152783, 4373, 423, 11, 37, "Output",ExpressionUUID->"e5458f28-bc44-49b6-b11a-21bb7b709e61"]
}, Open  ]],
Cell[153221, 4387, 1606, 43, 94, "Input",ExpressionUUID->"425692f7-2ad3-4559-b5a6-d3b29d06abcd"],
Cell[CellGroupData[{
Cell[154852, 4434, 763, 22, 33, "Input",ExpressionUUID->"732d2f56-af07-4c8c-ab94-10fd524d6e9c"],
Cell[155618, 4458, 1716, 51, 69, "Output",ExpressionUUID->"90eda4b3-abcd-4f1e-a792-6b119ec49a4c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[157371, 4514, 1010, 30, 33, "Input",ExpressionUUID->"a821a28e-2909-4249-a848-69f22382c631"],
Cell[158384, 4546, 545, 11, 26, "Message",ExpressionUUID->"247a07c9-3e92-41d7-a063-7e87f7ceab68"],
Cell[158932, 4559, 545, 11, 26, "Message",ExpressionUUID->"566eb007-38a3-4fef-b594-f832d57416bd"],
Cell[159480, 4572, 1082, 33, 37, "Output",ExpressionUUID->"5abc8408-89e2-48ec-b7f0-593aeb156d91"]
}, Open  ]],
Cell[CellGroupData[{
Cell[160599, 4610, 1121, 34, 33, "Input",ExpressionUUID->"0b136d81-4628-4018-b7db-2dd8f67b9e7d"],
Cell[161723, 4646, 2186, 64, 75, "Output",ExpressionUUID->"2a5bd022-f0ed-4bd7-a6af-59c3290c988c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[163946, 4715, 1223, 36, 33, "Input",ExpressionUUID->"f605c27b-ac1f-4358-b99c-7e2a772bd51f"],
Cell[165172, 4753, 2464, 71, 75, "Output",ExpressionUUID->"551dfa82-548d-4eb3-86a2-bc34691ce52b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[167673, 4829, 1391, 42, 33, "Input",ExpressionUUID->"5d4e6552-774a-4576-8205-937804902971"],
Cell[169067, 4873, 2589, 75, 93, "Output",ExpressionUUID->"969daa1d-7673-4611-bb1a-bc483cbcfda8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[171693, 4953, 266, 6, 30, "Input",ExpressionUUID->"d95c1602-c59d-48be-8687-2e5d8861e548"],
Cell[171962, 4961, 2541, 74, 93, "Output",ExpressionUUID->"f299ed1e-8e9e-44c1-8885-8ac525348d02"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[174552, 5041, 153, 3, 67, "Section",ExpressionUUID->"db199536-bf21-46a9-a54e-ed28576fc737"],
Cell[174708, 5046, 3253, 91, 388, "Input",ExpressionUUID->"682ab97a-879f-4330-8a15-37a6af2dd0f1"],
Cell[177964, 5139, 147, 3, 52, "Input",ExpressionUUID->"b00026b7-8b66-4a11-a136-84d5547d472e"],
Cell[CellGroupData[{
Cell[178136, 5146, 361, 8, 30, "Input",ExpressionUUID->"6374f263-8cd5-4bf8-883d-045bcd117af2"],
Cell[178500, 5156, 354, 7, 37, "Output",ExpressionUUID->"24845695-be98-416a-94bb-e7bebc7b8405"]
}, Open  ]],
Cell[178869, 5166, 2083, 46, 346, "Input",ExpressionUUID->"19bf051c-b6b3-4f62-84bd-9e8aa2339f90"],
Cell[CellGroupData[{
Cell[180977, 5216, 1024, 25, 73, "Input",ExpressionUUID->"40c4aa1a-1e29-44f3-955c-43aed36f8977"],
Cell[182004, 5243, 1820, 51, 73, "Output",ExpressionUUID->"4de09a5c-5054-4db4-b82d-f252801461cb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[183861, 5299, 1320, 34, 52, "Input",ExpressionUUID->"fc33d039-93a3-401f-a337-844644e44bc8"],
Cell[185184, 5335, 1018, 20, 37, "Output",ExpressionUUID->"2fe0dd14-061a-49d6-ac8c-20880dc90dc1"],
Cell[186205, 5357, 2855, 81, 115, "Output",ExpressionUUID->"90da747a-063d-4d13-93d8-ca556fa77b43"]
}, Open  ]],
Cell[CellGroupData[{
Cell[189097, 5443, 758, 19, 33, "Input",ExpressionUUID->"176bc7a7-1e9e-4543-8e61-b0a5d8592b68"],
Cell[189858, 5464, 153, 2, 34, "Output",ExpressionUUID->"0eb4bd9e-fc76-4cd6-a84c-9a8622b31872"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[190060, 5472, 166, 3, 67, "Section",ExpressionUUID->"2756629a-00e7-4d59-aa42-f93d4db73d60"],
Cell[CellGroupData[{
Cell[190251, 5479, 167, 3, 45, "Subsubsection",ExpressionUUID->"bc14ef9f-3e03-492d-9068-34b0ae5d1caa"],
Cell[CellGroupData[{
Cell[190443, 5486, 3343, 102, 94, "Input",ExpressionUUID->"8d9d82a0-6c9b-4d54-b554-e51e9291ef90"],
Cell[193789, 5590, 2576, 77, 135, "Output",ExpressionUUID->"2daa2107-3b50-4159-81db-6c38601ebbb7"],
Cell[196368, 5669, 2578, 77, 135, "Output",ExpressionUUID->"b6b74ad7-352d-4d9a-a230-8a0562abb0db"]
}, Open  ]],
Cell[CellGroupData[{
Cell[198983, 5751, 22193, 638, 598, "Input",ExpressionUUID->"4d5a4588-7d5d-430c-bea9-8a7ee1f1b98a"],
Cell[221179, 6391, 2093, 71, 62, "Output",ExpressionUUID->"bfff7370-1f4a-4cad-ba34-eac0cb2ae0ac"],
Cell[223275, 6464, 12755, 372, 305, "Output",ExpressionUUID->"fd56b42c-915b-4c29-adde-bda712df2211"],
Cell[236033, 6838, 12757, 372, 305, "Output",ExpressionUUID->"c19168f9-a71d-4256-b113-ab032c60486e"]
}, Open  ]],
Cell[248805, 7213, 152, 3, 30, "Input",ExpressionUUID->"8e29f160-4d99-4b49-9c76-9e93d092c3d8"],
Cell[248960, 7218, 1008, 31, 30, InheritFromParent,ExpressionUUID->"f9d40e7c-5d84-4b52-98ef-7475afe14781"],
Cell[249971, 7251, 2165, 72, 62, "Output",ExpressionUUID->"16fa72ed-230a-4b0a-bb76-82917b1d490d"],
Cell[CellGroupData[{
Cell[252161, 7327, 396, 10, 30, "Input",ExpressionUUID->"5a5f666a-90b8-4912-974c-a5d74250c094"],
Cell[252560, 7339, 1498, 51, 38, "Output",ExpressionUUID->"adf9f299-04ce-4e67-8d1d-02d0080b9fcf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[254095, 7395, 2809, 88, 94, "Input",ExpressionUUID->"f426037d-ffec-46a2-8922-50e17f03dd3f"],
Cell[256907, 7485, 2573, 78, 97, "Output",ExpressionUUID->"a241f1fc-0a72-4e61-98c2-5cbe4ca9ccbd"],
Cell[259483, 7565, 2193, 66, 75, "Output",ExpressionUUID->"0db0e268-fad6-4777-aa60-d6d907e50ce9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[261713, 7636, 7800, 244, 283, "Input",ExpressionUUID->"f6ab6781-1fda-4048-8c60-6ede268b2c92"],
Cell[269516, 7882, 4872, 143, 155, "Output",ExpressionUUID->"2fe62015-da79-4aec-b690-ede2e6b9de56"],
Cell[274391, 8027, 4246, 125, 135, "Output",ExpressionUUID->"845976fe-e6a7-4b8e-ac2a-73a6b5f05b79"]
}, Open  ]],
Cell[CellGroupData[{
Cell[278674, 8157, 721, 21, 33, "Input",ExpressionUUID->"f5f2adc5-b41e-47b5-9d9f-2643f2baff0e"],
Cell[279398, 8180, 362, 9, 24, "Message",ExpressionUUID->"0018df51-6d5d-4b2e-a7c6-55b3580ac251"],
Cell[279763, 8191, 427, 13, 34, "Output",ExpressionUUID->"bd426505-7b80-4592-bcf8-18ebf1289ba5"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)


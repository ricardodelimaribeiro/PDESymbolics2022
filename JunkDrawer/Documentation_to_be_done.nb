(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    205285,       5576]
NotebookOptionsPosition[    188908,       5295]
NotebookOutlinePosition[    189333,       5312]
CellTagsIndexPosition[    189290,       5309]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Documentation do be done ", "Title",
 CellChangeTimes->{{3.813549107777713*^9, 3.813549115219427*^9}, {
  3.84268254604047*^9, 
  3.84268255199832*^9}},ExpressionUUID->"660c5f89-d5c5-46f0-a9b7-\
acfdb00ac19e"],

Cell[CellGroupData[{

Cell["Errors detected", "Section",
 CellChangeTimes->{{3.873699365184341*^9, 
  3.873699369751521*^9}},ExpressionUUID->"8c364c31-4701-42d2-a687-\
90db0913d535"],

Cell[CellGroupData[{

Cell["TestOperator is whining ", "Subsubsection",
 CellChangeTimes->{{3.873702013261715*^9, 
  3.8737020268405037`*^9}},ExpressionUUID->"c91640c0-c34b-4242-bfeb-\
350001a31e0e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", "u", "}"}]}], ",", " ", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}], ",", 
     RowBox[{"\"\<pars\>\"", "\[Rule]", 
      RowBox[{"{", "a", "}"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{"expression", " ", "=", " ", 
  RowBox[{"Piecewise", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "+", 
        SuperscriptBox[
         RowBox[{"u", "[", "x", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"u", "[", "x", "]"}], "a"]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "a"}], "+", 
         SuperscriptBox["a", "2"]}], "\[NotEqual]", "0"}]}], "}"}], "}"}], 
    ",", "$Failed"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PiecewiseSimplifyOperator", "[", "variables", "]"}], "[", 
   "expression", "]"}], "//", "TestOperator"}]}], "Input",
 CellChangeTimes->{
  3.841737793660541*^9, 3.84173792354079*^9, {3.8417379948850117`*^9, 
   3.8417380415155277`*^9}, {3.873699008123373*^9, 3.873699012239036*^9}, {
   3.873699251231166*^9, 
   3.873699253738879*^9}},ExpressionUUID->"6b6da443-fd80-48d5-9051-\
8697ae02c55b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Piecewise beautify has an issue that maybe needs to be documented\
\>", "Subsubsection",
 CellChangeTimes->{{3.87370199945851*^9, 3.873702041776043*^9}, {
  3.873702534049438*^9, 
  3.873702539932523*^9}},ExpressionUUID->"49e7efb4-d945-4cc4-a1bb-\
7510f77327e5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"xp", "=", 
  RowBox[{"Piecewise", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", " ", 
        RowBox[{"x", ">", "0"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"2", ",", " ", 
        RowBox[{"x", "<", "1"}]}], "}"}]}], "}"}], ",", " ", "$Failed"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8737019269017267`*^9, 3.8737019503433657`*^9}, {
  3.873702313781898*^9, 3.873702332218561*^9}},
 CellLabel->"In[844]:=",
 CellID->2092730607,ExpressionUUID->"d651cbc8-57ac-4eb3-95fb-46709b740fa4"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {"1", 
        RowBox[{"x", ">", "0"}]},
       {"2", 
        RowBox[{"x", "<", "1"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{
  3.873701951240117*^9, {3.873702314942945*^9, 3.8737023328304787`*^9}},
 CellLabel->
  "Out[844]=",ExpressionUUID->"4be4dd98-edcb-46da-9339-5e8fc1f46bc9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PiecewiseBeautify", "[", "xp", "]"}]], "Input",
 CellChangeTimes->{{3.873701920130919*^9, 3.873701924336985*^9}, {
  3.8737019545393476`*^9, 3.873701955349922*^9}},
 CellLabel->"In[845]:=",
 CellID->630831398,ExpressionUUID->"ece3608f-3a02-4d03-ab30-21b08493e98b"],

Cell[BoxData[
 RowBox[{"PiecewiseBeautify", "[", 
  TagBox[GridBox[{
     {"\[Piecewise]", GridBox[{
        {"1", 
         RowBox[{"x", ">", "0"}]},
        {"2", 
         RowBox[{"x", "<", "1"}]},
        {"$Failed", 
         TagBox["True",
          "PiecewiseDefault",
          AutoDelete->True]}
       },
       AllowedDimensions->{2, Automatic},
       Editable->True,
       GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.84]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}},
       Selectable->True]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.35]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   "Piecewise",
   DeleteWithContents->True,
   Editable->False,
   SelectWithContents->True,
   Selectable->False,
   StripWrapperBoxes->True], "]"}]], "Output",
 CellChangeTimes->{{3.8737019559600697`*^9, 3.873701971331764*^9}, {
  3.8737023229682693`*^9, 3.87370233676026*^9}},
 CellLabel->
  "Out[845]=",ExpressionUUID->"5c300576-cf48-4eea-bc44-13fd67164e37"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["To Test", "Section",
 CellChangeTimes->{{3.873699487101947*^9, 3.873699493444639*^9}, {
  3.873700147844071*^9, 
  3.873700154146985*^9}},ExpressionUUID->"cc7bf2ea-1042-4f53-8424-\
4d51d116bb60"],

Cell[BoxData[{
 RowBox[{"TestEqualToZeroOperator", " ", "-", " ", 
  RowBox[{
  "see", " ", "if", " ", "it", " ", "works", " ", "since", " ", "now", " ", 
   "it", " ", "is", " ", "done", " ", "with", " ", 
   "KleisliTest"}]}], "\[IndentingNewLine]", 
 RowBox[{"TestPiecewiseBeautify", " ", "-", " ", 
  RowBox[{
  "likely", " ", "not", " ", "going", " ", "to", " ", "work", " ", "because", 
   " ", "PiecewiseBeautify", " ", "is", " ", "not", " ", "an", " ", 
   "operator", " ", "and", " ", "we", " ", "need", " ", "to", " ", "fix", " ",
    "it"}]}]}], "Input",
 CellChangeTimes->{{3.8737001656223373`*^9, 3.8737001881832542`*^9}, {
  3.873700713977645*^9, 
  3.873700739603252*^9}},ExpressionUUID->"1dd2c54f-45e6-4a76-a6e3-\
2f5ffd33a964"]
}, Open  ]],

Cell[CellGroupData[{

Cell["To add ", "Section",
 CellChangeTimes->{{3.873700245926433*^9, 
  3.873700251871962*^9}},ExpressionUUID->"45cc56ef-041b-4da7-8764-\
6b41d29558e8"],

Cell["Add help to piecewiseoperatormap", "Text",
 CellChangeTimes->{{3.8737002558587646`*^9, 
  3.873700268014914*^9}},ExpressionUUID->"e92a43af-5db4-4209-acff-\
7226d65c19c1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Work by package", "Section",
 CellChangeTimes->{{3.8651374706702013`*^9, 
  3.865137475466464*^9}},ExpressionUUID->"de998a16-8ce0-4e34-9ae8-\
a5e52e35a040"],

Cell["\<\




3)  Get[\[OpenCurlyDoubleQuote]PDESymbolics2020`PiecewiseTools`\
\[CloseCurlyDoubleQuote]];

- here we should change a bit the code for piecewisemap so that we use the \
\[OpenCurlyDoubleQuote]Assuming[\[OpenCurlyDoubleQuote]facts\
\[CloseCurlyDoubleQuote] & condition]\[CloseCurlyDoubleQuote] - this may make \
the code a bit more robust
- also code piecewisemapthread


2) Get[\[OpenCurlyDoubleQuote]PDESymbolics2020`Utilities`\
\[CloseCurlyDoubleQuote]];

- utilities should be after piecewise and kleisli - DONE
- getvars has an OPERATOR VERISION (WITH KLEISLI)
and \[OpenCurlyDoubleQuote]getallvars\[CloseCurlyDoubleQuote] (WHERE IS THIS \
FUNCTION? What getVars, with opt=Full, does is not clear.)
 should be made into operators - the reason is that they \
don\[CloseCurlyQuote]t seem to behave very well with piecewise expressions \
for example.... (IT SEEMS TO BE WORKING NOW. CHECK GETVARS.NB)
 
- move zeroq from test to utilities (Done) ,
 use ZEROQ in the code whenever possible (TBD)

4) Get[\[OpenCurlyDoubleQuote]PDESymbolics2020`Kleisli`\
\[CloseCurlyDoubleQuote]];

all seems to be working - maybe some tests? (I don\[CloseCurlyQuote]t see \
why... (Ricardo))
(I merged the two versions of Kleisli in Kleisli2, is there a situation in \
which this could fail?)

5) Get[\[OpenCurlyDoubleQuote]PDESymbolics2020`LinearAlgebra`\
\[CloseCurlyDoubleQuote]];

- all seems to be working - we could refactor some code using Kleisli - \
RegroupParametersOperator is a starting candidate (Done in Kleisli.nb)
- also we could get a better organization of the code by moving things like 
Numerizer, 
RegroupParametersOperator, 
ParametricRefineOperator, 
to a independent package - polynomials? (CREATED and MOVED ALL 3)
(ALSO MOVED removemultiples, RegroupParametersOperator depends on it)
((I moved things back to LinearAlgebra, there was some issue that I could not \
resolve.))


- Gaussian elimination should be completely recoded using new concepts such \
as Kleisli, piecewisemaps, etc - but this is really low priority...

6) Get[\[OpenCurlyDoubleQuote]PDESymbolics2020`Monomials`\
\[CloseCurlyDoubleQuote]];

- all good

7) To be created (Done) - polynomial algebra package - this is where groebner \
stuff will go

- piecewise Groebner basis

8) To be created - differential reduction package (DONE)

- at the simplest level, we need: prolongation and reduction of polynomials \
mod constraints - if the constraints are linear, we can just solve, if not we \
use poly division and groebner stuff
- there are a few \[OpenCurlyDoubleQuote]standard algorithms\
\[CloseCurlyDoubleQuote] that we perhaps can add

9) To be created - difference reduction package (DONE)

- there is already some stuff created by friedemann, so we need to decide \
what to do. 

10) Get[\[OpenCurlyDoubleQuote]PDESymbolics2020`VariationalCalculus`\
\[CloseCurlyDoubleQuote]];

solve variational problem 

11) Get[\[OpenCurlyDoubleQuote]PDESymbolics2020`Beautify`\
\[CloseCurlyDoubleQuote]];

-> this package is mostly ready, however, there are a few things that we \
could implement further, such as computing adjoints

12) Get[\[OpenCurlyDoubleQuote]PDESymbolics2020`Discrete`\
\[CloseCurlyDoubleQuote]];

13) Get[\[OpenCurlyDoubleQuote]PDESymbolics2020`TimeDependentPDEs`\
\[CloseCurlyDoubleQuote]];

(*Get[\[OpenCurlyDoubleQuote]PDESymbolics2020`TimeDependentPDEsDiscrete`\
\[CloseCurlyDoubleQuote]]*) - what is this is it the same as Discrete? \
(Ricardo was having some issues with the loading of Discrete and was trying \
to work around this issue)(DELETED)

14)  Get[\[OpenCurlyDoubleQuote]PDESymbolics2020`Positivity`\
\[CloseCurlyDoubleQuote]];

-> there is a lot to be done here wrt general algorithms

15) To be created - PDEs 

this should be a general purpose package for PDEs - for example things like \
conservation laws, ...

16) OverDeterminedSystems of PDEs 

this is partially done in the files but we can try to push it further. 

17) Get[\[OpenCurlyDoubleQuote]PDESymbolics2020`Test`\[CloseCurlyDoubleQuote]];

add more tests
\
\>", "Text",
 CellChangeTimes->{{3.865137476739335*^9, 3.8651374854827623`*^9}, {
   3.8651375191531153`*^9, 3.8651376205637407`*^9}, {3.865137674076248*^9, 
   3.865137719686969*^9}, {3.8651377512367363`*^9, 3.865137763180458*^9}, {
   3.865137911705062*^9, 3.865137954323894*^9}, {3.865138155271106*^9, 
   3.865138173618619*^9}, {3.8651382410171843`*^9, 3.865138284329651*^9}, {
   3.865138403779056*^9, 3.86513843360747*^9}, {3.865138487051976*^9, 
   3.8651385137134523`*^9}, {3.865138547201434*^9, 3.865138549340259*^9}, {
   3.86513859236915*^9, 3.8651385938220367`*^9}, {3.865138684507407*^9, 
   3.865138825368561*^9}, {3.8651389297551003`*^9, 3.8651389383453217`*^9}, {
   3.865138974130238*^9, 3.8651390089954453`*^9}, {3.865139058474969*^9, 
   3.865139121089739*^9}, {3.865139239877183*^9, 3.865139294983008*^9}, {
   3.86517506351581*^9, 3.865175130490415*^9}, {3.8651751672187147`*^9, 
   3.865175325435224*^9}, {3.8652129357503433`*^9, 3.865212948216989*^9}, {
   3.865604859174193*^9, 3.8656048803171053`*^9}, {3.865836918656974*^9, 
   3.86583701765697*^9}, {3.865837181376652*^9, 3.8658372209289713`*^9}, {
   3.867500585449644*^9, 3.867500602848754*^9}, {3.870228201788851*^9, 
   3.870228204246582*^9}, {3.870228612404852*^9, 3.8702286274144573`*^9}, {
   3.8702287356580153`*^9, 3.870228740651683*^9}, {3.870835967552945*^9, 
   3.870836081660376*^9}, {3.870836167174923*^9, 3.870836167607128*^9}, {
   3.8708364372021914`*^9, 3.870836437384099*^9}, {3.870836506985512*^9, 
   3.870836509699395*^9}, {3.870836550218914*^9, 3.870836551693993*^9}, {
   3.8708365824878807`*^9, 3.8708366894000463`*^9}, {3.870836720432377*^9, 
   3.870836726174244*^9}, {3.87083754045467*^9, 3.870837562258905*^9}, {
   3.8708508101911716`*^9, 3.870850849292851*^9}, {3.870919558790267*^9, 
   3.870919602374242*^9}, {3.870920041704232*^9, 3.870920076204426*^9}, {
   3.8709363126883583`*^9, 3.870936316277597*^9}, 3.8712686408383627`*^9, 
   3.871270854264304*^9, {3.8712709071755238`*^9, 3.871270909639904*^9}, {
   3.8712713503327637`*^9, 3.8712713686016283`*^9}, {3.871271702389373*^9, 
   3.871271704838477*^9}, {3.871272016662848*^9, 3.871272057472082*^9}, {
   3.871356311930211*^9, 3.871356359659376*^9}, 3.873694921869809*^9, 
   3.873697426772935*^9, {3.873697622869464*^9, 3.873697630069099*^9}, {
   3.873697701717854*^9, 
   3.8736977051806517`*^9}},ExpressionUUID->"fa6ee681-9051-42ab-998a-\
3a17525bca9e"],

Cell[BoxData["Assuming"], "Input",
 CellChangeTimes->{{3.870936323959394*^9, 
  3.8709363297715797`*^9}},ExpressionUUID->"4d050471-87e2-4d27-90c1-\
bad0c7a9cf28"]
}, Open  ]],

Cell["Last update to this document: Jun. 2022", "Section",
 CellChangeTimes->{{3.842682553830533*^9, 3.8426825704612303`*^9}, {
  3.845959668745592*^9, 3.8459596704654493`*^9}, {3.865137466573432*^9, 
  3.865137468700735*^9}},ExpressionUUID->"559cd727-0d0e-4244-9f3a-\
b9baa66b95b0"],

Cell[CellGroupData[{

Cell["PAGES TO BE DELETED", "Section",
 CellChangeTimes->{{3.8591032474851303`*^9, 
  3.8591032539192467`*^9}},ExpressionUUID->"6bd3e7fd-72cf-4212-bfe8-\
3d05e4514dcb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EquivalentsByIBPOperator", " ", "-", " ", 
   RowBox[{"i", " ", 
    RowBox[{"don", "'"}], "t", " ", "think", " ", "this", " ", "is", " ", 
    "used", " ", "anymore"}]}], "..."}]], "Input",
 CellChangeTimes->{{3.8591032580640078`*^9, 
  3.859103269138597*^9}},ExpressionUUID->"faa19278-7293-4329-b962-\
433f359b407f"],

Cell["\<\
UndeterminedCoefficientsEquationOperator[variables][{a X + b Y , X - Y}] 

vs 

UndeterminedCoefficientsOperator[variables][{a X + b Y , X - Y}] 

is there a difference? if not we should just have one function (the shorter \
name). This should be updated throughout the code...
\
\>", "Text",
 CellChangeTimes->{{3.859258923546783*^9, 
  3.859258965076254*^9}},ExpressionUUID->"c0f63a61-1f79-40f1-a012-\
70d75abb4d6c"],

Cell["\<\
PositivityQEOperator[variables][xp] does not seem to be working ? was it \
deleted?\
\>", "Text",
 CellChangeTimes->{{3.8592948669602823`*^9, 3.85929490980262*^9}, {
  3.859295223377281*^9, 
  3.859295243706832*^9}},ExpressionUUID->"289b0013-e232-493f-b8c5-\
e101244d2b59"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Pages to be created:", "Chapter",
 CellChangeTimes->{{3.813549063540679*^9, 
  3.813549091560173*^9}},ExpressionUUID->"f3588e6c-dc58-4a91-829f-\
958ad5a5f003"],

Cell["\<\
KroneckerDeltaOperator - Done
FindDiscreteConservedQuantityOperator - Done
FindDiscreteConservedQuantityBasisOperator - Done

HeaderOperator -> see if it works with TestOperator, otherwise change it \
accordingly . Also Header operator should be available to other parts of the \
code, so moved to a different package

PiecewiseAssociationOperator, PiecewiseAssociationFunction -> what do they \
do. Perhaps they need to be documented and moved to piecewise


\
\>", "Text",
 CellChangeTimes->{{3.859508896613659*^9, 3.8595089073906727`*^9}, {
   3.8595090736632147`*^9, 3.859509093281056*^9}, {3.8595091820273457`*^9, 
   3.85950921648874*^9}, {3.8595092675165586`*^9, 3.8595092944451857`*^9}, {
   3.859509409472316*^9, 3.8595094223065357`*^9}, {3.8702290994606047`*^9, 
   3.870229104501417*^9}, {3.8702291550567904`*^9, 3.870229169785447*^9}, 
   3.870229247898512*^9},ExpressionUUID->"cf6a1b95-c3a2-4bec-818c-\
46a8cdc07c5f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Pages created:", "Chapter",
 CellChangeTimes->{{3.8135490513790207`*^9, 
  3.813549058897029*^9}},ExpressionUUID->"1dfc02ec-141c-4c78-bb1a-\
810232d25d33"],

Cell[BoxData[{"RangeSchemeTranslationsOperator", "\[IndentingNewLine]", \
"PiecewiseAssociationClean", "\[IndentingNewLine]", \
"SignedFactorsOperator"}], "Input",
 CellChangeTimes->{{3.822383126749834*^9, 3.822383139275124*^9}, 
   3.822973115179236*^9, 3.829551510663495*^9, {3.854002802903121*^9, 
   3.854002803210907*^9}, {3.854002850584189*^9, 
   3.854002850894973*^9}},ExpressionUUID->"0fd15392-9e76-46dd-a74f-\
2e691e78208f"],

Cell[BoxData[{
 RowBox[{"PiecewiseFullSimplifyOperator", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "replaces", " ", "PiecewiseFullSimplify", " ", "which", "  ", "needs", " ",
     "to", " ", "be", " ", 
    RowBox[{"removed", " ", "[", "REMOVED", "]"}], " ", "from", " ", "the", 
    " ", "code", " ", "and", " ", "documentation"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"PiecewiseSimplifyOperator", 
  RowBox[{"(*", " ", 
   RowBox[{
   "replaces", " ", "PiecewiseSimplify", " ", "which", "  ", "needs", " ", 
    "to", " ", "be", " ", 
    RowBox[{"removed", " ", "[", "REMOVED", "]"}], " ", "from", " ", "the", 
    " ", "code", " ", "and", " ", "documentation"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"PiecewiseEliminateEqualitiesOperator", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "replaces", " ", "variables", " ", "given", " ", "by", " ", 
    "equalities", " ", "in", " ", "Piecewise"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"PiecewiseEqualOperator", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "this", " ", "needs", " ", "to", " ", "be", " ", "used", " ", "in", " ", 
     "the", " ", "unit", " ", "test", " ", "to", " ", "avoid", " ", "them", 
     " ", "failing", " ", "every", " ", "time", " ", "there", " ", "is", " ", 
     "a", " ", "change", " ", "in", " ", "algorithms"}], ",", " ", 
    RowBox[{"I", " ", 
     RowBox[{"(", "DG", ")"}], " ", "already", " ", "did", " ", "this", " ", 
     "in", " ", "the", " ", "disintegrate", " ", "and", " ", "in", " ", "the",
      " ", "representmodnulllagrangians", " ", "functions"}]}], "*)"}], " ", 
  RowBox[{"(*", 
   RowBox[{"however", ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "there", " ", "seems", " ", "to", " ", "be", " ", "a", " ", "problem", 
       " ", "in", " ", "disintegrateoperator"}], "..."}], " ", "["}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Diogo", ",", " ", 
    RowBox[{"I", " ", 
     RowBox[{"(", "RR", ")"}], " ", "think", " ", "this", " ", "may", " ", 
     "be", " ", "a", " ", "problem", " ", "that", " ", "comes", " ", "from", 
     " ", "the", " ", "different", " ", "coefficients"}], ",", " ", 
    RowBox[{
    "but", " ", "I", " ", "may", " ", "need", " ", "to", " ", "see", " ", 
     "the", " ", "code", " ", 
     RowBox[{"(", "PiecewiseEqualOperator", ")"}], " ", 
     RowBox[{"again", "."}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", "PiecewiseListClean"}], "Input",
 CellChangeTimes->{{3.817369662172151*^9, 3.8173697852209263`*^9}, {
   3.817457174550124*^9, 3.817457253102457*^9}, {3.817467968057043*^9, 
   3.8174680602257*^9}, 3.8174681174348583`*^9, {3.817525781825346*^9, 
   3.817525807954419*^9}, {3.817600390946694*^9, 3.817600400758354*^9}, {
   3.817627460823238*^9, 3.817627464726858*^9}, {3.81996529473999*^9, 
   3.819965321176309*^9}, {3.8199653719792233`*^9, 3.8199653724024677`*^9}, {
   3.8199656338408327`*^9, 3.81996569861329*^9}, {3.820566408396433*^9, 
   3.820566408806778*^9}, {3.8207378078834887`*^9, 3.820737809563633*^9}, {
   3.820738205695839*^9, 3.820738207754125*^9}, {3.8207382824503317`*^9, 
   3.820738285037985*^9}, {3.820741423916563*^9, 
   3.8207415096688557`*^9}},ExpressionUUID->"339b03c6-8f45-4f22-ad48-\
3dda91fee247"],

Cell[BoxData[{"SimplifyPositivityQEOperator", "\[IndentingNewLine]", \
"SimplifyPositivityOperator", "\[IndentingNewLine]", \
"PositivityConditionQEOperator", "\[IndentingNewLine]", \
"FastEquivalentsByIntegrationByPartsOperator"}], "Input",
 CellChangeTimes->{{3.81589397875708*^9, 3.8158939905335903`*^9}, {
   3.816154631158145*^9, 3.816154677144306*^9}, {3.816416288919263*^9, 
   3.816416297035182*^9}, {3.8164211130547132`*^9, 3.816421121501758*^9}, {
   3.816501490331456*^9, 3.816501500108431*^9}, {3.816510285814268*^9, 
   3.8165102908719273`*^9}, {3.816934223574485*^9, 3.816934239022222*^9}, {
   3.816935506920755*^9, 3.816935509717155*^9}, {3.816936027692321*^9, 
   3.816936034804782*^9}, {3.8170169546578083`*^9, 3.817016963406137*^9}, {
   3.817022698686523*^9, 3.8170227094632883`*^9}, {3.817022772306734*^9, 
   3.817022776804202*^9}, {3.8172152068442802`*^9, 3.8172152390472183`*^9}, {
   3.817468067915814*^9, 3.8174680682580976`*^9}, 3.8207375957725077`*^9, {
   3.820738213174654*^9, 
   3.820738214702664*^9}},ExpressionUUID->"372b511f-bbfa-47c1-93d4-\
20cd4550c854"],

Cell[BoxData["StencilOperator"], "Input",
 CellChangeTimes->{{3.816510292771062*^9, 3.816510293951582*^9}, 
   3.8165109840508957`*^9, {3.816933343875824*^9, 3.8169333537729473`*^9}, {
   3.8172019029395247`*^9, 
   3.817201919256321*^9}},ExpressionUUID->"1f361008-c2c3-4635-a392-\
5888c5aba180"],

Cell[BoxData[
 RowBox[{"DiscreteEquivalentsOperator", " "}]], "Input",
 CellChangeTimes->{{3.816510292771062*^9, 3.816510293951582*^9}, 
   3.8165109840508957`*^9, {3.816933343875824*^9, 3.8169333537729473`*^9}, {
   3.8172019029395247`*^9, 
   3.817201919256321*^9}},ExpressionUUID->"597d05e8-779a-4137-958e-\
83d1e6ef9dd6"],

Cell[BoxData[
 RowBox[{"PiecewiseReplace", " "}]], "Input",
 CellChangeTimes->{{3.81450307153318*^9, 3.814503082443478*^9}, {
   3.814538382189604*^9, 3.814538386897221*^9}, 3.814612353994542*^9, 
   3.815724699216416*^9},ExpressionUUID->"29181715-fa26-4cbc-8bdc-\
be7eb53ef8b3"],

Cell[BoxData["RegroupParametersOperator"], "Input",
 CellChangeTimes->{3.8134826936330633`*^9, 
  3.813482756981686*^9},ExpressionUUID->"d97029a8-d08e-4040-be1e-\
9114bc153b5c"],

Cell[BoxData["SolveAlwaysOperator"], "Input",
 CellChangeTimes->{{3.813482707482979*^9, 
  3.8134827123357973`*^9}},ExpressionUUID->"b3609549-17e5-4436-82e3-\
90a8d6c5b538"],

Cell["\<\
Document \"refineconstantmonomials\"  in MonomialDependence and \
ParametricRefine (this should be addressed by new data structure. \
\>", "Text",
 CellChangeTimes->{{3.813489496266982*^9, 3.813489515806665*^9}, {
  3.814770443526154*^9, 
  3.81477047371*^9}},ExpressionUUID->"828c4924-d275-47ad-b89d-1a5c4e98ff1d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Documentation to be written:", "Chapter",
 CellChangeTimes->{{3.8135491391707497`*^9, 3.81354914835424*^9}, 
   3.814162668124867*^9, {3.814596753203039*^9, 
   3.8145967540670033`*^9}},ExpressionUUID->"23e99a9e-fcbc-41d0-9349-\
779ee389921a"],

Cell[BoxData[
 RowBox[{"MatrixKernelOperator", " ", 
  RowBox[{"(", 
   RowBox[{"addED", " ", "to", " ", "code"}], ")"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"there", " ", "is", " ", "no", " ", "problem"}], " ", "-", " ", 
    RowBox[{
    "this", " ", "operator", " ", "returns", " ", "a", " ", "basis", " ", 
     "for", " ", "the", " ", "kernel"}], " ", "-", " ", 
    RowBox[{
    "if", " ", "the", " ", "kernel", " ", "is", " ", "trivial", " ", "then", 
     " ", "the", " ", "basis", " ", "is", " ", "the", " ", "empty", " ", 
     RowBox[{"set", "."}]}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.814596699033779*^9, 3.814596712596616*^9}, 
   3.814679231929439*^9, 3.8172019262960863`*^9, {3.817457078288055*^9, 
   3.817457111486835*^9}},ExpressionUUID->"5bcf10f1-ce54-45ae-983b-\
76c010d8f1a1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BasisOperator", " ", 
   RowBox[{"(", 
    RowBox[{
    "started", ",", " ", 
     "\"\<transfered from monomials_and_conservationlaws.nb\>\""}], ")"}]}], 
  "\n"}], "\n", "PiecewiseAssociationClean", "\n", "PiecewiseListClean", "\
\[IndentingNewLine]", "PiecewiseBeautify", "\n", "PiecewiseEqualOperator", "\n\
", "PiecewiseFullSimplifyOperator", "\n", "PiecewiseSimplifyOperator", "\
\[IndentingNewLine]", 
 RowBox[{"PiecewiseReplace", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"SolveAlwaysOperator", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"PositivityOperator", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"PositivityConditionQEOperator", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", "TestOperator", "\
\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.813482753879765*^9, 3.8134827538821163`*^9}, {
  3.815367066864566*^9, 3.815367070887012*^9}, {3.8153879161586933`*^9, 
  3.815387925158001*^9}, {3.815387994775432*^9, 3.815388006624136*^9}, {
  3.859256173579686*^9, 3.859256189907192*^9}, {3.8592563185846024`*^9, 
  3.85925632408638*^9}, {3.859256413295476*^9, 3.859256430980304*^9}, {
  3.859256516115569*^9, 3.859256524177087*^9}, {3.8592567442642508`*^9, 
  3.8592567504112253`*^9}, {3.8592569639246073`*^9, 3.859256967206023*^9}, {
  3.859257127765676*^9, 3.859257135462418*^9}, {3.859258630843767*^9, 
  3.859258633518282*^9}, {3.8592589021844263`*^9, 3.859258916592952*^9}, {
  3.8592949144170637`*^9, 3.859294926577704*^9}, {3.859298516446102*^9, 
  3.8592985195709743`*^9}},ExpressionUUID->"722c05b9-8d56-4a27-806f-\
42687e710548"],

Cell["\<\
PiecewiseExtractGeneratorsOperator -> I don' t understand well where we use \
this function and why - the documentation needs to be improved\
\>", "Text",
 CellChangeTimes->{{3.859256427915502*^9, 
  3.859256471146044*^9}},ExpressionUUID->"9fea0dec-be45-41dd-81a6-\
39b16ae4ae54"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Documentation written:", "Chapter",
 CellChangeTimes->{{3.8135491391707497`*^9, 3.81354914835424*^9}, 
   3.814162668124867*^9, {3.814596753203039*^9, 
   3.8145967617033854`*^9}},ExpressionUUID->"ac399ee4-2a46-46f6-a413-\
1a98c4d24f20"],

Cell[BoxData[{"FindIntegratingFactorBasisOperator", "\[IndentingNewLine]", \
"FindIntegratingFactorOperator"}], "Input",ExpressionUUID->"dd3ea5a0-2a8e-\
42b7-bdf4-3546e08427cc"],

Cell[BoxData[
 RowBox[{"SimplifyPositivityOperator", " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "need", " ", "to", " ", "find", " ", "an", " ", "example", " ", "in", " ",
      "which", " ", "\"\<eliminator\>\""}], "->", " ", 
    RowBox[{
    "False", " ", "produces", " ", "a", " ", "different", " ", "result"}]}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.817201580727468*^9, 
  3.8172016128959846`*^9}},ExpressionUUID->"ed112829-fbc4-4ce6-a84b-\
f3abd52626f5"],

Cell[BoxData["PositivityConditionQEOperator"], "Input",ExpressionUUID->"2907e74b-2b9d-4a15-8a68-e90853eb9324"],

Cell[BoxData[
 RowBox[{"SimplifyPositivityQEOperator", " "}]], "Input",
 CellChangeTimes->{
  3.81720187446763*^9},ExpressionUUID->"321edaf1-c1a6-4630-8ed1-a5278e280896"],

Cell[BoxData[
 RowBox[{"FindConservedQuantityBasisOperator", " ", 
  RowBox[{"(", 
   RowBox[{"looks", " ", "ok"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.814769624362877*^9, 3.814769624365643*^9}, {
  3.8147702220649347`*^9, 3.8147702290726137`*^9}, {3.815724667495557*^9, 
  3.815724677001107*^9}},ExpressionUUID->"f9eceb12-5215-4a23-b02f-\
4cc324f007d8"],

Cell["MonomialsOperator : partially done", "Text",
 CellChangeTimes->{{3.81450307153318*^9, 3.814503082443478*^9}, {
  3.814538382189604*^9, 3.814538386897221*^9}, {3.814612353994542*^9, 
  3.814612355616045*^9}, {3.814770402630865*^9, 3.814770427110178*^9}, {
  3.815364847547009*^9, 
  3.815364860259406*^9}},ExpressionUUID->"d47614c9-7ad7-402d-a17b-\
bae9519100c7"],

Cell[BoxData[
 RowBox[{"FindConservedQuantityOperator", " ", 
  RowBox[{"(", 
   RowBox[{"looks", " ", "done"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.81450307153318*^9, 3.814503082443478*^9}, {
  3.814538382189604*^9, 3.814538386897221*^9}, {3.814612353994542*^9, 
  3.814612355616045*^9}, {3.815724685228691*^9, 
  3.815724694340074*^9}},ExpressionUUID->"32243a93-53e0-4139-9607-\
afa6ba106572"],

Cell[CellGroupData[{

Cell["Unit tests missing", "Section",
 CellChangeTimes->{{3.823324740183577*^9, 
  3.823324746836854*^9}},ExpressionUUID->"714ce55c-4f69-4945-9aa2-\
b09867a5dea8"],

Cell["\<\
1) MatrixKernelOperator (there are some tests)


\
\>", "Text",
 CellChangeTimes->{{3.823324747877054*^9, 3.82332475503167*^9}, {
  3.831971998359273*^9, 3.831971999343134*^9}, {3.831972031752479*^9, 
  3.831972042449531*^9}},ExpressionUUID->"8aa751ba-542d-44e6-8b42-\
143b1d864528"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Other", "Section",
 CellChangeTimes->{{3.814161149289003*^9, 3.8141611523804703`*^9}, {
  3.814591419470584*^9, 
  3.814591420661352*^9}},ExpressionUUID->"6a87392b-ed68-4bee-bbb9-\
10179b526c11"],

Cell["\<\
We should document somewhere the possible fields in the variables association \
- like depVars, indvars, etc - there may be some obscure things that may not \
be well documented.... one way to find them is to search for Lookup in the \
code - this should give us everything that is used...\
\>", "Text",
 CellChangeTimes->{{3.81416115489258*^9, 3.814161252976487*^9}, {
  3.8207382301564007`*^9, 
  3.820738231248316*^9}},ExpressionUUID->"04582d9e-03ab-4005-a70e-\
62841e244fcd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["RoadMap", "Section",
 CellChangeTimes->{{3.8174681375316563`*^9, 
  3.817468141491003*^9}},ExpressionUUID->"0391bcea-5179-4842-aa50-\
8c59174f435b"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<PDESymbolics2020`\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.870937702599662*^9, 3.87093770876612*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"78d043f6-9387-4587-9e8f-19b29491f98b"],

Cell[CellGroupData[{

Cell["Critical", "Subsection",
 CellChangeTimes->{{3.817508770955008*^9, 
  3.817508772837222*^9}},ExpressionUUID->"ba32e54e-c1c4-4f68-b519-\
d599c15ffd3c"],

Cell["\<\
-3) Piecewise association clean is not documented and does not behave \
properly (I believe, we need to think) in

PiecewiseAssociationClean[Association[\[OpenCurlyDoubleQuote]a\
\[CloseCurlyDoubleQuote]->Piecewise[{{1,a>0},{-1,a<0}},$Failed]]] 

-2) Discrete equivalents seems to have issues - the issue is that \
\[OpenCurlyDoubleQuote]v\[CloseCurlyDoubleQuote] does not show up in the \
expression\
\>", "Text",
 CellChangeTimes->{{3.8584965574946537`*^9, 3.858496616653882*^9}, {
  3.859256074431053*^9, 
  3.859256120378347*^9}},ExpressionUUID->"76437213-bca9-4694-ae9c-\
a9264e6609f4"],

Cell[BoxData["N"], "Input",
 CellChangeTimes->{
  3.8709376932967043`*^9},ExpressionUUID->"b117306c-d4aa-4a8f-856b-\
4c18b76fcc4c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "Get", "[", 
   "\"\</Users/ribeirrd/Library/CloudStorage/Dropbox/KAUST/PDESymbolics/\
PdeSymbolics2020/PDESymbolics2020/Discrete.m\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.858496592008753*^9, 3.858496595837205*^9}, {
  3.858580029603919*^9, 3.858580032543085*^9}, {3.870937724304422*^9, 
  3.870937782890592*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"fca135d6-89a0-4598-84ff-2b5324bbddf0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"u", ",", "v"}], "}"}]}], ",", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}]}], ",", " ", 
     RowBox[{"\"\<pars\>\"", "\[Rule]", 
      RowBox[{"{", "a", "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DiscreteEquivalentsOperator", "[", "variables", "]"}], "[", 
  RowBox[{
   RowBox[{
    RowBox[{"u", "[", 
     RowBox[{
      RowBox[{"x", "+", "1"}], ",", 
      RowBox[{"y", "+", "1"}]}], "]"}], "^", "a"}], " ", "+", 
   RowBox[{"u", "[", 
    RowBox[{"x", ",", "y"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.858496592008753*^9, 3.858496595837205*^9}, {
  3.858580029603919*^9, 3.858580032543085*^9}, {3.870937724304422*^9, 
  3.870937782890592*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"9e70379a-96b6-4a83-a997-8573097410d0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DiscreteEquivalentsOperator", "[", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"depVars\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"u", ",", "v"}], "}"}]}], ",", 
     RowBox[{"\<\"indVars\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}]}], ",", 
     RowBox[{"\<\"pars\"\>", "\[Rule]", 
      RowBox[{"{", "a", "}"}]}]}], "\[RightAssociation]"}], "]"}], "[", 
  RowBox[{
   RowBox[{"u", "[", 
    RowBox[{"x", ",", "y"}], "]"}], "+", 
   SuperscriptBox[
    RowBox[{"u", "[", 
     RowBox[{
      RowBox[{"1", "+", "x"}], ",", 
      RowBox[{"1", "+", "y"}]}], "]"}], "a"]}], "]"}]], "Output",
 CellChangeTimes->{{3.858580028115014*^9, 3.858580033348345*^9}, {
  3.87093768495385*^9, 3.870937699625696*^9}, {3.870937770597681*^9, 
  3.870937790343381*^9}},
 CellLabel->"Out[13]=",ExpressionUUID->"be688afc-dafb-452b-9bd2-6c072e155197"]
}, Open  ]],

Cell[TextData[{
 "-1) ConservedQOperator seems to be giving the output in a weird format\n\n\
variables = \
<|\[CloseCurlyDoubleQuote]depVars\[CloseCurlyDoubleQuote]\[Rule]{u},\
\[CloseCurlyDoubleQuote]indVars\[CloseCurlyDoubleQuote]\[Rule]{x},\
\[CloseCurlyDoubleQuote]timederivativeorder\[CloseCurlyDoubleQuote]\[Rule]1,\
\[CloseCurlyDoubleQuote]eqRhs\[CloseCurlyDoubleQuote]\[Rule]{u\
\[CloseCurlyQuote]\[CloseCurlyQuote][x]},\[CloseCurlyDoubleQuote]pars\
\[CloseCurlyDoubleQuote]->{a}|>;\nConservedQOperator[variables][u[x]^a]\n\n0)\
\n \na)\nvb=Association[\[OpenCurlyDoubleQuote]depVars\[CloseCurlyDoubleQuote]\
\[Rule]{\[Rho],\[Rho]E},\[CloseCurlyDoubleQuote]pars\[CloseCurlyDoubleQuote]\
\[Rule]{\[Gamma]},\[CloseCurlyDoubleQuote]indVars\[CloseCurlyDoubleQuote]\
\[Rule]{n},\[CloseCurlyDoubleQuote]VarDOperator\[CloseCurlyDoubleQuote]\[Rule]\
DVarDOperator]\n",
 Cell[BoxData[
  RowBox[{
   RowBox[{"BasisModNullLagrangiansOperator", "[", "vb", "]"}], "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       RowBox[{" ", 
        RowBox[{"Log", "[", 
         RowBox[{"\[Rho]", "[", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], "]"}], "]"}]}]]}], ",", 
     FractionBox[
      RowBox[{" ", 
       RowBox[{"Log", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Gamma]"}], ")"}], " ", 
         RowBox[{"\[Rho]E", "[", "n", "]"}]}], "]"}], " "}], 
      RowBox[{" ", 
       RowBox[{"Log", "[", 
        RowBox[{"\[Rho]", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], "]"}], "]"}]}]]}], "}"}], "]"}]],
  CellChangeTimes->{{3.827885713783655*^9, 3.827885723863503*^9}, {
   3.827885812636751*^9, 3.827885815049177*^9}, {3.8278858675843143`*^9, 
   3.827885898015932*^9}, {3.82788594833287*^9, 3.827885985339484*^9}, {
   3.827886058599103*^9, 3.827886118446892*^9}},ExpressionUUID->
  "b63edc37-fdc0-446b-9641-a6d9a6c28b42"],
 "\n\nprehaps adding //PowerExpand somewhere will do the trick and this \
should be mostly harmless\n\nb)\nthis also seems to be running forever, \
removing the parameters solves the issue (albeit perhaps incorrectly)\n\n",
 Cell[BoxData[{
  RowBox[{
   RowBox[{"variables", " ", "=", " ", 
    RowBox[{"Association", "[", "\n", 
     RowBox[{
      RowBox[{"\"\<depVars\>\"", " ", "->", " ", 
       RowBox[{"{", 
        RowBox[{"v", ",", "m"}], "}"}]}], ",", "\n", 
      RowBox[{"\"\<indVars\>\"", " ", "->", " ", 
       RowBox[{"{", "x", "}"}]}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{"\"\<pars\>\"", "->", 
       RowBox[{"{", "a", "}"}]}], ",", "\n", 
      RowBox[{"\"\<eqRhs\>\"", " ", "->", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            FractionBox["1", "2"]}], " ", "a", " ", 
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{
             RowBox[{"-", "1"}], "-", "a"}]], " ", 
           SuperscriptBox[
            RowBox[{"v", "[", "x", "]"}], "2"], " ", 
           RowBox[{
            SuperscriptBox["m", "\[Prime]",
             MultilineFunction->None], "[", "x", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{"-", "a"}]], " ", 
           RowBox[{"v", "[", "x", "]"}], " ", 
           RowBox[{
            SuperscriptBox["v", "\[Prime]",
             MultilineFunction->None], "[", "x", "]"}]}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "a"}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{"-", "a"}]], " ", 
           RowBox[{"v", "[", "x", "]"}], " ", 
           RowBox[{
            SuperscriptBox["m", "\[Prime]",
             MultilineFunction->None], "[", "x", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{"1", "-", "a"}]], " ", 
           RowBox[{
            SuperscriptBox["v", "\[Prime]",
             MultilineFunction->None], "[", "x", "]"}]}]}]}], "}"}]}]}], "\n",
      "]"}]}], ";"}], "\n", 
  RowBox[{
   RowBox[{"FindConservedQuantityBasisOperator", "[", "variables", "]"}], "[",
    "\n", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<degree\>\"", " ", "->", " ", "3"}], ",", " ", 
     RowBox[{"\"\<derivatives\>\"", "->", "0"}], ",", "\n", 
     RowBox[{"\"\<generators\>\"", " ", "->", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"v", "[", "x", "]"}], ",", 
        RowBox[{"m", "[", "x", "]"}], ",", 
        FractionBox["1", 
         RowBox[{"m", "[", "x", "]"}]], ",", 
        SuperscriptBox[
         RowBox[{"m", "[", "x", "]"}], 
         RowBox[{"-", "a"}]]}], "}"}]}]}], "]"}], "]"}]}], "Input",
  CellChangeTimes->{{3.8434686497044983`*^9, 3.843468715839321*^9}},
  ExpressionUUID->"555e6f6f-9d72-41fa-a34a-b6fe29be8acb"],
 "\n\n\n1) [not urgent but should be addressed] BranchingGaussianElimination \
seems to use as domain the reals - need to see how this works. Need to change \
in GaussianEliminationOperator and then track the changes downhill, for \
example in RecursiveRowBranchingGaussianElimination we need to add the domain \
to the call of EqualToZero. Before doing this, however, we should develop the \
tests for GaussianEliminationOperator, so that it is easier to detect any \
issues\n\n3)   [not urgent but should be addressed]  We should revisit \
solveunderterminedcoefficients operator \n\n4) [not urgent but should be \
revisited] Replace AppendTo with Append whenever possible, same with \
AssociateTo ; also look at localvariables at various points of the code and \
clean them up\n\n5) [not urgent but should be revisited] Remove functions in \
operators (to avoid issues with testoperator)\n\n6) PiecewiseListClean and \
PiecewiseAssociationClean do not work with piecewise objects \
Piecewise[List[Piecewise, Piecewise...]] only with List[Piecewise, \
Piecewise...] - also these need to be documented\n\n\n"
}], "Text",
 CellChangeTimes->{{3.817508765094775*^9, 3.817508800471094*^9}, 
   3.817508831664051*^9, {3.8175088780596457`*^9, 3.817508897634988*^9}, {
   3.817509034409273*^9, 3.8175090610955553`*^9}, {3.817525840392498*^9, 
   3.817525841494968*^9}, {3.817536188109006*^9, 3.8175362108471537`*^9}, {
   3.817538246333933*^9, 3.817538265843874*^9}, {3.817548790307522*^9, 
   3.817548842628903*^9}, {3.8175492196812267`*^9, 3.81754923462951*^9}, {
   3.817599856237199*^9, 3.817599857979149*^9}, {3.817620948294074*^9, 
   3.817620952758827*^9}, {3.817621169006016*^9, 3.817621208212139*^9}, {
   3.817621331066687*^9, 3.817621343815146*^9}, {3.817621400044244*^9, 
   3.8176214201727667`*^9}, {3.817621485195517*^9, 3.817621485797687*^9}, {
   3.817627284867805*^9, 3.817627305530354*^9}, {3.817629475789854*^9, 
   3.8176294939982557`*^9}, {3.817921777889346*^9, 3.817921857119596*^9}, {
   3.8194330013102007`*^9, 3.8194330394746847`*^9}, {3.819433621665633*^9, 
   3.819433679692441*^9}, {3.819596383093007*^9, 3.819596386807218*^9}, {
   3.819596491578318*^9, 3.8195965455631323`*^9}, 3.820738236244844*^9, {
   3.821255245941835*^9, 3.821255269086843*^9}, 3.8218562737991323`*^9, {
   3.8224602573671827`*^9, 3.822460295535162*^9}, {3.822916876337996*^9, 
   3.8229168868911552`*^9}, {3.8229169258718023`*^9, 3.822916931180319*^9}, 
   3.823324730894779*^9, {3.8234913946064796`*^9, 3.823491399902233*^9}, {
   3.8236426632538443`*^9, 3.823642719101779*^9}, {3.8238335248853683`*^9, 
   3.823833526325748*^9}, {3.824187300023954*^9, 3.824187306989892*^9}, 
   3.824869061502666*^9, {3.824870427401163*^9, 3.8248704316654787`*^9}, {
   3.824870526798131*^9, 3.824870527048234*^9}, 3.824870618367886*^9, {
   3.824871626687282*^9, 3.82487163703321*^9}, {3.824872619858037*^9, 
   3.824872702231737*^9}, {3.824880547632975*^9, 3.824880551807948*^9}, {
   3.8248807999230947`*^9, 3.824880830283684*^9}, {3.825592805664384*^9, 
   3.825592825765902*^9}, {3.82575000128976*^9, 3.825750046304978*^9}, {
   3.826009332984105*^9, 3.826009388181711*^9}, {3.826009636324766*^9, 
   3.8260096437480392`*^9}, {3.826009682766512*^9, 3.82600970468633*^9}, {
   3.8261549534186172`*^9, 3.826154977551156*^9}, {3.8261550822037992`*^9, 
   3.826155112278843*^9}, {3.826255024056815*^9, 3.826255060608246*^9}, {
   3.8262662994913473`*^9, 3.826266304416366*^9}, {3.826359561467795*^9, 
   3.826359594414287*^9}, {3.8278861714714813`*^9, 3.82788617745885*^9}, {
   3.827886250425405*^9, 3.827886254409587*^9}, 3.8280193104103127`*^9, 
   3.832032768359036*^9, {3.834041965593697*^9, 3.834041974325178*^9}, {
   3.842682598272547*^9, 3.842682633753872*^9}, {3.842682931395775*^9, 
   3.8426829708940907`*^9}, {3.843468834929737*^9, 3.843468873054329*^9}, {
   3.844044680928286*^9, 3.844044702070911*^9}, {3.845862125483411*^9, 
   3.845862174684832*^9}, {3.8458622524876213`*^9, 3.8458622595818663`*^9}, {
   3.845863092093008*^9, 3.845863098785305*^9}, {3.85849541880492*^9, 
   3.858495443959559*^9}, {3.8585799924704933`*^9, 
   3.858579993541272*^9}},ExpressionUUID->"59b2ae38-2776-4982-8fc8-\
184d42469f53"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Important", "Subsection",
 CellChangeTimes->{{3.834041795275394*^9, 
  3.8340417983757277`*^9}},ExpressionUUID->"cfc5e2ba-31f8-43c0-a6f0-\
fda16dc76315"],

Cell["\<\

1) Decide a better representation for the Kronecker delta issue?? Was this \
solved?

2) It would be natural for EqualToZeroOperator to return a piecewise object

variables=Association[{\[OpenCurlyDoubleQuote]generators\
\[CloseCurlyDoubleQuote]\[Rule]{u[x],x}, \[OpenCurlyDoubleQuote]pars\
\[CloseCurlyDoubleQuote]\[Rule]{a,b,c}}];
EqualToZeroOperator[variables][ (c^2-1) u[x]^2+b u[x]^a]
EqualToZeroOperator[variables][0]
EqualToZeroOperator[variables][1]
EqualToZeroOperator[variables][ (a^29-1)]

this should handle the case where there are no solutions or multiple solutions

The same thing should be done for ImprovedHomogeneousSolveAlwaysOperator 

these probably should return an empty list when there is no solution. A \
question may be how to handle $Failed...

3) Solve the following issue for MatrixKernel - this is probably a deeper \
issue maybe in equal to zero...

variables= Association[\[OpenCurlyDoubleQuote]pars\[CloseCurlyDoubleQuote]\
\[Rule]{a,b},\[CloseCurlyDoubleQuote]generators\[CloseCurlyDoubleQuote]\[Rule]\
 {u[x],u\[CloseCurlyQuote][x]},\[CloseCurlyDoubleQuote]depVars\
\[CloseCurlyDoubleQuote]\[Rule]{u},\[CloseCurlyDoubleQuote]indVars\
\[CloseCurlyDoubleQuote]\[Rule]{x}];
MatrixKernelOperator[variables][{{u[x]^a ,u[x]^2},{u\[CloseCurlyQuote][x]^b,u\
\[CloseCurlyQuote][x]}}]
\
\>", "Text",
 CellChangeTimes->{{3.823853393443582*^9, 3.823853453819824*^9}, {
  3.824177020301347*^9, 3.8241770207054663`*^9}, {3.8248706242025843`*^9, 
  3.824870652278771*^9}, {3.824872319036413*^9, 3.824872320020384*^9}, {
  3.824872477199682*^9, 3.824872500229754*^9}, {3.824872654203616*^9, 
  3.824872707334902*^9}, {3.8340418000808573`*^9, 3.8340418180425177`*^9}, {
  3.834041938819481*^9, 3.8340419781038237`*^9}, {3.842682976974847*^9, 
  3.842682981745723*^9}, {3.85910298516997*^9, 3.859103001587742*^9}, {
  3.859171948750317*^9, 3.859171996645597*^9}, {3.859340692504249*^9, 
  3.8593407791141243`*^9}, {3.8593517238671618`*^9, 
  3.859351782294135*^9}},ExpressionUUID->"2b7ac6ca-5f60-4604-b089-\
0935302e8204"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.8248723175619287`*^9, {3.8591029781349792`*^9, 
   3.859102983585621*^9}},ExpressionUUID->"d7ce748d-d65f-4968-81b0-\
f13e62d7d910"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<PDESymbolics2020`\>\"", "]"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"7d233a9e-2ed7-499c-9ff8-bd5c26059571"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Next steps", "Subsection",
 CellChangeTimes->{{3.817620955024292*^9, 
  3.817620959338941*^9}},ExpressionUUID->"940efe1d-a262-4249-9542-\
c58473c1bbb8"],

Cell["\<\
-F) Build consistent schemes automatically; build consistent schemes with \
given conservation laws; both discrete a semi-discrete

-E) Maybe framework (Perhaps)

-D) Matteo proposed to look into positivity preservation by schemes - this \
needs to be done independently but we need to figure out how to do it with \
implicit schemes.

-C) [Friedmann is working on this] conservation laws in discrete time - DONE \
BUT we need to revisit Groebner basis.

-B) [Mohammead is doing this or maybe not] Sum by parts experimental test: \
will test if something is a null lagrangian, can also be done by random \
integration for continuous problems. 

-A) Stencil reduction operator - this is a recursive approach to summing by \
pars so that the stencil is reduced - returns minimal stencil expression. \
This is the discrete equivalent of IntegrateByParts -> we can use \
disintegrate to do this (how?)

a) we begin by disintegrating
c) we gather the monomials by stencil -> this will give a set of equations to \
be solved for remove a given point from stencil
d) We solve/reduce of the equations 
e) Then we look at all possible combinations of size \[OpenCurlyDoubleQuote]1\
\[CloseCurlyDoubleQuote] to \[OpenCurlyDoubleQuote]n\[CloseCurlyDoubleQuote] \
and see how many terms can we kill - alternatively we use a greedy strategy \
solve for 1 select the one with more parameters and iterate

*) [David K] suggested we look at finite elements as (translation invariant) \
systems 

**) Differential reduction mod constraints and prolongation - this is the \
\[OpenCurlyDoubleQuote]correct\[CloseCurlyDoubleQuote] way to handle NS \
equation. 


A) MasterPositivity

returns association with:

 necessary conditions
 sufficient conditions
 necessary & sufficient conditions
 
 expression rewritten according to these conditions
 
0) Create a master function Positivity

a) looks for a common factor, splits into positive, negative, and \
undetermined factors

b) applies necessary conditions 

c) if polynomial tries to use quantifier elimination

d) if non-poly or QE times out tries to use sufficient conditions (if possible)

e) output is BOTH the simplified expression AND positivity condition


1) SimplifyPositivityQE:

a) take the sufficient conditions part from the code and move it to a new \
function SimplifyPositivitySC (sufficient conditions),
b) same for PositivityConditionQEOperator

3) TestOperator and UnitTests for FindIntegratingFactorBasisOperator



5) [UNCLEAR IF THIS HELPS] change of variables before simplify positivity for \
discrete problems - not sure if this will help - need to think more about this

6) revisit $Failed in different functions to make sure this is what we mean

\
\>", "Text",
 CellChangeTimes->{{3.8176209647672157`*^9, 3.817620994801972*^9}, {
   3.819433049152973*^9, 3.819433066988117*^9}, {3.819593828506448*^9, 
   3.819593858874999*^9}, {3.8195963905581837`*^9, 3.819596460997355*^9}, {
   3.819598803831564*^9, 3.819598840920745*^9}, {3.8196396473901043`*^9, 
   3.819639668241439*^9}, {3.8196743932895517`*^9, 3.819674396110589*^9}, {
   3.8197093889779177`*^9, 3.819709400735344*^9}, 3.820738242065543*^9, {
   3.8212552794862537`*^9, 3.821255282819284*^9}, {3.821255432514895*^9, 
   3.82125547792511*^9}, {3.821856283779985*^9, 3.821856299980194*^9}, {
   3.821856404582079*^9, 3.821856438082919*^9}, {3.822383182805655*^9, 
   3.8223832148254223`*^9}, {3.822392795873931*^9, 3.8223927962212048`*^9}, {
   3.824870536599197*^9, 3.824870561260189*^9}, {3.824872720027192*^9, 
   3.824872723758649*^9}, {3.824880543969*^9, 3.824880544109226*^9}, {
   3.824880832209577*^9, 3.824880849635469*^9}, {3.8249540338133163`*^9, 
   3.824954206429761*^9}, {3.82556792022301*^9, 3.825567920746316*^9}, 
   3.825750054620118*^9, 3.826009742848957*^9, {3.8261549965245047`*^9, 
   3.826155033769718*^9}, {3.826155115829132*^9, 3.826155121621571*^9}, {
   3.826358754465085*^9, 3.826358756773329*^9}, {3.826358839813231*^9, 
   3.826358853762821*^9}, {3.826359371534198*^9, 3.826359379631919*^9}, 
   3.8263596464128*^9, {3.826375138624979*^9, 3.8263751935831823`*^9}, {
   3.8263752464499083`*^9, 3.826375253233266*^9}, {3.828019229686729*^9, 
   3.828019276080378*^9}, {3.82802002924374*^9, 3.8280200683231173`*^9}, {
   3.829383797454647*^9, 3.829383828908263*^9}, {3.83203278052092*^9, 
   3.832032816395775*^9}, {3.834042015013723*^9, 3.8340420518462667`*^9}, 
   3.8426830070203867`*^9, {3.84268303988507*^9, 3.84268304033337*^9}, {
   3.8426911776430807`*^9, 3.842691204167109*^9}, {3.8440455522452183`*^9, 
   3.84404576124797*^9}, {3.855398744382123*^9, 3.855398750834263*^9}, {
   3.8554062634764*^9, 3.8554062658316193`*^9}, {3.8580463175493402`*^9, 
   3.858046393388029*^9}, {3.858049544836775*^9, 3.8580495495320387`*^9}, {
   3.858057115926136*^9, 3.858057118071919*^9}, {3.8583895930907097`*^9, 
   3.858389630515731*^9}, {3.865136867468453*^9, 3.865136902263364*^9}, 
   3.865136991519044*^9, {3.8651370360227537`*^9, 
   3.8651370703286657`*^9}},ExpressionUUID->"5050bddc-1ae3-46dc-a5f0-\
44654cfbb74b"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8554797838726397`*^9, 
  3.855479785870636*^9}},ExpressionUUID->"2ccce39f-4ed0-4e68-81c1-\
0f9472399bf1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Ongoing", "Subsection",
 CellChangeTimes->{{3.817468143863112*^9, 3.8174681506237707`*^9}, {
  3.817508738417469*^9, 
  3.817508784512332*^9}},ExpressionUUID->"e96ba49f-8cf6-4802-82cb-\
4890604c1395"],

Cell["\<\
1) Write documentation
2) Write unit tests
3) Write Tests -  focus on CORE TESTS for TestOperator:  \
SolveUndeterminedCoefficientsOperator, GaussianEliminationOperator, \
MonomialDependenceOperator, ParametricRefineOperator,  \
RegroupParametersOperator
4) Function re-design to allow options to be either in variables or parameters

\
\>", "Text",
 CellChangeTimes->{{3.817468152824397*^9, 3.8174681747701473`*^9}, {
   3.8174778355907583`*^9, 3.817477859128257*^9}, {3.817478139245426*^9, 
   3.817478151161367*^9}, {3.817478244734268*^9, 3.817478378199456*^9}, {
   3.817478491743063*^9, 3.817478526936307*^9}, {3.817508725204816*^9, 
   3.81750873557064*^9}, {3.817508917410315*^9, 3.81750894458514*^9}, {
   3.817538268519236*^9, 3.8175382912275677`*^9}, 3.8175384508699923`*^9, 
   3.8176209692828827`*^9, {3.817621004034882*^9, 3.8176210395735598`*^9}, {
   3.817621488820921*^9, 3.817621498755176*^9}, {3.822383239959737*^9, 
   3.822383240790493*^9}, {3.823324802431538*^9, 3.823324805503413*^9}, {
   3.8261551367508593`*^9, 
   3.826155148640759*^9}},ExpressionUUID->"3668904b-e97d-416d-9351-\
a3a8ee59d33c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Near Term focus", "Subsection",
 CellChangeTimes->{{3.81746817918507*^9, 
  3.817468186330941*^9}},ExpressionUUID->"d7c519b1-a9f2-40f2-b138-\
4fc7fa775be6"],

Cell["\<\
1) PositivityOperator -> \[OpenCurlyDoubleQuote]one stop shop for all your \
positivity needs\[CloseCurlyDoubleQuote] (needs first to build \
FactorPositiveTerms) - will return necessary conditions if it can find them, \
conditions, or sufficient conditions

2) Develop applications to numerics (using findintegratingfactors, for \
example), find dissipated quantity, etc 

3) Theorem extraction 

4) Overdetermined system solve - this is something that we can build by \
parts, for example the differential reduction and prolongation are important \
on its own terms as well as various other routines there

5) Monomials and symmetries

6) Improved polynomial algebra:

a) monomial order
b) leading term 
c) leading coefficient
d)polynomial degree 
e) least common multiple
f) poly division
g) S polynomial for groebner basis
h) Buchberger algorithm
 \
\>", "Text",
 CellChangeTimes->{{3.81746819115554*^9, 3.817468199153569*^9}, {
   3.8174777556602697`*^9, 3.817477779455941*^9}, {3.817477824458932*^9, 
   3.817477830569536*^9}, {3.817477881630454*^9, 3.817477949442039*^9}, {
   3.8174780095731153`*^9, 3.817478014004567*^9}, {3.817509603252387*^9, 
   3.8175096132015457`*^9}, 3.817921901304386*^9, {3.819596579499506*^9, 
   3.819596678218185*^9}, {3.819596729685213*^9, 3.819596736165122*^9}, 
   3.821856441588212*^9, {3.8223832557980547`*^9, 3.8223832672104797`*^9}, {
   3.8241770789239817`*^9, 3.8241770947257557`*^9}, {3.824177377610434*^9, 
   3.824177408288682*^9}, 3.82487146224684*^9, {3.8263587683403053`*^9, 
   3.8263588288887253`*^9}, 3.842683062199188*^9, {3.8554062688436947`*^9, 
   3.855406280399539*^9}, {3.855479794774744*^9, 3.855479821168803*^9}, {
   3.855479925523226*^9, 3.855479962971423*^9}, {3.855495838325781*^9, 
   3.855495847442924*^9}, {3.86513709712422*^9, 
   3.865137133475122*^9}},ExpressionUUID->"64c2113e-f275-4b20-8846-\
5b2e2feee4e4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Medium Term focus", "Subsection",
 CellChangeTimes->{{3.81746817918507*^9, 3.817468186330941*^9}, {
  3.817627346529871*^9, 
  3.817627348580961*^9}},ExpressionUUID->"b8e94292-a741-47c2-a613-\
7da289eb1b5d"],

Cell["\<\


1) Improve efficiency  - collect a number of examples that as far as we know \
are not wrong but take too long to run and investigate alternatives

2) Change from non-polyvariables operator:  options for keeping exponentials \
and/or powers

3) Sufficient conditions for positivity: this could be framed as a fixed point

a) Algorithm 1: factor positive terms, simplify and try to check positivity \
of each of the terms 
b) Algorithm 2: extract positive terms, use young inequality to control the \
remaining terms 
c) Algorithm 3: write expression as sum of squares

- extract monomials for quadratic form
- for this we need to first find a quadratic form representation of an \
expression
- then we need to get positive definiteness condition for this quadratic form \
-> this is quantifier elimination...
- then we try to remove the \[OpenCurlyDoubleQuote]non-polynomial monomials\
\[CloseCurlyDoubleQuote]. 


d) Algorithm 4: Mher\[CloseCurlyQuote]s change of variables trick 
e) Algorithm 5: sufficient conditions via partial quantifier elimination and \
Boolean convert in disjunctive normal form ??? - what do i mean?

Base algorithm:

Q1 - are there non polynomial, non-power variables -> if yes change variables \
(trig functions, for example, keep exponentials and powers)
Q2 - can we factor - if so extract positive factors, address negative ones, etc
Q3 - change variables again for exponentials 
T1 - Try: Is the remaining expression polynomial -> if so try quantifier \
elimination
T2 - Try partial quantifier eliminator over polynomial variables with boolean \
convert in CNF
T3 - Try fact decomposing in sums and use recursion
T4 - Try rewrite powers and exponentials as new variables and use recursion  
T5 - Split expression into sum positive terms and the rest try to control \
using young-type inequality

3) Necessary conditions

(here we cannot do changes of variables because that messes up \
\[OpenCurlyDoubleQuote]necessary part\[CloseCurlyDoubleQuote]

Q1 - factor terms
Q2 - use simplify positivity
T1 - Try: Is the remaining expression polynomial -> if so try quantifier \
elimination
T2 - Try partial quantifier eliminator over polynomial variables with boolean \
convert in DNF
T3 - Try: If the expression simplifies to a sum, at least one of the terms \
must be non-negative - use recursion 



4) Heuristic conditions

Q1) factor terms
Q2) use simplify positivity
T1) chooses the coefficients so that the resulting expression satisfies \
\[OpenCurlyDoubleQuote]sum-of-squares\[CloseCurlyDoubleQuote] necessary \
conditions. \
(https://www.sciencedirect.com/science/article/pii/S0022404997838273)
 (eg necessary conditions for sum-of squares - which is a necessary condition \
for  a sufficient condition)
 
 ->> Artin\[CloseCurlyQuote]s theorem f pds implies exist g^2 f is sum of \
squares
 ->> Classical Positivstellensatz

5) Helmoltz equations for inverse lagrangians, other interesting operators

6) Represent mod null lagrangians and mod PDE system - requires differential \
elimination 

7) Computation of symmetries

8) Speculative: poincare compactification of PDEs
\
\>", "Text",
 CellChangeTimes->{{3.817627349861454*^9, 3.8176273813840714`*^9}, {
   3.817958404020184*^9, 3.817958452460225*^9}, {3.819684713995463*^9, 
   3.819684785029603*^9}, {3.8236426539194508`*^9, 3.823642654142737*^9}, {
   3.824177099439003*^9, 3.824177234713179*^9}, {3.8241772896023617`*^9, 
   3.824177358302547*^9}, {3.824871592950873*^9, 3.82487160158335*^9}, {
   3.826033181211112*^9, 3.826033193619958*^9}, 3.826266337571756*^9, {
   3.826270520487728*^9, 3.826270546458049*^9}, {3.8262707880190763`*^9, 
   3.826270842603252*^9}, {3.826276520982977*^9, 3.826276566690422*^9}, {
   3.826276772492673*^9, 3.8262767745412703`*^9}, {3.826287319018938*^9, 
   3.8262873831357727`*^9}, {3.826287465998217*^9, 3.826287470287407*^9}, {
   3.826287522237924*^9, 3.82628755510649*^9}, {3.8262876485976467`*^9, 
   3.826287675618704*^9}, {3.826287760758329*^9, 3.826287766755348*^9}, {
   3.826287799270207*^9, 3.8262878052247887`*^9}, {3.8262878560268393`*^9, 
   3.826287872029784*^9}, {3.826287920123166*^9, 3.826287952420209*^9}, 
   3.826288132390546*^9, {3.8262882138592777`*^9, 3.826288232503438*^9}, {
   3.826288913591867*^9, 3.8262889141244497`*^9}, {3.826289019478634*^9, 
   3.82628915059828*^9}, {3.8262893777669*^9, 3.826289393159074*^9}, {
   3.8263315757187757`*^9, 3.8263315882051897`*^9}, {3.8263316413195543`*^9, 
   3.826331911778442*^9}, {3.826331952196574*^9, 3.826332029937705*^9}, {
   3.826332074563986*^9, 3.826332264516906*^9}, 3.842687881744664*^9, {
   3.860978146183694*^9, 3.8609782330523443`*^9}, {3.8609782797821083`*^9, 
   3.860978342338294*^9}, {3.860978449824019*^9, 
   3.860978534710615*^9}},ExpressionUUID->"69b0e88f-dcc7-4438-ad05-\
240b1e37a272"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Variables", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"x", "^", "a"}], " ", "y"}], "+", " ", 
   RowBox[{"x", "^", 
    RowBox[{"(", 
     RowBox[{"b", "+", "1"}], ")"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.826288235247602*^9, 3.8262882497821007`*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"28314bad-1072-449b-8de2-45ea6cbdbf68"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x", ",", 
   SuperscriptBox["x", "a"], ",", 
   SuperscriptBox["x", "b"], ",", "y"}], "}"}]], "Output",
 CellChangeTimes->{3.826288250896208*^9},
 CellLabel->"Out[80]=",ExpressionUUID->"c9bed8bd-ea7b-4a41-9949-5e56ee1e70b2"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell["Operator works", "Section",
 CellChangeTimes->{{3.81355008030053*^9, 
  3.813550088107202*^9}},ExpressionUUID->"e1bcefb6-7d75-490e-8fc3-\
524e358a53c3"],

Cell[CellGroupData[{

Cell["Functions that need to be coded", "Section",
 CellChangeTimes->{{3.81477023277172*^9, 
  3.8147702426218653`*^9}},ExpressionUUID->"3bfa24b3-54ca-4026-bf89-\
dc1492382dc2"],

Cell["\<\

General issues

- maybe we should check whether Reduce can be replaced at some points by \
Resolve - this could avoid generating gigantic expressions?

Piecewise

PiecewiseMapThreadOperator

Linear algebra

this is already done in linearsystem solve or some other operators, but we \
may need to wrap it in some way 

1) [almost done but DG needs to figure out what is going on....] \
LinearDependentQOperator - checks if an expression is a linear combination of \
a certain basis - this is useful for a number of verification tests.
Before coding need to think what we really need, this is probably useful for \
polynomial basis
 Actually a more interesting test is to see if a subspace is contained in \
another subspace, if so, return the coefficients 
 
2) [?????] MatrixRangeOperator -> returns a basis for range -> this just what \
Gaussian elimination does, so I don\[CloseCurlyQuote]t think we need it

4) revisit solveunderdetermined stuff  (why? DG)

Variational Derivatives - no known issues

Beautification

1) discrete symmetrization: explore ideas, break by homogeneity degree should \
we also do parametric refine?

2) 2 u[x]^2+2 u[x] u[x+1] becomes u[x]^2+2 u[x] u[x+1]+u[x+1]^2

u[x]^2+v[x+1]^2 +2 u[x] v[x] 


Positivity

1) SimplifyPositivity:  

a) [IMPORTANT] simplifypositivity improve the treatment of variables that \
have sign treating odd coefficients as being even



2) SimplifyPositivityQE: add sufficient conditions option to PositivityQE - \
right now it is automatic 



3) Positivity:

a)implement factor in Positivity and test without factor (this is optional)
b) piecewise map thread
c) for each of the expressions that is a polynomial apply simplify positivity \

d) filter failed (also in Disintegrate, also audit other functions that map \
to lists )
e) apply positivityQE
f) replace and re-factor resulting expression



4) Theorem extraction

Timedependent

implement: DissipationCondition
implement findmultiplers AND finddissipative multipliers (?) 
implement: find divergence from a null-Lagrangian
- with these two we can implement the fully discrete stuff


[Low priority] Monomials

1) Symmetry stuff (including scaling)

2) Multipliers to \[OpenCurlyDoubleQuote]integrate\[CloseCurlyDoubleQuote] \
expressions

Overdetermined Systems

1) most of it needs to be re-coded - why?
2)

Test

1) quite a lot of tests are missing for the testoperator

Further stuff







\
\>", "Text",
 CellChangeTimes->{{3.814770244703479*^9, 3.8147702999859533`*^9}, {
   3.814770348326576*^9, 3.814770348804525*^9}, {3.815904783389151*^9, 
   3.815904814148562*^9}, {3.816137607478163*^9, 3.8161378165359783`*^9}, {
   3.816137881125607*^9, 3.816137952906931*^9}, {3.8161632201205473`*^9, 
   3.816163250960063*^9}, {3.816163321548664*^9, 3.816163338764751*^9}, {
   3.8163145383420687`*^9, 3.816314556570095*^9}, {3.816416326975547*^9, 
   3.816416337638626*^9}, {3.816416434757063*^9, 3.816416482553154*^9}, {
   3.816416713889209*^9, 3.816416715455668*^9}, {3.816421109653297*^9, 
   3.816421109987228*^9}, {3.816421149859808*^9, 3.816421218875369*^9}, {
   3.816499250834764*^9, 3.8164992579747343`*^9}, {3.81649955055728*^9, 
   3.816499643483693*^9}, {3.816499820534211*^9, 3.8164999229176407`*^9}, {
   3.816500057509849*^9, 3.816500086142888*^9}, {3.816500135102585*^9, 
   3.816500185923398*^9}, {3.816500223771927*^9, 3.816500253430213*^9}, {
   3.816500301432192*^9, 3.816500350603456*^9}, {3.816500609749505*^9, 
   3.816500620238063*^9}, {3.8165007296388273`*^9, 3.81650073497163*^9}, {
   3.816500813480056*^9, 3.816500817447836*^9}, {3.816935853537101*^9, 
   3.816935884821446*^9}, {3.816935969381382*^9, 3.8169359981194973`*^9}, {
   3.8169434525264397`*^9, 3.81694355120103*^9}, {3.816968354372075*^9, 
   3.8169684872272787`*^9}, 3.816968538994631*^9, {3.817075059032155*^9, 
   3.817075197714656*^9}, {3.81726850318729*^9, 3.8172686873562193`*^9}, {
   3.817268782512538*^9, 3.817268794585067*^9}, {3.817369652869813*^9, 
   3.817369657965025*^9}, {3.817369797540444*^9, 3.817369798303192*^9}, {
   3.817376479961363*^9, 3.817376557916891*^9}, {3.8173890569312973`*^9, 
   3.8173890797450314`*^9}, {3.8173891567170477`*^9, 3.817389166201168*^9}, {
   3.8174594870739937`*^9, 3.817459594972904*^9}, {3.817459631577991*^9, 
   3.8174596350636997`*^9}, 3.817599842420849*^9, {3.81759989532397*^9, 
   3.817599898587233*^9}, {3.817627398830057*^9, 3.817627399227454*^9}, 
   3.817629538421267*^9, 3.8194330895153933`*^9, 3.821261947022531*^9, {
   3.826155190811606*^9, 3.8261551914640083`*^9}, {3.860978564923067*^9, 
   3.860978566444961*^9}},ExpressionUUID->"6e96ae54-8b5a-49a0-872e-\
626f051fe1f0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Functions that may need some redesign ", "Section",
 CellChangeTimes->{{3.814591424212419*^9, 3.814591435118964*^9}, 
   3.81459149150642*^9},ExpressionUUID->"1272f8eb-0d74-4baf-b931-\
051213753cbe"],

Cell["\<\
1) SolveUndeterminedCoefficients - 
\tREDESIGN DONE - this needs to be documented though
\tUpdate in Disintegrate, RepresentModNull
\t
2) GenericLinearCombination (update in Disintegrate, RepresentModNull as well \
as in FindCons, the problem at hand)

We may need also to revisit in the same spirit: 
  1) VarDOperator, DVarDOperator, VariationalDOperator, [DONE: TimeDer \
(define the order inside a problem)]
  2) IntegrateByPartsOperator - intVars this could be part of the problem
  3) RemoveDers - rdVars
  4) FindConserved etc should also conform to new syntax. note that \
timederivative order should be part of the problem. document\
\>", "Text",
 CellChangeTimes->{{3.814591439923594*^9, 3.814591543242465*^9}, {
   3.814596770803203*^9, 3.814596780782323*^9}, {3.814596850138682*^9, 
   3.814596874071562*^9}, {3.814596944556179*^9, 3.814596957949191*^9}, {
   3.814597018509357*^9, 3.8145970234540367`*^9}, 3.8145970604568233`*^9, {
   3.8145970954783773`*^9, 3.814597178084972*^9}, {3.814597227887583*^9, 
   3.814597243716354*^9}, 3.814679045657072*^9, {3.815904862562995*^9, 
   3.815904866897604*^9}, {3.816968565769855*^9, 3.8169685674369926`*^9}, {
   3.816971802786577*^9, 
   3.816971827764102*^9}},ExpressionUUID->"991be709-e385-4952-b249-\
98d0ddcaef40"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Operator does not work well - There are, however, some computations that take \
quite long. We should do a notebook with those, and if at some point \
investigate if we can improve them. \
\>", "Section",
 CellChangeTimes->{{3.8135501127510157`*^9, 3.813550120601433*^9}, {
  3.817457265827755*^9, 3.817457323872397*^9}, {3.8175492665622797`*^9, 
  3.817549269160138*^9}},ExpressionUUID->"292905b3-9dd6-4a62-85a3-\
8ccf983fd97f"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<PDESymbolics2020`\>\"", "]"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"3b371471-4c33-4f86-8a52-2c2840530184"],

Cell[CellGroupData[{

Cell["SimplifyPositivityOperator", "Subsection",
 CellChangeTimes->{{3.8175492467517223`*^9, 
  3.8175492562047987`*^9}},ExpressionUUID->"e65d9629-69c9-4aaf-b8f1-\
0ad170615f3d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", "u", "}"}]}], ",", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}], ",", " ", 
     RowBox[{"\"\<pars\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}]}], ",", 
     RowBox[{"\"\<facts\>\"", "\[Rule]", 
      RowBox[{
       RowBox[{"u", "[", "x", "]"}], ">", "0"}]}]}], "|>"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SimplifyPositivityOperator", "[", "variables", "]"}], "[", 
  RowBox[{"Association", "[", 
   RowBox[{
    RowBox[{"\"\<expression\>\"", "\[Rule]", 
     RowBox[{"1", "+", " ", 
      RowBox[{"C1", " ", 
       RowBox[{
        RowBox[{"u", "'"}], "[", "x", "]"}], "  ", 
       RowBox[{
        RowBox[{"u", "[", "x", "]"}], "^", "2"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"u", "'"}], "[", "x", "]"}], "^", "4"}]}]}], ",", " ", 
    RowBox[{"\"\<coefficients\>\"", "\[Rule]", 
     RowBox[{"{", "C1", "}"}]}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.818058394893058*^9, 3.818058414539589*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"9b48ef71-88e9-43f6-8769-96a0e4f6a527"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"\<\"expression\"\>", "\[Rule]", 
           RowBox[{"1", "+", 
            SuperscriptBox[
             RowBox[{
              SuperscriptBox["u", "\[Prime]",
               MultilineFunction->None], "[", "x", "]"}], "4"]}]}], ",", 
          RowBox[{"\<\"rules\"\>", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"C1", "\[Rule]", "0"}], "}"}]}], ",", 
          RowBox[{"\<\"coefficients\"\>", "\[Rule]", 
           RowBox[{"{", "}"}]}]}], "\[RightAssociation]"}], 
        RowBox[{
         RowBox[{"u", "[", "x", "]"}], ">", "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{{3.8180583705021563`*^9, 3.818058415253972*^9}, 
   3.821262060332954*^9},
 CellLabel->
  "Out[110]=",ExpressionUUID->"fade71a2-c720-460e-9e82-99cbe0db1614"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["SolveUndeterminedCoefficientsOperatos", "Subsection",
 CellChangeTimes->{
  3.8159051556422243`*^9, {3.816499174949869*^9, 
   3.816499188753274*^9}},ExpressionUUID->"00dda868-3621-4805-a368-\
fc8ca56e7a84"],

Cell["\<\
There seems to be an issue related to Serik - diFrancesco stuff - solved? see \
particles.nb\
\>", "Text",
 CellChangeTimes->{{3.815905158476632*^9, 3.8159051758218393`*^9}, {
  3.816424581331643*^9, 3.816424583547155*^9}, {3.8164991901169653`*^9, 
  3.8164991937000504`*^9}},ExpressionUUID->"a3706572-d43c-489a-9e12-\
f566e2a1cfe4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Also the following computation is taking quite long  - there may be an issue \
with generic functions not being handled properly - investigate\
\>", "Subsection",
 CellChangeTimes->{{3.817041339164444*^9, 3.81704135301502*^9}, {
  3.817075343371759*^9, 
  3.817075371452559*^9}},ExpressionUUID->"9d5e0a90-3a90-43a3-bdbe-\
53c901fa616f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"m", ",", "u"}], "}"}]}], ",", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}], ",", 
     RowBox[{"\"\<genFuns\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"g", ",", "U", ",", "H"}], "}"}]}]}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"DisintegrateOperator", "[", "variables", "]"}], "[", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"g", "[", 
       RowBox[{"m", "[", "x", "]"}], "]"}]}], " ", 
     SuperscriptBox[
      RowBox[{
       SuperscriptBox["m", "\[Prime]",
        MultilineFunction->None], "[", "x", "]"}], "2"], " ", 
     RowBox[{
      SuperscriptBox["H", "\[Prime]\[Prime]",
       MultilineFunction->None], "[", 
      RowBox[{
       SuperscriptBox["u", "\[Prime]",
        MultilineFunction->None], "[", "x", "]"}], "]"}], " ", 
     RowBox[{
      SuperscriptBox["U", "\[Prime]\[Prime]",
       MultilineFunction->None], "[", 
      RowBox[{"m", "[", "x", "]"}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"g", "[", 
      RowBox[{"m", "[", "x", "]"}], "]"}], " ", 
     RowBox[{"m", "[", "x", "]"}], " ", 
     RowBox[{
      SuperscriptBox["m", "\[Prime]",
       MultilineFunction->None], "[", "x", "]"}], " ", 
     RowBox[{
      SuperscriptBox["u", "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "x", "]"}], " ", 
     RowBox[{
      SuperscriptBox["U", "\[Prime]\[Prime]",
       MultilineFunction->None], "[", 
      RowBox[{"m", "[", "x", "]"}], "]"}], " ", 
     RowBox[{
      SuperscriptBox["H", 
       TagBox[
        RowBox[{"(", "3", ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{
       SuperscriptBox["u", "\[Prime]",
        MultilineFunction->None], "[", "x", "]"}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"g", "[", 
      RowBox[{"m", "[", "x", "]"}], "]"}], " ", 
     RowBox[{"m", "[", "x", "]"}], " ", 
     SuperscriptBox[
      RowBox[{
       SuperscriptBox["m", "\[Prime]",
        MultilineFunction->None], "[", "x", "]"}], "2"], " ", 
     RowBox[{
      SuperscriptBox["H", "\[Prime]\[Prime]",
       MultilineFunction->None], "[", 
      RowBox[{
       SuperscriptBox["u", "\[Prime]",
        MultilineFunction->None], "[", "x", "]"}], "]"}], " ", 
     RowBox[{
      SuperscriptBox["U", 
       TagBox[
        RowBox[{"(", "3", ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"m", "[", "x", "]"}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{3.817041365074868*^9},
 CellLabel->
  "In[111]:=",ExpressionUUID->"c7046333-c10f-4af5-aaeb-4099fe2b0b18"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.821262128138321*^9},
 CellLabel->
  "Out[111]=",ExpressionUUID->"825f7585-43c0-4011-a390-215bf89bd311"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Relevant references", "Section",
 CellChangeTimes->{{3.8536538478322372`*^9, 
  3.853653853375557*^9}},ExpressionUUID->"782d019a-daba-451d-9589-\
c18a42074772"],

Cell["\<\
Ian Lisle and Tracy Huang . Algorithmic calculus for Lie determining systems. \
Journal of Symbolic Computation 79 (2017) : 482\[Dash]498.\[LineSeparator]
Greg Reid. Finding abstract Lie symmetry algebras of differential equations
without integrating determining equations. European Journal of Applied
Mathematics 2, 4 (1991): 319\[Dash]340.

*******> Algorithms for reducing a system of PDEs to standard form, \
determining the dimension of its solution space and calculating its Taylor \
series solution (this is the paper that gives the solver algorithm)

\
\>", "Text",
 CellChangeTimes->{{3.8536538550703287`*^9, 3.853653882003297*^9}, {
   3.858909273892613*^9, 3.858909282073412*^9}, 
   3.865137183285266*^9},ExpressionUUID->"80933266-b85c-4d7c-85f3-\
269854d0de88"]
}, Open  ]],

Cell[CellGroupData[{

Cell["In progress", "Section",
 CellChangeTimes->{{3.81721577927925*^9, 
  3.817215783857333*^9}},ExpressionUUID->"055d6c96-18d5-4e65-a56e-\
525d087947ce"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<PDESymbolics2020`\>\"", "]"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"41087d68-6de3-4750-9354-da34cd72999d"],

Cell[CellGroupData[{

Cell["DisintegrateOperator - this seems to be correct but ", "Subsection",
 CellChangeTimes->{{3.817443671056492*^9, 3.817443673744397*^9}, {
  3.8174440004755507`*^9, 
  3.817444007772728*^9}},ExpressionUUID->"55043cf8-4a84-428b-984f-\
3583da6ca95c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"variables", "=", 
  RowBox[{"Association", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", "u", "}"}]}], ",", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}], ",", 
     RowBox[{"\"\<depth\>\"", "\[Rule]", "1"}], ",", 
     RowBox[{"\"\<pars\>\"", "\[Rule]", 
      RowBox[{"{", "a", "}"}]}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.817443701857283*^9, 3.8174437040089407`*^9}},
 CellLabel->
  "In[112]:=",ExpressionUUID->"98fefc5c-b6e2-47d0-bb7c-44a4c7047121"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"depVars\"\>", "\[Rule]", 
    RowBox[{"{", "u", "}"}]}], ",", 
   RowBox[{"\<\"indVars\"\>", "\[Rule]", 
    RowBox[{"{", "x", "}"}]}], ",", 
   RowBox[{"\<\"depth\"\>", "\[Rule]", "1"}], ",", 
   RowBox[{"\<\"pars\"\>", "\[Rule]", 
    RowBox[{"{", "a", "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.817443705855542*^9, 3.8212621337198772`*^9},
 CellLabel->
  "Out[112]=",ExpressionUUID->"16a9e4a0-f512-4206-aade-38231d058f6c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DisintegrateOperator", "[", "variables", "]"}], "[", 
   RowBox[{"Piecewise", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"u", "[", "x", "]"}], "^", "a"}], " ", 
          RowBox[{
           RowBox[{"u", "''''"}], "[", "x", "]"}]}], ",", 
         RowBox[{"a", ">", "0"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"u", "''''"}], "[", "x", "]"}], ",", 
         RowBox[{"a", "\[Equal]", "0"}]}], "}"}]}], "}"}], ",", "$Failed"}], 
    "]"}], "]"}], "//", 
  RowBox[{"PiecewiseFullSimplifyOperator", "[", "variables", "]"}]}]], "Input",\

 CellChangeTimes->{{3.817443709033174*^9, 3.817443733023438*^9}, {
  3.817443848667721*^9, 3.81744385929364*^9}, {3.817443889410046*^9, 
  3.8174438912974777`*^9}},
 CellLabel->
  "In[113]:=",ExpressionUUID->"957f8b8f-6194-4cfb-828f-eaedab96454a"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{
         SubscriptBox["\[FormalA]", "1"], " ", 
         RowBox[{
          SuperscriptBox["u", 
           TagBox[
            RowBox[{"(", "4", ")"}],
            Derivative],
           MultilineFunction->None], "[", "x", "]"}]}], 
        RowBox[{"a", "\[Equal]", "0"}]},
       {
        RowBox[{
         FractionBox["1", "3"], " ", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], 
          RowBox[{
           RowBox[{"-", "3"}], "+", "a"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "a"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["\[FormalA]", "2"], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "a"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  SubscriptBox["\[FormalA]", "3"]}], "+", 
                 RowBox[{"a", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SubscriptBox["\[FormalA]", "4"]}], ")"}]}]}], ")"}]}]}], 
             ")"}], " ", 
            SuperscriptBox[
             RowBox[{
              SuperscriptBox["u", "\[Prime]",
               MultilineFunction->None], "[", "x", "]"}], "4"]}], "+", 
           RowBox[{"3", " ", 
            SubscriptBox["\[FormalA]", "2"], " ", 
            RowBox[{"u", "[", "x", "]"}], " ", 
            SuperscriptBox[
             RowBox[{
              SuperscriptBox["u", "\[Prime]",
               MultilineFunction->None], "[", "x", "]"}], "2"], " ", 
            RowBox[{
             SuperscriptBox["u", "\[Prime]\[Prime]",
              MultilineFunction->None], "[", "x", "]"}]}], "+", 
           RowBox[{"3", " ", 
            SubscriptBox["\[FormalA]", "3"], " ", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], "2"], " ", 
            RowBox[{
             SuperscriptBox["u", "\[Prime]",
              MultilineFunction->None], "[", "x", "]"}], " ", 
            RowBox[{
             SuperscriptBox["u", 
              TagBox[
               RowBox[{"(", "3", ")"}],
               Derivative],
              MultilineFunction->None], "[", "x", "]"}]}], "+", 
           RowBox[{"3", " ", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"a", "+", 
                 SubscriptBox["\[FormalA]", "3"], "-", 
                 RowBox[{"a", " ", 
                  SubscriptBox["\[FormalA]", "4"]}]}], ")"}], " ", 
               SuperscriptBox[
                RowBox[{
                 SuperscriptBox["u", "\[Prime]\[Prime]",
                  MultilineFunction->None], "[", "x", "]"}], "2"]}], "+", 
              RowBox[{
               SubscriptBox["\[FormalA]", "4"], " ", 
               RowBox[{"u", "[", "x", "]"}], " ", 
               RowBox[{
                SuperscriptBox["u", 
                 TagBox[
                  RowBox[{"(", "4", ")"}],
                  Derivative],
                 MultilineFunction->None], "[", "x", "]"}]}]}], ")"}]}]}], 
          ")"}]}], 
        RowBox[{"a", ">", "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{
  3.81744375176045*^9, 3.817443798693533*^9, {3.8174438526635838`*^9, 
   3.817443860052908*^9}, {3.817443894142836*^9, 3.817443926379096*^9}, 
   3.821262137037685*^9},
 CellLabel->
  "Out[113]=",ExpressionUUID->"1f210945-f3a0-4b36-804f-44e393a60e5d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FullSimplify", "[", "%", "]"}], "/.", 
   RowBox[{"a", "\[Rule]", "1"}]}], "//", "Expand"}]], "Input",
 CellChangeTimes->{{3.8174439165585823`*^9, 3.817443921843501*^9}, {
  3.821262152595993*^9, 3.8212621614588614`*^9}},
 CellLabel->
  "In[116]:=",ExpressionUUID->"c8e41661-90e3-4688-9f33-a0514ab342e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SubscriptBox["\[FormalA]", "2"], " ", 
     SuperscriptBox[
      RowBox[{
       SuperscriptBox["u", "\[Prime]",
        MultilineFunction->None], "[", "x", "]"}], "4"]}], 
    RowBox[{"3", " ", 
     SuperscriptBox[
      RowBox[{"u", "[", "x", "]"}], "2"]}]]}], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["\[FormalA]", "2"], " ", 
    SuperscriptBox[
     RowBox[{
      SuperscriptBox["u", "\[Prime]",
       MultilineFunction->None], "[", "x", "]"}], "2"], " ", 
    RowBox[{
     SuperscriptBox["u", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "x", "]"}]}], 
   RowBox[{"u", "[", "x", "]"}]], "+", 
  SuperscriptBox[
   RowBox[{
    SuperscriptBox["u", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "x", "]"}], "2"], "+", 
  RowBox[{
   SubscriptBox["\[FormalA]", "3"], " ", 
   SuperscriptBox[
    RowBox[{
     SuperscriptBox["u", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "x", "]"}], "2"]}], "-", 
  RowBox[{
   SubscriptBox["\[FormalA]", "4"], " ", 
   SuperscriptBox[
    RowBox[{
     SuperscriptBox["u", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "x", "]"}], "2"]}], "+", 
  RowBox[{
   SubscriptBox["\[FormalA]", "3"], " ", 
   RowBox[{
    SuperscriptBox["u", "\[Prime]",
     MultilineFunction->None], "[", "x", "]"}], " ", 
   RowBox[{
    SuperscriptBox["u", 
     TagBox[
      RowBox[{"(", "3", ")"}],
      Derivative],
     MultilineFunction->None], "[", "x", "]"}]}], "+", 
  RowBox[{
   SubscriptBox["\[FormalA]", "4"], " ", 
   RowBox[{"u", "[", "x", "]"}], " ", 
   RowBox[{
    SuperscriptBox["u", 
     TagBox[
      RowBox[{"(", "4", ")"}],
      Derivative],
     MultilineFunction->None], "[", "x", "]"}]}]}]], "Output",
 CellChangeTimes->{{3.817443922719184*^9, 3.817443928370462*^9}, {
  3.8212621417771673`*^9, 3.8212621623915052`*^9}},
 CellLabel->
  "Out[116]=",ExpressionUUID->"f1193209-fe59-44ef-894b-8cbdefd1afee"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["MfG with congestion - SEEMS TO HAVE ISSUES", "Subsection",
 CellChangeTimes->{{3.817017179154853*^9, 3.817017186187282*^9}, {
  3.8170269292920923`*^9, 3.817026935899173*^9}, {3.817027019916419*^9, 
  3.8170270269232893`*^9}},ExpressionUUID->"d3b96470-36ff-4380-a3b6-\
d92bc410da06"],

Cell[BoxData[
 RowBox[{"ConservedDensity", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"v", "[", "x", "]"}], "^", "2"}], "/", 
        RowBox[{"(", 
         RowBox[{"2", " ", 
          RowBox[{
           RowBox[{"m", "[", "x", "]"}], "^", "a"}]}], ")"}]}], ",", "x"}], 
      "]"}], ",", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"m", "[", "x", "]"}], "^", 
         RowBox[{"(", 
          RowBox[{"1", "-", "a"}], ")"}]}], " ", 
        RowBox[{"v", "[", "x", "]"}]}], ",", "x"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"v", ",", "m"}], "}"}], ",", 
   RowBox[{"{", "x", "}"}], ",", 
   RowBox[{"Generators", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"v", "[", "x", "]"}], ",", 
      RowBox[{"m", "[", "x", "]"}], ",", 
      RowBox[{"1", "/", 
       RowBox[{"m", "[", "x", "]"}]}], ",", 
      RowBox[{
       RowBox[{"m", "[", "x", "]"}], "^", 
       RowBox[{"(", 
        RowBox[{"-", "a"}], ")"}]}]}], "}"}]}], ",", 
   RowBox[{"Deg", "\[Rule]", 
    RowBox[{"{", "3", "}"}]}], ",", 
   RowBox[{"Der", "\[Rule]", 
    RowBox[{"{", "0", "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.817017187241416*^9, 3.817017187247929*^9}, {
  3.821262215676065*^9, 
  3.821262219475624*^9}},ExpressionUUID->"024fb811-0a10-4321-9fc9-\
799ec9a9e7f2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Association", "[", "\n", "        ", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"v", ",", "m"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{"\"\<eqRhs\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"v", "[", "x", "]"}], "^", "2"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{
              RowBox[{"m", "[", "x", "]"}], "^", "a"}]}], ")"}]}], ",", "x"}],
          "]"}], ",", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"m", "[", "x", "]"}], "^", 
            RowBox[{"(", 
             RowBox[{"1", "-", "a"}], ")"}]}], " ", 
           RowBox[{"v", "[", "x", "]"}]}], ",", "x"}], "]"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<pars\>\"", "\[Rule]", 
      RowBox[{"{", "a", "}"}]}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{"\"\<Beautify\>\"", "\[Rule]", "False"}]}], "\n", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"FindConservedQuantityBasisOperator", "[", "variables", "]"}], "[", 
  
  RowBox[{"Association", "[", 
   RowBox[{
    RowBox[{"\"\<degree\>\"", "\[Rule]", "3"}], ",", " ", 
    RowBox[{"\"\<generators\>\"", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"v", "[", "x", "]"}], ",", 
       RowBox[{"m", "[", "x", "]"}], ",", 
       RowBox[{"1", "/", 
        RowBox[{"m", "[", "x", "]"}]}], ",", 
       RowBox[{
        RowBox[{"m", "[", "x", "]"}], "^", 
        RowBox[{"(", 
         RowBox[{"-", "a"}], ")"}]}]}], "}"}]}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8170268118944693`*^9, 3.817026835276758*^9}, {
  3.817215973284429*^9, 3.817215997239716*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"f0411a63-ea80-49ef-89ed-a4d5472e00c0"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.817026912697935*^9, 3.817215979279182*^9, 
  3.817216101515349*^9, 3.8212622542424507`*^9},
 CellLabel->
  "Out[118]=",ExpressionUUID->"44aa5b8b-f454-47cb-9884-7ab3095ef4fe"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Association", "[", "\n", "        ", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"v", ",", "m"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{"\"\<eqRhs\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"v", "[", "x", "]"}], "^", "2"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{
              RowBox[{"m", "[", "x", "]"}], "^", "a"}]}], ")"}]}], ",", "x"}],
          "]"}], ",", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"m", "[", "x", "]"}], "^", 
            RowBox[{"(", 
             RowBox[{"1", "-", "a"}], ")"}]}], " ", 
           RowBox[{"v", "[", "x", "]"}]}], ",", "x"}], "]"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<pars\>\"", "\[Rule]", 
      RowBox[{"{", "a", "}"}]}]}], "\n", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MonomialsOperator", "[", "variables", "]"}], "[", 
  RowBox[{"Association", "[", 
   RowBox[{
    RowBox[{"\"\<degree\>\"", "\[Rule]", "3"}], ",", " ", 
    RowBox[{"\"\<generators\>\"", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"v", "[", "x", "]"}], ",", 
       RowBox[{"m", "[", "x", "]"}], ",", 
       RowBox[{"1", "/", 
        RowBox[{"m", "[", "x", "]"}]}], ",", 
       RowBox[{
        RowBox[{"m", "[", "x", "]"}], "^", 
        RowBox[{"(", 
         RowBox[{"-", "a"}], ")"}]}]}], "}"}]}], ",", 
    RowBox[{"\"\<eliminateequalities\>\"", "\[Rule]", "False"}]}], "]"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.817215950678606*^9, 3.817215990110586*^9}, 
   3.817216642990426*^9, 3.817217114492094*^9, {3.8174440554666643`*^9, 
   3.8174440641534233`*^9}, 3.817444112800555*^9, {3.8174441941544313`*^9, 
   3.817444194616126*^9}, {3.817444243340328*^9, 3.817444244310318*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"8f68a193-6257-4b09-b202-7291663d3070"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   RowBox[{"v", "[", "x", "]"}], ",", 
   SuperscriptBox[
    RowBox[{"v", "[", "x", "]"}], "2"], ",", 
   SuperscriptBox[
    RowBox[{"v", "[", "x", "]"}], "3"], ",", 
   RowBox[{"m", "[", "x", "]"}], ",", 
   RowBox[{
    RowBox[{"m", "[", "x", "]"}], " ", 
    RowBox[{"v", "[", "x", "]"}]}], ",", 
   RowBox[{
    RowBox[{"m", "[", "x", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"v", "[", "x", "]"}], "2"]}], ",", 
   SuperscriptBox[
    RowBox[{"m", "[", "x", "]"}], "2"], ",", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"m", "[", "x", "]"}], "2"], " ", 
    RowBox[{"v", "[", "x", "]"}]}], ",", 
   SuperscriptBox[
    RowBox[{"m", "[", "x", "]"}], "3"], ",", 
   FractionBox["1", 
    RowBox[{"m", "[", "x", "]"}]], ",", 
   FractionBox[
    RowBox[{"v", "[", "x", "]"}], 
    RowBox[{"m", "[", "x", "]"}]], ",", 
   FractionBox[
    SuperscriptBox[
     RowBox[{"v", "[", "x", "]"}], "2"], 
    RowBox[{"m", "[", "x", "]"}]], ",", "1", ",", 
   RowBox[{"v", "[", "x", "]"}], ",", 
   RowBox[{"m", "[", "x", "]"}], ",", 
   FractionBox["1", 
    SuperscriptBox[
     RowBox[{"m", "[", "x", "]"}], "2"]], ",", 
   FractionBox[
    RowBox[{"v", "[", "x", "]"}], 
    SuperscriptBox[
     RowBox[{"m", "[", "x", "]"}], "2"]], ",", 
   FractionBox["1", 
    RowBox[{"m", "[", "x", "]"}]], ",", 
   FractionBox["1", 
    SuperscriptBox[
     RowBox[{"m", "[", "x", "]"}], "3"]], ",", 
   SuperscriptBox[
    RowBox[{"m", "[", "x", "]"}], 
    RowBox[{"-", "a"}]], ",", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"m", "[", "x", "]"}], 
     RowBox[{"-", "a"}]], " ", 
    RowBox[{"v", "[", "x", "]"}]}], ",", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"m", "[", "x", "]"}], 
     RowBox[{"-", "a"}]], " ", 
    SuperscriptBox[
     RowBox[{"v", "[", "x", "]"}], "2"]}], ",", 
   SuperscriptBox[
    RowBox[{"m", "[", "x", "]"}], 
    RowBox[{"1", "-", "a"}]], ",", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"m", "[", "x", "]"}], 
     RowBox[{"1", "-", "a"}]], " ", 
    RowBox[{"v", "[", "x", "]"}]}], ",", 
   SuperscriptBox[
    RowBox[{"m", "[", "x", "]"}], 
    RowBox[{"2", "-", "a"}]], ",", 
   SuperscriptBox[
    RowBox[{"m", "[", "x", "]"}], 
    RowBox[{
     RowBox[{"-", "1"}], "-", "a"}]], ",", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"m", "[", "x", "]"}], 
     RowBox[{
      RowBox[{"-", "1"}], "-", "a"}]], " ", 
    RowBox[{"v", "[", "x", "]"}]}], ",", 
   SuperscriptBox[
    RowBox[{"m", "[", "x", "]"}], 
    RowBox[{"-", "a"}]], ",", 
   SuperscriptBox[
    RowBox[{"m", "[", "x", "]"}], 
    RowBox[{
     RowBox[{"-", "2"}], "-", "a"}]], ",", 
   SuperscriptBox[
    RowBox[{"m", "[", "x", "]"}], 
    RowBox[{
     RowBox[{"-", "2"}], " ", "a"}]], ",", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"m", "[", "x", "]"}], 
     RowBox[{
      RowBox[{"-", "2"}], " ", "a"}]], " ", 
    RowBox[{"v", "[", "x", "]"}]}], ",", 
   SuperscriptBox[
    RowBox[{"m", "[", "x", "]"}], 
    RowBox[{"1", "-", 
     RowBox[{"2", " ", "a"}]}]], ",", 
   SuperscriptBox[
    RowBox[{"m", "[", "x", "]"}], 
    RowBox[{
     RowBox[{"-", "1"}], "-", 
     RowBox[{"2", " ", "a"}]}]], ",", 
   SuperscriptBox[
    RowBox[{"m", "[", "x", "]"}], 
    RowBox[{
     RowBox[{"-", "3"}], " ", "a"}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.817215963737447*^9, 3.817215991066359*^9}, 
   3.8172161066297493`*^9, 3.817216644111771*^9, 3.8172171151025333`*^9, 
   3.817444025067748*^9, 3.8174441138138943`*^9, 3.817444195376749*^9, 
   3.817444244636538*^9, 3.821262260585616*^9},
 CellLabel->
  "Out[120]=",ExpressionUUID->"9e785396-ae7b-4fb6-80cd-ce6d718e3166"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"BasisOperator", "[", "variables", "]"}], "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", 
    RowBox[{"v", "[", "x", "]"}], ",", 
    SuperscriptBox[
     RowBox[{"v", "[", "x", "]"}], "2"], ",", 
    SuperscriptBox[
     RowBox[{"v", "[", "x", "]"}], "3"], ",", 
    RowBox[{"m", "[", "x", "]"}], ",", 
    RowBox[{
     RowBox[{"m", "[", "x", "]"}], " ", 
     RowBox[{"v", "[", "x", "]"}]}], ",", 
    RowBox[{
     RowBox[{"m", "[", "x", "]"}], " ", 
     SuperscriptBox[
      RowBox[{"v", "[", "x", "]"}], "2"]}], ",", 
    SuperscriptBox[
     RowBox[{"m", "[", "x", "]"}], "2"], ",", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"m", "[", "x", "]"}], "2"], " ", 
     RowBox[{"v", "[", "x", "]"}]}], ",", 
    SuperscriptBox[
     RowBox[{"m", "[", "x", "]"}], "3"], ",", 
    FractionBox["1", 
     RowBox[{"m", "[", "x", "]"}]], ",", 
    FractionBox[
     RowBox[{"v", "[", "x", "]"}], 
     RowBox[{"m", "[", "x", "]"}]], ",", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"v", "[", "x", "]"}], "2"], 
     RowBox[{"m", "[", "x", "]"}]], ",", "1", ",", 
    RowBox[{"v", "[", "x", "]"}], ",", 
    RowBox[{"m", "[", "x", "]"}], ",", 
    FractionBox["1", 
     SuperscriptBox[
      RowBox[{"m", "[", "x", "]"}], "2"]], ",", 
    FractionBox[
     RowBox[{"v", "[", "x", "]"}], 
     SuperscriptBox[
      RowBox[{"m", "[", "x", "]"}], "2"]], ",", 
    FractionBox["1", 
     RowBox[{"m", "[", "x", "]"}]], ",", 
    FractionBox["1", 
     SuperscriptBox[
      RowBox[{"m", "[", "x", "]"}], "3"]], ",", 
    SuperscriptBox[
     RowBox[{"m", "[", "x", "]"}], 
     RowBox[{"-", "a"}]], ",", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"m", "[", "x", "]"}], 
      RowBox[{"-", "a"}]], " ", 
     RowBox[{"v", "[", "x", "]"}]}], ",", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"m", "[", "x", "]"}], 
      RowBox[{"-", "a"}]], " ", 
     SuperscriptBox[
      RowBox[{"v", "[", "x", "]"}], "2"]}], ",", 
    SuperscriptBox[
     RowBox[{"m", "[", "x", "]"}], 
     RowBox[{"1", "-", "a"}]], ",", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"m", "[", "x", "]"}], 
      RowBox[{"1", "-", "a"}]], " ", 
     RowBox[{"v", "[", "x", "]"}]}], ",", 
    SuperscriptBox[
     RowBox[{"m", "[", "x", "]"}], 
     RowBox[{"2", "-", "a"}]], ",", 
    SuperscriptBox[
     RowBox[{"m", "[", "x", "]"}], 
     RowBox[{
      RowBox[{"-", "1"}], "-", "a"}]], ",", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"m", "[", "x", "]"}], 
      RowBox[{
       RowBox[{"-", "1"}], "-", "a"}]], " ", 
     RowBox[{"v", "[", "x", "]"}]}], ",", 
    SuperscriptBox[
     RowBox[{"m", "[", "x", "]"}], 
     RowBox[{"-", "a"}]], ",", 
    SuperscriptBox[
     RowBox[{"m", "[", "x", "]"}], 
     RowBox[{
      RowBox[{"-", "2"}], "-", "a"}]], ",", 
    SuperscriptBox[
     RowBox[{"m", "[", "x", "]"}], 
     RowBox[{
      RowBox[{"-", "2"}], " ", "a"}]], ",", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"m", "[", "x", "]"}], 
      RowBox[{
       RowBox[{"-", "2"}], " ", "a"}]], " ", 
     RowBox[{"v", "[", "x", "]"}]}], ",", 
    SuperscriptBox[
     RowBox[{"m", "[", "x", "]"}], 
     RowBox[{"1", "-", 
      RowBox[{"2", " ", "a"}]}]], ",", 
    SuperscriptBox[
     RowBox[{"m", "[", "x", "]"}], 
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      RowBox[{"2", " ", "a"}]}]], ",", 
    SuperscriptBox[
     RowBox[{"m", "[", "x", "]"}], 
     RowBox[{
      RowBox[{"-", "3"}], " ", "a"}]]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.817215967635529*^9, 3.817215970681686*^9}, {
   3.8172161107914677`*^9, 3.8172161242555*^9}, {3.8172163131060038`*^9, 
   3.817216344160494*^9}, {3.817216606931513*^9, 3.817216624150893*^9}, {
   3.81721712025439*^9, 3.8172171350795393`*^9}, 3.817217183697832*^9, {
   3.817217230476964*^9, 3.817217234985817*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"23189629-0fc2-4f2a-9e87-2a602f0d0736"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{{3.81721630187276*^9, 3.817216336173666*^9}, 
   3.817216372692164*^9, {3.817216613410598*^9, 3.817216636454123*^9}, {
   3.817217107848675*^9, 3.817217122390334*^9}, {3.817217179751687*^9, 
   3.817217187119706*^9}, 3.817217219902382*^9, 3.817217403238545*^9, 
   3.8174440486831007`*^9, 3.8174441554612417`*^9, 3.817444471093951*^9},
 CellLabel->"Out[49]=",ExpressionUUID->"852c32c7-c40b-415e-80f1-69def7ed1074"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"BasisOperator", "[", "variables", "]"}], "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"v", "[", "x", "]"}], ",", 
    RowBox[{"m", "[", "x", "]"}], ",", 
    RowBox[{"1", "/", 
     RowBox[{"m", "[", "x", "]"}]}], ",", 
    RowBox[{
     RowBox[{"m", "[", "x", "]"}], "^", 
     RowBox[{"(", 
      RowBox[{"-", "a"}], ")"}]}], ",", 
    SuperscriptBox[
     RowBox[{"m", "[", "x", "]"}], 
     RowBox[{
      RowBox[{"-", "2"}], "-", "a"}]], ",", 
    SuperscriptBox[
     RowBox[{"m", "[", "x", "]"}], 
     RowBox[{
      RowBox[{"-", "2"}], " ", "a"}]], ",", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"m", "[", "x", "]"}], 
      RowBox[{
       RowBox[{"-", "2"}], " ", "a"}]], " ", 
     RowBox[{"v", "[", "x", "]"}]}], " ", ",", " ", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"m", "[", "x", "]"}], 
      RowBox[{"-", "a"}]], " ", 
     SuperscriptBox[
      RowBox[{"v", "[", "x", "]"}], "2"]}], ",", 
    SuperscriptBox[
     RowBox[{"m", "[", "x", "]"}], 
     RowBox[{"1", "-", "a"}]], ",", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"m", "[", "x", "]"}], 
      RowBox[{"1", "-", "a"}]], " ", 
     RowBox[{"v", "[", "x", "]"}]}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.817444161742557*^9, 3.817444164358479*^9}, {
  3.817444235946991*^9, 3.817444236400852*^9}, {3.817444309855577*^9, 
  3.817444319495187*^9}},
 CellLabel->
  "In[121]:=",ExpressionUUID->"5b295dad-254f-4b27-9476-cbe9bdca8767"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"{", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"m", "[", "x", "]"}]], ",", 
          RowBox[{"m", "[", "x", "]"}], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], 
           RowBox[{"1", "-", "a"}]], ",", 
          RowBox[{"v", "[", "x", "]"}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{"1", "-", "a"}]], " ", 
           RowBox[{"v", "[", "x", "]"}]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{"-", "a"}]], " ", 
           SuperscriptBox[
            RowBox[{"v", "[", "x", "]"}], "2"]}]}], "}"}], 
        RowBox[{"a", "\[Equal]", 
         RowBox[{"-", "1"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"m", "[", "x", "]"}]], ",", 
          RowBox[{"m", "[", "x", "]"}], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], 
           RowBox[{
            RowBox[{"-", "2"}], "-", "a"}]], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], 
           RowBox[{"-", "a"}]], ",", 
          RowBox[{"v", "[", "x", "]"}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{"1", "-", "a"}]], " ", 
           RowBox[{"v", "[", "x", "]"}]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{
             RowBox[{"-", "2"}], " ", "a"}]], " ", 
           RowBox[{"v", "[", "x", "]"}]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{"-", "a"}]], " ", 
           SuperscriptBox[
            RowBox[{"v", "[", "x", "]"}], "2"]}]}], "}"}], 
        RowBox[{"a", "\[Equal]", "2"}]},
       {
        RowBox[{"{", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"m", "[", "x", "]"}]], ",", 
          RowBox[{"m", "[", "x", "]"}], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], 
           RowBox[{
            RowBox[{"-", "2"}], "-", "a"}]], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], 
           RowBox[{"1", "-", "a"}]], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], 
           RowBox[{"-", "a"}]], ",", 
          RowBox[{"v", "[", "x", "]"}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{"1", "-", "a"}]], " ", 
           RowBox[{"v", "[", "x", "]"}]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{
             RowBox[{"-", "2"}], " ", "a"}]], " ", 
           RowBox[{"v", "[", "x", "]"}]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{"-", "a"}]], " ", 
           SuperscriptBox[
            RowBox[{"v", "[", "x", "]"}], "2"]}]}], "}"}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", 
          RowBox[{"-", 
           FractionBox["1", "2"]}]}], "||", 
         RowBox[{"a", "\[Equal]", 
          FractionBox["1", "2"]}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"m", "[", "x", "]"}]], ",", 
          RowBox[{"m", "[", "x", "]"}], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], 
           RowBox[{
            RowBox[{"-", "2"}], "-", "a"}]], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], 
           RowBox[{"1", "-", "a"}]], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], 
           RowBox[{
            RowBox[{"-", "2"}], " ", "a"}]], ",", 
          RowBox[{"v", "[", "x", "]"}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{
             RowBox[{"-", "2"}], " ", "a"}]], " ", 
           RowBox[{"v", "[", "x", "]"}]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{"-", "a"}]], " ", 
           SuperscriptBox[
            RowBox[{"v", "[", "x", "]"}], "2"]}]}], "}"}], 
        RowBox[{"a", "\[Equal]", "1"}]},
       {
        RowBox[{"{", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"m", "[", "x", "]"}]], ",", 
          RowBox[{"m", "[", "x", "]"}], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], 
           RowBox[{"1", "-", "a"}]], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], 
           RowBox[{
            RowBox[{"-", "2"}], " ", "a"}]], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], 
           RowBox[{"-", "a"}]], ",", 
          RowBox[{"v", "[", "x", "]"}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{"1", "-", "a"}]], " ", 
           RowBox[{"v", "[", "x", "]"}]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{
             RowBox[{"-", "2"}], " ", "a"}]], " ", 
           RowBox[{"v", "[", "x", "]"}]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{"-", "a"}]], " ", 
           SuperscriptBox[
            RowBox[{"v", "[", "x", "]"}], "2"]}]}], "}"}], 
        RowBox[{"a", "\[Equal]", 
         RowBox[{"-", "3"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"m", "[", "x", "]"}]], ",", 
          RowBox[{"m", "[", "x", "]"}], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], 
           RowBox[{
            RowBox[{"-", "2"}], "-", "a"}]], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], 
           RowBox[{
            RowBox[{"-", "2"}], " ", "a"}]], ",", 
          RowBox[{"v", "[", "x", "]"}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{"1", "-", "a"}]], " ", 
           RowBox[{"v", "[", "x", "]"}]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{"-", "a"}]], " ", 
           SuperscriptBox[
            RowBox[{"v", "[", "x", "]"}], "2"]}]}], "}"}], 
        RowBox[{"a", "\[Equal]", "0"}]},
       {
        RowBox[{"{", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"m", "[", "x", "]"}]], ",", 
          RowBox[{"m", "[", "x", "]"}], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], 
           RowBox[{
            RowBox[{"-", "2"}], "-", "a"}]], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], 
           RowBox[{"1", "-", "a"}]], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], 
           RowBox[{
            RowBox[{"-", "2"}], " ", "a"}]], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], 
           RowBox[{"-", "a"}]], ",", 
          RowBox[{"v", "[", "x", "]"}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{"1", "-", "a"}]], " ", 
           RowBox[{"v", "[", "x", "]"}]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{
             RowBox[{"-", "2"}], " ", "a"}]], " ", 
           RowBox[{"v", "[", "x", "]"}]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{"-", "a"}]], " ", 
           SuperscriptBox[
            RowBox[{"v", "[", "x", "]"}], "2"]}]}], "}"}], 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "a"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "a"}], ")"}], " ", "a", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "a"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"3", "+", "a"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "a"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"2", " ", "a"}]}], ")"}]}], "\[NotEqual]", "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{{3.817444165040522*^9, 3.81744424977013*^9}, {
   3.8174443183570538`*^9, 3.817444321728849*^9}, 3.821262272168723*^9},
 CellLabel->
  "Out[121]=",ExpressionUUID->"690b164d-a2be-421c-b128-a54d7f612f5d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"BasisModNullLagrangiansOperator", "[", "variables", "]"}], "[", 
  "%", "]"}]], "Input",
 CellChangeTimes->{{3.817217194283163*^9, 3.817217199539229*^9}, {
  3.81744420601604*^9, 3.817444217216898*^9}, {3.817444259941825*^9, 
  3.817444260204939*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"3a345826-5a25-4e0c-91bf-27a5758abd87"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"{", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"m", "[", "x", "]"}]], ",", 
          RowBox[{"m", "[", "x", "]"}], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], 
           RowBox[{"1", "-", "a"}]], ",", 
          RowBox[{"v", "[", "x", "]"}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{"1", "-", "a"}]], " ", 
           RowBox[{"v", "[", "x", "]"}]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{"-", "a"}]], " ", 
           SuperscriptBox[
            RowBox[{"v", "[", "x", "]"}], "2"]}]}], "}"}], 
        RowBox[{"a", "\[Equal]", 
         RowBox[{"-", "1"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"m", "[", "x", "]"}]], ",", 
          RowBox[{"m", "[", "x", "]"}], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], 
           RowBox[{
            RowBox[{"-", "2"}], "-", "a"}]], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], 
           RowBox[{"-", "a"}]], ",", 
          RowBox[{"v", "[", "x", "]"}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{"1", "-", "a"}]], " ", 
           RowBox[{"v", "[", "x", "]"}]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{
             RowBox[{"-", "2"}], " ", "a"}]], " ", 
           RowBox[{"v", "[", "x", "]"}]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{"-", "a"}]], " ", 
           SuperscriptBox[
            RowBox[{"v", "[", "x", "]"}], "2"]}]}], "}"}], 
        RowBox[{"a", "\[Equal]", "2"}]},
       {
        RowBox[{"{", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"m", "[", "x", "]"}]], ",", 
          RowBox[{"m", "[", "x", "]"}], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], 
           RowBox[{
            RowBox[{"-", "2"}], "-", "a"}]], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], 
           RowBox[{"1", "-", "a"}]], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], 
           RowBox[{"-", "a"}]], ",", 
          RowBox[{"v", "[", "x", "]"}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{"1", "-", "a"}]], " ", 
           RowBox[{"v", "[", "x", "]"}]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{
             RowBox[{"-", "2"}], " ", "a"}]], " ", 
           RowBox[{"v", "[", "x", "]"}]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{"-", "a"}]], " ", 
           SuperscriptBox[
            RowBox[{"v", "[", "x", "]"}], "2"]}]}], "}"}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", 
          RowBox[{"-", 
           FractionBox["1", "2"]}]}], "||", 
         RowBox[{"a", "\[Equal]", 
          FractionBox["1", "2"]}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"m", "[", "x", "]"}]], ",", 
          RowBox[{"m", "[", "x", "]"}], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], 
           RowBox[{
            RowBox[{"-", "2"}], "-", "a"}]], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], 
           RowBox[{
            RowBox[{"-", "2"}], " ", "a"}]], ",", 
          RowBox[{"v", "[", "x", "]"}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{
             RowBox[{"-", "2"}], " ", "a"}]], " ", 
           RowBox[{"v", "[", "x", "]"}]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{"-", "a"}]], " ", 
           SuperscriptBox[
            RowBox[{"v", "[", "x", "]"}], "2"]}]}], "}"}], 
        RowBox[{"a", "\[Equal]", "1"}]},
       {
        RowBox[{"{", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"m", "[", "x", "]"}]], ",", 
          RowBox[{"m", "[", "x", "]"}], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], 
           RowBox[{"1", "-", "a"}]], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], 
           RowBox[{
            RowBox[{"-", "2"}], " ", "a"}]], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], 
           RowBox[{"-", "a"}]], ",", 
          RowBox[{"v", "[", "x", "]"}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{"1", "-", "a"}]], " ", 
           RowBox[{"v", "[", "x", "]"}]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{
             RowBox[{"-", "2"}], " ", "a"}]], " ", 
           RowBox[{"v", "[", "x", "]"}]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{"-", "a"}]], " ", 
           SuperscriptBox[
            RowBox[{"v", "[", "x", "]"}], "2"]}]}], "}"}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", 
          RowBox[{"-", "3"}]}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "\[Equal]", 
            RowBox[{"-", "2"}]}], "&&", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", "6"}], " ", "a"}], "+", 
             SuperscriptBox["a", "2"], "+", 
             RowBox[{"31", " ", 
              SuperscriptBox["a", "3"]}], "-", 
             RowBox[{"5", " ", 
              SuperscriptBox["a", "4"]}], "-", 
             RowBox[{"29", " ", 
              SuperscriptBox["a", "5"]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["a", "6"]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["a", "7"]}]}], "\[NotEqual]", "0"}], "&&", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", "12"}], " ", "a"}], "-", 
             RowBox[{"4", " ", 
              SuperscriptBox["a", "2"]}], "+", 
             RowBox[{"63", " ", 
              SuperscriptBox["a", "3"]}], "+", 
             RowBox[{"21", " ", 
              SuperscriptBox["a", "4"]}], "-", 
             RowBox[{"63", " ", 
              SuperscriptBox["a", "5"]}], "-", 
             RowBox[{"21", " ", 
              SuperscriptBox["a", "6"]}], "+", 
             RowBox[{"12", " ", 
              SuperscriptBox["a", "7"]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["a", "8"]}]}], "\[Equal]", "0"}]}], ")"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"m", "[", "x", "]"}]], ",", 
          RowBox[{"m", "[", "x", "]"}], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], 
           RowBox[{
            RowBox[{"-", "2"}], "-", "a"}]], ",", 
          RowBox[{"v", "[", "x", "]"}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{"1", "-", "a"}]], " ", 
           RowBox[{"v", "[", "x", "]"}]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{"-", "a"}]], " ", 
           SuperscriptBox[
            RowBox[{"v", "[", "x", "]"}], "2"]}]}], "}"}], 
        RowBox[{"a", "\[Equal]", "0"}]},
       {
        RowBox[{"{", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"m", "[", "x", "]"}]], ",", 
          RowBox[{"m", "[", "x", "]"}], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], 
           RowBox[{
            RowBox[{"-", "2"}], "-", "a"}]], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], 
           RowBox[{"1", "-", "a"}]], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], 
           RowBox[{
            RowBox[{"-", "2"}], " ", "a"}]], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], 
           RowBox[{"-", "a"}]], ",", 
          RowBox[{"v", "[", "x", "]"}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{"1", "-", "a"}]], " ", 
           RowBox[{"v", "[", "x", "]"}]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{
             RowBox[{"-", "2"}], " ", "a"}]], " ", 
           RowBox[{"v", "[", "x", "]"}]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{"-", "a"}]], " ", 
           SuperscriptBox[
            RowBox[{"v", "[", "x", "]"}], "2"]}]}], "}"}], 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "6"}], " ", "a"}], "+", 
           SuperscriptBox["a", "2"], "+", 
           RowBox[{"31", " ", 
            SuperscriptBox["a", "3"]}], "-", 
           RowBox[{"5", " ", 
            SuperscriptBox["a", "4"]}], "-", 
           RowBox[{"29", " ", 
            SuperscriptBox["a", "5"]}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["a", "6"]}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["a", "7"]}]}], "\[NotEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "12"}], " ", "a"}], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["a", "2"]}], "+", 
           RowBox[{"63", " ", 
            SuperscriptBox["a", "3"]}], "+", 
           RowBox[{"21", " ", 
            SuperscriptBox["a", "4"]}], "-", 
           RowBox[{"63", " ", 
            SuperscriptBox["a", "5"]}], "-", 
           RowBox[{"21", " ", 
            SuperscriptBox["a", "6"]}], "+", 
           RowBox[{"12", " ", 
            SuperscriptBox["a", "7"]}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["a", "8"]}]}], "\[NotEqual]", "0"}]}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{
  3.8172172006366243`*^9, {3.817444184572749*^9, 3.817444222148178*^9}, 
   3.817444261352313*^9, 3.8174443270236397`*^9},
 CellLabel->"Out[47]=",ExpressionUUID->"3d1e6fc6-310e-4cb2-92b0-f054949c151e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", 
  RowBox[{"PiecewiseSimplifyOperator", "[", "variables", "]"}]}]], "Input",
 CellChangeTimes->{{3.817444266597472*^9, 3.817444274558784*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"eb80b10a-d775-406b-b909-18f6afe29353"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"{", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"m", "[", "x", "]"}]], ",", 
          RowBox[{"m", "[", "x", "]"}], ",", 
          FractionBox["1", 
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], "2"]], ",", 
          RowBox[{"v", "[", "x", "]"}], ",", 
          RowBox[{
           RowBox[{"m", "[", "x", "]"}], " ", 
           RowBox[{"v", "[", "x", "]"}]}], ",", 
          SuperscriptBox[
           RowBox[{"v", "[", "x", "]"}], "2"]}], "}"}], 
        RowBox[{"a", "\[Equal]", "0"}]},
       {
        RowBox[{"{", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"m", "[", "x", "]"}]], ",", 
          RowBox[{"m", "[", "x", "]"}], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], "2"], ",", 
          RowBox[{"v", "[", "x", "]"}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], "2"], " ", 
           RowBox[{"v", "[", "x", "]"}]}], ",", 
          RowBox[{
           RowBox[{"m", "[", "x", "]"}], " ", 
           SuperscriptBox[
            RowBox[{"v", "[", "x", "]"}], "2"]}]}], "}"}], 
        RowBox[{"a", "\[Equal]", 
         RowBox[{"-", "1"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"m", "[", "x", "]"}]], ",", 
          RowBox[{"m", "[", "x", "]"}], ",", 
          FractionBox["1", 
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], "3"]], ",", 
          FractionBox["1", 
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], "2"]], ",", 
          RowBox[{"v", "[", "x", "]"}], ",", 
          FractionBox[
           RowBox[{"v", "[", "x", "]"}], 
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], "2"]], ",", 
          FractionBox[
           SuperscriptBox[
            RowBox[{"v", "[", "x", "]"}], "2"], 
           RowBox[{"m", "[", "x", "]"}]]}], "}"}], 
        RowBox[{"a", "\[Equal]", "1"}]},
       {
        RowBox[{"{", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"m", "[", "x", "]"}]], ",", 
          RowBox[{"m", "[", "x", "]"}], ",", 
          FractionBox["1", 
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], "4"]], ",", 
          FractionBox["1", 
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], "2"]], ",", 
          RowBox[{"v", "[", "x", "]"}], ",", 
          FractionBox[
           RowBox[{"v", "[", "x", "]"}], 
           RowBox[{"m", "[", "x", "]"}]], ",", 
          FractionBox[
           RowBox[{"v", "[", "x", "]"}], 
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], "4"]], ",", 
          FractionBox[
           SuperscriptBox[
            RowBox[{"v", "[", "x", "]"}], "2"], 
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], "2"]]}], "}"}], 
        RowBox[{"a", "\[Equal]", "2"}]},
       {
        RowBox[{"{", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"m", "[", "x", "]"}]], ",", 
          RowBox[{"m", "[", "x", "]"}], ",", 
          FractionBox["1", 
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{"3", "/", "2"}]]], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], 
           RowBox[{"3", "/", "2"}]], ",", 
          SqrtBox[
           RowBox[{"m", "[", "x", "]"}]], ",", 
          RowBox[{"v", "[", "x", "]"}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{"3", "/", "2"}]], " ", 
           RowBox[{"v", "[", "x", "]"}]}], ",", 
          RowBox[{
           RowBox[{"m", "[", "x", "]"}], " ", 
           RowBox[{"v", "[", "x", "]"}]}], ",", 
          RowBox[{
           SqrtBox[
            RowBox[{"m", "[", "x", "]"}]], " ", 
           SuperscriptBox[
            RowBox[{"v", "[", "x", "]"}], "2"]}]}], "}"}], 
        RowBox[{"a", "\[Equal]", 
         RowBox[{"-", 
          FractionBox["1", "2"]}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"m", "[", "x", "]"}]], ",", 
          RowBox[{"m", "[", "x", "]"}], ",", 
          FractionBox["1", 
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{"5", "/", "2"}]]], ",", 
          SqrtBox[
           RowBox[{"m", "[", "x", "]"}]], ",", 
          FractionBox["1", 
           SqrtBox[
            RowBox[{"m", "[", "x", "]"}]]], ",", 
          RowBox[{"v", "[", "x", "]"}], ",", 
          RowBox[{
           SqrtBox[
            RowBox[{"m", "[", "x", "]"}]], " ", 
           RowBox[{"v", "[", "x", "]"}]}], ",", 
          FractionBox[
           RowBox[{"v", "[", "x", "]"}], 
           RowBox[{"m", "[", "x", "]"}]], ",", 
          FractionBox[
           SuperscriptBox[
            RowBox[{"v", "[", "x", "]"}], "2"], 
           SqrtBox[
            RowBox[{"m", "[", "x", "]"}]]]}], "}"}], 
        RowBox[{"a", "\[Equal]", 
         FractionBox["1", "2"]}]},
       {
        RowBox[{"{", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"m", "[", "x", "]"}]], ",", 
          RowBox[{"m", "[", "x", "]"}], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], "4"], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], "6"], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], "3"], ",", 
          RowBox[{"v", "[", "x", "]"}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], "4"], " ", 
           RowBox[{"v", "[", "x", "]"}]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], "6"], " ", 
           RowBox[{"v", "[", "x", "]"}]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], "3"], " ", 
           SuperscriptBox[
            RowBox[{"v", "[", "x", "]"}], "2"]}]}], "}"}], 
        RowBox[{"a", "\[Equal]", 
         RowBox[{"-", "3"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"m", "[", "x", "]"}]], ",", 
          RowBox[{"m", "[", "x", "]"}], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], "3"], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], "4"], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], "2"], ",", 
          RowBox[{"v", "[", "x", "]"}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], "3"], " ", 
           RowBox[{"v", "[", "x", "]"}]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], "4"], " ", 
           RowBox[{"v", "[", "x", "]"}]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"v", "[", "x", "]"}], "2"]}]}], "}"}], 
        RowBox[{"a", "\[Equal]", 
         RowBox[{"-", "2"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"m", "[", "x", "]"}]], ",", 
          RowBox[{"m", "[", "x", "]"}], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], 
           RowBox[{
            RowBox[{"-", "2"}], "-", "a"}]], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], 
           RowBox[{"1", "-", "a"}]], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], 
           RowBox[{
            RowBox[{"-", "2"}], " ", "a"}]], ",", 
          SuperscriptBox[
           RowBox[{"m", "[", "x", "]"}], 
           RowBox[{"-", "a"}]], ",", 
          RowBox[{"v", "[", "x", "]"}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{"1", "-", "a"}]], " ", 
           RowBox[{"v", "[", "x", "]"}]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{
             RowBox[{"-", "2"}], " ", "a"}]], " ", 
           RowBox[{"v", "[", "x", "]"}]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"m", "[", "x", "]"}], 
            RowBox[{"-", "a"}]], " ", 
           SuperscriptBox[
            RowBox[{"v", "[", "x", "]"}], "2"]}]}], "}"}], 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "a"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "a"}], ")"}], " ", "a", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "a"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", "a"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"3", "+", "a"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "a"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"2", " ", "a"}]}], ")"}]}], "\[NotEqual]", "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{3.817444275779043*^9, 3.817444331926868*^9},
 CellLabel->"Out[48]=",ExpressionUUID->"b08d2e1c-6279-49df-8439-f1a28247ee8c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Association", "[", "\n", "        ", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"v", ",", "m"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{"\"\<eqRhs\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"v", "[", "x", "]"}], "^", "2"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{
              RowBox[{"m", "[", "x", "]"}], "^", "a"}]}], ")"}]}], ",", "x"}],
          "]"}], ",", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"m", "[", "x", "]"}], "^", 
            RowBox[{"(", 
             RowBox[{"1", "-", "a"}], ")"}]}], " ", 
           RowBox[{"v", "[", "x", "]"}]}], ",", "x"}], "]"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<pars\>\"", "\[Rule]", 
      RowBox[{"{", "}"}]}]}], "\n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindConservedQuantityBasisOperator", "[", "variables", "]"}], "[", 
  
  RowBox[{"Association", "[", 
   RowBox[{
    RowBox[{"\"\<degree\>\"", "\[Rule]", "3"}], ",", " ", 
    RowBox[{"\"\<generators\>\"", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"v", "[", "x", "]"}], ",", 
       RowBox[{"m", "[", "x", "]"}], ",", 
       RowBox[{"1", "/", 
        RowBox[{"m", "[", "x", "]"}]}], ",", 
       RowBox[{
        RowBox[{"m", "[", "x", "]"}], "^", 
        RowBox[{"(", 
         RowBox[{"-", "a"}], ")"}]}]}], "}"}]}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.817216657562603*^9, 3.8172166579131823`*^9}, {
  3.817218650950262*^9, 
  3.817218731655102*^9}},ExpressionUUID->"34d31659-376c-469e-a929-\
77b098cfd8f4"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.817216660382062*^9, 3.81721838771601*^9, {3.817218669848845*^9, 
   3.81721868071699*^9}, 3.817218723461237*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"b8a8fb83-8906-4e2a-be5d-7b19a6ccbdd4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", "\[IndentingNewLine]", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", "u", "}"}]}], ",", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}], ",", " ", 
     RowBox[{"\"\<pars\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}]}], ",", 
     RowBox[{"\"\<eqRhs\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"u", "''"}], "[", "x", "]"}], "}"}]}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<timederivativeorder\>\"", "\[Rule]", "1"}], ",", " ", 
     RowBox[{"\"\<eliminateequalities\>\"", "\[Rule]", "False"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindConservedQuantityBasisOperator", "[", "variables", "]"}], "[", 
  
  RowBox[{"Association", "[", 
   RowBox[{
    RowBox[{"\"\<derivatives\>\"", "\[Rule]", "0"}], ",", 
    RowBox[{"\"\<degree\>\"", "\[Rule]", "4"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<generators\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u", "[", "x", "]"}], "^", "a"}], "}"}]}]}], "]"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.817444522916503*^9, 3.817444533680582*^9}, {
  3.817445006628902*^9, 3.81744500865798*^9}, {3.8212623190560837`*^9, 
  3.821262335926682*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"87b3108d-54c9-4af0-81ea-b1e249f2247e"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"{", "}"}], 
        RowBox[{
         RowBox[{"a", "\[NotEqual]", 
          FractionBox["1", "4"]}], "&&", 
         RowBox[{"a", "\[NotEqual]", 
          FractionBox["1", "3"]}], "&&", 
         RowBox[{"a", "\[NotEqual]", 
          FractionBox["1", "2"]}], "&&", 
         RowBox[{"a", "\[NotEqual]", "1"}]}]},
       {
        RowBox[{"{", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], "a"], "}"}], 
        RowBox[{"a", "\[Equal]", "1"}]},
       {
        RowBox[{"{", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], 
          RowBox[{"2", " ", "a"}]], "}"}], 
        RowBox[{"a", "\[Equal]", 
         FractionBox["1", "2"]}]},
       {
        RowBox[{"{", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], 
          RowBox[{"3", " ", "a"}]], "}"}], 
        RowBox[{"a", "\[Equal]", 
         FractionBox["1", "3"]}]},
       {
        RowBox[{"{", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], 
          RowBox[{"4", " ", "a"}]], "}"}], 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{
  3.817445038436344*^9, 3.821262288151721*^9, {3.821262319674099*^9, 
   3.821262336686488*^9}},
 CellLabel->
  "Out[129]=",ExpressionUUID->"76300c75-6782-4c5b-b53e-8a827f4dac19"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PiecewiseEliminateEqualitiesOperator", "[", "variables", "]"}], 
  "[", "%", "]"}]], "Input",
 CellChangeTimes->{{3.8212623530050087`*^9, 3.8212623851144867`*^9}},
 CellLabel->
  "In[130]:=",ExpressionUUID->"f393ba87-674e-4ea8-bdd6-b1800c31ead8"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"{", "}"}], 
        RowBox[{
         RowBox[{"a", "\[NotEqual]", 
          FractionBox["1", "4"]}], "&&", 
         RowBox[{"a", "\[NotEqual]", 
          FractionBox["1", "3"]}], "&&", 
         RowBox[{"a", "\[NotEqual]", 
          FractionBox["1", "2"]}], "&&", 
         RowBox[{"a", "\[NotEqual]", "1"}]}]},
       {
        RowBox[{"{", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], "a"], "}"}], 
        RowBox[{"a", "\[Equal]", "1"}]},
       {
        RowBox[{"{", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], 
          RowBox[{"2", " ", "a"}]], "}"}], 
        RowBox[{"a", "\[Equal]", 
         FractionBox["1", "2"]}]},
       {
        RowBox[{"{", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], 
          RowBox[{"3", " ", "a"}]], "}"}], 
        RowBox[{"a", "\[Equal]", 
         FractionBox["1", "3"]}]},
       {
        RowBox[{"{", 
         SuperscriptBox[
          RowBox[{"u", "[", "x", "]"}], 
          RowBox[{"4", " ", "a"}]], "}"}], 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{3.821262385948443*^9},
 CellLabel->
  "Out[130]=",ExpressionUUID->"8e3aad8d-d88f-4134-b3fc-8f7a218362c0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mon", "=", 
  RowBox[{
   RowBox[{"MonomialsOperator", "[", "variables", "]"}], "[", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<derivatives\>\"", "\[Rule]", "0"}], ",", 
     RowBox[{"\"\<degree\>\"", "\[Rule]", "2"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<generators\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"u", "[", "x", "]"}], "^", "a"}], ",", " ", 
        RowBox[{
         RowBox[{"u", "[", "x", "]"}], "^", "b"}]}], "}"}]}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.817217534376692*^9, 3.817217564220318*^9}, {
  3.817217624299312*^9, 3.817217624958231*^9}},
 CellLabel->
  "In[131]:=",ExpressionUUID->"5703ce60-aeb1-4135-bef7-577a8b0b1269"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   SuperscriptBox[
    RowBox[{"u", "[", "x", "]"}], "a"], ",", 
   SuperscriptBox[
    RowBox[{"u", "[", "x", "]"}], 
    RowBox[{"2", " ", "a"}]], ",", 
   SuperscriptBox[
    RowBox[{"u", "[", "x", "]"}], "b"], ",", 
   SuperscriptBox[
    RowBox[{"u", "[", "x", "]"}], 
    RowBox[{"a", "+", "b"}]], ",", 
   SuperscriptBox[
    RowBox[{"u", "[", "x", "]"}], 
    RowBox[{"2", " ", "b"}]]}], "}"}]], "Output",
 CellChangeTimes->{3.817217565359655*^9, 3.817217632670804*^9, 
  3.821262410662175*^9},
 CellLabel->
  "Out[131]=",ExpressionUUID->"ccd82a8d-7303-4d3c-97dc-6f3a20c9eb94"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<PDESymbolics2020`\>\"", "]"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"a63f873c-d45b-4675-8666-f0404b4551d3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"variables", "=", "\[IndentingNewLine]", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", "u", "}"}]}], ",", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}], ",", " ", 
     RowBox[{"\"\<pars\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}]}], ",", 
     RowBox[{"\"\<eqRhs\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"u", "''"}], "[", "x", "]"}], "}"}]}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<timederivativeorder\>\"", "\[Rule]", "1"}]}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[132]:=",ExpressionUUID->"378087c5-8987-42ce-936b-33a32842c79a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ParametricRefineOperator", "[", "variables", "]"}], "[", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     SuperscriptBox[
      RowBox[{"u", "[", "x", "]"}], "a"], ",", 
     SuperscriptBox[
      RowBox[{"u", "[", "x", "]"}], 
      RowBox[{"2", " ", "a"}]], ",", 
     SuperscriptBox[
      RowBox[{"u", "[", "x", "]"}], "b"], ",", 
     SuperscriptBox[
      RowBox[{"u", "[", "x", "]"}], 
      RowBox[{"a", "+", "b"}]], ",", 
     SuperscriptBox[
      RowBox[{"u", "[", "x", "]"}], 
      RowBox[{"2", " ", "b"}]]}], "}"}], "]"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8172175864435053`*^9, 3.817217647582498*^9}, {
   3.817217679831688*^9, 3.817217707790924*^9}, {3.817218114291539*^9, 
   3.817218132223927*^9}, {3.8172181712127943`*^9, 3.817218188894442*^9}, 
   3.8172182266199703`*^9},
 CellLabel->
  "In[133]:=",ExpressionUUID->"0b6fb899-2078-47fb-b1af-9862ef330b5b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"12.256297`", ",", 
   TagBox[GridBox[{
      {"\[Piecewise]", GridBox[{
         {
          RowBox[{"{", 
           RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
           "}"}], 
          RowBox[{
           RowBox[{"a", "\[Equal]", "0"}], "&&", 
           RowBox[{"b", "\[Equal]", "0"}]}]},
         {
          RowBox[{"{", 
           RowBox[{"1", ",", "1", ",", "1", ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], "b"], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], "b"], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], 
             RowBox[{"2", " ", "b"}]]}], "}"}], 
          RowBox[{
           RowBox[{"a", "\[Equal]", "0"}], "&&", 
           RowBox[{"b", "\[NotEqual]", "0"}]}]},
         {
          RowBox[{"{", 
           RowBox[{"1", ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], "a"], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], 
             RowBox[{"2", " ", "a"}]], ",", "1", ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], "a"], ",", "1"}], "}"}], 
          RowBox[{
           RowBox[{"a", "\[NotEqual]", "0"}], "&&", 
           RowBox[{"b", "\[Equal]", "0"}]}]},
         {
          RowBox[{"{", 
           RowBox[{"1", ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], "a"], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], 
             RowBox[{"2", " ", "a"}]], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], "b"], ",", "1", ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], 
             RowBox[{"2", " ", "b"}]]}], "}"}], 
          RowBox[{
           RowBox[{"a", "\[Equal]", 
            RowBox[{"-", "b"}]}], "&&", 
           RowBox[{"b", "\[NotEqual]", "0"}]}]},
         {
          RowBox[{"{", 
           RowBox[{"1", ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], "a"], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], 
             RowBox[{"4", " ", "b"}]], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], "b"], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], 
             RowBox[{"3", " ", "b"}]], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], "a"]}], "}"}], 
          RowBox[{
           RowBox[{"a", "\[Equal]", 
            RowBox[{"2", " ", "b"}]}], "&&", 
           RowBox[{"b", "\[NotEqual]", "0"}]}]},
         {
          RowBox[{"{", 
           RowBox[{"1", ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], "b"], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], 
             RowBox[{"2", " ", "b"}]], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], "b"], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], 
             RowBox[{"2", " ", "b"}]], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], 
             RowBox[{"2", " ", "b"}]]}], "}"}], 
          RowBox[{
           RowBox[{"a", "\[Equal]", "b"}], "&&", 
           RowBox[{"b", "\[NotEqual]", "0"}]}]},
         {
          RowBox[{"{", 
           RowBox[{"1", ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], "a"], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], "b"], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], "b"], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], 
             RowBox[{"3", " ", "a"}]], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], 
             RowBox[{"2", " ", "b"}]]}], "}"}], 
          RowBox[{
           RowBox[{"a", "\[Equal]", 
            FractionBox["b", "2"]}], "&&", 
           RowBox[{"b", "\[NotEqual]", "0"}]}]},
         {
          RowBox[{"{", 
           RowBox[{"1", ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], "a"], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], 
             RowBox[{"2", " ", "a"}]], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], "b"], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], 
             RowBox[{"a", "+", "b"}]], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], 
             RowBox[{"2", " ", "b"}]]}], "}"}], 
          RowBox[{
           RowBox[{"a", " ", 
            RowBox[{"(", 
             RowBox[{"a", "-", 
              RowBox[{"2", " ", "b"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"a", "-", "b"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "a"}], "-", "b"}], ")"}], " ", "b", " ", 
            RowBox[{"(", 
             RowBox[{"a", "+", "b"}], ")"}]}], "\[NotEqual]", "0"}]},
         {"$Failed", 
          TagBox["True",
           "PiecewiseDefault",
           AutoDelete->True]}
        },
        AllowedDimensions->{2, Automatic},
        Editable->True,
        GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.84]}, 
            Offset[0.27999999999999997`]}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}},
        Selectable->True]}
     },
     GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.35]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    "Piecewise",
    DeleteWithContents->True,
    Editable->False,
    SelectWithContents->True,
    Selectable->False,
    StripWrapperBoxes->True]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8172176343879423`*^9, {3.817217666656941*^9, 3.817217699108679*^9}, 
   3.817217729782374*^9, 3.817218133202525*^9, 3.81721819690174*^9, 
   3.817218250402636*^9, 3.8172183121267233`*^9, 3.821262431167639*^9},
 CellLabel->
  "Out[133]=",ExpressionUUID->"df220e68-d9f5-429f-b88e-0a157e359782"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BasisOperator", "[", "variables", "]"}], "[", 
   RowBox[{"%", "[", 
    RowBox[{"[", "2", "]"}], "]"}], "]"}], "//", "AbsoluteTiming"}]], "Input",\

 CellChangeTimes->{{3.817217567323004*^9, 3.817217576800693*^9}, {
  3.817218176450637*^9, 3.817218201768179*^9}},
 CellLabel->
  "In[134]:=",ExpressionUUID->"034a0458-293b-40d9-9595-146556fbf2e8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.308458`", ",", 
   TagBox[GridBox[{
      {"\[Piecewise]", GridBox[{
         {
          RowBox[{"{", "1", "}"}], 
          RowBox[{
           RowBox[{"a", "\[Equal]", "0"}], "&&", 
           RowBox[{"b", "\[Equal]", "0"}]}]},
         {
          RowBox[{"{", 
           RowBox[{"1", ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], "b"], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], 
             RowBox[{"2", " ", "b"}]]}], "}"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"a", "\[Equal]", "0"}], "&&", 
             RowBox[{"b", "\[NotEqual]", "0"}]}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"b", "\[NotEqual]", "0"}], "&&", 
             RowBox[{
              RowBox[{"a", "-", 
               RowBox[{"2", " ", "b"}]}], "\[NotEqual]", "0"}], "&&", 
             RowBox[{
              RowBox[{"a", "-", "b"}], "\[Equal]", "0"}], "&&", 
             RowBox[{
              RowBox[{"a", "+", "b"}], "\[NotEqual]", "0"}]}], ")"}]}]},
         {
          RowBox[{"{", 
           RowBox[{"1", ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], "a"], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], 
             RowBox[{"2", " ", "a"}]]}], "}"}], 
          RowBox[{
           RowBox[{"a", "\[NotEqual]", "0"}], "&&", 
           RowBox[{"b", "\[Equal]", "0"}]}]},
         {
          RowBox[{"{", 
           RowBox[{"1", ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], "a"], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], 
             RowBox[{"2", " ", "a"}]], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], "b"], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], 
             RowBox[{"2", " ", "b"}]]}], "}"}], 
          RowBox[{
           RowBox[{
            RowBox[{"a", "+", "b"}], "\[Equal]", "0"}], "&&", 
           RowBox[{"b", "\[NotEqual]", "0"}]}]},
         {
          RowBox[{"{", 
           RowBox[{"1", ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], "a"], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], "b"], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], 
             RowBox[{"3", " ", "b"}]], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], 
             RowBox[{"4", " ", "b"}]]}], "}"}], 
          RowBox[{
           RowBox[{
            RowBox[{"a", "-", 
             RowBox[{"2", " ", "b"}]}], "\[Equal]", "0"}], "&&", 
           RowBox[{"b", "\[NotEqual]", "0"}]}]},
         {
          RowBox[{"{", 
           RowBox[{"1", ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], "a"], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], 
             RowBox[{"3", " ", "a"}]], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], "b"], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], 
             RowBox[{"2", " ", "b"}]]}], "}"}], 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"2", " ", "a"}], "-", "b"}], "\[Equal]", "0"}], "&&", 
           RowBox[{"b", "\[NotEqual]", "0"}]}]},
         {
          RowBox[{"{", 
           RowBox[{"1", ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], "a"], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], 
             RowBox[{"2", " ", "a"}]], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], "b"], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], 
             RowBox[{"2", " ", "b"}]], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], 
             RowBox[{"a", "+", "b"}]]}], "}"}], 
          RowBox[{
           RowBox[{
            RowBox[{"2", " ", 
             SuperscriptBox["a", "5"], " ", "b"}], "-", 
            RowBox[{"5", " ", 
             SuperscriptBox["a", "4"], " ", 
             SuperscriptBox["b", "2"]}], "+", 
            RowBox[{"5", " ", 
             SuperscriptBox["a", "2"], " ", 
             SuperscriptBox["b", "4"]}], "-", 
            RowBox[{"2", " ", "a", " ", 
             SuperscriptBox["b", "5"]}]}], "\[NotEqual]", "0"}]},
         {"$Failed", 
          TagBox["True",
           "PiecewiseDefault",
           AutoDelete->True]}
        },
        AllowedDimensions->{2, Automatic},
        Editable->True,
        GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.84]}, 
            Offset[0.27999999999999997`]}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}},
        Selectable->True]}
     },
     GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.35]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    "Piecewise",
    DeleteWithContents->True,
    Editable->False,
    SelectWithContents->True,
    Selectable->False,
    StripWrapperBoxes->True]}], "}"}]], "Output",
 CellChangeTimes->{3.817217584654132*^9, 3.817218147145192*^9, 
  3.81721820261263*^9, 3.817218250857533*^9, 3.817218312669496*^9, 
  3.821262437614842*^9},
 CellLabel->
  "Out[134]=",ExpressionUUID->"c21b3fa1-8fdb-446c-995d-e6243c95246b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BasisOperator", "[", "variables", "]"}], "[", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     SuperscriptBox[
      RowBox[{"u", "[", "x", "]"}], "a"], ",", 
     SuperscriptBox[
      RowBox[{"u", "[", "x", "]"}], 
      RowBox[{"2", " ", "a"}]], ",", 
     SuperscriptBox[
      RowBox[{"u", "[", "x", "]"}], "b"], ",", 
     SuperscriptBox[
      RowBox[{"u", "[", "x", "]"}], 
      RowBox[{"a", "+", "b"}]]}], "}"}], "]"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8172181577792463`*^9, 3.817218194475254*^9}},
 CellLabel->
  "In[135]:=",ExpressionUUID->"40fb8d6e-6e34-4c5f-908e-27d0b35e2557"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.283359`", ",", 
   TagBox[GridBox[{
      {"\[Piecewise]", GridBox[{
         {
          RowBox[{"{", "1", "}"}], 
          RowBox[{
           RowBox[{"b", "\[Equal]", "0"}], "&&", 
           RowBox[{"a", "\[Equal]", "0"}]}]},
         {
          RowBox[{"{", 
           RowBox[{"1", ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], "b"]}], "}"}], 
          RowBox[{
           RowBox[{"a", "\[Equal]", "0"}], "&&", 
           RowBox[{"b", "\[NotEqual]", "0"}]}]},
         {
          RowBox[{"{", 
           RowBox[{"1", ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], "a"], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], 
             RowBox[{"2", " ", "a"}]]}], "}"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"a", "\[Equal]", "b"}], "&&", 
             RowBox[{"b", "\[NotEqual]", "0"}]}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"b", "\[Equal]", "0"}], "&&", 
             RowBox[{"a", "\[NotEqual]", "0"}]}], ")"}]}]},
         {
          RowBox[{"{", 
           RowBox[{"1", ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], "a"], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], 
             RowBox[{"2", " ", "a"}]], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], "b"]}], "}"}], 
          RowBox[{
           RowBox[{"a", "\[Equal]", 
            RowBox[{"-", "b"}]}], "&&", 
           RowBox[{"b", "\[NotEqual]", "0"}]}]},
         {
          RowBox[{"{", 
           RowBox[{"1", ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], "a"], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], 
             RowBox[{"2", " ", "a"}]], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], 
             RowBox[{"a", "+", "b"}]]}], "}"}], 
          RowBox[{
           RowBox[{"a", "\[Equal]", 
            FractionBox["b", "2"]}], "&&", 
           RowBox[{"b", "\[NotEqual]", "0"}]}]},
         {
          RowBox[{"{", 
           RowBox[{"1", ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], "a"], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], 
             RowBox[{"2", " ", "a"}]], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], "b"], ",", 
            SuperscriptBox[
             RowBox[{"u", "[", "x", "]"}], 
             RowBox[{"a", "+", "b"}]]}], "}"}], 
          RowBox[{
           RowBox[{"a", " ", 
            RowBox[{"(", 
             RowBox[{"a", "-", "b"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "a"}], "-", "b"}], ")"}], " ", "b", " ", 
            RowBox[{"(", 
             RowBox[{"a", "+", "b"}], ")"}]}], "\[NotEqual]", "0"}]},
         {"$Failed", 
          TagBox["True",
           "PiecewiseDefault",
           AutoDelete->True]}
        },
        AllowedDimensions->{2, Automatic},
        Editable->True,
        GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.84]}, 
            Offset[0.27999999999999997`]}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}},
        Selectable->True]}
     },
     GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.35]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    "Piecewise",
    DeleteWithContents->True,
    Editable->False,
    SelectWithContents->True,
    Selectable->False,
    StripWrapperBoxes->True]}], "}"}]], "Output",
 CellChangeTimes->{3.817218168574258*^9, 3.8172182074085217`*^9, 
  3.817218251379472*^9, 3.817218287257702*^9, 3.821262445299498*^9},
 CellLabel->
  "Out[135]=",ExpressionUUID->"5cf6e73f-f6d6-4078-8379-9368a12660b3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"BasisModNullLagrangiansOperator", "[", "variables", "]"}], "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", 
    SuperscriptBox[
     RowBox[{"u", "[", "x", "]"}], "a"], ",", 
    SuperscriptBox[
     RowBox[{"u", "[", "x", "]"}], 
     RowBox[{"2", " ", "a"}]], ",", 
    SuperscriptBox[
     RowBox[{"u", "[", "x", "]"}], "b"], ",", 
    SuperscriptBox[
     RowBox[{"u", "[", "x", "]"}], 
     RowBox[{"a", "+", "b"}]], ",", 
    SuperscriptBox[
     RowBox[{"u", "[", "x", "]"}], 
     RowBox[{"2", " ", "b"}]]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.817220975196232*^9, 3.817221008174773*^9}, {
  3.817221258502083*^9, 3.817221295642334*^9}},
 CellLabel->
  "In[136]:=",ExpressionUUID->"5410646c-1057-4842-bc5f-a7e2dc5b54d7"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"{", "}"}], 
        RowBox[{
         RowBox[{"b", "\[Equal]", "0"}], "&&", 
         RowBox[{"a", "\[Equal]", "0"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], "a"], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], 
           RowBox[{"2", " ", "a"}]]}], "}"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "\[Equal]", "b"}], "&&", 
           RowBox[{"b", "\[NotEqual]", "0"}]}], ")"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"b", "\[Equal]", "0"}], "&&", 
           RowBox[{"a", "\[NotEqual]", "0"}]}], ")"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], "b"], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], 
           RowBox[{"2", " ", "b"}]]}], "}"}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", "0"}], "&&", 
         RowBox[{"b", "\[NotEqual]", "0"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], "a"], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], 
           RowBox[{"2", " ", "a"}]], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], "b"], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], 
           RowBox[{"2", " ", "b"}]]}], "}"}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", 
          RowBox[{"-", "b"}]}], "&&", 
         RowBox[{"b", "\[NotEqual]", "0"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], "a"], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], 
           RowBox[{"2", " ", "a"}]], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], "b"], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], 
           RowBox[{"a", "+", "b"}]]}], "}"}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", 
          RowBox[{"2", " ", "b"}]}], "&&", 
         RowBox[{"b", "\[NotEqual]", "0"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], "a"], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], 
           RowBox[{"2", " ", "a"}]], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], 
           RowBox[{"2", " ", "b"}]], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], 
           RowBox[{"a", "+", "b"}]]}], "}"}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", 
          FractionBox["b", "2"]}], "&&", 
         RowBox[{"b", "\[NotEqual]", "0"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], "a"], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], 
           RowBox[{"2", " ", "a"}]], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], "b"], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], 
           RowBox[{"2", " ", "b"}]], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], 
           RowBox[{"a", "+", "b"}]]}], "}"}], 
        RowBox[{
         RowBox[{"a", " ", 
          RowBox[{"(", 
           RowBox[{"a", "-", 
            RowBox[{"2", " ", "b"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"a", "-", "b"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "a"}], "-", "b"}], ")"}], " ", "b", " ", 
          RowBox[{"(", 
           RowBox[{"a", "+", "b"}], ")"}]}], "\[NotEqual]", "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{
  3.817220990898056*^9, 3.817221021272917*^9, {3.8172212595772657`*^9, 
   3.81722129680827*^9}, 3.821262452049795*^9},
 CellLabel->
  "Out[136]=",ExpressionUUID->"f8a14383-260c-4c07-b05e-8afdd81d0131"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", "\[IndentingNewLine]", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", "u", "}"}]}], ",", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}], ",", " ", 
     RowBox[{"\"\<pars\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}]}], ",", 
     RowBox[{"\"\<eqRhs\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"u", "''"}], "[", "x", "]"}], "}"}]}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<timederivativeorder\>\"", "\[Rule]", "1"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindConservedQuantityBasisOperator", "[", "variables", "]"}], "[", 
  
  RowBox[{"Association", "[", 
   RowBox[{
    RowBox[{"\"\<derivatives\>\"", "\[Rule]", "0"}], ",", 
    RowBox[{"\"\<degree\>\"", "\[Rule]", "2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<generators\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"u", "[", "x", "]"}], "^", "a"}], ",", " ", 
       RowBox[{
        RowBox[{"u", "[", "x", "]"}], "^", "b"}]}], "}"}]}]}], "]"}], 
  "]"}]}], "Input",
 CellLabel->
  "In[137]:=",ExpressionUUID->"d1b50f47-8927-40c5-92af-e306ae2d08f5"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{{3.817221942104224*^9, 3.817221959492457*^9}, 
   3.821262544818803*^9},
 CellLabel->
  "Out[138]=",ExpressionUUID->"fb4d93b3-2f8c-4d4e-a136-3e80e251f7de"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"variables", "=", "\[IndentingNewLine]", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<depVars\>\"", "\[Rule]", 
      RowBox[{"{", "u", "}"}]}], ",", 
     RowBox[{"\"\<indVars\>\"", "\[Rule]", 
      RowBox[{"{", "x", "}"}]}], ",", " ", 
     RowBox[{"\"\<pars\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}]}], ",", 
     RowBox[{"\"\<eqRhs\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"u", "''"}], "[", "x", "]"}], "}"}]}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<timederivativeorder\>\"", "\[Rule]", "1"}]}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->"In[97]:=",ExpressionUUID->"9eb4174a-f2de-4ef1-b2e5-ac53ab5ec9f4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"MonomialsOperator", "[", "variables", "]"}], "[", 
  RowBox[{"Association", "[", 
   RowBox[{
    RowBox[{"\"\<derivatives\>\"", "\[Rule]", "0"}], ",", 
    RowBox[{"\"\<degree\>\"", "\[Rule]", "2"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<generators\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"u", "[", "x", "]"}], "^", "a"}], ",", " ", 
       RowBox[{
        RowBox[{"u", "[", "x", "]"}], "^", "b"}]}], "}"}]}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.817222224937886*^9, 3.817222243900415*^9}},
 CellLabel->
  "In[104]:=",ExpressionUUID->"88f97c42-0d34-4a42-a7a8-3fe7a1c31d64"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   SuperscriptBox[
    RowBox[{"u", "[", "x", "]"}], "a"], ",", 
   SuperscriptBox[
    RowBox[{"u", "[", "x", "]"}], 
    RowBox[{"2", " ", "a"}]], ",", 
   SuperscriptBox[
    RowBox[{"u", "[", "x", "]"}], "b"], ",", 
   SuperscriptBox[
    RowBox[{"u", "[", "x", "]"}], 
    RowBox[{"a", "+", "b"}]], ",", 
   SuperscriptBox[
    RowBox[{"u", "[", "x", "]"}], 
    RowBox[{"2", " ", "b"}]]}], "}"}]], "Output",
 CellChangeTimes->{3.817222245195056*^9, 3.817222287048967*^9, 
  3.8212617519254*^9, 3.821261813109991*^9},
 CellLabel->
  "Out[104]=",ExpressionUUID->"3ef08f82-3142-4c78-baef-490dbe413ea6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"BasisModNullLagrangiansOperator", "[", "variables", "]"}], "[", 
  "%", "]"}]], "Input",
 CellChangeTimes->{{3.817222280498886*^9, 3.817222290651188*^9}},
 CellLabel->
  "In[105]:=",ExpressionUUID->"5e87d7b6-10de-44d8-aea1-df09c3a37ece"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"{", "}"}], 
        RowBox[{
         RowBox[{"b", "\[Equal]", "0"}], "&&", 
         RowBox[{"a", "\[Equal]", "0"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], "a"], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], 
           RowBox[{"2", " ", "a"}]]}], "}"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "\[Equal]", "b"}], "&&", 
           RowBox[{"b", "\[NotEqual]", "0"}]}], ")"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"b", "\[Equal]", "0"}], "&&", 
           RowBox[{"a", "\[NotEqual]", "0"}]}], ")"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], "b"], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], 
           RowBox[{"2", " ", "b"}]]}], "}"}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", "0"}], "&&", 
         RowBox[{"b", "\[NotEqual]", "0"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], "a"], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], 
           RowBox[{"2", " ", "a"}]], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], "b"], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], 
           RowBox[{"2", " ", "b"}]]}], "}"}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", 
          RowBox[{"-", "b"}]}], "&&", 
         RowBox[{"b", "\[NotEqual]", "0"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], "a"], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], 
           RowBox[{"2", " ", "a"}]], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], "b"], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], 
           RowBox[{"a", "+", "b"}]]}], "}"}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", 
          RowBox[{"2", " ", "b"}]}], "&&", 
         RowBox[{"b", "\[NotEqual]", "0"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], "a"], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], 
           RowBox[{"2", " ", "a"}]], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], 
           RowBox[{"2", " ", "b"}]], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], 
           RowBox[{"a", "+", "b"}]]}], "}"}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", 
          FractionBox["b", "2"]}], "&&", 
         RowBox[{"b", "\[NotEqual]", "0"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], "a"], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], 
           RowBox[{"2", " ", "a"}]], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], "b"], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], 
           RowBox[{"2", " ", "b"}]], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], 
           RowBox[{"a", "+", "b"}]]}], "}"}], 
        RowBox[{
         RowBox[{"a", " ", 
          RowBox[{"(", 
           RowBox[{"a", "-", 
            RowBox[{"2", " ", "b"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"a", "-", "b"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "a"}], "-", "b"}], ")"}], " ", "b", " ", 
          RowBox[{"(", 
           RowBox[{"a", "+", "b"}], ")"}]}], "\[NotEqual]", "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{{3.817222292329225*^9, 3.817222318384197*^9}, 
   3.821261753786933*^9, 3.8212618150948067`*^9},
 CellLabel->
  "Out[105]=",ExpressionUUID->"3742815a-2c7b-4a4e-9785-ecc68dff212b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"%", "//", 
   RowBox[{"PiecewiseFullSimplifyOperator", "[", "variables", "]"}]}], "//", 
  "PiecewiseBeautify"}]], "Input",
 CellChangeTimes->{{3.817222294764002*^9, 3.817222335532158*^9}, {
  3.8212617979193068`*^9, 3.82126180250891*^9}},
 CellLabel->
  "In[106]:=",ExpressionUUID->"540e8f93-0567-45bb-8ef1-04256ca91362"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"{", "}"}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", "0"}], "&&", 
         RowBox[{"b", "\[Equal]", "0"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], "a"], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], 
           RowBox[{"2", " ", "a"}]]}], "}"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "\[Equal]", "b"}], "&&", 
           RowBox[{"b", "\[NotEqual]", "0"}]}], ")"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"b", "\[Equal]", "0"}], "&&", 
           RowBox[{"a", "\[NotEqual]", "0"}]}], ")"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], "b"], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], 
           RowBox[{"2", " ", "b"}]]}], "}"}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", "0"}], "&&", 
         RowBox[{"b", "\[NotEqual]", "0"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], "a"], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], 
           RowBox[{"2", " ", "a"}]], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], "b"], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], 
           RowBox[{"2", " ", "b"}]]}], "}"}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", 
          RowBox[{"-", "b"}]}], "&&", 
         RowBox[{"b", "\[NotEqual]", "0"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], "a"], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], 
           RowBox[{"4", " ", "b"}]], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], "b"], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], 
           RowBox[{"3", " ", "b"}]]}], "}"}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", 
          RowBox[{"2", " ", "b"}]}], "&&", 
         RowBox[{"b", "\[NotEqual]", "0"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], "a"], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], "b"], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], 
           RowBox[{"2", " ", "b"}]], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], 
           RowBox[{"3", " ", "a"}]]}], "}"}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", 
          FractionBox["b", "2"]}], "&&", 
         RowBox[{"b", "\[NotEqual]", "0"}]}]},
       {
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], "a"], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], 
           RowBox[{"2", " ", "a"}]], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], "b"], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], 
           RowBox[{"2", " ", "b"}]], ",", 
          SuperscriptBox[
           RowBox[{"u", "[", "x", "]"}], 
           RowBox[{"a", "+", "b"}]]}], "}"}], 
        RowBox[{
         RowBox[{"a", " ", 
          RowBox[{"(", 
           RowBox[{"a", "-", 
            RowBox[{"2", " ", "b"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"a", "-", "b"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "a"}], "-", "b"}], ")"}], " ", "b", " ", 
          RowBox[{"(", 
           RowBox[{"a", "+", "b"}], ")"}]}], "\[NotEqual]", "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{{3.817222300720072*^9, 3.817222336678136*^9}, 
   3.821261771905086*^9, {3.82126180366541*^9, 3.8212618158952017`*^9}},
 CellLabel->
  "Out[106]=",ExpressionUUID->"f33d2070-5022-4596-8407-cdddcd58e91d"]
}, Open  ]],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", " ", "x"}], ",", 
          RowBox[{"b", " ", "x"}]}], "}"}], 
        RowBox[{
         RowBox[{
          RowBox[{"a", "+", "b"}], "\[Equal]", "0"}], "&&", 
         RowBox[{"b", "\[NotEqual]", "0"}]}]},
       {"0", 
        RowBox[{"b", "\[Equal]", "0"}]},
       {
        RowBox[{"b", " ", "x"}], 
        RowBox[{
         RowBox[{"a", "+", "b"}], "\[NotEqual]", "0"}]},
       {"$Failed", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Input",
 CellChangeTimes->{{3.817222466954658*^9, 
  3.817222466984466*^9}},ExpressionUUID->"a613af24-3697-4b1f-a3c0-\
739bdd55b0d9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"a", "\[Equal]", 
   RowBox[{"-", "b"}]}], "//", "Solve"}]], "Input",
 CellChangeTimes->{{3.8172224444310093`*^9, 3.8172224454947023`*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"0cac3b16-594e-4ed4-8c31-6b827d35f601"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"b", "\[Rule]", 
    RowBox[{"-", "a"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.8212618312772207`*^9},
 CellLabel->
  "Out[107]=",ExpressionUUID->"54c8d076-1870-4e07-bf40-7afd3cc7f438"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"a", " ", "x"}], ",", 
    RowBox[{"b", " ", "x"}]}], "}"}], "/.", 
  RowBox[{"{", 
   RowBox[{"b", "\[Rule]", "a"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.817222455273694*^9, 3.817222464213771*^9}},
 CellLabel->
  "In[108]:=",ExpressionUUID->"b307006b-9a54-4189-b622-c2304c32a4eb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"a", " ", "x"}], ",", 
   RowBox[{"a", " ", "x"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.817222445995103*^9, 3.817222464809862*^9}, 
   3.821261836382592*^9},
 CellLabel->
  "Out[108]=",ExpressionUUID->"6a42b3ec-30c5-421d-a42a-739278f06353"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{2283, 1770},
WindowMargins->{{495, Automatic}, {Automatic, 106}},
Magnification:>2. Inherited,
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"8d956a1b-8790-4c90-9ae4-c94b32a90377"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 215, 4, 194, "Title",ExpressionUUID->"660c5f89-d5c5-46f0-a9b7-acfdb00ac19e"],
Cell[CellGroupData[{
Cell[820, 30, 160, 3, 134, "Section",ExpressionUUID->"8c364c31-4701-42d2-a687-90db0913d535"],
Cell[CellGroupData[{
Cell[1005, 37, 177, 3, 89, "Subsubsection",ExpressionUUID->"c91640c0-c34b-4242-bfeb-350001a31e0e"],
Cell[1185, 42, 1336, 37, 148, "Input",ExpressionUUID->"6b6da443-fd80-48d5-9051-8697ae02c55b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2558, 84, 272, 6, 89, "Subsubsection",ExpressionUUID->"49e7efb4-d945-4cc4-a1bb-7510f77327e5"],
Cell[CellGroupData[{
Cell[2855, 94, 579, 16, 59, "Input",ExpressionUUID->"d651cbc8-57ac-4eb3-95fb-46709b740fa4",
 CellID->2092730607],
Cell[3437, 112, 1423, 43, 154, "Output",ExpressionUUID->"4be4dd98-edcb-46da-9339-5e8fc1f46bc9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4897, 160, 288, 5, 81, "Input",ExpressionUUID->"ece3608f-3a02-4d03-ab30-21b08493e98b",
 CellID->630831398],
Cell[5188, 167, 1530, 44, 154, "Output",ExpressionUUID->"5c300576-cf48-4eea-bc44-13fd67164e37"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[6779, 218, 201, 4, 134, "Section",ExpressionUUID->"cc7bf2ea-1042-4f53-8424-4d51d116bb60"],
Cell[6983, 224, 744, 15, 101, "Input",ExpressionUUID->"1dd2c54f-45e6-4a76-a6e3-2f5ffd33a964"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7764, 244, 152, 3, 134, "Section",ExpressionUUID->"45cc56ef-041b-4da7-8764-6b41d29558e8"],
Cell[7919, 249, 176, 3, 69, "Text",ExpressionUUID->"e92a43af-5db4-4209-acff-7226d65c19c1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8132, 257, 162, 3, 134, "Section",ExpressionUUID->"de998a16-8ce0-4e34-9ae8-a5e52e35a040"],
Cell[8297, 262, 6474, 152, 4029, "Text",ExpressionUUID->"fa6ee681-9051-42ab-998a-3a17525bca9e"],
Cell[14774, 416, 162, 3, 59, "Input",ExpressionUUID->"4d050471-87e2-4d27-90c1-bad0c7a9cf28"]
}, Open  ]],
Cell[14951, 422, 283, 4, 134, "Section",ExpressionUUID->"559cd727-0d0e-4244-9f3a-b9baa66b95b0"],
Cell[CellGroupData[{
Cell[15259, 430, 168, 3, 102, "Section",ExpressionUUID->"6bd3e7fd-72cf-4212-bfe8-3d05e4514dcb"],
Cell[15430, 435, 353, 8, 59, "Input",ExpressionUUID->"faa19278-7293-4329-b962-433f359b407f"],
Cell[15786, 445, 428, 13, 384, "Text",ExpressionUUID->"c0f63a61-1f79-40f1-a012-70d75abb4d6c"],
Cell[16217, 460, 283, 7, 69, "Text",ExpressionUUID->"289b0013-e232-493f-b8c5-e101244d2b59"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16537, 472, 165, 3, 136, "Chapter",ExpressionUUID->"f3588e6c-dc58-4a91-829f-958ad5a5f003"],
Cell[16705, 477, 940, 21, 519, "Text",ExpressionUUID->"cf6a1b95-c3a2-4bec-818c-46a8cdc07c5f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17682, 503, 161, 3, 136, "Chapter",ExpressionUUID->"1dfc02ec-141c-4c78-bb1a-810232d25d33"],
Cell[17846, 508, 434, 7, 142, "Input",ExpressionUUID->"0fd15392-9e76-46dd-a74f-2e691e78208f"],
Cell[18283, 517, 3277, 66, 429, "Input",ExpressionUUID->"339b03c6-8f45-4f22-ad48-3dda91fee247"],
Cell[21563, 585, 1091, 16, 183, "Input",ExpressionUUID->"372b511f-bbfa-47c1-93d4-20cd4550c854"],
Cell[22657, 603, 296, 5, 59, "Input",ExpressionUUID->"1f361008-c2c3-4635-a392-5888c5aba180"],
Cell[22956, 610, 325, 6, 59, "Input",ExpressionUUID->"597d05e8-779a-4137-958e-83d1e6ef9dd6"],
Cell[23284, 618, 279, 5, 59, "Input",ExpressionUUID->"29181715-fa26-4cbc-8bdc-be7eb53ef8b3"],
Cell[23566, 625, 177, 3, 59, "Input",ExpressionUUID->"d97029a8-d08e-4040-be1e-9114bc153b5c"],
Cell[23746, 630, 173, 3, 59, "Input",ExpressionUUID->"b3609549-17e5-4436-82e3-90a8d6c5b538"],
Cell[23922, 635, 325, 6, 69, "Text",ExpressionUUID->"828c4924-d275-47ad-b89d-1a5c4e98ff1d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24284, 646, 249, 4, 136, "Chapter",ExpressionUUID->"23e99a9e-fcbc-41d0-9349-779ee389921a"],
Cell[24536, 652, 822, 17, 101, "Input",ExpressionUUID->"5bcf10f1-ce54-45ae-983b-76c010d8f1a1"],
Cell[25361, 671, 1645, 29, 757, "Input",ExpressionUUID->"722c05b9-8d56-4a27-806f-42687e710548"],
Cell[27009, 702, 290, 6, 69, "Text",ExpressionUUID->"9fea0dec-be45-41dd-81a6-39b16ae4ae54"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27336, 713, 243, 4, 136, "Chapter",ExpressionUUID->"ac399ee4-2a46-46f6-a413-1a98c4d24f20"],
Cell[27582, 719, 177, 2, 101, "Input",ExpressionUUID->"dd3ea5a0-2a8e-42b7-bdf4-3546e08427cc"],
Cell[27762, 723, 477, 12, 59, "Input",ExpressionUUID->"ed112829-fbc4-4ce6-a84b-f3abd52626f5"],
Cell[28242, 737, 110, 0, 59, "Input",ExpressionUUID->"2907e74b-2b9d-4a15-8a68-e90853eb9324"],
Cell[28355, 739, 170, 3, 59, "Input",ExpressionUUID->"321edaf1-c1a6-4630-8ed1-a5278e280896"],
Cell[28528, 744, 359, 7, 59, "Input",ExpressionUUID->"f9eceb12-5215-4a23-b02f-4cc324f007d8"],
Cell[28890, 753, 368, 6, 69, "Text",ExpressionUUID->"d47614c9-7ad7-402d-a17b-bae9519100c7"],
Cell[29261, 761, 400, 8, 59, "Input",ExpressionUUID->"32243a93-53e0-4139-9607-afa6ba106572"],
Cell[CellGroupData[{
Cell[29686, 773, 163, 3, 134, "Section",ExpressionUUID->"714ce55c-4f69-4945-9aa2-b09867a5dea8"],
Cell[29852, 778, 293, 9, 204, "Text",ExpressionUUID->"8aa751ba-542d-44e6-8b42-143b1d864528"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30182, 792, 201, 4, 134, "Section",ExpressionUUID->"6a87392b-ed68-4bee-bbb9-10179b526c11"],
Cell[30386, 798, 489, 9, 114, "Text",ExpressionUUID->"04582d9e-03ab-4005-a70e-62841e244fcd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30912, 812, 154, 3, 134, "Section",ExpressionUUID->"0391bcea-5179-4842-aa50-8c59174f435b"],
Cell[31069, 817, 225, 3, 59, "Input",ExpressionUUID->"78d043f6-9387-4587-9e8f-19b29491f98b"],
Cell[CellGroupData[{
Cell[31319, 824, 156, 3, 107, "Subsection",ExpressionUUID->"ba32e54e-c1c4-4f68-b519-d599c15ffd3c"],
Cell[31478, 829, 601, 14, 249, "Text",ExpressionUUID->"76437213-bca9-4694-ae9c-a9264e6609f4"],
Cell[32082, 845, 131, 3, 59, "Input",ExpressionUUID->"b117306c-d4aa-4a8f-856b-4c18b76fcc4c"],
Cell[32216, 850, 441, 9, 59, "Input",ExpressionUUID->"fca135d6-89a0-4598-84ff-2b5324bbddf0"],
Cell[CellGroupData[{
Cell[32682, 863, 1004, 26, 101, "Input",ExpressionUUID->"9e70379a-96b6-4a83-a997-8573097410d0"],
Cell[33689, 891, 929, 24, 72, "Output",ExpressionUUID->"be688afc-dafb-452b-9bd2-6c072e155197"]
}, Open  ]],
Cell[34633, 918, 9175, 179, 1991, "Text",ExpressionUUID->"59b2ae38-2776-4982-8fc8-184d42469f53"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43845, 1102, 159, 3, 107, "Subsection",ExpressionUUID->"cfc5e2ba-31f8-43c0-a6f0-fda16dc76315"],
Cell[44007, 1107, 2050, 44, 1014, "Text",ExpressionUUID->"2b7ac6ca-5f60-4604-b089-0935302e8204"],
Cell[46060, 1153, 201, 4, 101, "Input",ExpressionUUID->"d7ce748d-d65f-4968-81b0-f13e62d7d910"],
Cell[46264, 1159, 160, 2, 59, "Input",ExpressionUUID->"7d233a9e-2ed7-499c-9ff8-bd5c26059571"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46461, 1166, 158, 3, 107, "Subsection",ExpressionUUID->"940efe1d-a262-4249-9542-c58473c1bbb8"],
Cell[46622, 1171, 5073, 112, 2859, "Text",ExpressionUUID->"5050bddc-1ae3-46dc-a5f0-44654cfbb74b"],
Cell[51698, 1285, 154, 3, 60, "Input",ExpressionUUID->"2ccce39f-4ed0-4e68-81c1-0f9472399bf1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51889, 1293, 206, 4, 108, "Subsection",ExpressionUUID->"e96ba49f-8cf6-4802-82cb-4890604c1395"],
Cell[52098, 1299, 1130, 22, 346, "Text",ExpressionUUID->"3668904b-e97d-416d-9351-a3a8ee59d33c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53265, 1326, 162, 3, 108, "Subsection",ExpressionUUID->"d7c519b1-a9f2-40f2-b138-4fc7fa775be6"],
Cell[53430, 1331, 1892, 43, 1082, "Text",ExpressionUUID->"64c2113e-f275-4b20-8846-5b2e2feee4e4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55359, 1379, 213, 4, 108, "Subsection",ExpressionUUID->"b8e94292-a741-47c2-a613-7da289eb1b5d"],
Cell[55575, 1385, 4818, 109, 3060, "Text",ExpressionUUID->"69b0e88f-dcc7-4438-ad05-240b1e37a272"],
Cell[CellGroupData[{
Cell[60418, 1498, 361, 9, 60, "Input",ExpressionUUID->"28314bad-1072-449b-8de2-45ea6cbdbf68"],
Cell[60782, 1509, 264, 6, 76, "Output",ExpressionUUID->"c9bed8bd-ea7b-4a41-9949-5e56ee1e70b2"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[61085, 1520, 158, 3, 134, "Section",ExpressionUUID->"e1bcefb6-7d75-490e-8fc3-524e358a53c3"],
Cell[CellGroupData[{
Cell[61268, 1527, 177, 3, 106, "Section",ExpressionUUID->"3bfa24b3-54ca-4026-bf89-dc1492382dc2"],
Cell[61448, 1532, 4658, 134, 4164, "Text",ExpressionUUID->"6e96ae54-8b5a-49a0-872e-626f051fe1f0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66143, 1671, 205, 3, 134, "Section",ExpressionUUID->"1272f8eb-0d74-4baf-b931-051213753cbe"],
Cell[66351, 1676, 1286, 25, 530, "Text",ExpressionUUID->"991be709-e385-4952-b249-98d0ddcaef40"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67674, 1706, 439, 8, 286, "Section",ExpressionUUID->"292905b3-9dd6-4a62-85a3-8ccf983fd97f"],
Cell[68116, 1716, 160, 2, 60, "Input",ExpressionUUID->"3b371471-4c33-4f86-8a52-2c2840530184"],
Cell[CellGroupData[{
Cell[68301, 1722, 178, 3, 108, "Subsection",ExpressionUUID->"e65d9629-69c9-4aaf-b8f1-0ad170615f3d"],
Cell[CellGroupData[{
Cell[68504, 1729, 1244, 34, 146, "Input",ExpressionUUID->"9b48ef71-88e9-43f6-8769-96a0e4f6a527"],
Cell[69751, 1765, 1961, 55, 110, "Output",ExpressionUUID->"fade71a2-c720-460e-9e82-99cbe0db1614"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[71761, 1826, 213, 4, 108, "Subsection",ExpressionUUID->"00dda868-3621-4805-a368-fc8ca56e7a84"],
Cell[71977, 1832, 343, 7, 70, "Text",ExpressionUUID->"a3706572-d43c-489a-9e12-f566e2a1cfe4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72357, 1844, 346, 7, 162, "Subsection",ExpressionUUID->"9d5e0a90-3a90-43a3-bdbe-53c901fa616f"],
Cell[CellGroupData[{
Cell[72728, 1855, 2716, 80, 196, "Input",ExpressionUUID->"c7046333-c10f-4af5-aaeb-4099fe2b0b18"],
Cell[75447, 1937, 160, 3, 68, "Output",ExpressionUUID->"825f7585-43c0-4011-a390-215bf89bd311"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[75668, 1947, 166, 3, 134, "Section",ExpressionUUID->"782d019a-daba-451d-9589-c18a42074772"],
Cell[75837, 1952, 784, 16, 484, "Text",ExpressionUUID->"80933266-b85c-4d7c-85f3-269854d0de88"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76658, 1973, 155, 3, 134, "Section",ExpressionUUID->"055d6c96-18d5-4e65-a56e-525d087947ce"],
Cell[76816, 1978, 160, 2, 60, "Input",ExpressionUUID->"41087d68-6de3-4750-9354-da34cd72999d"],
Cell[CellGroupData[{
Cell[77001, 1984, 251, 4, 108, "Subsection",ExpressionUUID->"55043cf8-4a84-428b-984f-3583da6ca95c"],
Cell[CellGroupData[{
Cell[77277, 1992, 575, 14, 60, "Input",ExpressionUUID->"98fefc5c-b6e2-47d0-bb7c-44a4c7047121"],
Cell[77855, 2008, 523, 12, 74, "Output",ExpressionUUID->"16a9e4a0-f512-4206-aade-38231d058f6c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78415, 2025, 983, 28, 104, "Input",ExpressionUUID->"957f8b8f-6194-4cfb-828f-eaedab96454a"],
Cell[79401, 2055, 4843, 134, 210, "Output",ExpressionUUID->"1f210945-f3a0-4b36-804f-44e393a60e5d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[84281, 2194, 351, 8, 60, "Input",ExpressionUUID->"c8e41661-90e3-4688-9f33-a0514ab342e8"],
Cell[84635, 2204, 1986, 63, 118, "Output",ExpressionUUID->"f1193209-fe59-44ef-894b-8cbdefd1afee"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[86670, 2273, 289, 4, 108, "Subsection",ExpressionUUID->"d3b96470-36ff-4380-a3b6-d92bc410da06"],
Cell[86962, 2279, 1418, 44, 104, "Input",ExpressionUUID->"024fb811-0a10-4321-9fc9-799ec9a9e7f2"],
Cell[CellGroupData[{
Cell[88405, 2327, 2059, 56, 398, "Input",ExpressionUUID->"f0411a63-ea80-49ef-89ed-a4d5472e00c0"],
Cell[90467, 2385, 231, 4, 68, "Output",ExpressionUUID->"44aa5b8b-f454-47cb-9884-7ab3095ef4fe"]
}, Open  ]],
Cell[CellGroupData[{
Cell[90735, 2394, 2212, 58, 356, "Input",ExpressionUUID->"8f68a193-6257-4b09-b202-7291663d3070"],
Cell[92950, 2454, 3643, 117, 254, "Output",ExpressionUUID->"9e785396-ae7b-4fb6-80cd-ce6d718e3166"]
}, Open  ]],
Cell[CellGroupData[{
Cell[96630, 2576, 3901, 119, 270, "Input",ExpressionUUID->"23189629-0fc2-4f2a-9e87-2a602f0d0736"],
Cell[100534, 2697, 469, 6, 68, "Output",ExpressionUUID->"852c32c7-c40b-415e-80f1-69def7ed1074"]
}, Open  ]],
Cell[CellGroupData[{
Cell[101040, 2708, 1471, 45, 112, "Input",ExpressionUUID->"5b295dad-254f-4b27-9476-cbe9bdca8767"],
Cell[102514, 2755, 9875, 285, 810, "Output",ExpressionUUID->"690b164d-a2be-421c-b128-a54d7f612f5d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112426, 3045, 365, 7, 60, "Input",ExpressionUUID->"3a345826-5a25-4e0c-91bf-27a5758abd87"],
Cell[112794, 3054, 11653, 331, 818, "Output",ExpressionUUID->"3d1e6fc6-310e-4cb2-92b0-f054949c151e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[124484, 3390, 255, 4, 60, "Input",ExpressionUUID->"eb80b10a-d775-406b-b909-18f6afe29353"],
Cell[124742, 3396, 10400, 297, 910, "Output",ExpressionUUID->"b08d2e1c-6279-49df-8439-f1a28247ee8c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[135179, 3698, 1956, 54, 356, "Input",ExpressionUUID->"34d31659-376c-469e-a929-77b098cfd8f4"],
Cell[137138, 3754, 251, 4, 68, "Output",ExpressionUUID->"b8a8fb83-8906-4e2a-be5d-7b19a6ccbdd4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[137426, 3763, 1444, 36, 230, "Input",ExpressionUUID->"87b3108d-54c9-4af0-81ea-b1e249f2247e"],
Cell[138873, 3801, 2385, 73, 274, "Output",ExpressionUUID->"76300c75-6782-4c5b-b53e-8a827f4dac19"]
}, Open  ]],
Cell[CellGroupData[{
Cell[141295, 3879, 281, 6, 60, "Input",ExpressionUUID->"f393ba87-674e-4ea8-bdd6-b1800c31ead8"],
Cell[141579, 3887, 2310, 71, 274, "Output",ExpressionUUID->"8e3aad8d-d88f-4134-b3fc-8f7a218362c0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[143926, 3963, 763, 19, 104, "Input",ExpressionUUID->"5703ce60-aeb1-4135-bef7-577a8b0b1269"],
Cell[144692, 3984, 635, 19, 76, "Output",ExpressionUUID->"ccd82a8d-7303-4d3c-97dc-6f3a20c9eb94"]
}, Open  ]],
Cell[145342, 4006, 160, 2, 60, "Input",ExpressionUUID->"a63f873c-d45b-4675-8666-f0404b4551d3"],
Cell[145505, 4010, 748, 20, 146, "Input",ExpressionUUID->"378087c5-8987-42ce-936b-33a32842c79a"],
Cell[CellGroupData[{
Cell[146278, 4034, 946, 25, 68, "Input",ExpressionUUID->"0b6fb899-2078-47fb-b1af-9862ef330b5b"],
Cell[147227, 4061, 6593, 178, 442, "Output",ExpressionUUID->"df220e68-d9f5-429f-b88e-0a157e359782"]
}, Open  ]],
Cell[CellGroupData[{
Cell[153857, 4244, 394, 10, 60, "Input",ExpressionUUID->"034a0458-293b-40d9-9595-146556fbf2e8"],
Cell[154254, 4256, 5916, 162, 472, "Output",ExpressionUUID->"c21b3fa1-8fdb-446c-995d-e6243c95246b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[160207, 4423, 663, 19, 68, "Input",ExpressionUUID->"40fb8d6e-6e34-4c5f-908e-27d0b35e2557"],
Cell[160873, 4444, 4378, 122, 346, "Output",ExpressionUUID->"5cf6e73f-f6d6-4078-8379-9368a12660b3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[165288, 4571, 768, 21, 68, "Input",ExpressionUUID->"5410646c-1057-4842-bc5f-a7e2dc5b54d7"],
Cell[166059, 4594, 5169, 153, 394, "Output",ExpressionUUID->"f8a14383-260c-4c07-b05e-8afdd81d0131"]
}, Open  ]],
Cell[CellGroupData[{
Cell[171265, 4752, 1298, 35, 230, "Input",ExpressionUUID->"d1b50f47-8927-40c5-92af-e306ae2d08f5"],
Cell[172566, 4789, 210, 4, 68, "Output",ExpressionUUID->"fb4d93b3-2f8c-4d4e-a136-3e80e251f7de"]
}, Open  ]],
Cell[172791, 4796, 744, 19, 146, "Input",ExpressionUUID->"9eb4174a-f2de-4ef1-b2e5-ac53ab5ec9f4"],
Cell[CellGroupData[{
Cell[173560, 4819, 676, 17, 104, "Input",ExpressionUUID->"88f97c42-0d34-4a42-a7a8-3fe7a1c31d64"],
Cell[174239, 4838, 655, 19, 76, "Output",ExpressionUUID->"3ef08f82-3142-4c78-baef-490dbe413ea6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[174931, 4862, 272, 6, 60, "Input",ExpressionUUID->"5e87d7b6-10de-44d8-aea1-df09c3a37ece"],
Cell[175206, 4870, 5145, 152, 394, "Output",ExpressionUUID->"3742815a-2c7b-4a4e-9785-ecc68dff212b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[180388, 5027, 357, 8, 60, "Input",ExpressionUUID->"540e8f93-0567-45bb-8ef1-04256ca91362"],
Cell[180748, 5037, 5136, 151, 394, "Output",ExpressionUUID->"f33d2070-5022-4596-8407-cdddcd58e91d"]
}, Open  ]],
Cell[185899, 5191, 1726, 53, 166, "Input",ExpressionUUID->"a613af24-3697-4b1f-a3c0-739bdd55b0d9"],
Cell[CellGroupData[{
Cell[187650, 5248, 256, 6, 60, "Input",ExpressionUUID->"0cac3b16-594e-4ed4-8c31-6b827d35f601"],
Cell[187909, 5256, 250, 7, 68, "Output",ExpressionUUID->"54c8d076-1870-4e07-bf40-7afd3cc7f438"]
}, Open  ]],
Cell[CellGroupData[{
Cell[188196, 5268, 349, 10, 60, "Input",ExpressionUUID->"b307006b-9a54-4189-b622-c2304c32a4eb"],
Cell[188548, 5280, 296, 8, 68, "Output",ExpressionUUID->"6a42b3ec-30c5-421d-a42a-739278f06353"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

